window.__require=function e(t,o,n){function i(a,s){if(!o[a]){if(!t[a]){var l=a.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+a+"'")}}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){return i(t[a][1][e]||e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({App:[function(e,t,o){"use strict";cc._RF.push(t,"eaeeaWDD5pJfqkUameEwNsk","App"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Controller/ResourceController"),i=e("../Initialization/Facade/InitialFacade"),r=e("../Model/PlayModelProxy"),a=e("../Utils/HashMap"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UI=null,t.Animation=null,t.Add=null,t.Sub=null,t.ShowScore=null,t.TimeRed=null,t.TimeWhite=null,t.Result=null,t.Draw=null,t.Revert=null,t}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){o.AppInstance=this,console.log(" app onload "),this.UI&&n.ResourceController.inst.setAtlas(this.UI),this.Animation&&n.ResourceController.inst.setAnimationAtlas(this.Animation),this.Result&&n.ResourceController.inst.setFont(n.Font.ResultScore,this.Result),this.Add&&n.ResourceController.inst.setFont(n.Font.AddScore,this.Add),this.Sub&&n.ResourceController.inst.setFont(n.Font.SubScore,this.Sub),this.ShowScore&&n.ResourceController.inst.setFont(n.Font.ShowScore,this.ShowScore),this.TimeRed&&n.ResourceController.inst.setFont(n.Font.TimeRed,this.TimeRed),this.TimeWhite&&n.ResourceController.inst.setFont(n.Font.TimeWhite,this.TimeWhite)},t.prototype.start=function(){i.InitialFacade.inst.start()},t.prototype.update=function(e){r.PlayModelProxy.inst.addGameTime(-e)},t.TuneMatchMap=new a.HashMap,t.TuneRootMap=new a.HashMap,__decorate([c(cc.SpriteAtlas)],t.prototype,"UI",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"Animation",void 0),__decorate([c(cc.Font)],t.prototype,"Add",void 0),__decorate([c(cc.Font)],t.prototype,"Sub",void 0),__decorate([c(cc.Font)],t.prototype,"ShowScore",void 0),__decorate([c(cc.Font)],t.prototype,"TimeRed",void 0),__decorate([c(cc.Font)],t.prototype,"TimeWhite",void 0),__decorate([c(cc.Font)],t.prototype,"Result",void 0),__decorate([c(cc.Node)],t.prototype,"Draw",void 0),__decorate([c(cc.Node)],t.prototype,"Revert",void 0),t=o=__decorate([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../Controller/ResourceController":"ResourceController","../Initialization/Facade/InitialFacade":"InitialFacade","../Model/PlayModelProxy":"PlayModelProxy","../Utils/HashMap":"HashMap"}],ArrayAniamtion:[function(e,t,o){"use strict";cc._RF.push(t,"f4ef4hvBZ1BSJ3Mzq4H02o6","ArrayAniamtion"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],AudioManager:[function(e,t,o){"use strict";cc._RF.push(t,"88c70Ktw0pBKKUTDtyQ2NkZ","AudioManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=e("../Command/CommonSignal"),r=e("../Controller/GameStateController"),a=e("../Utils/ToSingleton"),s=e("../GamePlay/View/PokerRoot/Recycle"),l=e("../Utils/Signal"),c=e("../GamePlay/View/Poker/PokerPosMediator"),u=e("../Model/PlayModelProxy");window.oncanplay&&(window.oncanplay=function(){S.canPlay=!0});var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayDispatchPokerSignal=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayToDeskSignal=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayPokerPlaceSignal=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayPokerFlySignal=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayRecycleDrawSignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayShakeSignal=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.PlayResultShow=m;var P="sounds/",S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioID={},t.clips=new n.HashMap,t.effectVolumeScale=1,t.musicVolumeScale=.8,t}return __extends(t,e),t.prototype.init=function(e){var t=this;console.log(" start load AudioClip ");var o=this;cc.loader.loadRes(P+"bgm",cc.AudioClip,function(t,n){t?console.error(t):("string"==typeof n._audio&&cc.loader._cache&&cc.loader._cache[n._audio]&&cc.loader._cache[n._audio].buffer&&(n._audio=cc.loader._cache[n._audio].buffer),o.clips.add(n.name,n),e&&e(),o.playMusic("bgm",!0))}),cc.loader.loadResDir(P,function(e,o,n){if(e)console.error(e);else for(var i=0,r=o;i<r.length;i++){var a=r[i];"string"==typeof a._audio&&cc.loader._cache&&cc.loader._cache[a._audio]&&cc.loader._cache[a._audio].buffer&&(a._audio=cc.loader._cache[a._audio].buffer),t.clips.has(a.name)||t.clips.add(a.name,a)}}),this.bindSignal()},t.prototype.setEffectVolume=function(e){this.effectVolumeScale=1,cc.audioEngine.setEffectsVolume(e*this.effectVolumeScale)},t.prototype.setMusicVolume=function(e){this.musicVolumeScale=1,cc.audioEngine.setMusicVolume(e*this.musicVolumeScale)},Object.defineProperty(t.prototype,"EffectVolume",{get:function(){return cc.audioEngine.getEffectsVolume()/this.effectVolumeScale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MusicVolume",{get:function(){return cc.audioEngine.getMusicVolume()/this.musicVolumeScale},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){var e=this;this.setEffectVolume(1),this.setMusicVolume(1),c.ShakePokerSignal.inst.addListener(function(){e.playEffect("shake")},this),y.inst.addListener(function(){e.playEffect("recyclePoker")},this),i.UpdateTimeNumber.inst.addListenerOne(function(e){},this),m.inst.addListener(function(){e.playEffect("result_flip")},this),f.inst.addListener(function(){e.playEffect("pokerFly")},this),h.inst.addListenerOne(function(t){void 0===t&&(t=!1),e.audioID.pokerPlace&&0==t||(e.audioID.pokerPlace=!0,e.playEffect("pokerPlace",!1,function(){}),setTimeout(function(){e.audioID.pokerPlace=null},50))},this),p.inst.addListener(function(){e.playEffect("lay_success")},this),d.inst.addListener(function(t){void 0===t&&(t=!1),e.audioID.devPoker&&0==t||(e.audioID.devPoker=!0,e.playEffect("devPoker",!1,function(){}),setTimeout(function(){e.audioID.devPoker=!1},5))},this),s.PlayRecycleAnimationSignal.inst.addListenerTwo(function(t,o){e.playEffect("recycle"+Math.max(0,u.PlayModelProxy.inst.Combo)%8)},this),i.OpenResultLayerSignal.inst.addListenerOne(function(e){e==r.RoundEndType.TimeUp||r.RoundEndType.Complete},this),i.PlayerScoreChanged.inst.addListenerThree(function(e,t,o){},this),r.RoundStartSignal.inst.addListener(function(){},this),i.GamePauseSignal.inst.addListener(function(){e.playEffect("pause")},this),i.GameOverSignal.inst.addListenerOne(function(e){switch(e){case r.RoundEndType.Complete:case r.RoundEndType.TimeUp:case r.RoundEndType.Over:}},this)},t.prototype.playEffect=function(e,o,n){var i=this;if(void 0===o&&(o=!1),t.canPlay){if(!(cc.audioEngine.getEffectsVolume()<=.05)){var r=this.clips.get(e);r?(this.audioID[e]=cc.audioEngine.playEffect(r,o),cc.audioEngine.setFinishCallback(this.audioID[e],function(){n&&n()})):cc.loader.loadRes(P+e,cc.AudioClip,function(t,r){t?console.error(t):("string"==typeof r._audio&&cc.loader._cache&&cc.loader._cache[r._audio]&&cc.loader._cache[r._audio].buffer&&(r._audio=cc.loader._cache[r._audio].buffer),i.clips.add(r.name,r),i.audioID[e]=cc.audioEngine.playEffect(r,o),cc.audioEngine.setFinishCallback(i.audioID[e],function(){n&&n()}))})}}else this.bindTouch()},t.prototype.playMusic=function(e,o){var n=this;if(void 0===o&&(o=!0),!t.canPlay)return this.bindTouch(),void t.PlayedList.push({loop:!0,volume:1,clipName:e,supTime:Date.now(),skip:!1,isBgm:!0});var i=this.clips.get(e);i?this.audioID[e]=cc.audioEngine.playMusic(i,o):cc.loader.loadRes(P+e,cc.AudioClip,function(t,i){t?console.error(t):("string"==typeof i._audio&&cc.loader._cache&&cc.loader._cache[i._audio]&&cc.loader._cache[i._audio].buffer&&(i._audio=cc.loader._cache[i._audio].buffer),n.clips.add(i.name,i),n.audioID[e]=cc.audioEngine.playMusic(i,o))})},t.prototype.bindTouch=function(){if(!t.hasBindTouch){var e=this,o=function(){var n;for(cc.game.canvas.removeEventListener("touchstart",o),t.canPlay=!0;(n=t.PlayedList.pop())&&e.clips.get(n.clipName)&&!n.skip;)cc.audioEngine.playMusic(e.clips.get(n.clipName),n.loop)};t.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",o)}},t.PlayedList=[],t.canPlay=cc.sys.WIN32==cc.sys.platform,t.hasBindTouch=!1,t}(a.SingleTon());o.gAudio=S.inst,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","../GamePlay/View/Poker/PokerPosMediator":"PokerPosMediator","../GamePlay/View/PokerRoot/Recycle":"Recycle","../Model/PlayModelProxy":"PlayModelProxy","../Utils/HashMap":"HashMap","../Utils/Signal":"Signal","../Utils/ToSingleton":"ToSingleton"}],BaseMediator:[function(e,t,o){"use strict";cc._RF.push(t,"a76c1ySm3tAQId4zbAsdr/d","BaseMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){console.error(" should override onRegister ")},t.prototype.onUnregister=function(){console.error(" should override onUnregister ")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"6daedF7tVNJ3qN565kuohVZ","BaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=0},t.prototype.Show=function(e){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()})))},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.active=!1,e&&e()})))},t.prototype.OnClick=function(){},t.prototype.BindMedaitor=function(e){if(!this.node.getComponent(e)){var t=this.node.addComponent(e);return t.bind&&t.bind(this),t.onRegister&&t.onRegister(),t}console.warn(" this node already has the same component..")},t.prototype.UnbindMedaitor=function(e){var t=this.node.getComponent(e);if(t)return t.onUnregister&&t.onUnregister(),t.bind&&t.bind(null),this.node.removeComponent(e),t;console.warn(" component already removed..")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],BlackView:[function(e,t,o){"use strict";cc._RF.push(t,"f7137KIFk5HzYzsbeidU/gx","BlackView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.GameOverSignal.inst.addListenerOne(function(t){t!=i.RoundEndType.Complete&&(e.node.active=!0)},this),this.node.active=!1},t.prototype.start=function(){},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController"}],CelerSDK:[function(e,t,o){"use strict";cc._RF.push(t,"34a72Ol/DRKJb0NyonTxi8g","CelerSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ToSingleton"),i=e("../LogHandler"),r=e("../Random"),a=e("../../Command/CommonSignal"),s=e("../../Model/PlayModelProxy"),l=e("../../Controller/GameStateController"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alreadySubmit=!1,t.isNewPlayer=!0,t.celerStartCallback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"MatchID",{get:function(){return this.match.matchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MatchRandomSeed",{get:function(){return this.match.sharedRandomSeed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DifficultyLevel",{get:function(){return this.match.difficultyLevel},enumerable:!0,configurable:!0}),t.prototype.init=function(e){this.alreadySubmit=!1,CELER_X&&celerSDK.onStart(this.onCelerStart.bind(this)),CELER_X&&celerSDK.provideScore(function(){return s.PlayModelProxy.inst.getTotalScore()}),this.celerStartCallback=e,i.LogHandler.inst.ready(),CELER_X?i.LogHandler.inst.initLog(celerSDK.log):console.log("v 1.4")},t.prototype.celerXReady=function(){console.log(" invoke celerx.ready() "),CELER_X?celerSDK.ready():this.onCelerStart()},t.prototype.isNew=function(){return this.isNewPlayer},t.prototype.isOnCelerPlatform=function(){return CELER_X},t.prototype.onCelerStart=function(){console.log(" celerx onStart call"),this.match=CELER_X?celerSDK.getMatch():{matchId:"error : can not get id",shouldLaunchTutorial:!1,sharedRandomSeed:Math.random(),difficultyLevel:1},0==this.match.difficultyLevel&&(this.match.difficultyLevel=1),console.log("match :",this.match),r.Random.setRandomSeed(this.match.sharedRandomSeed),s.PlayModelProxy.inst.Level=this.match.difficultyLevel,this.match&&this.match.shouldLaunchTutorial?this.isNewPlayer=!0:this.isNewPlayer=!1,CELER_X?(celerSDK.onPause(function(){console.log(" on pause "),l.GameStateController.inst.isGameOver()||s.PlayModelProxy.inst.isOnTutorial||a.ShowPauseLayerSignal.inst.dispatch()}),celerSDK.onResume(function(){console.log(" on resume ")})):(cc.game.on(cc.game.EVENT_HIDE,function(){console.log(" on pause "),l.GameStateController.inst.isGameOver()||s.PlayModelProxy.inst.isOnTutorial||a.ShowPauseLayerSignal.inst.dispatch()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log(" on resume ")})),this.celerStartCallback&&(this.celerStartCallback(),this.celerStartCallback=null)},t.prototype.submitScore=function(e){this.alreadySubmit||(this.alreadySubmit=!0,console.log(" submit score:",e,", match id:",this.match.matchId),CELER_X?celerSDK.submitScore(e):window.location.reload())},t}(n.SingleTon());o.CelerSDK=c,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Model/PlayModelProxy":"PlayModelProxy","../LogHandler":"LogHandler","../Random":"Random","../ToSingleton":"ToSingleton"}],Cocos:[function(e,t,o){"use strict";cc._RF.push(t,"d9795RGCWVCp5Zf4JNywPPb","Cocos"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Random");function i(e){return e&&e.getParent&&e.getParent()?e.getParent().convertToWorldSpaceAR(e.position):cc.v2(0,0)}o.GetWorldPosition=i,o.ConvertToNodeSpaceAR=function(e,t){if(!t)return cc.v2(0,0);var o=i(e);return t.convertToNodeSpaceAR(o)},o.Distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},o.AreaOf2CrossRect=function(e,t){var o=e.x,n=e.y,i=e.x+e.width,r=e.y+e.height,a=t.x,s=t.y,l=t.x+t.width,c=t.y+t.height;return Math.max(0,Math.min(i,l)-Math.max(o,a))*Math.max(0,Math.min(r,c)-Math.max(n,s))},o.disOrderArray=function(e){for(var t,o=0;o<e.length;++o){var i=n.Random.randomFloorToInt(0,e.length);t=[e[i],e[o]],e[o]=t[0],e[i]=t[1]}},o.Clamp=function(e,t,o){return Math.max(Math.min(e,t),o)};var r={mul:null};function a(e,t,o){e._updateLocalMatrix();var n=e._contentSize.width,i=e._contentSize.height,a=cc.rect(-e._anchorPoint.x*n,-e._anchorPoint.y*i,n,i);if(t=r.mul(e._worldMatrix,t,e._matrix),a.transformMat4(a,t),!o)return a;var l=s(o);return l.intersects(a)?a=c(a,l.intersection(l,a)):a}function s(e,t){return e._parent?(e._parent._updateWorldMatrix(),a(e,e._parent._worldMatrix,t)):l(e,t)}function l(e,t){e._updateLocalMatrix();var o=e._contentSize.width,n=e._contentSize.height,i=cc.rect(-e._anchorPoint.x*o,-e._anchorPoint.y*n,o,n),r=i.transformMat4(i,e._matrix);if(!t)return r;var a=s(t);return a.intersects(i)?r=c(r,a.intersection(a,i)):i}function c(e,t){var o=e.x,n=e.y,i=(e.width,e.height),r=(t.x,t.y,t.width,t.height);return e.x=o,e.y=n+r,e.height=Math.abs(i-r),e}r.mul=function(e,t,o){var n=t.m00,i=t.m01,r=t.m02,a=t.m03,s=t.m04,l=t.m05,c=t.m06,u=t.m07,d=t.m08,p=t.m09,h=t.m10,f=t.m11,y=t.m12,g=t.m13,m=t.m14,P=t.m15,S=o.m00,v=o.m01,_=o.m02,C=o.m03;return e.m00=S*n+v*s+_*d+C*y,e.m01=S*i+v*l+_*p+C*g,e.m02=S*r+v*c+_*h+C*m,e.m03=S*a+v*u+_*f+C*P,S=o.m04,v=o.m05,_=o.m06,C=o.m07,e.m04=S*n+v*s+_*d+C*y,e.m05=S*i+v*l+_*p+C*g,e.m06=S*r+v*c+_*h+C*m,e.m07=S*a+v*u+_*f+C*P,S=o.m08,v=o.m09,_=o.m10,C=o.m11,e.m08=S*n+v*s+_*d+C*y,e.m09=S*i+v*l+_*p+C*g,e.m10=S*r+v*c+_*h+C*m,e.m11=S*a+v*u+_*f+C*P,S=o.m12,v=o.m13,_=o.m14,C=o.m15,e.m12=S*n+v*s+_*d+C*y,e.m13=S*i+v*l+_*p+C*g,e.m14=S*r+v*c+_*h+C*m,e.m15=S*a+v*u+_*f+C*P,e},o.GetBoxToWorld=s,o.getBoundingBox=l,o.RectSub=c,cc._RF.pop()},{"./Random":"Random"}],CommonSignal:[function(e,t,o){"use strict";cc._RF.push(t,"f95914FtRVEIaVFtfSVd+lO","CommonSignal"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Signal"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowPauseLayerSignal=i;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.HidePauseLayerSignal=r;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameThemeInit=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowHelpLayerSignal=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.HideHelpLayerSignal=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.OpenResultLayerSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowSubmitSignal=u;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ScoreCountingSignal=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ButtonClickSignal=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.TimeAnimationStateChanged=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.UpdateTimeNumber=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameReadySignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowTutorialSignal=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameStartSignal=m;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameOverSignal=P;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GamePauseSignal=S;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.PlayerScoreChanged=v;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.NoviceScoreChanged=_;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.CountDownSignal=C,cc._RF.pop()},{"../Utils/Signal":"Signal"}],CompleteView:[function(e,t,o){"use strict";cc._RF.push(t,"ba3d1yfxbBDUoRT1kaH73rI","CompleteView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Controller/ResourceController"),a=e("../../../Utils/Celer/CelerSDK"),s=e("../../Model/GameLogic"),l=e("../Poker/PokerPosMediator"),c=cc._decorator,u=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.flyCount=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Font",{get:function(){return this.node.getChildByName("Font").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Con",{get:function(){return this.node.getChildByName("Con")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;n.GameOverSignal.inst.addListenerOne(this.onGameOver,this),this.Font.node.active=!1,this.Con.active=!1,l.PokerFlyDoneSignal.inst.addListener(function(){e.flyCount++,e.flyCount>=52&&(console.log(" poker fly:",e.flyCount),e.flyCount=0,3==a.CelerSDK.inst.DifficultyLevel?(e.Font.node.active=!1,e.Con.active=!1,setTimeout(function(){s.NextRoundSignal.inst.dispatch()},0)):setTimeout(function(){n.OpenResultLayerSignal.inst.dispatchOne(i.RoundEndType.Complete)},1e3))},this)},t.prototype.start=function(){},t.prototype.onGameOver=function(e){switch(this.Font.node.active=!0,e){case i.RoundEndType.Complete:this.Con.active=!0,3==a.CelerSDK.inst.DifficultyLevel?this.Font.spriteFrame=r.ResourceController.inst.getAnimationAtlas("font_next"):this.Font.spriteFrame=r.ResourceController.inst.getAnimationAtlas("font_gamecom");break;case i.RoundEndType.Over:this.Font.spriteFrame=r.ResourceController.inst.getAnimationAtlas("bg_font02"),this.Font.node.active=!1;break;case i.RoundEndType.TimeUp:this.Font.spriteFrame=r.ResourceController.inst.getAnimationAtlas("bg_font03"),this.Font.node.active=!1}this.Font.node.active&&(this.Font.node.scaleX=0,this.Font.node.runAction(cc.scaleTo(.1,1,1))),this.Con.active?(this.Con.scale=0,this.Con.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.delayTime(.15),cc.scaleTo(.1,1)))):setTimeout(function(){n.OpenResultLayerSignal.inst.dispatchOne(e)},0)},t=__decorate([u],t)}(cc.Component));o.default=d,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Utils/Celer/CelerSDK":"CelerSDK","../../Model/GameLogic":"GameLogic","../Poker/PokerPosMediator":"PokerPosMediator"}],Desk:[function(e,t,o){"use strict";cc._RF.push(t,"d84c2ZijZNBnZjn6u9CbsJY","Desk"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Cocos"),i=e("../../Model/Poker/PokerParentModel"),r=e("../new/ToturialLayer"),a=e("./Draw"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;r.TutorialPrepareDoneSignal.inst.addListener(function(){"0"==e.node.name&&r.default.AddToturialStep(4,e.node,null,!1,function(){},function(){},function(){},!0)},this)},t.prototype.onPokerParentChanged=function(e,t){if(i.DeskParents.indexOf(t).toString()==this.node.name){var o=a.default.PokerNodes.get(e);o&&(o.setPosition(n.ConvertToNodeSpaceAR(o,this.node)),o.setParent(this.node))}},t=__decorate([l],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../Model/Poker/PokerParentModel":"PokerParentModel","../new/ToturialLayer":"ToturialLayer","./Draw":"Draw"}],DrawAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"36f668o1s1LNaOFwxh7JKfn","DrawAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/PlayModelProxy"),i=e("../../../Utils/FrameAniBase"),r=e("../../../Utils/Signal"),a=e("../new/ToturialLayer"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.ShowDrawAniamtionSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),c.inst.addListenerOne(function(e){t.node.active=e,t.node.getChildByName("DrawTipAnimation").active=n.PlayModelProxy.inst.isOnTutorial},this),setTimeout(function(){t.node.active=!1},0),a.default.AddToturialStep(5,this.node,null,!1,function(){},function(){c.inst.dispatchOne(!0)},function(){},!1)},t=__decorate([l],t)}(i.default);o.default=u,cc._RF.pop()},{"../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/FrameAniBase":"FrameAniBase","../../../Utils/Signal":"Signal","../new/ToturialLayer":"ToturialLayer"}],DrawButton:[function(e,t,o){"use strict";cc._RF.push(t,"e3c22rBGj1P2r3GqfKjtqVh","DrawButton"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/SingleTouchView"),i=e("../PokerRoot/Draw"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){console.log("Draw on touchend"),i.RedrawCardSignal.inst.dispatch()},t=__decorate([a],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../View/SingleTouchView":"SingleTouchView","../PokerRoot/Draw":"Draw"}],Draw:[function(e,t,o){"use strict";cc._RF.push(t,"f4107sbrTlCu5h7zujyF3Rl","Draw"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=e("../../../Factory/GameFactory"),r=e("../../../Utils/HashMap"),a=e("../../../Utils/Signal"),s=e("../../Model/GameLogic"),l=e("../../Model/Poker/PokerModel"),c=e("../Animation/DrawAnimation"),u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.RedrawCardSignal=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){var e=this;l.PokerCreatedSignal.inst.addListenerOne(this.onPokerCreated,this),l.PokerRemovedSignal.inst.addListenerOne(this.onPokerRemoved,this),s.FreeRedrawCountUpdateSignal.inst.addListenerOne(function(t){e.getComponent(cc.Sprite).spriteFrame=t>0?n.ResourceController.inst.getAltas("bg_solitarienone"+t):n.ResourceController.inst.getAltas("bg_solitarienone20")},this),c.ShowDrawAniamtionSignal.inst.addListener(function(){},this)},t.prototype.onPokerRemoved=function(e){var t=o.PokerNodes.get(e);t&&i.gFactory.putObj("Poker",t),o.PokerNodes.remove(e)},t.prototype.onPokerCreated=function(e){var t=i.gFactory.getObj("Poker",e);this.node.addChild(t),o.PokerNodes.add(e.ID,t)},t.PokerNodes=new r.HashMap,t=o=__decorate([d],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController","../../../Factory/GameFactory":"GameFactory","../../../Utils/HashMap":"HashMap","../../../Utils/Signal":"Signal","../../Model/GameLogic":"GameLogic","../../Model/Poker/PokerModel":"PokerModel","../Animation/DrawAnimation":"DrawAnimation"}],EaseBaseView:[function(e,t,o){"use strict";cc._RF.push(t,"fc226Q7q/NHwZUZiG7X+tIZ","EaseBaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../BaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetVal=new cc.Vec3(0,0,0),t.startTime=0,t.lastTime=0,t.completeCallback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"StartTime",{get:function(){return this.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastTime",{get:function(){return this.lastTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Target",{get:function(){return this.targetVal},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.startUpdate=function(e,t,o,n){void 0===n&&(n=0),this.targetVal=e,this.startTime=Date.now()+1e3*n,this.lastTime=1e3*t,this.completeCallback=o},t.prototype.end=function(){this.onComplete(),this.complete()},t.prototype.complete=function(){if(this.startTime=this.lastTime=0,this.completeCallback){var e=this.completeCallback;this.completeCallback=null,e()}},t.prototype.update=function(e){0!=this.startTime&&0!=this.canUpdate()&&(this.isComplete()?(this.onComplete(),this.complete()):this.canStart()&&this.onStep())},t.prototype.canStart=function(){return Date.now()>=this.startTime&&0!=this.startTime},t.prototype.isComplete=function(){return Date.now()>=this.startTime+this.lastTime},t.prototype.canUpdate=function(){return console.error("you should override this method."),!0},t.prototype.onStep=function(){},t.prototype.onComplete=function(){},t.prototype.ease=function(e,t){return this.lastTime<=0?t:(t-e)*(Date.now()-this.startTime)/this.lastTime+e},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../BaseView":"BaseView"}],FireWorkAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"fdcc6mLSFRPvZPIgAxSjpVB","FireWorkAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onComplete=function(){this.node.runAction(cc.fadeOut(.1))},t.prototype.play=function(){this.node.active=!0,this.node.opacity=255,e.prototype.play.call(this)},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],FrameAniBase:[function(e,t,o){"use strict";cc._RF.push(t,"6298cJI+OZK9J9ZyfrpqPP2","FrameAniBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=n.requireComponent,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Frames=null,t.PrefixName="",t.FrameCount=0,t.Interval=.1,t.Priority=0,t.Loop=!1,t.PlayOnLoad=!1,t.currentIndex=0,t.time=0,t.isPlay=!1,t.listener=[],t.complateEvent=[],t}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{set:function(e){this.Frames=e},enumerable:!0,configurable:!0}),t.prototype.onFocusInEditor=function(){},t.prototype.onLostFocusInEditor=function(){clearInterval(o.intervalID)},t.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},t.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,0==this.isPlaying&&this.callEventComplete()},t.prototype.playOnLoop=function(){this.Loop=!0,this.play()},t.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},t.prototype.pause=function(){this.isPlay=!1},t.prototype.resume=function(){this.isPlay=!0},t.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.updateCurrentFrame(),this.Loop=!1},t.prototype.updateCurrentFrame=function(){""!=this.PrefixName?this.Sprite.spriteFrame=this.Frames.getSpriteFrame(this.PrefixName+(this.currentIndex+1)):this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex]},t.prototype.onKeyFrame=function(e){},t.prototype.addKeyEventListener=function(e,t){this.listener.push({callback:e,target:t})},Object.defineProperty(t.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),t.prototype.clearAllListener=function(){return this.listener.length=0,this},t.prototype.onComplete=function(){},t.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var e=0,t=this.listener;e<t.length;e++){var o=t[e];o.callback.apply(o.target,[this.currentIndex,this.__classname__])}},t.prototype.callEventComplete=function(){this.onComplete();for(var e=0,t=this.complateEvent;e<t.length;e++){var o=t[e];o.f.apply(o.target,[this.__classname__])}},t.prototype.addCompleteEvent=function(e,t){this.complateEvent.push({f:e,target:t})},Object.defineProperty(t.prototype,"TotalFrameCount",{get:function(){return""!=this.PrefixName&&this.FrameCount>0?this.FrameCount:this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),t.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},t.prototype.start=function(){},Object.defineProperty(t.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var e=0,t=this.getComponents(o);e<t.length;e++){var n=t[e];if(n.Priority>this.Priority&&n.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(this.updateCurrentFrame(),this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.TotalFrameCount,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},t.prototype.update=function(e){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=e},t.aniName="FrameAniBase",t.intervalID=-1,__decorate([r(cc.SpriteAtlas)],t.prototype,"Frames",void 0),__decorate([r],t.prototype,"PrefixName",void 0),__decorate([r],t.prototype,"FrameCount",void 0),__decorate([r],t.prototype,"Interval",void 0),__decorate([r],t.prototype,"Priority",void 0),__decorate([r],t.prototype,"Loop",void 0),__decorate([r],t.prototype,"PlayOnLoad",void 0),t=o=__decorate([i,a(cc.Sprite)],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],FrontView:[function(e,t,o){"use strict";cc._RF.push(t,"a7fe8WWCZVPgYx/jpZQ6l8q","FrontView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.update=function(e){this.node.parent.scaleX>=0?this.node.scaleX=1:this.node.scaleX=0,this.node.parent.scaleY<0?this.node.scaleY=1:this.node.scaleY=0},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],GameFactory:[function(e,t,o){"use strict";cc._RF.push(t,"93d23kfnY1A76OtZSkIyJ5r","GameFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=function(){function e(e,t,o){this._pool=[],this.totalSize=0,this.initTime=[],this.completeHandler=o,this.template=e,this.totalSize=t,this.hashKey="ObjPool:"+this.template.name+" - "+this.totalSize,this.initPool(t)}return e.prototype.initPool=function(e,t){var o=this;if(void 0===t&&(t=!1),t)for(var n=0;n<e;++n){this.initTime.push(Date.now());var i=cc.instantiate(this.template);this.put(i)}else for(n=0;n<e;++n)this.initTime.push(Date.now()),setTimeout(function(){var e=cc.instantiate(o.template);o.put(e)},n)},e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy&&this._pool[t].destroy();this._pool.length=0},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){e.removeFromParent(!1);for(var t=0,o=e.getComponents(cc.Component);t<o.length;t++){var n=o[t];n&&n.unuse&&n.unuse.apply(n)}this._pool.push(e),this.completeHandler&&this.totalSize<=this._pool.length&&(this.completeHandler(),this.completeHandler=null)}},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this._pool.length-1;o<0&&this.initPool(1,!0),o=this._pool.length-1;var n=this._pool[o];this._pool.length=o;for(var i=0,r=n.getComponents(cc.Component);i<r.length;i++){var a=r[i];a&&a.reuse&&a.reuse.apply(a,arguments)}return n},e}(),r=function(){function e(){this.count=0,this.totalCount=0,this.objPool=new n.HashMap,this.startTime=0}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;this.doneCallback=e,this.startTime=Date.now(),cc.loader.loadResDir("prefabs/",cc.Prefab,function(e,o,n){if(e)console.error(" Game Factory init failed:",e);else{t.totalCount=o.length;for(var r=function(e){var n=o[e],r=n.name.split("."),a=r[0],s=r[1]?parseInt(r[1]):30;console.log(" init pool:",a,", count:",s),setTimeout(function(){var e=new i(n,s,t.addCount.bind(t));t.objPool.add(a,e)},10*e)},a=0;a<o.length;a++)r(a)}})},e.prototype.addCount=function(){this.count++,this.count>=this.totalCount&&(console.log(" factory cost time:",(Date.now()-this.startTime).toFixed(2)+"ms"),this.doneCallback&&(this.doneCallback(),this.doneCallback=null))},e.prototype.getObj=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return this.objPool.has(e)?(t=this.objPool.get(e)).get.apply(t,o):(console.error(" objPool dosen't exists this obj:",e),null)},e.prototype.putObj=function(e,t){if(this.objPool.has(e))return this.objPool.get(e).put(t);console.error(" objPool dosen't exists this obj:",e)},e}();o.gFactory=r.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],GameLogic:[function(e,t,o){"use strict";cc._RF.push(t,"8eac8qigolL7YHFHSzuPQ/j","GameLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../App/App"),i=e("../../Command/CommonSignal"),r=e("../../Controller/GameStateController"),a=e("../../Global/GameRule"),s=e("../../Manager/AudioManager"),l=e("../../Model/PlayModelProxy"),c=e("../../Utils/Cocos"),u=e("../../Utils/HashMap"),d=e("../../Utils/Signal"),p=e("../Test/TestView"),h=e("../View/Animation/DrawAnimation"),f=e("../View/new/ToturialLayer"),y=e("../View/Poker/PokerPosMediator"),g=e("../View/PokerInter/PokerToucherMediator"),m=e("../View/PokerRoot/Draw"),P=e("../View/UI/RevertButtonView"),S=e("./GamePlayModel"),v=e("./Poker/PokerModel"),_=e("./Poker/PokerParentModel"),C=e("./Poker/PokerStateModel"),k=e("./Poker/PokerUtil"),T=e("./SolutionChecker"),b=.9*k.PokerSize.width,M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(d.BaseSignal);o.NextRoundSignal=M;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(d.BaseSignal);o.ReadyToFlyPokerSignal=R;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(d.BaseSignal);o.FreeRedrawCountUpdateSignal=w;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(d.BaseSignal);o.LevelChangedSignal=F;var D=function(){function e(e){var t=this;this.recycle=new u.HashMap,this.draw=[],this.ready=[],this.desk=new u.HashMap,this.step=[],this.canDraw=!0,this.handleRevertLock={},this.freeRedrawCount=3,this.playHandleIndex=0,this.totalFlipCount=0,this.currentFlipCount=0,this.totalHasFlipCount=0,this.level=0,this.scoreSkip=new u.HashMap,this.gamePlay=e,g.DrawCardSignal.inst.addListener(this.onDrawCard,this),m.RedrawCardSignal.inst.addListener(this.onCardRedraw,this),g.CheckAutoRecycleSignal.inst.addListenerOne(function(e){t.checkAutoRecycle(e)||e.State.isFront()&&y.ShakePokerSignal.inst.dispatchOne([e.ID])},this),P.RevertSignal.inst.addListener(this.revert,this),p.NextStepSignal.inst.addListener(this.onNextStepRequset,this),p.LastStepSignal.inst.addListener(this.onForwardStepRequset,this),i.GameOverSignal.inst.addListener(this.clearRevertRecord,this)}return Object.defineProperty(e.prototype,"Level",{get:function(){return this.level},set:function(e){this.level=e,F.inst.dispatchOne(this.level)},enumerable:!0,configurable:!0}),e.prototype.recordFlipCount=function(){console.info(" record flip:",this.FlipCount,this.totalHasFlipCount," , level:",this.level),this.totalHasFlipCount+=this.FlipCount},e.prototype.clear=function(){this.ready.length=0,this.desk.clear(),this.recycle.clear(),this.scoreSkip.clear(),this.draw.length=0,this.step.length=0,this.handleRevertLock={},S.RevertButtonStateChangedSignal.inst.dispatchOne(this.hasStep())},e.prototype.clearRevertRecord=function(){this.canDraw=!1,this.step.length=0,S.RevertButtonStateChangedSignal.inst.dispatchOne(this.hasStep())},e.prototype.startByCheckerInfo=function(e){var t=this;console.log(" total solution step:",T.SolutionChecker.inst.TotalStep);var o=T.SolutionChecker.inst.getRandomCache();if(o){for(var n=0,i=function(){return++n>=52&&setTimeout(function(){console.log(" ready ."),e()},500),10*n},r=0;r<o.draw.length;r++){var a=o.draw[r],l=new v.PokerModel(a.point,a.type,a.parent);T.SolutionChecker.inst.bindPokerID(l),this.gamePlay.addToPokers(l.ID,l),setTimeout(function(e){t.addToDraw(e),e.Position.updatePosition()},i(),l)}for(r=0;r<o.ready.length;r++){a=o.ready[r],l=new v.PokerModel(a.point,a.type,a.parent);T.SolutionChecker.inst.bindPokerID(l),this.gamePlay.addToPokers(l.ID,l),setTimeout(function(e){e.Index%2&&s.PlayDispatchPokerSignal.inst.dispatch(),t.addToReady(e)},i(),l)}o.desk.forEach(function(e,o){t.desk.add(e,[]);for(var n=0,r=0,a=o;r<a.length;r++){var l=a[r],c=new v.PokerModel(l.point,l.type,l.parent);T.SolutionChecker.inst.bindPokerID(c),t.gamePlay.addToPokers(c.ID,c),t.desk.get(e).push(c),c.Index=t.desk.get(e).length-1;var u=i();setTimeout(function(t,n){t.state==C.PokerState.Back&&t.index<o.length-1?(console.log(" poker index:",t.index,", desk:",e),n.turnBack()):n.turnFront()},u,l,c),n=Math.max(n,u)}setTimeout(function(e){s.PlayDispatchPokerSignal.inst.dispatch(),t.updateDeskOffset(e);for(var o=0,n=t.desk.get(e);o<n.length;o++){n[o].Position.updatePosition()}},n,e)}),o.recycle.forEach(function(e,o){t.recycle.add(e,[]);for(var n=0,r=o;n<r.length;n++){var a=r[n],l=new v.PokerModel(a.point,a.type,a.parent);T.SolutionChecker.inst.bindPokerID(l),t.scoreSkip.add(l.ID,!0),t.gamePlay.addToPokers(l.ID,l),t.recycle.get(e).push(l),l.Index=t.recycle.get(e).length-1,setTimeout(function(e){e.Index%2&&s.PlayDispatchPokerSignal.inst.dispatch(),e.turnFront(),e.Position.updatePosition()},i(),l)}})}},e.prototype.onNextStepRequset=function(){var e=T.SolutionChecker.inst.getCurrentCache();null!=e?(console.log("current step: ",T.SolutionChecker.inst.TotalStep-T.SolutionChecker.inst.CurrentStep),this.evalByPokers(e)):console.error("no step cache.")},e.prototype.onForwardStepRequset=function(){var e=this,t=T.SolutionChecker.inst.getLastCache();if(null!=t){console.log("current step: ",T.SolutionChecker.inst.TotalStep-T.SolutionChecker.inst.CurrentStep),this.evalByPokers(t);var o=[];t.desk.forEach(function(t,n){for(var i=0,r=n;i<r.length;i++){var a=r[i],s=e.gamePlay.getPoker(a.ID);s&&a.state==C.PokerState.Back&&a.index<n.length-1&&(s.State.State=a.state,o.push(t))}e.updateDeskOffset(t)}),setTimeout(function(){e.desk.forEach(function(e,t){if(o.indexOf(e)>=0)for(var n=0,i=t;n<i.length;n++){i[n].Position.updatePosition()}})},50)}else console.error("no step cache.")},e.prototype.evalByPokers=function(e){var t=this;if(e.ready.length+e.draw.length==this.ready.length+this.draw.length){if(e.ready.length>this.ready.length)this.onDrawCard();else if(e.ready.length<this.ready.length)if(e.draw.length==this.ready.length)this.onCardRedraw();else{for(;this.ready.length>e.ready.length;){var o=this.ready.pop();this.readyToDraw(o)}this.updateReadyOffset();for(var n=0,i=this.ready;n<i.length;n++){i[n].Position.updatePosition()}}}else if(e.ready.length>this.ready.length)for(var r=0,a=e.ready;r<a.length;r++){if((o=a[r]).ID){var s=this.gamePlay.getPoker(o.ID);if(s){if(s.Parent.Parent!=o.parent)switch(s.Parent.ParentType){case _.ParentType.Desk:this.revertFromDesk(s,o.parent);break;case _.ParentType.Draw:this.revertFromDraw(s,o.parent);break;case _.ParentType.Ready:!CELER_X&&alert("ready \u9519\u8bef\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22");break;case _.ParentType.Recycle:this.revertFromRecycle(s,o.parent)}}else!CELER_X&&alert("ready poker model\u4e0d\u5b58\u5728\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22")}else!CELER_X&&alert("ready poker ID\u4e0d\u5b58\u5728\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22")}else if(e.ready.length<this.ready.length)if(e.ready.length-this.ready.length<-1)!CELER_X&&alert("\u6b65\u9aa4\u5927\u4e8e1\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22");else{o=this.ready[this.ready.length-1];var l=T.SolutionChecker.inst.getPokerByID(o.ID);this.revertFromReady(o,l.parent)}else!CELER_X&&alert("\u7ffb\u724c\u51fa\u9519");e.desk.forEach(function(e,o){for(var n=0,i=o;n<i.length;n++){var r=i[n];if(r.ID){var a=t.gamePlay.getPoker(r.ID);if(a){if(a.Parent.Parent!=r.parent)switch(a.Parent.ParentType){case _.ParentType.Desk:t.revertFromDesk(a,r.parent);break;case _.ParentType.Draw:t.revertFromDraw(a,r.parent);break;case _.ParentType.Ready:t.revertFromReady(a,r.parent);break;case _.ParentType.Recycle:t.revertFromRecycle(a,r.parent)}}else!CELER_X&&alert("desk poker model\u4e0d\u5b58\u5728\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22")}else!CELER_X&&alert("desk poker ID\u4e0d\u5b58\u5728\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22")}}),e.recycle.forEach(function(e,o){for(var n=0,i=o;n<i.length;n++){var r=i[n];if(r.ID){var a=t.gamePlay.getPoker(r.ID);if(a){if(a.Parent.Parent!=r.parent)switch(a.Parent.ParentType){case _.ParentType.Desk:t.revertFromDesk(a,r.parent);break;case _.ParentType.Draw:console.error(_.PokerParent[a.Parent.Parent],r);break;case _.ParentType.Ready:t.revertFromReady(a,r.parent);break;case _.ParentType.Recycle:t.revertFromRecycle(a,r.parent)}}else!CELER_X&&alert("recycle poker model\u4e0d\u5b58\u5728\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22")}else!CELER_X&&alert("recycle poker ID\u4e0d\u5b58\u5728\uff0c\u622a\u56fe\u53cd\u9988\u8c22\u8c22")}})},e.prototype.checkIsShowFront=function(e){if(r.GameStateController.inst.isGameOver())return!0;switch(e.Parent.ParentType){case _.ParentType.Desk:case _.ParentType.Draw:return!0}if(e.Parent.ParentType==_.ParentType.Ready)return this.ready.length<=4||e.Index>=this.ready.length-4;var t=_.RecycleParents.indexOf(e.Parent.Parent),o=this.recycle.get(t);return null==o||o.length<=2||e.Index>=o.length-2},e.prototype.hasStep=function(){for(var e=0,t=0,o=this.step;t<o.length;t++){var n=o[t];n&&n.pokerIDs.length>0&&e++}return e>0},Object.defineProperty(e.prototype,"TotalHasFlipCount",{get:function(){return 0==this.totalHasFlipCount&&(this.totalHasFlipCount+=this.FlipCount),this.totalHasFlipCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FlipCount",{get:function(){if(0==this.currentFlipCount){var e=0;e+=this.ready.length,e+=this.draw.length,this.desk.forEach(function(t,o){for(var n=0,i=o;n<i.length;n++){0==i[n].State.isFront()&&e++}}),this.currentFlipCount=Math.max(0,this.totalFlipCount-e)}return this.currentFlipCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FlipRate",{get:function(){return this.FlipCount/this.totalFlipCount},enumerable:!0,configurable:!0}),e.prototype.initTotalFlipCount=function(){var e=0;this.currentFlipCount=0,this.desk.forEach(function(t,o){for(var n=0,i=o;n<i.length;n++){0==i[n].State.isFront()&&e++}}),this.totalFlipCount=this.draw.length+this.ready.length+e,console.log("total need flip:",this.totalFlipCount)},e.prototype.revert=function(){if(!(this.step.length<=0||this.handleRevertLock[this.playHandleIndex-1]||r.GameStateController.inst.isGameOver())){var e=this.PlayHandleIndex-1,t=this.step[e];if(null!=t){l.PlayModelProxy.inst.Combo=-1;for(var o=0;o<t.pokerIDs.length;o++){var i=t.pokerIDs[o],s=t.states[o],c=t.parents[o];null!=(u=this.gamePlay.getPoker(i))?s!=u.State.State&&(s==C.PokerState.Back?(u.State.turnBack(),k.GetParentType(c)==_.ParentType.Desk&&this.gamePlay.addPlayerScore(-a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(u.ID))):(u.State.turnFront(),k.GetParentType(c)==_.ParentType.Desk&&this.gamePlay.addPlayerScore(a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(u.ID)))):console.error(" cant find poker:",i)}for(o=0;o<t.pokerIDs.length;o++){var u;i=t.pokerIDs[o],c=t.parents[o];if(null!=(u=this.gamePlay.getPoker(i)))switch(u.Parent.ParentType){case _.ParentType.Desk:this.revertFromDesk(u,c);break;case _.ParentType.Draw:this.revertFromDraw(u,c);break;case _.ParentType.Ready:this.revertFromReady(u,c);break;case _.ParentType.Recycle:this.revertFromRecycle(u,c)}else console.error(" cant find poker:",i)}this.gamePlay.addPlayerScore(t.score,S.ScoreType.Normal,1,n.default.AppInstance.Revert),this.FreeDrawCount+=t.drawCount,console.log(" revert :",this.PlayHandleIndex),this.step[e]=null,this.PlayHandleIndex--}}},e.prototype.revertFromDesk=function(e,t){switch(k.GetParentType(t)){case _.ParentType.Desk:this.deskToDesk(e,_.DeskParents.indexOf(t),!0);break;case _.ParentType.Draw:console.error(" cant revert from desk to draw");break;case _.ParentType.Ready:this.deskToReady(e);break;case _.ParentType.Recycle:this.deskToRecycle(e,_.RecycleParents.indexOf(t),!0)}},e.prototype.revertFromDraw=function(e,t){switch(k.GetParentType(t)){case _.ParentType.Desk:console.error(" cant not revert from draw to desk.");break;case _.ParentType.Draw:console.error(" cant not revert from draw to draw.");break;case _.ParentType.Ready:s.PlayDispatchPokerSignal.inst.dispatch(),this.delFromDraw(e),this.addToReady(e);break;case _.ParentType.Recycle:console.error(" cant not revert from draw to recycle.")}},e.prototype.revertFromRecycle=function(e,t){switch(k.GetParentType(t)){case _.ParentType.Desk:this.recycleToDesk(e,_.DeskParents.indexOf(t),!0);break;case _.ParentType.Draw:console.error(" cant not revert from recycle to draw.");break;case _.ParentType.Ready:this.recycleToReady(e);break;case _.ParentType.Recycle:this.recycleToRecycle(e,_.RecycleParents.indexOf(t),!0)}},e.prototype.revertFromReady=function(e,t){switch(k.GetParentType(t)){case _.ParentType.Desk:s.PlayDispatchPokerSignal.inst.dispatch(),this.delFromReady(e),this.readyToDesk(e,_.DeskParents.indexOf(t),!0,!1),this.updateReadyOffset();for(var o=0,n=this.ready;o<n.length;o++){n[o].Position.updatePosition(.1)}break;case _.ParentType.Draw:s.PlayDispatchPokerSignal.inst.dispatch(),this.delFromReady(e),this.readyToDraw(e),this.updateReadyOffset();for(var i=0,r=this.ready;i<r.length;i++){r[i].Position.updatePosition(.1)}break;case _.ParentType.Ready:break;case _.ParentType.Recycle:s.PlayDispatchPokerSignal.inst.dispatch(),this.delFromReady(e),this.updateReadyOffset();for(var a=0,l=this.ready;a<l.length;a++){l[a].Position.updatePosition(.1)}this.readyToRecycle(e,_.RecycleParents.indexOf(t),!0,!1)}},e.prototype.addToStep=function(e){null==this.step[this.playHandleIndex]?this.step[this.playHandleIndex]=e:(this.step[this.playHandleIndex].drawCount+=e.drawCount,this.step[this.playHandleIndex].parents=this.step[this.playHandleIndex].parents.concat(e.parents),this.step[this.playHandleIndex].pokerIDs=this.step[this.playHandleIndex].pokerIDs.concat(e.pokerIDs),this.step[this.playHandleIndex].states=this.step[this.playHandleIndex].states.concat(e.states),this.step[this.playHandleIndex].score+=e.score)},Object.defineProperty(e.prototype,"PlayHandleIndex",{get:function(){return this.playHandleIndex},set:function(e){this.playHandleIndex<e?(S.RevertButtonStateChangedSignal.inst.dispatchOne(this.hasStep()),this.step[this.playHandleIndex-1]=null):S.RevertButtonStateChangedSignal.inst.dispatchOne(!this.handleRevertLock[e-1]&&this.hasStep()),this.playHandleIndex=e},enumerable:!0,configurable:!0}),e.prototype.addToDraw=function(e){e.Index=this.draw.length,this.draw.unshift(e)},e.prototype.drawToDesk=function(e){var t=this.draw.pop();this.desk.has(e)?this.desk.get(e).push(t):this.desk.add(e,[t]),t.Index=this.desk.get(e).length-1,e==t.Index?t.turnFront():l.PlayModelProxy.inst.isOnTutorial&&(4!=e&&6!=e||t.Index==e-1&&t.turnFront()),this.updateDeskOffset(e),s.PlayDispatchPokerSignal.inst.dispatch(),t.setParent(_.DeskParents[e]),l.PlayModelProxy.inst.isOnTutorial&&(t.Parent.Parent!=_.PokerParent.Desk4&&t.Parent.Parent!=_.PokerParent.Desk6||f.default.AddToturialStep(3,m.default.PokerNodes.get(t.ID),null,t.Point!==v.Poker.$_6,function(){},function(){},function(){},t.Point==v.Poker.$_6&&t.Type==v.PokerType.Spade||t.Point==v.Poker.$_7&&t.Type==v.PokerType.Diamond,-1,t.Parent.Parent==_.PokerParent.Desk6)),this.desk.get(6)&&this.desk.get(6).length>=7&&(this.gameReady(),l.PlayModelProxy.inst.isOnTutorial?(f.default.AddToturialStep(5,m.default.PokerNodes.get(this.draw[0].ID),null,!1,function(){},function(){h.ShowDrawAniamtionSignal.inst.dispatchOne(!0)},function(){},!1),f.default.AddToturialStep(6,m.default.PokerNodes.get(this.draw[0].ID),null,!0,function(){},function(){h.ShowDrawAniamtionSignal.inst.dispatchOne(!1)},function(){},!1,-1,!0),f.default.AddToturialStep(6,m.default.PokerNodes.get(this.draw[1].ID),null,!0,function(){},function(){},function(){},!1,-1,!0),f.default.AddToturialStep(6,m.default.PokerNodes.get(this.draw[2].ID),null,!1,function(){},function(){},function(){},!0),f.TutorialPrepareDoneSignal.inst.dispatch()):h.ShowDrawAniamtionSignal.inst.dispatchOne(!0))},e.prototype.gameReady=function(){this.canDraw=!0,r.GameStateController.inst.isReady=!0,this.Level>1&&r.GameStateController.inst.roundStart(),console.log("\u53d1\u724c\u7ed3\u675f:",this.Level),S.AfterGenLevelSignal.inst.dispatch(),this.initTotalFlipCount()},e.prototype.updateDeskOffset=function(e){var t=this.desk.get(e);if(t)for(var o=t.length>19?24*.8:24,n=t.length>19?28.8:36,i=0;i<t.length;i++){var r=t[i],a=t[i-1];r.Offset=o,a&&a.State.isFront()?r.OffsetFront=n+a.OffsetFront:r.OffsetFront=0}},e.prototype.updateReadyOffset=function(){if(1==this.ready.length)this.ready[0].Offset=0;else if(2==this.ready.length)this.ready[0].Offset=0,this.ready[1].Offset=60;else if(3==this.ready.length)this.ready[0].Offset=0,this.ready[1].Offset=60,this.ready[2].Offset=120;else for(var e=0,t=this.ready;e<t.length;e++){var o=t[e];o.Index<=this.ready.length-3?o.Offset=0:o.Offset=60*(o.Index-this.ready.length+3)}},e.prototype.onDrawCard=function(){var e=this;if(!(0==this.canDraw||this.draw.length<=0)){h.ShowDrawAniamtionSignal.inst.dispatchOne(!1),this.canDraw=!1;for(var t=2,o=this.draw.length;t>=0;)this.draw[t]&&this.addToStep({pokerIDs:[this.draw[t].ID],parents:[_.PokerParent.Draw],states:[C.PokerState.Back],score:0,drawCount:0}),t--;t=0;var n=this.playHandleIndex;this.handleRevertLock[n]=!0;var i=function(){var e=r.draw.shift();if(null==e)return"break";r.draw.length<=0&&h.ShowDrawAniamtionSignal.inst.dispatchOne(!0),e.DrawToReadyDelay=t/20;var o=1e3*e.DrawToReadyDelay;setTimeout(function(){setTimeout(function(){s.PlayDispatchPokerSignal.inst.dispatchOne(!0)},o)},0),r.addToReady(e,!1),e&&e.State.turnFront()},r=this;for(t=0;t<3;t++){if("break"===i())break}for(var a=0,c=this.ready;a<c.length;a++){c[a].Position.updatePosition()}setTimeout(function(){(o-length>=3||length<=0)&&(e.canDraw=!0,e.handleRevertLock[n]=!1,setTimeout(function(){S.RevertButtonStateChangedSignal.inst.dispatchOne(e.hasStep())},50),console.log(" draw card done2:",e.draw.length),l.PlayModelProxy.inst.isOnTutorial&&setTimeout(function(){f.TutorialNextStepSignal.inst.dispatch()},100))},t/20*1e3+100),this.addToStep({pokerIDs:[],parents:[],states:[],score:0,drawCount:0}),this.PlayHandleIndex++}},Object.defineProperty(e.prototype,"FreeDrawCount",{get:function(){return this.freeRedrawCount},set:function(e){this.freeRedrawCount=e,w.inst.dispatchOne(this.freeRedrawCount)},enumerable:!0,configurable:!0}),e.prototype.onCardRedraw=function(){if(!(0==this.canDraw||this.draw.length>0)){if(this.ready.length>=3?s.PlayRecycleDrawSignal.inst.dispatch():s.PlayDispatchPokerSignal.inst.dispatch(),h.ShowDrawAniamtionSignal.inst.dispatchOne(!1),this.FreeDrawCount>0)this.FreeDrawCount--,this.addToStep({parents:[],pokerIDs:[],score:0,drawCount:1,states:[]});else{var e=this.gamePlay.addPlayerScore(a.GetDrawCost(),S.ScoreType.DrawCost,1,n.default.AppInstance.Draw);this.addToStep({parents:[],pokerIDs:[],score:-e,drawCount:0,states:[]})}for(var t=[];this.ready.length>0;){var o=this.ready.pop();this.readyToDraw(o),t.unshift(o)}for(;t.length>0;){o=t.shift();this.addToStep({parents:[_.PokerParent.Ready],pokerIDs:[o.ID],score:0,drawCount:0,states:[C.PokerState.Front]})}this.PlayHandleIndex++,console.log(" redraw card:",this.draw.length,", ready:",this.ready.length)}},e.prototype.onCancel=function(e){var t=this.gamePlay.getPoker(e);t&&(t.Parent.ParentType==_.ParentType.Desk?this.onDeskPokerMovedEnd(t):t.Position.onMovedEnd())},e.prototype.isTopOfReady=function(e){if(0==this.canDraw)return!1;for(var t=!1,o=0,n=this.ready;o<n.length;o++){if(n[o].ID==e.ID){t=!0;break}}return!(this.ready.length<=0||0==t)&&e.Index>=this.ready.length-1},e.prototype.isTopOfRecycle=function(e){var t=!1,o=0;return this.recycle.forEach(function(n,i){for(var r=0,a=i;r<a.length;r++){if(a[r].ID==e.ID){o=n,t=!0;break}}}),!!t&&e.Index>=this.recycle.get(o).length-1},e.prototype.onDeskPokerMoved=function(e,t){var o=_.DeskParents.indexOf(e.Parent.Parent);if(o>=0)for(var n=0,i=this.desk.get(o);n<i.length;n++){var r=i[n];r.Index>=e.Index&&r.Position.onMoved(t)}},e.prototype.onDeskPokerMovedEnd=function(e){var t=_.DeskParents.indexOf(e.Parent.Parent);if(t>=0)for(var o=0,n=this.desk.get(t);o<n.length;o++){var i=n[o];i.Index>=e.Index&&i.Position.onMovedEnd()}},e.prototype.onMoved=function(e,t){if(!r.GameStateController.inst.isGameOver()){var o=this.gamePlay.getPoker(e);o?o.State.isFront()&&(o.Parent.ParentType==_.ParentType.Ready?this.isTopOfReady(o)&&o.Position.onMoved(t):o.Parent.ParentType==_.ParentType.Desk?this.onDeskPokerMoved(o,t):o.Parent.ParentType==_.ParentType.Recycle&&this.isTopOfRecycle(o)&&o.Position.onMoved(t)):console.error("cant find poker:",e)}},e.prototype.onMovedEnd=function(e){if(!r.GameStateController.inst.isGameOver()){var t=this.gamePlay.getPoker(e);t&&(this.checkCanDragToDesk(t)?console.log(" drag to desk. "):this.checkCanDragToRecycle(t)?console.log(" drag to recycle. "):(t.State.isFront()&&s.PlayDispatchPokerSignal.inst.dispatch(),t.Parent.ParentType==_.ParentType.Desk?this.onDeskPokerMovedEnd(t):t.Position.onMovedEnd()))}},e.prototype.checkCanDragToDesk=function(e){for(var t,o=-1,n=1e5,i=0;i<=6;i++){var r=this.desk.get(i);if(r&&r.length>0){var a=r[r.length-1];(s=c.Distance(a.Position.Position,e.Position.MovingPosition))<=b&&this.canBeNext(a,e)&&n>s&&(n=s,o=i)}else if(e.Point!=v.Poker.$_K);else{var s,l=e.Position.getDeskRootPos(i);(s=c.Distance(l,e.Position.MovingPosition))<=b&&n>s&&(n=s,o=i)}}return(t=-1!=o)&&(e.Parent.ParentType==_.ParentType.Desk?this.deskToDesk(e,o):e.Parent.ParentType==_.ParentType.Ready?this.readyToDesk(e,o):this.recycleToDesk(e,o)),t},e.prototype.checkAutoRecycle=function(e,t){void 0===t&&(t=!1);for(var o=!1,n=0;n<=3;n++){var i=this.recycle.get(n);if(i&&i.length>0)if(i.length>=13);else{var r=i[i.length-1];this.canBeRecycle(r,e)&&(e.Parent.ParentType==_.ParentType.Desk?(0==t&&this.deskToRecycle(e,n),o=!0):e.Parent.ParentType==_.ParentType.Ready&&this.isTopOfReady(e)&&(0==t&&this.readyToRecycle(e,n),o=!0))}else e.Point!=v.Poker.$_A||(e.Parent.ParentType==_.ParentType.Desk?(0==t&&this.deskToRecycle(e,n),o=!0):e.Parent.ParentType==_.ParentType.Ready&&this.isTopOfReady(e)&&(0==t&&this.readyToRecycle(e,n),o=!0))}return o},e.prototype.checkCanDragToRecycle=function(e){for(var t,o=-1,n=1e5,i=0;i<=3;i++){var r=this.recycle.get(i);if(r&&r.length>0){var a=r[r.length-1];(s=c.Distance(a.Position.Position,e.Position.MovingPosition))<=b&&this.canBeRecycle(a,e)&&n>s&&(n=s,o=i)}else if(e.Point!=v.Poker.$_A);else{var s,l=e.Position.getRecycleRootPos(i);(s=c.Distance(l,e.Position.MovingPosition))<=b&&n>s&&(n=s,o=i)}}return(t=-1!=o)&&(e.Parent.ParentType==_.ParentType.Desk?this.deskToRecycle(e,o):e.Parent.ParentType==_.ParentType.Ready?this.readyToRecycle(e,o):this.recycleToRecycle(e,o)),t},e.prototype.delFromReady=function(e){for(var t=0;t<this.ready.length;t++){var o=this.ready[t];o.ID==e.ID?(this.ready.splice(t,1),t--):o.Index=t}},e.prototype.delFromDraw=function(e){for(var t=0;t<this.draw.length;t++){var o=this.draw[t];o.ID==e.ID?(this.draw.splice(t,1),t--):o.Index=t}},e.prototype.canBeNext=function(e,t){return e.Point-t.Point==1&&e.Color!=t.Color},e.prototype.canBeRecycle=function(e,t){return t.Point-e.Point==1&&t.Type==e.Type},e.prototype.deskToDesk=function(e,t,o){void 0===o&&(o=!1);var n=_.DeskParents.indexOf(e.Parent.Parent);if(n<0)console.error("[deskToDesk] poker :",e.ID," is not on desk");else if(n!=t){var i=this.desk.get(n);if(i){for(var r=[],a=0;a<i.length;a++){(p=i[a]).Index>=e.Index&&(r.push(p),0==o&&this.addToStep({pokerIDs:[p.ID],parents:[p.Parent.Parent],states:[p.State.State],score:0,drawCount:0}))}0==this.desk.has(t)&&this.desk.add(t,[]);for(var c=this.desk.get(t),u=0,d=r;u<d.length;u++){var p=d[u];this.delFromDesk(p,o),c.push(p),p.Index=c.length-1}this.updateDeskOffset(n),this.updateDeskOffset(t);for(var h=0,y=r;h<y.length;h++){(p=y[h]).setParent(_.DeskParents[t])}for(var g=0,m=i;g<m.length;g++){(p=m[g]).Position.updatePosition()}for(var P=0,S=c;P<S.length;P++){(p=S[P]).Position.updatePosition()}this.checkIsAutoComplete(),0==o&&(this.PlayHandleIndex++,s.PlayToDeskSignal.inst.dispatch()),s.PlayPokerPlaceSignal.inst.dispatch(),l.PlayModelProxy.inst.isOnTutorial&&f.TutorialNextStepSignal.inst.dispatch()}}else this.onDeskPokerMovedEnd(e)},e.prototype.recycleToRecycle=function(e,t,o){void 0===o&&(o=!1);var n=_.RecycleParents.indexOf(e.Parent.Parent);if(n<0)console.error("[recycleToRecycle] poker :",e.ID," is not on recycle");else if(n==t||l.PlayModelProxy.inst.isOnTutorial)e.Position.onMovedEnd();else{0==this.recycle.has(t)&&this.recycle.add(t,[]);var i=this.recycle.get(t);if(i.length>=13)e.Position.onMovedEnd();else{this.delFromRecycle(e),i.push(e),e.Index=i.length-1,0==o&&(this.addToStep({pokerIDs:[e.ID],parents:[e.Parent.Parent],states:[e.State.State],drawCount:0,score:0}),this.PlayHandleIndex++),e.setParent(_.RecycleParents[t]);for(var r=0,a=i;r<a.length;r++){a[r].Position.updatePosition()}}}},e.prototype.delFromDesk=function(e,t){void 0===t&&(t=!1);var o=_.DeskParents.indexOf(e.Parent.Parent);if(o<0)console.error("[delFromDesk] poker :",e.ID," is not on desk");else{var n=this.desk.get(o);if(n){for(var i=0;i<n.length;i++){(r=n[i]).ID==e.ID?(n.splice(i,1),i--):r.Index=i}for(i=0;i<n.length;i++){var r;(r=n[i]).Index>=n.length-1&&0==r.State.isFront()&&(0==t&&this.addToStep({pokerIDs:[r.ID],parents:[r.Parent.Parent],states:[r.State.State],score:0,drawCount:0}),r.turnFront(),this.gamePlay.addPlayerScore(a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(r.ID)))}}}},e.prototype.delFromRecycle=function(e){var t=_.RecycleParents.indexOf(e.Parent.Parent);if(t<0)console.error(" poker :",e.ID," is not on recycle");else{var o=this.recycle.get(t);if(o)for(var n=0;n<o.length;n++){var i=o[n];i.ID==e.ID?(o.splice(n,1),n--):i.Index=n}}},e.prototype.readyToDesk=function(e,t,o,n){void 0===o&&(o=!1),void 0===n&&(n=!0),n&&this.ready.pop(),this.updateReadyOffset();for(var i=0,r=this.ready;i<r.length;i++){r[i].Position.updatePosition(.1)}0==this.desk.has(t)&&this.desk.add(t,[]);var c=this.desk.get(t);c.push(e),e.Index=c.length-1,this.updateDeskOffset(t),0==o&&(this.addToStep({pokerIDs:[e.ID],parents:[e.Parent.Parent],states:[e.State.State],score:0,drawCount:0}),this.PlayHandleIndex++,s.PlayToDeskSignal.inst.dispatch()),e.setParent(_.DeskParents[t]);for(var u=0,d=c;u<d.length;u++){d[u].Position.updatePosition()}this.gamePlay.addPlayerScore(a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID)),this.checkIsAutoComplete(),l.PlayModelProxy.inst.isOnTutorial&&f.TutorialNextStepSignal.inst.dispatch()},e.prototype.deskToReady=function(e){var t=_.DeskParents.indexOf(e.Parent.Parent);if(t<0)console.error("[delFromDesk] poker :",e.ID," is not on desk");else{var o=this.desk.get(t);o&&(o[o.length-1].ID==e.ID?(this.delFromDesk(e),this.updateDeskOffset(t),this.addToReady(e),this.gamePlay.addPlayerScore(-a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID)),s.PlayPokerPlaceSignal.inst.dispatch()):console.log(" is not root of desk:",t))}},e.prototype.deskToRecycle=function(e,t,o){void 0===o&&(o=!1);var n=_.DeskParents.indexOf(e.Parent.Parent);if(n<0)console.error("[delFromDesk] poker :",e.ID," is not on desk");else{var i=this.desk.get(n);if(i){if(i[i.length-1].ID!=e.ID&&0==r.GameStateController.inst.isGameOver())return console.log(" is not root of desk:",n),void this.onDeskPokerMovedEnd(e);for(var c=[],u=0;u<i.length;u++){(y=i[u]).Index>=e.Index&&c.push(y)}if(r.GameStateController.inst.isGameOver()&&(c=[e]),c.length>1)console.error(" only desk root poker can to recycle.");else{0==o&&this.addToStep({pokerIDs:[e.ID],parents:[e.Parent.Parent],states:[e.State.State],score:0,drawCount:0}),0==this.scoreSkip.has(e.ID)&&0==r.GameStateController.inst.isGameOver()&&(setTimeout(function(){},300),l.PlayModelProxy.inst.Combo++,this.gamePlay.addPlayerScore(a.GetPokerRecycleScore(e.Point),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID),1e3*a.RecycleLastTime)),0==this.recycle.has(t)&&this.recycle.add(t,[]);for(var d=this.recycle.get(t),p=0,h=c;p<h.length;p++){var y=h[p];this.delFromDesk(y,o),d.push(y),y.Index=d.length-1}if(0==r.GameStateController.inst.isGameOver()){this.updateDeskOffset(n);for(var g=0,P=i;g<P.length;g++){(y=P[g]).Position.updatePosition()}}for(var v=0,C=c;v<C.length;v++){(y=C[v]).setParent(_.RecycleParents[t])}0==o&&this.PlayHandleIndex++,this.checkIsAutoComplete(),r.GameStateController.inst.isGameOver()&&s.PlayPokerPlaceSignal.inst.dispatch(),l.PlayModelProxy.inst.isOnTutorial&&setTimeout(function(){f.TutorialNextStepSignal.inst.dispatch()},300)}}}},e.prototype.recycleToDesk=function(e,t,o){void 0===o&&(o=!1);var n=_.RecycleParents.indexOf(e.Parent.Parent);if(n<0)console.error("[recycleToDesk] poker :",e.ID," is not on desk");else if(this.recycle.get(n)){0==this.desk.has(t)&&this.desk.add(t,[]);var i=this.desk.get(t);this.delFromRecycle(e),i.push(e),e.Index=i.length-1,this.updateDeskOffset(t),0==o&&(this.addToStep({pokerIDs:[e.ID],parents:[e.Parent.Parent],states:[e.State.State],score:0,drawCount:0}),this.PlayHandleIndex++),0==this.scoreSkip.has(e.ID)&&this.gamePlay.addPlayerScore(-a.GetPokerRecycleScore(e.Point),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID)),e.setParent(_.DeskParents[t]);for(var r=0,l=i;r<l.length;r++){l[r].Position.updatePosition()}s.PlayPokerPlaceSignal.inst.dispatch()}},e.prototype.readyToRecycle=function(e,t,o,n){(void 0===o&&(o=!1),void 0===n&&(n=!0),n)&&((u=this.ready.pop()).ID!=e.ID&&console.error(" ready top is not same with handled model:",u.ID,e.ID));this.updateReadyOffset();for(var i=0,c=this.ready;i<c.length;i++){var u;(u=c[i]).Position.updatePosition(.1)}0==this.recycle.has(t)&&this.recycle.add(t,[]);var d=this.recycle.get(t);d.push(e),e.Index=d.length-1,0==o&&(this.addToStep({pokerIDs:[e.ID],parents:[e.Parent.Parent],states:[e.State.State],score:0,drawCount:0}),this.PlayHandleIndex++),0==this.scoreSkip.has(e.ID)&&0==r.GameStateController.inst.isGameOver()&&(setTimeout(function(){},300),l.PlayModelProxy.inst.Combo++,this.gamePlay.addPlayerScore(a.GetPokerRecycleScore(e.Point),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID),1e3*a.RecycleLastTime),this.gamePlay.addPlayerScore(a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID))),console.log(" ready to recycle ."),e.setParent(_.RecycleParents[t]),r.GameStateController.inst.isGameOver()&&s.PlayPokerPlaceSignal.inst.dispatch(),this.checkIsAutoComplete()},e.prototype.checkScoreSkip=function(e){return this.scoreSkip.has(e)},e.prototype.recycleToReady=function(e){this.delFromRecycle(e),this.addToReady(e),0==this.scoreSkip.has(e.ID)&&(this.gamePlay.addPlayerScore(-a.GetPokerRecycleScore(e.Point),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID)),setTimeout(function(){},100),this.gamePlay.addPlayerScore(-a.GetPokerFlipScore(),S.ScoreType.Normal,1,m.default.PokerNodes.get(e.ID),100)),s.PlayPokerPlaceSignal.inst.dispatch()},e.prototype.addToReady=function(e,t){if(void 0===t&&(t=!0),this.ready.push(e),e.Index=this.ready.length-1,t&&e.turnFront(),this.updateReadyOffset(),e.setParent(_.PokerParent.Ready),t)for(var o=0,n=this.ready;o<n.length;o++){n[o].Position.updatePosition()}},e.prototype.readyToDraw=function(e){this.addToDraw(e),e.turnBack(),e.setParent(_.PokerParent.Draw)},e.prototype.checkIsAutoComplete=function(){var e=this;if(!r.GameStateController.inst.isGameOver()&&!(this.draw.length>0||this.ready.length>0)){var t=!0;this.desk.forEach(function(e,o){for(var n=0,i=o;n<i.length;n++){if(0==i[n].State.isFront()){t=!1;break}}}),t&&(r.GameStateController.inst.roundEnd(r.RoundEndType.Complete),setTimeout(function(){var t=0;e.desk.forEach(function(e,o){t+=o.length});for(var o=0;t>0;)e.desk.forEach(function(n,i){for(var r=i.length-1;r<=i.length-1&&r>=0;){var a=i[r];e.checkAutoRecycle(a,!0)&&(a.AutoRecycleDelay=100*l.PlayModelProxy.inst.AutoRecycleCount,e.checkAutoRecycle(a),l.PlayModelProxy.inst.AutoRecycleCount++,o=Math.max(a.AutoRecycleDelay,o),t--,r=i.length-1),r--}});e.checkIsReadyToFly(o+500)},120))}},e.prototype.checkIsReadyToFly=function(e){console.log("fly delay:",e);var t=0;return this.recycle.forEach(function(e,o){o.length>=13&&t++}),t>=4&&setTimeout(function(){y.FlyPokerSignal.inst.dispatch()},e),t>=4},e}();o.GameLogic=D,cc._RF.pop()},{"../../App/App":"App","../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Global/GameRule":"GameRule","../../Manager/AudioManager":"AudioManager","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Cocos":"Cocos","../../Utils/HashMap":"HashMap","../../Utils/Signal":"Signal","../Test/TestView":"TestView","../View/Animation/DrawAnimation":"DrawAnimation","../View/Poker/PokerPosMediator":"PokerPosMediator","../View/PokerInter/PokerToucherMediator":"PokerToucherMediator","../View/PokerRoot/Draw":"Draw","../View/UI/RevertButtonView":"RevertButtonView","../View/new/ToturialLayer":"ToturialLayer","./GamePlayModel":"GamePlayModel","./Poker/PokerModel":"PokerModel","./Poker/PokerParentModel":"PokerParentModel","./Poker/PokerStateModel":"PokerStateModel","./Poker/PokerUtil":"PokerUtil","./SolutionChecker":"SolutionChecker"}],GamePlayModel:[function(e,t,o){"use strict";var n;cc._RF.push(t,"3a3dbMmjXZDlbutv0S4vxKQ","GamePlayModel"),Object.defineProperty(o,"__esModule",{value:!0});var i,r,a=e("../../Global/Theme"),s=e("../../Global/GameRule"),l=e("../../Command/CommonSignal"),c=e("../../Utils/Random"),u=e("../../Utils/Signal"),d=e("../View/UI/RevertButtonView"),p=e("../View/UI/MoveCountLabelView"),h=e("../../Controller/GameStateController"),f=e("../View/UI/SubmitLayerView"),y=e("./GameLogic"),g=e("./Poker/PokerUtil"),m=e("../../Utils/HashMap"),P=e("./Poker/PokerModel"),S=e("./Poker/PokerParentModel"),v=e("../../Utils/Celer/CelerSDK"),_=e("../View/UI/TimeLabelView"),C=e("../../Model/PlayModelProxy"),k=e("./SolutionChecker");(function(e){e[e.DrawCost=0]="DrawCost",e[e.TimeBonus=1]="TimeBonus",e[e.Normal=2]="Normal"})(i=o.ScoreType||(o.ScoreType={})),function(e){e[e.Tune_11=0]="Tune_11",e[e.Tune_10=1]="Tune_10",e[e.Tune_12=2]="Tune_12"}(r=o.GameType||(o.GameType={}));var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.GameTypeInitSignal=T,o.TuneIndexPool=((n={})[r.Tune_10]=[2,3,5,6,7,8,9,10,11,12],n[r.Tune_11]=[2,3,4,5,6,7,8,9,10,11,12],n[r.Tune_12]=[1,2,3,4,5,6,7,8,9,10,11,12],n);var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.RevertButtonStateChangedSignal=b;var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.PLayerScoreInitSignal=M;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.BeforeGenLevelSignal=R;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.AfterGenLevelSignal=w;var F=function(){function e(){this.level=0,this.playerScore=0,this.noviceScore=0,this.gameTime=0,this.totalGameTime=0,this.pauseCount=0,this.pauseScore=0,this.streak=0,this.totalStreak=0,this.maxSteak=0,this.moveCount=0,this.scoreMap={},this.playerScoreMap={},this.gameLogic=new y.GameLogic(this),this.pokers=new m.HashMap,this.init()}return e.prototype.init=function(){var e=this;d.RevertSignal.inst.addListener(this.revertAction,this),f.EndNowSignal.inst.addListener(this.onEndNow,this),l.GameOverSignal.inst.addListener(function(){e.Logic.recordFlipCount()},this),y.NextRoundSignal.inst.addListener(function(){e.nextRound()},this)},Object.defineProperty(e.prototype,"Logic",{get:function(){return this.gameLogic},enumerable:!0,configurable:!0}),e.prototype.resetPlayerData=function(){this.level=0,this.playerScore=0,M.inst.dispatchOne(this.playerScore),this.noviceScore=0,this.gameTime=s.GetGameTime(v.CelerSDK.inst.DifficultyLevel),_.TimeInitSignal.inst.dispatchOne(this.gameTime),this.totalGameTime=this.gameTime,this.pauseCount=0,this.pauseScore=0,this.streak=0,this.totalStreak=0,this.maxSteak=0,this.moveCount=0,this.scoreMap={},this.playerScoreMap={},this.clearPoker()},e.prototype.clearPoker=function(){this.gameLogic.FreeDrawCount=3,this.gameLogic.clear(),this.removeAllPoker()},e.prototype.getPoker=function(e){return this.pokers.get(e)},e.prototype.removeAllPoker=function(){this.pokers.forEach(function(e,t){t.removeSelf()}),this.pokers.clear()},Object.defineProperty(e.prototype,"Time",{get:function(){return this.gameTime},set:function(e){this.gameTime=e,this.gameTime=Math.max(0,this.gameTime)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return this.theme},set:function(e){console.log("set game theme:",a.Theme[e]),this.theme=e,l.GameThemeInit.inst.dispatchOne(this.theme)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this.level},set:function(e){console.log("set difficult Level:",e),this.level=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalScore",{get:function(){return Math.max(this.Timebonus+this.ScoreSpread+this.playerScore-this.moveCount,0)},enumerable:!0,configurable:!0}),e.prototype.checkIsShowFront=function(e){return this.Logic.checkIsShowFront(e)},Object.defineProperty(e.prototype,"Timebonus",{get:function(){return this.gameTime>=this.totalGameTime||this.gameTime<=0||this.Logic.TotalHasFlipCount<=0?0:(console.log("total Level:",this.Logic.Level,"Last Level:",this.Logic.FlipCount,", Total :",this.Logic.TotalHasFlipCount,", time:",this.gameTime),Math.floor((this.Logic.TotalHasFlipCount/30*2.4+.3)*this.gameTime))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScoreSpread",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerScore",{get:function(){return this.playerScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MoveCount",{get:function(){return this.moveCount},set:function(e){this.moveCount=e,p.MoveCountChangedSignal.inst.dispatchOne(this.moveCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseScore",{get:function(){return this.pauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NoviceScore",{get:function(){return this.noviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalCombo",{get:function(){return this.totalStreak},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseCount",{get:function(){return this.pauseCount},enumerable:!0,configurable:!0}),e.prototype.onEndNow=function(){this.checkCompleteScore(),h.GameStateController.inst.roundEnd(h.RoundEndType.Over)},e.prototype.revertAction=function(){},e.prototype.checkCompleteScore=function(){},e.prototype.initGametheme=function(){},e.prototype.nextRound=function(){var e=this;R.inst.dispatch(),this.gameLogic.Level++,C.PlayModelProxy.inst.AutoRecycleCount=0,this.clearPoker(),h.GameStateController.inst.isReady=!1,h.GameStateController.inst.setRoundStart(!1),k.SolutionChecker.inst.startGeneratePokers(),this.gameLogic.startByCheckerInfo(function(){setTimeout(function(){e.gameLogic.gameReady(),w.inst.dispatch()},100)})},e.prototype.lastStep=function(){var e=this;R.inst.dispatch(),this.clearPoker(),h.GameStateController.inst.isReady=!1,h.GameStateController.inst.setRoundStart(!1),this.gameLogic.startByCheckerInfo(function(){setTimeout(function(){e.gameLogic.gameReady(),w.inst.dispatch()},100)})},e.prototype.initGameData=function(){if(console.log("init game data."),this.resetPlayerData(),3==v.CelerSDK.inst.DifficultyLevel)this.nextRound();else{var e=[];if(1==v.CelerSDK.inst.DifficultyLevel){for(var t=(e=g.Pokers.concat([])).concat([]),o=[],n=[];t.length>0;){var i=t.length,r=c.Random.getRandom(0,1),a=Math.floor(r*i);n.push(a),o.push(t.splice(a,1)[0])}for(var s=0;s++<=499&&0==g.checkIsNotZeroScore(o);)for(o.length=0,t.length=0,t=g.Pokers.concat([]),n.length=0;t.length>0;){i=t.length,r=c.Random.getRandom(0,1),a=Math.floor(r*i);n.push(a);var l=t.splice(a,1)[0];o.push(l)}for(console.log(" \u662f\u5426\u662f\u975e0\u5206\u5c40\uff1a",g.checkIsNotZeroScore(o),",checkCount:",s,o);e.length>0;){var u=e.splice(n.shift(),1)[0],d=parseInt(u.split(",")[1]),p=g.getType(u.split(",")[0]),f=new P.PokerModel(d,p,S.PokerParent.Draw);this.pokers.add(f.ID,f),this.gameLogic.addToDraw(f)}}else for(k.SolutionChecker.inst.startGeneratePokers(),e=k.SolutionChecker.inst.SolutionPokers;e.length>0;){u=e.pop(),d=parseInt(u.split(",")[1]),p=g.getType(u.split(",")[0]),f=new P.PokerModel(d,p,S.PokerParent.Draw);k.SolutionChecker.inst.bindPokerID(f),this.pokers.add(f.ID,f),this.gameLogic.addToDraw(f)}h.GameStateController.inst.isReady=!1,this.startDevPoker()}},e.prototype.addToPokers=function(e,t){this.pokers.add(e,t)},e.prototype.startDevPoker=function(){for(var e=this,t=0,o=0,n=0;t++<28;)setTimeout(function(){e.gameLogic.drawToDesk(o),++o>6&&(o=++n)},50*t)},e.prototype.initGameTutorial=function(){console.log("init game tutorial."),this.resetPlayerData();for(var e=g.GuidePokers.reverse().concat([]),t=e.concat([]),o=[],n=[];t.length>0;){var i=t.length-1;n.push(i),o.push(t.splice(i,1)[0])}for(;e.length>0;){var r=e.splice(n.shift(),1)[0],a=parseInt(r.split(",")[1]),s=g.getType(r.split(",")[0]),l=new P.PokerModel(a,s,S.PokerParent.Draw);this.pokers.add(l.ID,l),this.gameLogic.addToDraw(l)}h.GameStateController.inst.isReady=!1,this.startDevPokerTutorial()},e.prototype.startDevPokerTutorial=function(){for(var e=this,t=0,o=0,n=0;t++<28;)setTimeout(function(){e.gameLogic.drawToDesk(o),++o>6&&(o=++n)},50*t)},e.prototype.addPlayerScore=function(e,t,o,n,i){var r=this;if(void 0===o&&(o=1),void 0===n&&(n=null),void 0===i&&(i=0),0!=e){null==this.playerScoreMap[t]&&(this.playerScoreMap[t]=0),this.playerScoreMap[t]+=e;var a=this.playerScore;return this.playerScore+=e,e>0||this.resetCombo(),this.playerScore=Math.max(this.playerScore,0),setTimeout(function(){l.PlayerScoreChanged.inst.dispatchFour(r.playerScore,e,o,n)},i),this.playerScore-a}},e.prototype.addNoviceScore=function(e,t){void 0===t&&(t=1),this.noviceScore+=e,this.noviceScore=Math.max(this.noviceScore,0),l.NoviceScoreChanged.inst.dispatchThree(this.noviceScore,e,t)},e.prototype.getScoreByType=function(e){return"number"!=typeof this.playerScoreMap[e]?0:this.playerScoreMap[e]},e.prototype.addPauseCount=function(){C.PlayModelProxy.inst.isOnTutorial||(this.pauseCount++,console.log("add pause count:",this.pauseCount),this.pauseCount>s.FreePauseLimit&&this.addPlayerScore(-s.PauseScoreCost,i.Normal))},e.prototype.resetCombo=function(){this.streak=0},e.prototype.addStreak=function(){this.streak++,this.totalStreak++,this.maxSteak=Math.max(this.maxSteak,this.streak)},e.prototype.dump=function(){},e}();o.GamePlayModel=F,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Global/GameRule":"GameRule","../../Global/Theme":"Theme","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Celer/CelerSDK":"CelerSDK","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../View/UI/MoveCountLabelView":"MoveCountLabelView","../View/UI/RevertButtonView":"RevertButtonView","../View/UI/SubmitLayerView":"SubmitLayerView","../View/UI/TimeLabelView":"TimeLabelView","./GameLogic":"GameLogic","./Poker/PokerModel":"PokerModel","./Poker/PokerParentModel":"PokerParentModel","./Poker/PokerUtil":"PokerUtil","./SolutionChecker":"SolutionChecker"}],GamePlaySignal:[function(e,t,o){"use strict";cc._RF.push(t,"6a923XZO3BHe6UfcoANFeWX","GamePlaySignal"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e("../../Utils/Signal").BaseSignal);o.SubmitButtonClickSignal=n,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],GameRule:[function(e,t,o){"use strict";cc._RF.push(t,"58c53me7vtEdKVK7W6RnNQo","GameRule"),Object.defineProperty(o,"__esModule",{value:!0}),o.DrawDebug=!1,o.FreePauseLimit=2,o.PauseScoreCost=1e3,o.RecycleLastTime=.2,o.Speed=2500,o.GetDrawCost=function(){return-20},o.GetRevertCost=function(){return 0},o.GetPokerFlipScore=function(){return 20},o.GetPokerRecycleScore=function(e){return 10*(13-e)},o.GetGameTime=function(e){switch(e){case 1:return 300;case 2:case 3:return CELER_X,180;default:return 300}},cc._RF.pop()},{}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"b768b1DCFpC4aef+tHUAH/Y","GameStateController"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../Utils/ToSingleton"),r=e("../Command/CommonSignal"),a=e("../Model/PlayModelProxy"),s=e("../Utils/Signal");(function(e){e[e.Complete=0]="Complete",e[e.Over=1]="Over",e[e.TimeUp=2]="TimeUp"})(n=o.RoundEndType||(o.RoundEndType={}));var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.RoundStartSignal=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pauseCount=0,t.roundstart=!1,t.isReady=!1,t.isOver=!1,t.currentRound=0,t.onResumeCallbacks=[],t}return __extends(t,e),t.prototype.start=function(){this.pauseCount=0},t.prototype.canStart=function(){return this.isReady},t.prototype.setRoundStart=function(e){this.roundstart=e,this.isOver=!1},t.prototype.roundStart=function(){this.isOver||(console.log(" round start:",++this.currentRound),this.roundstart=!0,l.inst.dispatch())},t.prototype.roundEnd=function(e){console.log("round end :",n[e]),this.roundstart=!1,this.isOver=!0,r.GameOverSignal.inst.dispatchOne(e)},t.prototype.isRoundStart=function(){return this.roundstart},t.prototype.pause=function(e){void 0===e&&(e=!1),0==this.isPause()&&(this.onResumeCallbacks.length=0,r.GamePauseSignal.inst.dispatch(),e||this.onResumeCallbacks.push(function(){a.PlayModelProxy.inst.addPauseCount()})),this.pauseCount++,console.log(" pause pause ref count:",this.pauseCount)},t.prototype.testEndComplete=function(){this.roundEnd(n.Complete)},t.prototype.testEndTimeUp=function(){a.PlayModelProxy.inst.addGameTime(-1e12)},t.prototype.clearResumeCallback=function(){this.onResumeCallbacks.length=0},t.prototype.resume=function(){if(this.pauseCount--,console.log(" resume pause ref count:",this.pauseCount),console.assert(this.pauseCount>=0," pause count smaller than 0!!!"),this.pauseCount=Math.max(this.pauseCount,0),this.pauseCount<=0){for(var e=0,t=this.onResumeCallbacks;e<t.length;e++){(0,t[e])()}this.onResumeCallbacks.length=0}},t.prototype.isPause=function(){return this.pauseCount>0},t.prototype.addResumeCallback=function(e){this.onResumeCallbacks||(this.onResumeCallbacks=[]),this.onResumeCallbacks.push(e)},t.prototype.isGameOver=function(){return this.isOver},t}(i.SingleTon());o.GameStateController=c,!CELER_X&&(window.GameState=c.inst),cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Model/PlayModelProxy":"PlayModelProxy","../Utils/Signal":"Signal","../Utils/ToSingleton":"ToSingleton"}],GlobalSingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"50484YTu+lAFp2acGVLgU7t","GlobalSingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Controller/GameStateController"),i=e("../../GamePlay/View/Animation/SubmitTip"),r=e("../../Model/PlayModelProxy"),a=e("../../Utils/Celer/CelerSDK"),s=e("../SingleTouchMediator"),l=cc._decorator,c=l.ccclass,u=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeoutID=-100,t}return __extends(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.node._touchListener.swallowTouches=!1},t.prototype.onTouchStart=function(e){n.GameStateController.inst.canStart()&&0==n.GameStateController.inst.isRoundStart()&&n.GameStateController.inst.roundStart(),a.CelerSDK.inst.isNew()&&0==r.PlayModelProxy.inst.isOnTutorial&&(-100!=this.timeoutID&&clearTimeout(this.timeoutID),i.ShowSubmitTipSignal.inst.dispatchOne(!1),this.timeoutID=setTimeout(function(){i.ShowSubmitTipSignal.inst.dispatchOne(!0)},5e3))},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t=__decorate([c],t)}(s.default));o.default=u,cc._RF.pop()},{"../../Controller/GameStateController":"GameStateController","../../GamePlay/View/Animation/SubmitTip":"SubmitTip","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Celer/CelerSDK":"CelerSDK","../SingleTouchMediator":"SingleTouchMediator"}],GlobalSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"4cc97bBcEZPu7Haxk0HdV9+","GlobalSingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../BaseView"),i=e("./GlobalSingleTouchMediator"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.BindMedaitor(i.default)},t.prototype.start=function(){},t=__decorate([a],t)}(n.default));o.default=s,cc._RF.pop()},{"../BaseView":"BaseView","./GlobalSingleTouchMediator":"GlobalSingleTouchMediator"}],HandAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"b5cd4TIWTBH/75CEBas9rin","HandAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],HashMap:[function(e,t,o){"use strict";cc._RF.push(t,"4b0e7DzcRNJnZXTYCWgDaDU","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._list=new Array,this.clear()}return e.prototype.getIndexByKey=function(e){for(var t=this._list.length,o=0;o<t;o++){if(this._list[o].key==e)return o}return-1},e.prototype.keyOf=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];if(n.value.hashKey&&e.hashKey&&n.value.hashKey===e.hashKey||n.value==e)return n.key}return null},Object.defineProperty(e.prototype,"keys",{get:function(){for(var e=new Array,t=0,o=this._list;t<o.length;t++){var n=o[t];n&&e.push(n.key)}return e},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var o={key:e,value:t},n=this.getIndexByKey(e);-1!=n?this._list[n]=o:this._list.push(o)},Object.defineProperty(e.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.getIndexByKey(e);if(-1!=t){var o=this._list[t];return this._list.splice(t,1),o}return null},e.prototype.has=function(e){return-1!=this.getIndexByKey(e)},e.prototype.get=function(e){var t=this.getIndexByKey(e);return-1!=t?this._list[t].value:null},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.sort=function(e){this._list.sort(e)},e.prototype.forEachKeyValue=function(e){for(var t=this._list.length,o=0;o<t;o++){e(this._list[o])}},e.prototype.forEach=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];e(n.key,n.value)}},e.prototype.clone=function(){var t=new e;return this.forEach(function(e,o){t.add(e,o)}),t},e.prototype.clear=function(){this._list=[]},e}();o.HashMap=n,cc._RF.pop()},{}],HelpButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"55938+NxDZMXZHVR36gYzbo","HelpButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../View/SingleTouchView"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||(n.ShowHelpLayerSignal.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t=__decorate([s],t)}(r.default));o.default=l,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../View/SingleTouchView":"SingleTouchView"}],HelpLayerMediator:[function(e,t,o){"use strict";cc._RF.push(t,"ab216iOmFFBBo7YhihjIFYL","HelpLayerMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseMediator"),i=e("../Command/CommonSignal"),r=e("../Controller/GameStateController"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeCallback=null,t}return __extends(t,e),t.prototype.onRegister=function(){i.ShowHelpLayerSignal.inst.addListenerOne(this.showHelp,this),i.HideHelpLayerSignal.inst.addListenerOne(this.hideGuide,this)},t.prototype.showHelp=function(e){this.View.isShowed()||(r.GameStateController.inst.pause(),this.closeCallback=e,this.View.Show())},t.prototype.showGuide=function(e){this.View.isShowed()||(r.GameStateController.inst.pause(!0),this.closeCallback=e,this.View.Show())},t.prototype.hideGuide=function(){0!=this.View.isShowed()&&(r.GameStateController.inst.resume(),this.View.Hide(this.closeCallback),this.closeCallback=null)},t=__decorate([s],t)}(n.default));o.default=l,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","./BaseMediator":"BaseMediator"}],HelpLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"7de5dV5nLxKg6SXhg1Pqw8Z","HelpLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./BaseView"),r=e("./HelpLayerMediator"),a=e("../Command/CommonSignal"),s=cc._decorator,l=s.ccclass,c=s.property;(function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"})(n||(n={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=n.Hide,t.Next=null,t.Close=null,t.GuidePage=null,t.TotalPage=null,t.Page=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.BindMedaitor(r.default),this.state=n.Hide,this.node.scale=1,this.node.active=!1,this.GuidePage.node.on("page-turning",this.onPageChanged,this),this.Close.on(cc.Node.EventType.TOUCH_END,this.close,this),this.Next.on(cc.Node.EventType.TOUCH_END,this.next,this)},t.prototype.start=function(){},t.prototype.close=function(){a.ButtonClickSignal.inst.dispatch(),a.HideHelpLayerSignal.inst.dispatch()},t.prototype.next=function(){a.ButtonClickSignal.inst.dispatch(),this.GuidePage.scrollToPage((this.GuidePage.getCurrentPageIndex()+1)%this.GuidePage.content.childrenCount,0),this.onPageChanged()},t.prototype.onPageChanged=function(){var e=this;this.TotalPage&&(this.TotalPage.string=this.GuidePage.content.childrenCount.toString()),this.Page&&(this.Page.string=(this.GuidePage.getCurrentPageIndex()+1).toString()),this.GuidePage.getCurrentPageIndex()>=this.GuidePage.content.childrenCount-1?setTimeout(function(){e.Next.active=!1,e.Close.active=!0},0):setTimeout(function(){e.Next.active=!0,e.Close.active=!1},0)},t.prototype.isShowed=function(){return this.state==n.Show},t.prototype.Show=function(e){this.isShowed()||(this.state=n.Show,this.node.active=!0,this.node.stopAllActions(),this.node.scale=0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()}))),this.Next.active=!0,this.Close.active=!1,this.GuidePage.scrollToPage(0,0),this.onPageChanged())},t.prototype.Hide=function(e){var t=this;0!=this.isShowed()&&(this.state=n.Hide,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.scale=1,e&&e(),t.node.active=!1}))))},__decorate([c(cc.Node)],t.prototype,"Next",void 0),__decorate([c(cc.Node)],t.prototype,"Close",void 0),__decorate([c(cc.PageView)],t.prototype,"GuidePage",void 0),__decorate([c(cc.Label)],t.prototype,"TotalPage",void 0),__decorate([c(cc.Label)],t.prototype,"Page",void 0),t=__decorate([l],t)}(i.default);o.default=u,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","./BaseView":"BaseView","./HelpLayerMediator":"HelpLayerMediator"}],InitialFacade:[function(e,t,o){"use strict";cc._RF.push(t,"cbbbcO7od5PrqaPNOs8dFh3","InitialFacade"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Command/InititalCommand"),i=e("../Command/StartGameCommand"),r=e("../Command/LoadAudioCommand"),a=e("../Command/LoadPrefabCommand"),s=e("../../Utils/Celer/CelerSDK"),l=e("../../Manager/StepManager"),c=function(){function e(e){this.stepMgr=new l.StepManager,this.facade=puremvc.Facade.getInstance(e)}return Object.defineProperty(e,"inst",{get:function(){return this.instance?this.instance:this.instance=new e(e.MULTITON_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Facade",{get:function(){return console.assert(null!==this.facade," facade is null"),this.facade},enumerable:!0,configurable:!0}),e.prototype.register=function(){var t=this;this.facade.registerCommand(e.INITIALIZATION,n.InitialCommand),this.facade.registerCommand(e.START_UP,i.StartGameCommand),s.CelerSDK.inst.init(function(){t.facade.sendNotification(e.START_UP,t)}),this.stepMgr.register(function(){s.CelerSDK.inst.celerXReady()},e.TOTAL_STEPS)},e.prototype.unregister=function(){this.facade.removeCommand(e.INITIALIZATION),this.facade.removeCommand(e.START_UP)},e.prototype.start=function(){this.register(),this.facade.sendNotification(e.INITIALIZATION,this)},e.prototype.step=function(e){console.log(" initialization step:",e),this.stepMgr.nextStep(e)},e.MULTITON_KEY="INITIAL_FCADE",e.INITIALIZATION="initialization",e.START_UP="startup",e.TOTAL_STEPS=[r.LoadAudioCommand.STEP,a.LoadPrefabCommand.STEP],e}();o.InitialFacade=c,cc._RF.pop()},{"../../Manager/StepManager":"StepManager","../../Utils/Celer/CelerSDK":"CelerSDK","../Command/InititalCommand":"InititalCommand","../Command/LoadAudioCommand":"LoadAudioCommand","../Command/LoadPrefabCommand":"LoadPrefabCommand","../Command/StartGameCommand":"StartGameCommand"}],InititalCommand:[function(e,t,o){"use strict";cc._RF.push(t,"a28caT/H41F74cWxJYqN9pz","InititalCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./LoadPrefabCommand"),i=e("./LoadAudioCommand"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initializeMacroCommand=function(){this.addSubCommand(n.LoadPrefabCommand),this.addSubCommand(i.LoadAudioCommand)},t}(puremvc.MacroCommand);o.InitialCommand=r,cc._RF.pop()},{"./LoadAudioCommand":"LoadAudioCommand","./LoadPrefabCommand":"LoadPrefabCommand"}],Level2Animation:[function(e,t,o){"use strict";cc._RF.push(t,"70e3bKp05RPErvjQCbQ7mVh","Level2Animation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pos=[cc.v2(0,-188.616),cc.v2(-21.285,-201.524)],t.isFirst=!0,t}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this),this.isFirst=!0},t.prototype.onKeyFrame=function(e){this.node.setPosition(this.pos[e]),this.isFirst||(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.fadeIn(.1)))),this.isFirst=!1},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],Level3Animation:[function(e,t,o){"use strict";cc._RF.push(t,"31e987wZSxLgoJJj1vhiubx","Level3Animation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pos=[cc.v2(0,-298),cc.v2(-21.285,-201.524)],t.isFirst=!0,t}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this),this.isFirst=!0},t.prototype.onKeyFrame=function(e){this.node.setPosition(this.pos[e]),this.isFirst||(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.fadeIn(.1)))),this.isFirst=!1},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],Level:[function(e,t,o){"use strict";cc._RF.push(t,"3db54FVK6dM2Ik/+eMmSgop","Level"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Cocos"),i=e("./Theme"),r=function(){function e(){}return e.getThemeRandomPool=function(e){for(;this.pool.length<120;)this.pool.push(i.Theme.Blue),this.pool.push(i.Theme.Green),this.pool.push(i.Theme.Red);return n.disOrderArray(this.pool),this.pool},e.pool=[],e}();o.Level=r,cc._RF.pop()},{"../Utils/Cocos":"Cocos","./Theme":"Theme"}],LoadAudioCommand:[function(e,t,o){"use strict";cc._RF.push(t,"d4f3eGYUlBES5d8aEvuPQna","LoadAudioCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Manager/AudioManager"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){if(e){var o=e.getBody();o&&o.step&&n.gAudio.init(function(){o.step(t.STEP)})}},t.STEP="LoadAudio",t}(puremvc.SimpleCommand);o.LoadAudioCommand=i,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager"}],LoadPrefabCommand:[function(e,t,o){"use strict";cc._RF.push(t,"8b33fPnvCZEJ7bc/zCVv9My","LoadPrefabCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){n.gFactory.init(function(){if(e){var o=e.getBody();o&&o.step&&o.step(t.STEP)}})},t.STEP="LoadPrefab",t}(puremvc.SimpleCommand);o.LoadPrefabCommand=i,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory"}],LoadingPageMediator:[function(e,t,o){"use strict";cc._RF.push(t,"359acCsI6FNpLUAuWOw+Fv4","LoadingPageMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseMediator"),i=e("../../Utils/Celer/CelerSDK"),r=e("../../Command/CommonSignal"),a=e("../../Model/PlayModelProxy"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=3e3,t.startTime=0,t}return __extends(t,e),t.prototype.onRegister=function(){this.startTime=Date.now(),r.GameReadySignal.inst.addListener(this.onGameReady,this)},t.prototype.onGameReady=function(){var e=this,t=Date.now()-this.startTime;console.log(" -- game init done, hide loading page: ",t),this.time,this.View.Hide(function(){e.startGame()})},t.prototype.startGame=function(){i.CelerSDK.inst.isNew()?(a.PlayModelProxy.inst.isOnTutorial=!0,a.PlayModelProxy.inst.initTutorial(),r.ShowTutorialSignal.inst.dispatchOne(function(){a.PlayModelProxy.inst.isOnTutorial=!1,a.PlayModelProxy.inst.init(),r.GameStartSignal.inst.dispatch()})):(a.PlayModelProxy.inst.isOnTutorial=!1,a.PlayModelProxy.inst.init(),r.GameStartSignal.inst.dispatch())},t.prototype.onDestroy=function(){},t=__decorate([l],t)}(n.default));o.default=c,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Celer/CelerSDK":"CelerSDK","../../View/BaseMediator":"BaseMediator"}],LoadingView:[function(e,t,o){"use strict";cc._RF.push(t,"dfec6LZreJCaa8QdaMxRAO/","LoadingView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseView"),i=e("./LoadingPageMediator"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=1,this.node.opacity=0,this.BindMedaitor(i.default)},t.prototype.start=function(){},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.node.active=!1,e()})))},t=__decorate([a],t)}(n.default));o.default=s,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],LogHandler:[function(e,t,o){"use strict";cc._RF.push(t,"a4747QIvUBIo6Ktpx/xQwuB","LogHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var o=e.call(this)||this;if(o.logFunc=console.log,o.logMsg=null,o.frameTimes=0,o.now=0,o.Frame=20,o.totalFrames=0,o.startTime=0,window.addEventListener)for(var n=0,i=t.LISTENNING_EVENTS;n<i.length;n++){var r=i[n],a="trigger"+r.charAt(0).toLocaleUpperCase()+r.substring(1);o[a]&&"function"==typeof o[a]&&window.addEventListener(r,o[a].bind(o))}return o}return __extends(t,e),t.prototype.dumpFrameInfo=function(){var e=(Date.now()-this.startTime)/1e3,t=e/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",e+"s"," , per frame cost time ave:"+t+"s")},t.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLog.apply(this,e),this.sendLog()},t.prototype.ready=function(){console.log(t.VERSION)},t.prototype.initLog=function(e){var o=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){o.frameTimes=0,o.now=Date.now(),o.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){o.frameTimes++,o.totalFrames++,o.frameTimes>=o.Frame&&(o.frameTimes=0,o.now=Date.now())},this),this.logFunc=e,window.consoleError=console.error,window.consoleWarn=console.warn,window.consoleLog=console.log,window.consoleAssert=console.assert,console.error=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[ERROR]"].concat(o))},console.warn=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[WARN]"].concat(o))},console.log=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[INFO]"].concat(o))},console.assert=function(e){for(var o,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];e||(o=t.inst).log.apply(o,["[ASSERT ERROR]"].concat(n))}},t.prototype.formatLogArguments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o="",n=0;n<arguments.length;n++){var i=typeof arguments[n];"string"==i||"number"==i?o+=" "+arguments[n]:"object"==i?o+=" "+JSON.stringify(arguments[n]):"boolean"==i&&arguments[n].toString&&(o+=arguments[n].toString())}return o},t.prototype.addLog=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==this.logMsg&&(this.logMsg={});var n=this.formatLogArguments.apply(this,e),i=this.getFullTime(new Date);this.logMsg[i]=t.VERSION+n},t.prototype.getFullTime=function(e){var t="";t+=e.getFullYear();var o=e.getMonth()+1;t+="-"+(o>=10?o:"0"+o);var n=e.getDate();t+="-"+(n>=10?n:"0"+n);var i=e.getHours();t+="  "+(i>=10?i:"0"+i);var r=e.getMinutes();t+=":"+(r>=10?r:"0"+r);var a=e.getSeconds();return t+=":"+(a>=10?a:"0"+a)},t.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},t.prototype.triggerClose=function(e){this.addLog("triggerClose"),this.sendLog()},t.prototype.triggerLoad=function(e){this.addLog("triggerLoad"),this.sendLog()},t.prototype.triggerUnload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerOnunload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerError=function(e){this.addLog("triggerError"),this.addLog(e.message),this.sendLog()},t.prototype.triggerFocus=function(e){this.addLog("triggerFocus"),this.sendLog()},t.prototype.triggerBlur=function(e){this.addLog("triggerBlur"),this.sendLog()},t.prototype.triggerAbort=function(e){this.addLog("triggerAbort"),this.sendLog()},t.prototype.triggerSuspend=function(e){this.addLog("triggerSuspend"),this.sendLog()},t.prototype.beforeunload=function(e){this.addLog("beforeunload"),this.sendLog()},t.VERSION=window.GAME_VERSION||" --- ",t.LISTENNING_EVENTS=["error"],t}(e("./ToSingleton").SingleTon());o.LogHandler=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],MenuButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"28073o37LNPKaWTUfECMch5","MenuButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Utils/Signal"),a=e("../../../View/SingleTouchView"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.MenuButtonClickSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||(c.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t.prototype.start=function(){},t=__decorate([l],t)}(a.default);o.default=u,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView"}],MenuLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"85bd9XHwOpA8pPYE/vCkvEe","MenuLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Controller/ResourceController"),a=e("../../../Manager/AudioManager"),s=e("../../../Model/PlayModelProxy"),l=e("../../../View/BaseView"),c=e("../../../View/SliderView"),u=e("./MenuButtonView"),d=e("./SubmitLayerView"),p=cc._decorator,h=p.ccclass,f=p.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Content=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("ResumeButton")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return this.node.getChildByName("FreePauseCount").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseInfo",{get:function(){return this.node.getChildByName("PauseInfo").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VolumeSlider",{get:function(){return this.node.getChildByName("VolumeSlider").getComponent(c.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;d.HideSubmitLayerSignal.inst.addListener(function(){t.node.active&&(i.GameStateController.inst.resume(),setTimeout(function(){t.Hide()},0))},this),u.MenuButtonClickSignal.inst.addListener(this.onShow,this),n.ShowPauseLayerSignal.inst.addListener(function(){t.onShow()},this),this.Resume.on(cc.Node.EventType.TOUCH_END,function(){i.GameStateController.inst.resume(),setTimeout(function(){t.Hide()},0)},this),this.Content._enableBold(!0),e.prototype.onLoad.call(this),this.VolumeSlider.onProgress=function(e){a.gAudio.setEffectVolume(e),a.gAudio.setMusicVolume(e)},setTimeout(function(){t.node.active=!1,t.node.scale=1},0)},t.prototype.onShow=function(){var e=this;this.node.active||(s.PlayModelProxy.inst.FreePauseCount<=0?(this.FreePauseCount.node.active=!1,this.PauseInfo.spriteFrame=r.ResourceController.inst.getAnimationAtlas("bg_pause_font2")):(this.FreePauseCount.node.active=!0,this.FreePauseCount.string=s.PlayModelProxy.inst.FreePauseCount.toString(),this.PauseInfo.spriteFrame=r.ResourceController.inst.getAnimationAtlas("bg_pause_font1")),this.Show(function(){e.VolumeSlider.Percent=a.gAudio.MusicVolume}),setTimeout(function(){e.VolumeSlider.Percent=a.gAudio.MusicVolume},0),i.GameStateController.inst.pause())},t.prototype.start=function(){},__decorate([f(cc.Label)],t.prototype,"Content",void 0),t=__decorate([h],t)}(l.default);o.default=y,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Manager/AudioManager":"AudioManager","../../../Model/PlayModelProxy":"PlayModelProxy","../../../View/BaseView":"BaseView","../../../View/SliderView":"SliderView","./MenuButtonView":"MenuButtonView","./SubmitLayerView":"SubmitLayerView"}],MoveCountLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"523c3oc4AhAw43gNtGFJ99Y","MoveCountLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../../../View/NumberChangedView"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.MoveCountChangedSignal=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),s.inst.addListenerOne(this.onNumberChanged,this)},t=__decorate([a],t)}(i.default);o.default=l,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../../../View/NumberChangedView":"NumberChangedView"}],NumberChangedView:[function(e,t,o){"use strict";cc._RF.push(t,"5f2acutWoZLka/VldveJWjk","NumberChangedView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.num=0,t.showNum=0,t.step=0,t.label=null,t.action=!0,t.STEP=60,t.callback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.label?this.label:this.label=this.node.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.setNumber=function(e){this.showNum=e,this.num=e,this.Label.string=e.toString()},t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onStep=function(e){},t.prototype.onNumberChanged=function(e,t){if(this.num=e,this.callback=t,this.num!=this.showNum){var o=this.num-this.showNum;this.step=o>0?Math.ceil(o/this.STEP):Math.floor(o/this.STEP),this.action}else this.step=0},t.prototype.update=function(e){this.num!=this.showNum&&(this.showNum+=this.step,this.onStep(this.step),(this.showNum>this.num&&this.step>0||this.showNum<this.num&&this.step<0)&&(this.showNum=this.num,this.step=0)),Math.abs(this.num-this.showNum)<=Math.abs(this.step)&&this.callback&&"function"==typeof this.callback&&(this.callback(),this.callback=null),this.Label.string=this.showNum>=0?this.showNum.toString():"/"+Math.abs(this.showNum).toString()},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"./BaseView":"BaseView"}],PlayModelProxy:[function(e,t,o){"use strict";cc._RF.push(t,"50835VU6k9M3pgXsJbG5zxG","PlayModelProxy"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=e("../Controller/GameStateController"),r=e("../GamePlay/Model/GamePlayModel"),a=e("../Command/CommonSignal"),s=e("../Global/GameRule"),l=e("../Manager/AudioManager"),c=function(e){function t(){var t=e.call(this)||this;return t.playerModel=null,t.isOnTutorial=!1,t.Combo=-1,t.AutoRecycleCount=0,t.isStart=!1,t.bindSignal(),t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.playerModel?this.playerModel:this.playerModel=new r.GamePlayModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeLeft",{get:function(){return this.Model.Time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlayerScore",{get:function(){return this.Model.PlayerScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MoveCount",{get:function(){return this.Model.MoveCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NoviceScore",{get:function(){return this.Model.NoviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointSpread",{get:function(){return this.Model.ScoreSpread},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Model.Timebonus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Theme",{get:function(){return this.Model.Theme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this.Model.Level},set:function(e){this.Model.Level=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseScore",{get:function(){return this.Model.PauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return Math.max(0,s.FreePauseLimit-this.Model.PauseCount)},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){},t.prototype.initGametheme=function(){this.Model.initGametheme()},t.prototype.getTotalScore=function(){return this.Model.TotalScore},t.prototype.addPauseCount=function(){this.Model.addPauseCount()},t.prototype.addGameTime=function(e){i.GameStateController.inst.isPause()||0==i.GameStateController.inst.isRoundStart()||this.isOnTutorial||(0==this.isStart&&(l.gAudio.playEffect("start_count"),this.isStart=!0),this.Model.Time+=e,a.UpdateTimeNumber.inst.dispatchOne(this.Model.Time),a.TimeAnimationStateChanged.inst.dispatchOne(this.Model.Time<=60),this.Model.Time<=0&&(this.Model.checkCompleteScore(),i.GameStateController.inst.roundEnd(i.RoundEndType.TimeUp)))},t.prototype.getScoreByType=function(e){return this.Model.getScoreByType(e)},t.prototype.checkIsShowFront=function(e){return this.Model.checkIsShowFront(e)},t.prototype.addPlayerScore=function(e,t,o,n){this.Model.addPlayerScore(e,t,o,n)},t.prototype.dump=function(){this.Model.dump()},t.prototype.init=function(){i.GameStateController.inst.setRoundStart(!1),this.Model.initGameData()},t.prototype.initTutorial=function(){this.Model.initGameTutorial()},t.prototype.onCancel=function(e){this.Model.Logic.onCancel(e)},t.prototype.onMoved=function(e,t){this.Model.Logic.onMoved(e,t)},t.prototype.onMovedEnd=function(e){this.Model.Logic.onMovedEnd(e)},t}(n.SingleTon());o.PlayModelProxy=c,!CELER_X&&(window.Game=c.inst),cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","../GamePlay/Model/GamePlayModel":"GamePlayModel","../Global/GameRule":"GameRule","../Manager/AudioManager":"AudioManager","../Utils/ToSingleton":"ToSingleton"}],PokerFrontView:[function(e,t,o){"use strict";cc._RF.push(t,"47cf2yv55hIg57hSb8USvAR","PokerFrontView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/PlayModelProxy"),i=e("../../../Utils/Signal"),r=e("./PokerRotationView"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.CheckIsHideSignal=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Front",{get:function(){return this.node.getChildByName("Front")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;r.PokerPosFlySignal.inst.addListener(function(){0==e.Front.active&&setTimeout(function(){e.Front.active=!0},e.getComponent(r.default).randomFlyDelay/2)},this),l.inst.addListenerTwo(function(t,o){e.model&&e.model.ID==t?e.Front.active=o||n.PlayModelProxy.inst.checkIsShowFront(e.model):e.model&&(e.Front.active=n.PlayModelProxy.inst.checkIsShowFront(e.model))},this)},t.prototype.onParentChanged=function(e){this.model.ID},t.prototype.reuse=function(e){this.model=e},t.prototype.unuse=function(){this.model=null,this.node.zIndex=0},t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","./PokerRotationView":"PokerRotationView"}],PokerLockView:[function(e,t,o){"use strict";cc._RF.push(t,"2050475NTtNwpyp5DbfN2bN","PokerLockView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/PlayModelProxy"),i=e("../../../Utils/Signal"),r=e("../../../View/BaseView"),a=e("../../Model/Poker/PokerModel"),s=e("../Animation/RecycleAnimation"),l=e("../new/ToturialLayer"),c=e("../PokerRoot/Recycle"),u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.LockStateChangedSignal=p;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Animation",{get:function(){return this.node.getChildByName("Animation").getComponent(s.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){var t=this;this.model=e,n.PlayModelProxy.inst.isOnTutorial&&(this.model.Point==a.Poker.$_A&&this.model.Type==a.PokerType.Diamond?(l.default.AddToturialStep(1,this.node,null,!1,function(){},function(){},function(){},!0),setTimeout(function(){l.default.AddToturialStep(2,t.node,null,!1,function(){},function(){},function(){},!0)},0)):this.model.Point==a.Poker.$_2&&this.model.Type==a.PokerType.Diamond?l.default.AddToturialStep(2,this.node,null,!1,function(){},function(){},function(){},!0):this.model.Point==a.Poker.$_K&&this.model.Type==a.PokerType.Heart&&l.default.AddToturialStep(4,this.node,null,!1,function(){},function(){},function(){},!0)),this.Lock.active=!1},t.prototype.unuse=function(){this.model=null},Object.defineProperty(t.prototype,"Lock",{get:function(){return this.node.getChildByName("Locked")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;p.inst.addListenerTwo(this.onLockStateChanged,this),setTimeout(function(){e.Animation.node.active=!1},0),c.PlayRecycleAnimationSignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t&&(e.Animation.node.active=!0,e.Animation.node.opacity=255,e.Animation.play(),e.Animation.onComplete=function(){e.Animation.node.runAction(cc.fadeOut(.1))})},this),l.TutorialPrepareDoneSignal.inst.addListener(function(){e.model&&e.model.Point==a.Poker.$_5&&e.model.Type==a.PokerType.Club&&l.default.AddToturialStep(6,e.node,null,!1,function(){},function(){},function(){},!0)},this)},t.prototype.start=function(){},t.prototype.onLockStateChanged=function(e,t){this.model&&this.model.ID==e&&(this.Lock.active=t)},t=__decorate([d],t)}(r.default);o.default=h,cc._RF.pop()},{"../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/BaseView":"BaseView","../../Model/Poker/PokerModel":"PokerModel","../Animation/RecycleAnimation":"RecycleAnimation","../PokerRoot/Recycle":"Recycle","../new/ToturialLayer":"ToturialLayer"}],PokerModel:[function(e,t,o){"use strict";cc._RF.push(t,"575239ZUbVJ3a83YhGhDyoe","PokerModel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i,r,a=e("../../../Utils/HashMap"),s=e("../../../Utils/Signal"),l=e("./PokerParentModel"),c=e("./PokerPositionModel"),u=e("./PokerStateModel");(function(e){e[e.Spade=0]="Spade",e[e.Club=1]="Club",e[e.Diamond=2]="Diamond",e[e.Heart=3]="Heart"})(n=o.PokerType||(o.PokerType={})),function(e){e[e.$_A=1]="$_A",e[e.$_2=2]="$_2",e[e.$_3=3]="$_3",e[e.$_4=4]="$_4",e[e.$_5=5]="$_5",e[e.$_6=6]="$_6",e[e.$_7=7]="$_7",e[e.$_8=8]="$_8",e[e.$_9=9]="$_9",e[e.$_10=10]="$_10",e[e.$_J=11]="$_J",e[e.$_Q=12]="$_Q",e[e.$_K=13]="$_K"}(i=o.Poker||(o.Poker={})),function(e){e[e.Black=0]="Black",e[e.Red=1]="Red"}(r=o.PokerColor||(o.PokerColor={}));var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.PokerRemovedSignal=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.PokerCreatedSignal=p;var h=function(){function e(t,o,r){this.position=null,this.parent=null,this.state=null,this.id="",this.point=null,this.type=null,this.index=0,this.offset=0,this.offsetFront=0,this.AutoRecycleDelay=0,this.DrawToReadyDelay=0,this.id=e.count+++"-"+i[t]+"-"+n[o],this.point=t,this.type=o,this.parent=new l.PokerParentModel(this,r),this.position=new c.PokerPositionModel(this),this.state=new u.PokerStateModel(this,u.PokerState.Back),e.pokerMap.add(this.id,this),p.inst.dispatchOne(this)}return Object.defineProperty(e.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"State",{get:function(){return this.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Parent",{get:function(){return this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Position",{get:function(){return this.position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Point",{get:function(){return this.point},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Index",{get:function(){return this.index},set:function(e){this.index=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.offset},set:function(e){this.offset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetFront",{get:function(){return this.offsetFront},set:function(e){this.offsetFront=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.type==n.Spade||this.type==n.Club?r.Black:r.Red},enumerable:!0,configurable:!0}),e.prototype.setParent=function(e){this.parent.Parent=e,this.parent.OldParent==l.PokerParent.Draw&&e==l.PokerParent.Ready||this.position.updatePosition()},e.prototype.isOnDraw=function(){return this.parent.Parent==l.PokerParent.Draw},e.prototype.isOnRecycle=function(){return this.parent.ParentType==l.ParentType.Recycle},e.prototype.turnFront=function(){this.state.turnFront()},e.prototype.turnBack=function(){this.state.turnBack()},e.prototype.removeSelf=function(){d.inst.dispatchOne(this.ID),e.pokerMap.remove(this.ID)},e.count=0,e.pokerMap=new a.HashMap,e}();o.PokerModel=h,cc._RF.pop()},{"../../../Utils/HashMap":"HashMap","../../../Utils/Signal":"Signal","./PokerParentModel":"PokerParentModel","./PokerPositionModel":"PokerPositionModel","./PokerStateModel":"PokerStateModel"}],PokerParentModel:[function(e,t,o){"use strict";cc._RF.push(t,"a9331OecqRGTLhS/6V/nD74","PokerParentModel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i,r=e("../../../Utils/Signal");(function(e){e[e.Recycle0=0]="Recycle0",e[e.Recycle1=1]="Recycle1",e[e.Recycle2=2]="Recycle2",e[e.Recycle3=3]="Recycle3",e[e.Draw=4]="Draw",e[e.Ready=5]="Ready",e[e.Desk0=6]="Desk0",e[e.Desk1=7]="Desk1",e[e.Desk2=8]="Desk2",e[e.Desk3=9]="Desk3",e[e.Desk4=10]="Desk4",e[e.Desk5=11]="Desk5",e[e.Desk6=12]="Desk6",e[e.Removed=13]="Removed"})(n=o.PokerParent||(o.PokerParent={})),function(e){e[e.Desk=0]="Desk",e[e.Recycle=1]="Recycle",e[e.Draw=2]="Draw",e[e.Ready=3]="Ready",e[e.Removed=4]="Removed"}(i=o.ParentType||(o.ParentType={})),o.DeskParents=[n.Desk0,n.Desk1,n.Desk2,n.Desk3,n.Desk4,n.Desk5,n.Desk6],o.RecycleParents=[n.Recycle0,n.Recycle1,n.Recycle2,n.Recycle3];var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.PokerParentChangedSignal=a;var s=function(){function e(e,t){this.model=null,this.parent=null,this.oldParent=null,this.model=e,this.parent=t,this.oldParent=t}return Object.defineProperty(e.prototype,"Parent",{get:function(){return this.parent},set:function(e){this.parent!=e&&(this.oldParent=this.parent,this.parent=e,a.inst.dispatchTwo(this.model.ID,this.parent))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OldParent",{get:function(){return this.oldParent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentType",{get:function(){return o.DeskParents.indexOf(this.parent)>=0?i.Desk:o.RecycleParents.indexOf(this.Parent)>=0?i.Recycle:this.Parent==n.Draw?i.Draw:this.Parent==n.Ready?i.Ready:this.Parent==n.Removed?i.Removed:void 0},enumerable:!0,configurable:!0}),e.prototype.sync=function(){this.oldParent=this.parent},e}();o.PokerParentModel=s,cc._RF.pop()},{"../../../Utils/Signal":"Signal"}],PokerPosMediator:[function(e,t,o){"use strict";cc._RF.push(t,"6f77ai9CXtGKpf/YE0vWwvh","PokerPosMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Factory/GameFactory"),a=e("../../../Global/GameRule"),s=e("../../../Model/PlayModelProxy"),l=e("../../../Utils/Cocos"),c=e("../../../Utils/Random"),u=e("../../../Utils/Signal"),d=e("../../../View/BaseMediator"),p=e("../../Model/GamePlayModel"),h=e("../../Model/Poker/PokerParentModel"),f=e("../../Model/Poker/PokerPositionModel"),y=e("../../Model/Poker/PokerUtil"),g=e("../PokerRoot/Recycle"),m=e("./PokerFrontView"),P=e("./PokerRotationView"),S=cc._decorator,v=S.ccclass,_=(S.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal));o.ShakePokerSignal=_;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.FlyPokerSignal=C;var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(u.BaseSignal);o.PokerFlyDoneSignal=k;var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isShaking=!1,t}var o;return __extends(t,e),o=t,t.prototype.onRegister=function(){var e=this;P.PokerPosFlySignal.inst.addListener(function(){var t=cc.v2(e.node.x+c.Random.getRandom(0,500),e.node.y+c.Random.getRandom(300,500));e.isShaking=!1,e.View.onPositionChanged(t,c.Random.getRandom(.2,.4),function(){e.View.onPositionChanged(t.add(cc.v2(c.Random.getRandom(100,200),-2400)),c.Random.getRandom(.3,.7),function(){e.isShaking=!1,k.inst.dispatch(),r.gFactory.putObj("Poker",e.node)})},e.getComponent(P.default).randomFlyDelay)},this),f.PokerPositionChangedSignal.inst.addListenerFour(this.onPositionChanged,this),_.inst.addListenerOne(this.shake,this),n.GamePauseSignal.inst.addListener(function(){e.node.group="default"},this),n.GameOverSignal.inst.addListener(function(){e.node.group="default"},this)},t.prototype.onPositionChanged=function(e,t,n,r){var c=this;if(this.View.Model&&this.View.Model.ID==e){var u=i.GameStateController.inst.isReady?.1:.05,d=0,P=function(){c.isShaking=!1};if(!this.View.Model.isOnRecycle()||n!=f.MoveType.Drag||!s.PlayModelProxy.inst.isOnTutorial){switch(n){case f.MoveType.Drag:u=0;break;case f.MoveType.Normal:case f.MoveType.Return:this.View.Model.Parent.ParentType==h.ParentType.Recycle&&y.GetParentType(this.View.Model.Parent.OldParent)!=h.ParentType.Recycle&&(u=l.Distance(t,this.node.position)/a.Speed),this.View.Model.Parent.ParentType==h.ParentType.Ready&&y.GetParentType(this.View.Model.Parent.OldParent)==h.ParentType.Draw&&(u=.1,this.node.x+=60),P=function(){c.isShaking=!1,i.GameStateController.inst.isRoundStart(),c.View.Model.Parent.ParentType==h.ParentType.Recycle&&y.GetParentType(c.View.Model.Parent.OldParent)!=h.ParentType.Recycle&&g.PlayRecycleAnimationSignal.inst.dispatchTwo(c.View.Model.ID,c.View.Model.Point),c.node.zIndex=c.View.Model.Index,o.maxZIndex=Math.max(c.node.zIndex,o.maxZIndex),c.View.Model.Parent.ParentType==h.ParentType.Ready||c.View.Model.Parent.ParentType==h.ParentType.Recycle?m.CheckIsHideSignal.inst.dispatchOne(c.View.Model.ID):m.CheckIsHideSignal.inst.dispatchTwo(c.View.Model.ID,!0),c.View.Model&&c.View.Model.Parent.OldParent!=c.View.Model.Parent.Parent&&c.View.Model.Parent.sync()},this.View.Model&&(this.View.Model.Parent.ParentType==h.ParentType.Ready&&y.GetParentType(this.View.Model.Parent.OldParent)==h.ParentType.Ready&&f.MoveType.Normal==n||this.View.Model.Parent.ParentType==h.ParentType.Draw)&&(u=0,this.View.Model.Parent.ParentType==h.ParentType.Draw?d=.05:0!=r&&(u=r))}i.GameStateController.inst.isGameOver()?(u=l.Distance(t,this.node.position)/a.Speed,this.View.Model.Parent.ParentType==h.ParentType.Recycle&&(d=this.View.Model.AutoRecycleDelay/1e3),P=function(){c.isShaking=!1,c.node.zIndex=c.View.Model.Index,c.View.Model.Parent.ParentType==h.ParentType.Recycle&&y.GetParentType(c.View.Model.Parent.OldParent)!=h.ParentType.Recycle&&(g.PlayRecycleAnimationSignal.inst.dispatchTwo(c.View.Model.ID,c.View.Model.Point),0==s.PlayModelProxy.inst.Model.Logic.checkScoreSkip(c.View.Model.ID)&&(s.PlayModelProxy.inst.Combo++,s.PlayModelProxy.inst.addPlayerScore(a.GetPokerRecycleScore(c.View.Model.Point),p.ScoreType.Normal,1,c.node))),o.maxZIndex=Math.max(c.node.zIndex,o.maxZIndex),c.View.Model.Parent.ParentType==h.ParentType.Ready||c.View.Model.Parent.ParentType==h.ParentType.Recycle?m.CheckIsHideSignal.inst.dispatchOne(c.View.Model.ID):m.CheckIsHideSignal.inst.dispatchTwo(c.View.Model.ID,!0)}):this.View.Model.DrawToReadyDelay>0&&(d=this.View.Model.DrawToReadyDelay,this.View.Model.DrawToReadyDelay=0),d>0?setTimeout(function(){c.node.zIndex=(o.maxZIndex+1)%cc.macro.MAX_ZINDEX,n==f.MoveType.Normal&&(o.maxZIndex=c.node.zIndex)},1e3*d):(this.node.zIndex=(o.maxZIndex+1)%cc.macro.MAX_ZINDEX,n==f.MoveType.Normal&&(o.maxZIndex=this.node.zIndex)),this.isShaking=!0,0==u?(this.View.end(),this.node.setPosition(t),P()):this.View.onPositionChanged(t,u,P,d)}}},t.prototype.shake=function(e){var t=this;if(!(e.indexOf(this.View.Model.ID)<0||this.isShaking)){this.isShaking=!0;var o=this.View.TargetPos.clone(),n=o.add(cc.v2(-10,0)),i=o.add(cc.v2(10,0));this.View.onPositionChanged(n,.025,function(){t.View.onPositionChanged(i,0,function(){t.View.onPositionChanged(n,.05,function(){t.View.onPositionChanged(i,.05,function(){t.View.onPositionChanged(n,.05,function(){t.View.onPositionChanged(i,.05,function(){t.View.onPositionChanged(o,.025,function(){t.isShaking=!1},0)},0)},0)},0)},0)},0)},0)}},t.maxZIndex=0,t=o=__decorate([v],t)}(d.default);o.default=T,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Factory/GameFactory":"GameFactory","../../../Global/GameRule":"GameRule","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Cocos":"Cocos","../../../Utils/Random":"Random","../../../Utils/Signal":"Signal","../../../View/BaseMediator":"BaseMediator","../../Model/GamePlayModel":"GamePlayModel","../../Model/Poker/PokerParentModel":"PokerParentModel","../../Model/Poker/PokerPositionModel":"PokerPositionModel","../../Model/Poker/PokerUtil":"PokerUtil","../PokerRoot/Recycle":"Recycle","./PokerFrontView":"PokerFrontView","./PokerRotationView":"PokerRotationView"}],PokerPosView:[function(e,t,o){"use strict";cc._RF.push(t,"974b9fbCRpAgqbzv3WbbzdS","PokerPosView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/Transform/PositionView"),i=e("./PokerPosMediator"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(i.default)},t.prototype.reuse=function(e){this.model=e,this.node._onSetParent=this.onParentChanged.bind(this),this.node.x=0,this.node.y=0},t.prototype.unuse=function(){this.model=null,i.default.maxZIndex=0},t.prototype.onParentChanged=function(e){},t=__decorate([a],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../View/Transform/PositionView":"PositionView","./PokerPosMediator":"PokerPosMediator"}],PokerPositionModel:[function(e,t,o){"use strict";cc._RF.push(t,"11f7coKNpNHqrOS+8MBWnvV","PokerPositionModel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../../Utils/Signal"),r=e("./PokerParentModel");(function(e){e[e.Drag=0]="Drag",e[e.Normal=1]="Normal",e[e.Return=2]="Return"})(n=o.MoveType||(o.MoveType={}));var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PokerPositionChangedSignal=a;var s=function(){function e(e){this.model=null,this.position=cc.v2(0,0),this.movedDetal=cc.v2(0,0),this.rootOffset=cc.v2(0,0),this.model=e}return Object.defineProperty(e.prototype,"Position",{get:function(){return this.position.add(this.rootOffset)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MovingPosition",{get:function(){return this.Position.add(this.movedDetal)},enumerable:!0,configurable:!0}),e.prototype.updatePosition=function(e){switch(void 0===e&&(e=0),this.movedDetal=cc.v2(0,0),this.model.Parent.ParentType){case r.ParentType.Desk:this.updateDeskRootOffset(r.DeskParents.indexOf(this.model.Parent.Parent)),this.setPosition(0,0-this.model.Index*this.model.Offset-this.model.OffsetFront);break;case r.ParentType.Ready:this.updateReadyRootOffset(),this.setPosition(0+this.model.Offset,0,e);break;case r.ParentType.Draw:this.rootOffset=cc.v2(0,0),this.setPosition(0,0);break;case r.ParentType.Recycle:this.updateRecycleRootOffset(r.RecycleParents.indexOf(this.model.Parent.Parent)),this.setPosition(0,0)}},e.prototype.updateReadyRootOffset=function(){this.rootOffset=cc.v2(-310.36,0)},e.prototype.updateRecycleRootOffset=function(e){this.rootOffset=this.getRecycleRootPos(e)},e.prototype.updateDeskRootOffset=function(e){this.rootOffset=this.getDeskRootPos(e)},e.prototype.getDeskRootPos=function(e){var t=cc.v2(-907,-274);return cc.v2(t.add(cc.v2(151*e,0)))},e.prototype.getRecycleRootPos=function(e){var t=cc.v2(-911.565,0);return cc.v2(t.add(cc.v2((911.565-768.321)*e,0)))},e.prototype.setPosition=function(e,t,o){void 0===o&&(o=0),this.position=cc.v2(e,t),a.inst.dispatchFour(this.model.ID,this.Position,n.Normal,o)},e.prototype.onMoved=function(e){this.movedDetal.addSelf(e),a.inst.dispatchThree(this.model.ID,this.Position.add(this.movedDetal),n.Drag)},e.prototype.onMovedEnd=function(){0==this.movedDetal.x&&0==this.movedDetal.y||(this.movedDetal.x=0,this.movedDetal.y=0,a.inst.dispatchThree(this.model.ID,this.Position,n.Return))},e}();o.PokerPositionModel=s,cc._RF.pop()},{"../../../Utils/Signal":"Signal","./PokerParentModel":"PokerParentModel"}],PokerRotationView:[function(e,t,o){"use strict";cc._RF.push(t,"23239YHUmRFzZqXa73xQGrK","PokerRotationView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Manager/AudioManager"),i=e("../../../Utils/Random"),r=e("../../../Utils/Signal"),a=e("../../../View/Transform/RotationView"),s=e("./PokerPosMediator"),l=cc._decorator,c=l.ccclass,u=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.PokerPosFlySignal=u;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.randomFlyDelay=0,t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;s.FlyPokerSignal.inst.addListener(function(){e.randomFlyDelay=100*(13-e.model.Index)/1e3,e.randomFlyDelay=i.Random.getRandom(1,1.8)*e.randomFlyDelay,e.onRotationChanged(7200,3,function(){},e.randomFlyDelay),setTimeout(function(){n.PlayPokerFlySignal.inst.dispatch()},1e3*e.randomFlyDelay),u.inst.dispatch()},this)},t.prototype.reuse=function(e){this.model=e,this.node.rotation=0},t.prototype.unuse=function(){this.model=null,this.onRotationChanged(0,0,function(){})},t=__decorate([c],t)}(a.default);o.default=d,cc._RF.pop()},{"../../../Manager/AudioManager":"AudioManager","../../../Utils/Random":"Random","../../../Utils/Signal":"Signal","../../../View/Transform/RotationView":"RotationView","./PokerPosMediator":"PokerPosMediator"}],PokerScale:[function(e,t,o){"use strict";cc._RF.push(t,"f9a1f9YGitGj6N1bt080HSd","PokerScale"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/Transform/ScaleView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../View/Transform/ScaleView":"ScaleView"}],PokerSelectedView:[function(e,t,o){"use strict";cc._RF.push(t,"09ce2QFI4NC/7uS9K52XIXE","PokerSelectedView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/BaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Selected",{get:function(){return this.node.getChildByName("Selected")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onSelectedChanged=function(e,t){this.model&&this.model.ID==e&&(this.Selected.active=t)},t.prototype.reuse=function(e){this.model=e,this.Selected.active=!1},t.prototype.unuse=function(){this.model=null},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../View/BaseView":"BaseView"}],PokerSpriteView:[function(e,t,o){"use strict";cc._RF.push(t,"b7642s1IftLCqGFCzvxMiml","PokerSpriteView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Front",{get:function(){return this.node.getChildByName("Front").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){this.model=e,this.Front.spriteFrame=n.ResourceController.inst.getPokerSprite(this.model.Point,this.model.Type)},t.prototype.unuse=function(){this.model=null},t=__decorate([r],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController"}],PokerStateMediator:[function(e,t,o){"use strict";cc._RF.push(t,"8524epau0dPDpTNBwQhRDkf","PokerStateMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/BaseMediator"),i=e("../../Model/Poker/PokerStateModel"),r=e("../../Model/Poker/PokerParentModel"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){i.PokerStateChangedSignal.inst.addListenerTwo(this.onPokerStateChanged,this)},t.prototype.onPokerStateChanged=function(e,t){this.View.Model&&this.View.Model.ID==e&&(t==i.PokerState.Back?this.View.Model.Parent.ParentType==r.ParentType.Draw?this.View.turnBack(0,function(){},0):this.View.turnBack(.1,function(){},0):this.View.turnFront(.1,function(){},0))},t=__decorate([s],t)}(n.default));o.default=l,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Model/Poker/PokerParentModel":"PokerParentModel","../../Model/Poker/PokerStateModel":"PokerStateModel"}],PokerStateModel:[function(e,t,o){"use strict";cc._RF.push(t,"70fbcCEGNZK3p4xVsaK5V+6","PokerStateModel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../../Utils/Signal");(function(e){e[e.Front=0]="Front",e[e.Back=1]="Back"})(n=o.PokerState||(o.PokerState={}));var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PokerStateChangedSignal=r;var a=function(){function e(e,t){this.model=null,this.state=null,this.model=e,this.state=t}return Object.defineProperty(e.prototype,"State",{get:function(){return this.state},set:function(e){e!=this.state&&(this.state=e,r.inst.dispatchTwo(this.model.ID,this.State))},enumerable:!0,configurable:!0}),e.prototype.isFront=function(){return this.State==n.Front},e.prototype.turnBack=function(){this.State=n.Back},e.prototype.turnFront=function(){this.State=n.Front},e}();o.PokerStateModel=a,cc._RF.pop()},{"../../../Utils/Signal":"Signal"}],PokerStateView:[function(e,t,o){"use strict";cc._RF.push(t,"5e994cIevtJtoXn/+INxa7D","PokerStateView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./PokerStateMediator"),i=e("../../../View/BaseView"),r=e("./PokerScale"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Front",{get:function(){return this.node.getChildByName("Front").getComponent(r.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Back",{get:function(){return this.node.getChildByName("Back").getComponent(r.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(n.default)},t.prototype.start=function(){},t.prototype.reuse=function(e){this.model=e},t.prototype.unuse=function(){this.model=null,this.Back.end(),this.Front.end(),this.Front.onScaleChanged(cc.v2(0,1),0,function(){}),this.Back.onScaleChanged(cc.v2(1,1),0,function(){})},t.prototype.turnFront=function(e,t,o){var n=this;void 0===e&&(e=.2),void 0===t&&(t=function(){}),void 0===o&&(o=0),this.Back.end(),this.Front.end(),this.Back.onScaleChanged(cc.v2(0,1),e,function(){n.Front.onScaleChanged(cc.v2(1,1),e,t,o)},o)},t.prototype.turnBack=function(e,t,o){var n=this;void 0===e&&(e=.2),void 0===t&&(t=function(){}),void 0===o&&(o=0),this.Back.end(),this.Front.end(),this.Front.onScaleChanged(cc.v2(0,1),e,function(){n.Back.onScaleChanged(cc.v2(1,1),e,t,o)},o)},t.prototype.update=function(e){},t=__decorate([s],t)}(i.default));o.default=l,cc._RF.pop()},{"../../../View/BaseView":"BaseView","./PokerScale":"PokerScale","./PokerStateMediator":"PokerStateMediator"}],PokerToucherMediator:[function(e,t,o){"use strict";cc._RF.push(t,"a33a8c3/vJEo5ohy8XJrV3D","PokerToucherMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../../../View/SingleTouchMediator"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.DrawCardSignal=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.CheckAutoRecycleSignal=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this)},t=__decorate([a],t)}(i.default);o.default=c,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../../../View/SingleTouchMediator":"SingleTouchMediator"}],PokerToucher:[function(e,t,o){"use strict";cc._RF.push(t,"15b48h9uKtN2pgwh78d9nyb","PokerToucher"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Manager/AudioManager"),a=e("../../../Model/PlayModelProxy"),s=e("../../../View/BaseView"),l=e("../../Model/Poker/PokerParentModel"),c=e("../Poker/PokerPosMediator"),u=e("./PokerToucherMediator"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasMoved=!1,t.movedDetal=cc.v2(0,0),t.model=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.GamePauseSignal.inst.addListener(function(){e.isMoved()&&a.PlayModelProxy.inst.onCancel(e.Model.ID)},this),n.GameOverSignal.inst.addListener(function(){e.isMoved()&&a.PlayModelProxy.inst.onCancel(e.Model.ID)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){e.onTouchEnd(t),e.OnClick()},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){this.model=e},t.prototype.unuse=function(){this.model=null},t.prototype.onTouchCancel=function(e){this.onTouchEnd(e),e.stopPropagation()},t.prototype.onTouchMove=function(e){0!=i.GameStateController.inst.isRoundStart()&&(this.hasMoved=!1,this.movedDetal.addSelf(e.getDelta()),this.hasMoved=!0,0!=this.isMoved()&&(a.PlayModelProxy.inst.onMoved(this.Model.ID,e.getDelta()),e.stopPropagation()))},t.prototype.onTouchStart=function(e){e.stopPropagation(),this.model&&this.model.Parent.Parent!=l.PokerParent.Draw&&r.PlayPokerPlaceSignal.inst.dispatch()},t.prototype.onTouchEnd=function(e){this.hasMoved&&a.PlayModelProxy.inst.onMovedEnd(this.Model.ID),e.stopPropagation()},t.prototype.OnClick=function(){0!=i.GameStateController.inst.isRoundStart()&&(this.Model.isOnDraw()?u.DrawCardSignal.inst.dispatch():0==this.Model.isOnRecycle()?0==this.isMoved()&&this.Model.State.isFront()&&u.CheckAutoRecycleSignal.inst.dispatchOne(this.Model):this.Model.State.isFront()&&0==this.isMoved()&&c.ShakePokerSignal.inst.dispatchOne([this.Model.ID]),this.movedDetal.x=0,this.movedDetal.y=0,this.hasMoved=!1)},t.prototype.isMoved=function(){return this.movedDetal.mag()>=20},t=__decorate([p],t)}(s.default));o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Manager/AudioManager":"AudioManager","../../../Model/PlayModelProxy":"PlayModelProxy","../../../View/BaseView":"BaseView","../../Model/Poker/PokerParentModel":"PokerParentModel","../Poker/PokerPosMediator":"PokerPosMediator","./PokerToucherMediator":"PokerToucherMediator"}],PokerUtil:[function(e,t,o){"use strict";cc._RF.push(t,"43c72rbqgVAoqlh7nf6t0Rz","PokerUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./PokerModel"),r=e("./PokerParentModel");o.PokerSize=cc.size(156,212),o.GuidePokers=["diamond_,1","spade_,1","heart_,1","club_,1","spade_,2","heart_,2","club_,2","club_,5","spade_,3","heart_,3","club_,3","diamond_,3","spade_,4","heart_,13","club_,4","diamond_,4","spade_,5","heart_,5","diamond_,2","spade_,6","club_,6","heart_,6","diamond_,5","diamond_,6","heart_,7","spade_,7","club_,8","diamond_,7","spade_,8","heart_,8","club_,7","diamond_,8","spade_,9","heart_,9","club_,9","diamond_,9","spade_,10","heart_,10","club_,10","diamond_,10","spade_,11","heart_,11","club_,11","diamond_,11","spade_,12","heart_,12","club_,12","diamond_,12","spade_,13","heart_,4","club_,13","diamond_,13"],o.Pokers=["spade_,1","heart_,1","club_,1","diamond_,1","spade_,2","heart_,2","club_,2","diamond_,2","spade_,3","heart_,3","club_,3","diamond_,3","spade_,4","heart_,4","club_,4","diamond_,4","spade_,5","heart_,5","club_,5","diamond_,5","spade_,6","heart_,6","club_,6","diamond_,6","spade_,7","heart_,7","club_,7","diamond_,7","spade_,8","heart_,8","club_,8","diamond_,8","spade_,9","heart_,9","club_,9","diamond_,9","spade_,10","heart_,10","club_,10","diamond_,10","spade_,11","heart_,11","club_,11","diamond_,11","spade_,12","heart_,12","club_,12","diamond_,12","spade_,13","heart_,13","club_,13","diamond_,13"],o.GetPokerString=function(e,t){var o="",n=t.toString();switch(e){case i.PokerType.Club:o="club_,";break;case i.PokerType.Diamond:o="diamond_,";break;case i.PokerType.Heart:o="heart_,";break;case i.PokerType.Spade:o="spade_,"}return o+n},function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(n=o.PokerColor||(o.PokerColor={}));var a=[0,7,13,18,22,25,27],s=[49,46,43,40,37,34,31,28];function l(e){var t=e.split(",")[0];return"spade_"==t||"club_"==t?n.Black:n.Red}function c(e,t,o,n){return 1==e||1==t||e-t==1&&o!=n}o.GetParentType=function(e){return r.DeskParents.indexOf(e)>=0?r.ParentType.Desk:r.RecycleParents.indexOf(e)>=0?r.ParentType.Recycle:e==r.PokerParent.Draw?r.ParentType.Draw:e==r.PokerParent.Ready?r.ParentType.Ready:e==r.PokerParent.Removed?r.ParentType.Removed:void 0},o.getType=function(e){switch(e.split(",")[0]){case"spade_":return i.PokerType.Spade;case"club_":return i.PokerType.Club;case"heart_":return i.PokerType.Heart;case"diamond_":return i.PokerType.Diamond}},o.getColor=l,o.getColorByType=function(e){return e==i.PokerType.Club||e==i.PokerType.Spade?n.Black:n.Red},o.checkCanMove=c,o.checkIsNotZeroScore=function(e){for(var t=!1,o=!1,n=0;n<a.length;++n)for(var i=e[a[n]],r=parseInt(i.split(",")[1]),u=l(i.split(",")[0]),d=n+1;d<a.length;++d){var p=e[a[d]];if(c(r,h=parseInt(p.split(",")[1]),u,f=l(p.split(",")[0]))||c(h,r,u,f)){t=!0;break}}for(n=0;n<a.length;++n)for(i=e[a[n]],r=parseInt(i.split(",")[1]),u=l(i.split(",")[0]),d=0;d<s.length;++d){var h,f;if(p=e[s[d]],c(r,h=parseInt(p.split(",")[1]),u,f=l(p.split(",")[0]))){o=!0;break}}return t||o},cc._RF.pop()},{"./PokerModel":"PokerModel","./PokerParentModel":"PokerParentModel"}],PositionView:[function(e,t,o){"use strict";cc._RF.push(t,"416f296ZMZPEaWAE2E6IRlj","PositionView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startPos=cc.Vec2.ZERO,t}return __extends(t,e),Object.defineProperty(t.prototype,"TargetPos",{get:function(){return cc.v2(this.Target.x,this.Target.y)},enumerable:!0,configurable:!0}),t.prototype.canUpdate=function(){return!0},t.prototype.onLoad=function(){0},t.prototype.start=function(){},t.prototype.onPositionChanged=function(e,t,o,n){void 0===n&&(n=0),this.startPos=this.node.position.clone(),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.x=this.ease(this.startPos.x,this.Target.x),this.node.y=this.ease(this.startPos.y,this.Target.y)},t.prototype.onComplete=function(){this.node.setPosition(cc.v2(this.Target.x,this.Target.y))},t.prototype.ease=function(e,t){if(this.LastTime<=0)return t;var o=Date.now()-this.StartTime;return(t-e)/this.LastTime*o+e},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],PrefabBaseView:[function(e,t,o){"use strict";cc._RF.push(t,"f24ed/ng45Kt5VKvqibEbvg","PrefabBaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.reuse=function(e){this.model=e,this.onReuse()},t.prototype.unuse=function(){this.node.group="default",this.model,this.model=null,this.onUnuse()},t.prototype.onReuse=function(){console.warn(" should override onReuse.")},t.prototype.onUnuse=function(){console.warn(" should override onUnuse.")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],Random:[function(e,t,o){"use strict";cc._RF.push(t,"114f9Vox8JGQbohBr4HFlkf","Random"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e("./Signal").BaseSignal);o.RandomSeedInitSignal=n;var i=function(){function e(){}return e.seededRandom=function(e,t,o){return t+1e6*((1711*e+88888)%302654/302654+(1722*e+55555)%302665/302665+(1755*e+23333)%302766/302766)%1e6/1e6*(o-t)},e.getRandom=function(e,t){void 0===e&&(e=0),void 0===t&&(t=1);var o=this.randomSeed,n=this.seededRandom(o,e,t),i=Math.floor(this.seededRandom(o,1,302766));return this.randomSeed+=i,n},e.setRandomSeed=function(e){console.log(" set random seed:",e),this.randomSeed=e,this.sharedSeed=e,n.inst.dispatchOne(e)},e.randomRoundToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.round(this.getRandom(e,t))},e.randomFloorToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.floor(this.getRandom(e,t))},e.randomCeilToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.ceil(this.getRandom(e,t))},e.clamp=function(e,t,o){return Math.max(t,Math.min(e,o))},e.randomSeed=Math.random(),e.sharedSeed=Math.random(),e}();o.Random=i,cc._RF.pop()},{"./Signal":"Signal"}],Ready:[function(e,t,o){"use strict";cc._RF.push(t,"99b7eEnNYRPzIbIcYpR3b71","Ready"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onPokerParentChanged=function(e,t){},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],RecycleAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"aff19hIEIJELplp7z83oY0d","RecycleAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],Recycle:[function(e,t,o){"use strict";cc._RF.push(t,"22098dc3bhIybrKLXJ5ybx8","Recycle"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../Animation/RecycleAnimation"),r=e("../new/ToturialLayer"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.PlayRecycleAnimationSignal=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Animation",{get:function(){return this.node.getChildByName("Animation").getComponent(i.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;setTimeout(function(){e.Animation.node.active=!1},0),r.TutorialPrepareDoneSignal.inst.addListener(function(){"0"==e.node.name&&r.default.AddToturialStep(1,e.node,null,!1,function(){},function(){},function(){},!0)},this)},t.prototype.start=function(){},t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../Animation/RecycleAnimation":"RecycleAnimation","../new/ToturialLayer":"ToturialLayer"}],RedrawAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"4bcefuOTqlOArX6qzJ/Mx/i","RedrawAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Manager/AudioManager"),i=e("../../../Utils/FrameAniBase"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.opacity=0,n.PlayRecycleDrawSignal.inst.addListener(function(){t.node.active=!0,t.node.opacity=255,t.play(),t.onComplete=function(){t.node.active=!1}},this),setTimeout(function(){t.node.active=!1},0)},t=__decorate([a],t)}(i.default));o.default=s,cc._RF.pop()},{"../../../Manager/AudioManager":"AudioManager","../../../Utils/FrameAniBase":"FrameAniBase"}],Removed:[function(e,t,o){"use strict";cc._RF.push(t,"4569evzq/VH34knzDpwajph","Removed"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onPokerParentChanged=function(e,t){},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],ResourceController:[function(e,t,o){"use strict";var n,i;cc._RF.push(t,"d264b/eizRMLqzXH1k4Oll+","ResourceController"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Utils/ToSingleton"),a=e("../Utils/HashMap"),s=e("../GamePlay/Model/Poker/PokerModel");o.Title={Complete:"bg_font05",TimeUp:"bg_font03",Over:"bg_font02"},o.PauseFont={HasFree:"bg_pause_font1",NoneFree:"bg_pause_font2"},o.Font={TotalScore:"totalScore",ResultScore:"resultScore",TimeWhite:"TimeWhite",TimeRed:"TimeRed",AddScore:"addScore",SubScore:"subScore",ShowScore:"showScore"},o.PokerSprite=((n={})[s.Poker.$_A]="bg_solitarie_[color]A",n[s.Poker.$_2]="bg_solitarie_[color]2",n[s.Poker.$_3]="bg_solitarie_[color]3",n[s.Poker.$_4]="bg_solitarie_[color]4",n[s.Poker.$_5]="bg_solitarie_[color]5",n[s.Poker.$_6]="bg_solitarie_[color]6",n[s.Poker.$_7]="bg_solitarie_[color]7",n[s.Poker.$_8]="bg_solitarie_[color]8",n[s.Poker.$_9]="bg_solitarie_[color]9",n[s.Poker.$_10]="bg_solitarie_[color]10",n[s.Poker.$_J]="bg_solitarie_[color]J",n[s.Poker.$_Q]="bg_solitarie_[color]Q",n[s.Poker.$_K]="bg_solitarie_[color]K",n),o.PokerColorType=((i={})[s.PokerType.Club]="03",i[s.PokerType.Diamond]="04",i[s.PokerType.Heart]="02",i[s.PokerType.Spade]="01",i);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontMap=new a.HashMap,t.UIAtlas=null,t.Animation=null,t}return __extends(t,e),t.prototype.setFont=function(e,t){this.fontMap.add(e,t)},t.prototype.setAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.UIAtlas=e},t.prototype.getTitleSprite=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.getAltas=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.setAnimationAtlas=function(e){console.assert(null!=e,"animation atlas is null!"),this.Animation=e},t.prototype.getAnimationAtlas=function(e){return this.Animation.getSpriteFrame(e)},t.prototype.getAddScoreFont=function(){return this.fontMap.get(o.Font.AddScore)},t.prototype.getSubScoreFont=function(){return this.fontMap.get(o.Font.SubScore)},t.prototype.getSoundDisabled=function(){return this.UIAtlas.getSpriteFrame("btn_nosound")},t.prototype.getSoundEnable=function(){return this.UIAtlas.getSpriteFrame("btn_sound")},t.prototype.getPauseFont=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.getTimeRedFont=function(){return this.fontMap.get(o.Font.TimeRed)},t.prototype.getTimeWhiteFont=function(){return this.fontMap.get(o.Font.TimeWhite)},t.prototype.getPokerSprite=function(e,t){var n=o.PokerSprite[e].replace("[color]",o.PokerColorType[t]);return this.UIAtlas.getSpriteFrame(n)},t}(r.SingleTon());o.ResourceController=l,cc._RF.pop()},{"../GamePlay/Model/Poker/PokerModel":"PokerModel","../Utils/HashMap":"HashMap","../Utils/ToSingleton":"ToSingleton"}],ResultLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"ba2b7WYGTNEqazUlmB5rAul","ResultLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/BaseView"),i=e("../../../View/NumberChangedView"),r=e("../../../Command/CommonSignal"),a=e("../../../Controller/GameStateController"),s=e("../../../Controller/ResourceController"),l=e("../../../Model/PlayModelProxy"),c=e("../../../Utils/Celer/CelerSDK"),u=e("../../Model/GamePlayModel"),d=e("../../../Utils/Random"),p=e("../../../Manager/AudioManager"),h=cc._decorator,f=h.ccclass,y=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Light=null,t.Stars=null,t.CountTotal=3,t.count=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Root",{get:function(){return this.node.getChildByName("Root")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.Root.getChildByName("Title").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalScore",{get:function(){return this.Root.getChildByName("TotalScore").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Root.getChildByName("TimeBonus").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Score",{get:function(){return this.Root.getChildByName("ScoreLabel").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Submit",{get:function(){return this.Root.getChildByName("Submit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Spine",{get:function(){return this.Root.getChildByName("Spine").getComponent(sp.Skeleton)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.active=!1,this.node.scale=1,r.OpenResultLayerSignal.inst.addListenerOne(this.onGameOver,this),this.Spine.setEventListener(this.eventListener.bind(this));for(var e=0,t=this.Stars.children;e<t.length;e++){t[e].opacity=0}},t.prototype.eventListener=function(e,t){switch(t.stringValue){case"light":this.Light.active=!0,this.Light.runAction(cc.repeatForever(cc.rotateBy(5,360)));break;case"music1":break;case"music2":cc.audioEngine.setEffectsVolume(2),p.gAudio.playEffect("result_dev")}},t.prototype.onGameOver=function(e){console.log("Open result:",a.RoundEndType[e],Date.now()),p.PlayResultShow.inst.dispatch(),cc.audioEngine.setMusicVolume(.5),this.Submit.scale=1,e==a.RoundEndType.TimeUp?this.Title.spriteFrame=s.ResourceController.inst.getTitleSprite(s.Title.TimeUp):e==a.RoundEndType.Complete?this.Title.spriteFrame=s.ResourceController.inst.getTitleSprite(s.Title.Complete):this.Title.spriteFrame=s.ResourceController.inst.getTitleSprite(s.Title.Over),this.Root.scale=0,this.node.active=!0,this.Root.runAction(cc.sequence(cc.scaleTo(0,1),cc.callFunc(this.showInfo.bind(this))))},Object.defineProperty(t.prototype,"Count",{get:function(){return this.count},set:function(e){var t=this;this.count!=e&&(this.count=e,console.log("count:",this.Count),this.Count>=this.CountTotal&&(r.ShowSubmitSignal.inst.dispatch(),this.Submit.runAction(cc.sequence(cc.delayTime(0),cc.callFunc(function(){t.Submit.once(cc.Node.EventType.TOUCH_END,function(){c.CelerSDK.inst.submitScore(l.PlayModelProxy.inst.getTotalScore())},t),CELER_X&&setTimeout(function(){c.CelerSDK.inst.submitScore(l.PlayModelProxy.inst.getTotalScore())},5e3)})))))},enumerable:!0,configurable:!0}),t.prototype.showInfo=function(){for(var e=this,t=function(e){var t=cc.repeatForever(cc.sequence(cc.fadeIn(d.Random.getRandom(.5,1.5)).easing(cc.easeQuadraticActionInOut()),cc.fadeOut(d.Random.getRandom(.4,.8)).easing(cc.easeQuadraticActionInOut())));e.opacity=0,setTimeout(function(){e.runAction(t)},1e3*d.Random.getRandom(0,.5))},o=0,n=this.Stars.children;o<n.length;o++){t(n[o])}this.Light.active=!1,this.Count=0,this.Spine.animation="animation",this.TotalScore.STEP=150,this.TimeBonus.STEP=150,this.Score.STEP=150;var i=function(){r.ScoreCountingSignal.inst.dispatch()};this.TimeBonus.onStep=i,this.TotalScore.onStep=i,this.Score.onStep=i,this.TimeBonus.onNumberChanged(l.PlayModelProxy.inst.TimeBonus,function(){e.Count++,console.log("TimeBonus Done")}),this.TotalScore.onNumberChanged(l.PlayModelProxy.inst.getTotalScore(),function(){e.Count++,console.log("TotalScore Done")}),this.Score.onNumberChanged(l.PlayModelProxy.inst.getScoreByType(u.ScoreType.Normal),function(){e.Count++,console.log("Score Done")})},__decorate([y(cc.Node)],t.prototype,"Light",void 0),__decorate([y(cc.Node)],t.prototype,"Stars",void 0),t=__decorate([f],t)}(n.default);o.default=g,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Manager/AudioManager":"AudioManager","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Celer/CelerSDK":"CelerSDK","../../../Utils/Random":"Random","../../../View/BaseView":"BaseView","../../../View/NumberChangedView":"NumberChangedView","../../Model/GamePlayModel":"GamePlayModel"}],RevertButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"3e84eq+F3NMM5PkgzsJHXMl","RevertButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Controller/ResourceController"),a=e("../../../Utils/Signal"),s=e("../../../View/SingleTouchView"),l=e("../../Model/GamePlayModel"),c=cc._decorator,u=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.RevertSignal=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Button",{get:function(){return this.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.Button.spriteFrame=r.ResourceController.inst.getAltas("btn_backgray"),this.getComponent(cc.Button).transition=cc.Button.Transition.NONE,l.RevertButtonStateChangedSignal.inst.addListenerOne(this.onButtonStateChanged,this),n.GameOverSignal.inst.addListener(function(){t.Button.spriteFrame=r.ResourceController.inst.getAltas("btn_backgray"),t.getComponent(cc.Button).transition=cc.Button.Transition.NONE},this)},t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||0==i.GameStateController.inst.isRoundStart()||this.getComponent(cc.Button).transition==cc.Button.Transition.NONE||d.inst.dispatch()},t.prototype.onButtonStateChanged=function(e){e?(this.getComponent(cc.Button).transition=cc.Button.Transition.SCALE,this.Button.spriteFrame=r.ResourceController.inst.getAltas("btn_back")):(this.getComponent(cc.Button).transition=cc.Button.Transition.NONE,this.node.scale=1,this.Button.spriteFrame=r.ResourceController.inst.getAltas("btn_backgray"))},t=__decorate([u],t)}(s.default);o.default=p,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../../Model/GamePlayModel":"GamePlayModel"}],RotationView:[function(e,t,o){"use strict";cc._RF.push(t,"f3329CeqRdN6ZoUyx7znT4N","RotationView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startRotation=0,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.canUpdate=function(){return!0},t.prototype.start=function(){},t.prototype.onRotationChanged=function(e,t,o,n){void 0===n&&(n=0),this.startRotation=this.node.rotation,this.startUpdate(new cc.Vec3(e,e,e),t,o,n)},t.prototype.onStep=function(){this.node.rotation=this.ease(this.startRotation,this.Target.x)},t.prototype.onComplete=function(){this.node.setRotation(this.Target.x)},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],ScaleView:[function(e,t,o){"use strict";cc._RF.push(t,"b6981r0u55OyqSF4preRXtY","ScaleView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startScale=cc.Vec2.ZERO,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.canUpdate=function(){return!0},t.prototype.start=function(){},t.prototype.onScaleChanged=function(e,t,o,n){void 0===n&&(n=0),this.startScale=cc.v2(this.node.scaleX,this.node.scaleY),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.scaleX=this.ease(this.startScale.x,this.Target.x),this.node.scaleY=this.ease(this.startScale.y,this.Target.y)},t.prototype.onComplete=function(){this.node.scaleX=this.Target.x,this.node.scaleY=this.Target.y},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],ScoreLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"5857dLL+ulDqKijkly4V/xN","ScoreLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),r=e("../../../Factory/GameFactory"),a=e("../../../Model/PlayModelProxy"),s=e("../../../Utils/Cocos"),l=e("../../../View/NumberChangedView"),c=e("../../Model/GamePlayModel"),u=cc._decorator,d=u.ccclass,p=u.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScoreFloatRoot=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.PlayerScoreChanged.inst.addListenerFour(this.onScoreChanged,this),c.PLayerScoreInitSignal.inst.addListenerOne(function(t){e.setNumber(t)},this)},t.prototype.onScoreChanged=function(e,t,o,n){var l=this;if(null!=this.ScoreFloatRoot){var c=r.gFactory.getObj("AddScore"),u=c.getComponent(cc.Label);u.font=t>=0?i.ResourceController.inst.getAddScoreFont():i.ResourceController.inst.getSubScoreFont(),u.string="/"+Math.abs(t),this.ScoreFloatRoot.addChild(c);var d=cc.v2(0,0);n&&(d=s.ConvertToNodeSpaceAR(n,this.ScoreFloatRoot));var p=s.ConvertToNodeSpaceAR(this.node,this.ScoreFloatRoot);c.setPosition(d);var h=s.Distance(d,p)/2500;c.runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.1,1.2),cc.scaleTo(.1,1),cc.moveTo(h,p),cc.callFunc(function(){r.gFactory.putObj("AddScore",c)}))),setTimeout(function(){l.onNumberChanged(a.PlayModelProxy.inst.PlayerScore)},200+1e3*h)}else this.onNumberChanged(a.PlayModelProxy.inst.PlayerScore)},__decorate([p(cc.Node)],t.prototype,"ScoreFloatRoot",void 0),t=__decorate([d],t)}(l.default);o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController","../../../Factory/GameFactory":"GameFactory","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Cocos":"Cocos","../../../View/NumberChangedView":"NumberChangedView","../../Model/GamePlayModel":"GamePlayModel"}],Signal:[function(e,t,o){"use strict";cc._RF.push(t,"5e03fyVNOZPs7lLvT6ttunM","Signal"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listenerMap=[],t.onceListenerMap=[],t}return __extends(t,e),t.prototype.doDispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.excuteListener.apply(this,e),this.excuteOnce.apply(this,e)},t.prototype.excuteListener=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.listenerMap&&this.listenerMap.length>0)for(var o=0,n=this.listenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}},t.prototype.excuteOnce=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var o=0,n=this.onceListenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}this.onceListenerMap.length=0}},t.prototype.listen=function(e,t){this.listenerMap.push({callback:e,target:t})},t.prototype.listenOnce=function(e,t){this.onceListenerMap.push({callback:e,target:t})},t.prototype.removeListener=function(e,t){if(this.listenerMap&&this.listenerMap.length>0)for(var o=0;o<this.listenerMap.length;++o){var n=this.listenerMap[o];n.callback==e&&n.target==t&&(this.listenerMap.splice(o,1),--o)}},t.prototype.removeTarget=function(e){if(this.listenerMap&&this.listenerMap.length>0)for(var t=0;t<this.listenerMap.length;++t){this.listenerMap[t].target==e&&(this.listenerMap.splice(t,1),--t)}},t.prototype.dispatch=function(){this.doDispatch(null)},t.prototype.dispatchOne=function(e){this.doDispatch(e)},t.prototype.dispatchTwo=function(e,t){this.doDispatch(e,t)},t.prototype.dispatchThree=function(e,t,o){this.doDispatch(e,t,o)},t.prototype.dispatchFour=function(e,t,o,n){this.doDispatch(e,t,o,n)},t.prototype.dispatchFive=function(e,t,o,n,i){this.doDispatch(e,t,o,n,i)},t.prototype.addListener=function(e,t){this.listen(e,t)},t.prototype.addOnce=function(e,t){this.listenOnce(e,t)},t.prototype.addListenerOne=function(e,t){this.listen(e,t)},t.prototype.addListenerTwo=function(e,t){this.listen(e,t)},t.prototype.addListenerThree=function(e,t){this.listen(e,t)},t.prototype.addListenerFour=function(e,t){this.listen(e,t)},t.prototype.addListenerFive=function(e,t){this.listen(e,t)},t.prototype.addOnceOne=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceTwo=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceThree=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFour=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFive=function(e,t){this.listenOnce(e,t)},t}(e("./ToSingleton").SingleTon());o.BaseSignal=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],SingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"e1695pPIshGg5cBwRP4Oun7","SingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){this.node.targetOff(this),this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.onUnregister=function(){this.node.targetOff(this)},t.prototype.touchStart=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch start  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();this.touchid=e.getID(),this.onTouchStart(e)},t.prototype.touchMove=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchMove(e)):e.stopPropagation()},t.prototype.touchEnd=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch end  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchEnd(e),this.OnClick()):e.stopPropagation()},t.prototype.touchCancel=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch cancel  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchCancel(e)):e.stopPropagation()},t.prototype.OnClick=function(){},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],SingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"85688DQVyhPRqaAh/y2/Qug","SingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.start=function(){},t.prototype.touchStart=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchStart(e)):console.log(this.node.name," touch start  touchid is different! ")},t.prototype.touchMove=function(e){null!==this.touchid&&this.touchid!==e.getID()||(this.touchid=e.getID(),this.onTouchMove(e))},t.prototype.touchEnd=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchEnd(e)):console.log(this.node.name," touch end  touchid is different! ")},t.prototype.touchCancel=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchCancel(e)):console.log(this.node.name," touch cancel  touchid is different! ")},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"./BaseView":"BaseView"}],SkewView:[function(e,t,o){"use strict";cc._RF.push(t,"dec79oJ2D1Ju7yCFAAR3rSI","SkewView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startSkew=cc.Vec2.ZERO,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.start=function(){},t.prototype.canUpdate=function(){return!0},t.prototype.onSkewChanged=function(e,t,o,n){void 0===n&&(n=0),this.startSkew=cc.v2(this.node.skewX,this.node.skewY),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.skewX=this.ease(this.startSkew.x,this.Target.x),this.node.skewY=this.ease(this.startSkew.y,this.Target.y)},t.prototype.onComplete=function(){this.node.skewX=this.Target.x,this.node.skewY=this.Target.y},t=__decorate([r],t)}(n.default));o.default=a,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],SliderView:[function(e,t,o){"use strict";cc._RF.push(t,"2c746YFJCxKFJ34ypIaA1v3","SliderView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Random"),i=cc._decorator,r=i.ccclass,a=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Progress=null,t.Slider=null,t.totalLength=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Percent",{get:function(){return this.Slider.progress},set:function(e){this.Slider.progress=n.Random.clamp(e,0,1),this.Progress.width=this.Slider.node.width*this.Slider.progress},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.Slider.node.on("slide",this.onSlided,this),this.totalLength=this.Progress.width,this.Slider.node.width=this.totalLength},t.prototype.onSlided=function(){this.Progress.width=this.totalLength*this.Slider.progress,this.onProgress&&this.onProgress(this.Slider.progress)},t.prototype.start=function(){},t.prototype.onProgress=function(e){},__decorate([a(cc.Node)],t.prototype,"Progress",void 0),__decorate([a(cc.Slider)],t.prototype,"Slider",void 0),t=__decorate([r],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../Utils/Random":"Random"}],SolutionChecker:[function(e,t,o){"use strict";cc._RF.push(t,"23c1duYxE5D/Yp7WpEGxZrU","SolutionChecker"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Utils/Celer/CelerSDK"),i=e("../../Utils/Cocos"),r=e("../../Utils/HashMap"),a=e("../../Utils/Random"),s=e("../../Utils/ToSingleton"),l=e("../Test/TestView"),c=e("./Poker/PokerModel"),u=e("./Poker/PokerParentModel"),d=e("./Poker/PokerStateModel"),p=e("./Poker/PokerUtil"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.recycle=new r.HashMap,t.draw=[],t.ready=[],t.desk=new r.HashMap,t.totalStepCount=0,t._currentStep=0,t.solutionPokers=[],t.selectedDeskIndex=[],t.stepCache=new r.HashMap,t.returnLoopCount=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"SolutionPokers",{get:function(){return this.solutionPokers.concat([])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentStep",{get:function(){return this._currentStep},set:function(e){this._currentStep=e,l.StepUpdateSignal.inst.dispatchOne(this._currentStep)},enumerable:!0,configurable:!0}),t.prototype.checkCanBeNext=function(e,t){return null==e?t.point==c.Poker.$_K:p.getColorByType(e.type)!=p.getColorByType(t.type)&&e.point-t.point==1},t.prototype.checkCanBeRecycle=function(e,t){return null==e?t.point==c.Poker.$_A:e.type==t.type&&e.point-t.point==-1},t.prototype.bindPokerID=function(e){this.stepCache.forEach(function(t,o){o.desk.forEach(function(t,o){for(var n=0,i=o;n<i.length;n++){var r=i[n];r.type==e.Type&&r.point==e.Point&&(r.ID=e.ID)}}),o.recycle.forEach(function(t,o){for(var n=0,i=o;n<i.length;n++){var r=i[n];r.type==e.Type&&r.point==e.Point&&(r.ID=e.ID)}});for(var n=0,i=o.ready;n<i.length;n++){(s=i[n]).type==e.Type&&s.point==e.Point&&(s.ID=e.ID)}for(var r=0,a=o.draw;r<a.length;r++){var s;(s=a[r]).type==e.Type&&s.point==e.Point&&(s.ID=e.ID)}})},t.prototype.clear=function(){this.recycle.clear(),this.draw.length=0,this.ready.length=0,this.desk.clear(),this.totalStepCount=0,this.currentStep=0,this.stepCache.clear()},t.prototype.initialRecycle=function(){for(var e=[];e.length<100;)e.push(c.PokerType.Club),e.push(c.PokerType.Diamond),e.push(c.PokerType.Heart),e.push(c.PokerType.Spade);i.disOrderArray(e);for(var t=0;t<=3;t++){for(var o=a.Random.randomFloorToInt(0,e.length),n=e.splice(o,1)[0],r=0;r<e.length;r++)e[r]==n&&(e.splice(r,1),r--);this.recycle.add(t,[]);for(var s=c.Poker.$_A;s<=c.Poker.$_K;s++)this.recycle.get(t).push({point:s,state:d.PokerState.Front,parent:u.RecycleParents[t],type:n,index:s-1})}this.addToCache()},t.prototype.initialDesk=function(){for(var e=this,t=[];t.length<600;)t.push(0),t.push(1),t.push(2),t.push(3),t.push(4),t.push(5),t.push(6);for(i.disOrderArray(t),this.selectedDeskIndex.length=0;this.selectedDeskIndex.length<4;){var o=t.splice(a.Random.randomFloorToInt(0,t.length),1)[0];this.selectedDeskIndex.push(o);for(var n=0;n<t.length;n++)t[n]==o&&(t.splice(n,1),n--)}var r=this.selectedDeskIndex[0],s=this.selectedDeskIndex[1],l=this.selectedDeskIndex[2],u=this.selectedDeskIndex[3];console.log("selectedDeskIndex:",this.selectedDeskIndex);for(n=0;n<=6;n++)this.desk.add(n,[]);for(var d=[null==this.desk.get(r)[this.desk.get(r).length-1]||this.desk.get(r)[this.desk.get(r).length-1].point!=c.Poker.$_A,null==this.desk.get(s)[this.desk.get(s).length-1]||this.desk.get(s)[this.desk.get(s).length-1].point!=c.Poker.$_A,null==this.desk.get(l)[this.desk.get(l).length-1]||this.desk.get(l)[this.desk.get(l).length-1].point!=c.Poker.$_A,null==this.desk.get(u)[this.desk.get(u).length-1]||this.desk.get(u)[this.desk.get(u).length-1].point!=c.Poker.$_A],p=this.selectedDeskIndex.concat();d[0]||d[1]||d[2]||d[3];)this.recycle.forEach(function(t,o){if(o.length>0)for(var n=o[o.length-1],i=0,r=p;i<r.length;i++){var a=r[i],s=e.desk.get(a)[e.desk.get(a).length-1];if(e.checkCanBeNext(s,n)){e.addToDesk(n,a),o.pop();break}}}),d=[null==this.desk.get(r)[this.desk.get(r).length-1]||this.desk.get(r)[this.desk.get(r).length-1].point!=c.Poker.$_A,null==this.desk.get(s)[this.desk.get(s).length-1]||this.desk.get(s)[this.desk.get(s).length-1].point!=c.Poker.$_A,null==this.desk.get(l)[this.desk.get(l).length-1]||this.desk.get(l)[this.desk.get(l).length-1].point!=c.Poker.$_A,null==this.desk.get(u)[this.desk.get(u).length-1]||this.desk.get(u)[this.desk.get(u).length-1].point!=c.Poker.$_A];this.addToCache()},t.prototype.startGeneratePokers=function(){for(var e=0,t=Date.now();e++<100&&0==this.doGenerate(););if(console.log(" generate time:",e,",cost time:",Date.now()-t," ms"),3!=n.CelerSDK.inst.DifficultyLevel){for(var o=6;o>=0;o--)for(var i=6;i>=o;i--){var r=this.desk.get(i);if(r.length>0){var a=r.pop();this.draw.unshift(a),a.index=this.draw.length-1,a.state=d.PokerState.Back,a.parent=u.PokerParent.Draw}}for(var s=0,l=this.draw;s<l.length;s++){a=l[s];this.solutionPokers.unshift(p.GetPokerString(a.type,a.point))}console.log(this.solutionPokers)}},t.prototype.doGenerate=function(){this.clear(),this.initialRecycle(),this.initialDesk(),this.returnToRecycle();var e=this.returnAll(),t=0;t+=this.ready.length;var o=t+=this.draw.length,n=[],i=[];return this.recycle.forEach(function(e,o){t+=o.length,n[e]=o.length}),this.desk.forEach(function(e,o){t+=o.length,i[e]=o.length}),console.log(" total:",t,",draw:",o,",desk:",i,",recycle:",n,",loopCount: ",this.returnLoopCount),t<52&&console.error(" poker missing."),e},t.prototype.getPokerByID=function(e){var t=null,o=this.getCache(this.currentStep);o.desk.forEach(function(o,n){for(var i=0,r=n;i<r.length;i++){var a=r[i];a.ID==e&&(null!=t&&console.log("desk dumplicate:",e),t=a)}}),o.recycle.forEach(function(o,n){for(var i=0,r=n;i<r.length;i++){var a=r[i];a.ID==e&&(null!=t&&console.log("recycle dumplicate:",e),t=a)}});for(var n=0,i=o.ready;n<i.length;n++){(s=i[n]).ID==e&&(null!=t&&console.log("ready dumplicate:",e),t=s)}for(var r=0,a=o.draw;r<a.length;r++){var s;(s=a[r]).ID==e&&(null!=t&&console.log("draw dumplicate:",e),t=s)}return t},t.prototype.returnAll=function(){var e=this,t=0,o=100;if(!(this.returnLoopCount>=30)){for(var n=function(){var n=[];r.recycle.forEach(function(e,t){t.length>0&&n.push(e)}),i.disOrderArray(n);var s=[];r.desk.forEach(function(t,o){0==e.isDeskComplete(t)&&o.length>1&&o[o.length-1].state==d.PokerState.Front&&o[o.length-2].state==d.PokerState.Front&&e.checkCanBeNext(o[o.length-2],o[o.length-1])&&s.push(t)}),i.disOrderArray(s);var l=[];for(r.desk.forEach(function(e,t){t.length<=0&&l.push(e)}),i.disOrderArray(l);l.length>0;){s=[],r.desk.forEach(function(t,o){0==e.isDeskComplete(t)&&o.length>1&&o[o.length-1].state==d.PokerState.Front&&o[o.length-2].state==d.PokerState.Front&&e.checkCanBeNext(o[o.length-2],o[o.length-1])&&s.push(t)}),i.disOrderArray(s);for(var u=0,p=l;u<p.length;u++){var h=p[u];if(a.Random.getRandom()>.5)if(s.length>0){var f=s[a.Random.randomFloorToInt(0,s.length)],y=r.desk.get(f).pop();r.addToDesk(y,h,!0),r.addToCache()}else if(n.length>0){var g=n[a.Random.randomFloorToInt(0,n.length)];y=r.recycle.get(g).pop();r.addToDesk(y,h,!0),r.addToCache()}else console.error("1.1.nothing to return ."),t=o;else if(n.length>0){g=n[a.Random.randomFloorToInt(0,n.length)],y=r.recycle.get(g).pop();r.addToDesk(y,h,!0),r.addToCache()}else if(s.length>0){f=s[a.Random.randomFloorToInt(0,s.length)],y=r.desk.get(f).pop();r.addToDesk(y,h,!0),r.addToCache()}else console.error("1.2.nothing to return ."),t=o}l=[],r.desk.forEach(function(e,t){t.length<=0&&l.push(e)}),i.disOrderArray(l)}var m=[];r.desk.forEach(function(e,t){t[t.length-1].state==d.PokerState.Back&&m.push(e)}),i.disOrderArray(m);for(var P=!1;m.length>0&&t<o;){if(P)for(var S=0,v=m;S<v.length;S++){var _=v[S];if(n=[],r.recycle.forEach(function(e,t){t.length>0&&n.push(e)}),i.disOrderArray(n),s=[],r.desk.forEach(function(t,o){0==e.isDeskComplete(t)&&o.length>1&&o[o.length-1].state==d.PokerState.Front&&o[o.length-2].state==d.PokerState.Front&&e.checkCanBeNext(o[o.length-2],o[o.length-1])&&s.push(t)}),i.disOrderArray(s),a.Random.getRandom()>.5)if(n.length>0){g=n[a.Random.randomFloorToInt(0,n.length)],y=r.recycle.get(g).pop();r.addToDesk(y,_,!0),r.addToCache()}else{if(!(s.length>0)){console.error(" 2.1.nothing to return."),t=o;break}f=s[a.Random.randomFloorToInt(0,s.length)];for(var C=r.desk.get(f),k=[],T=-1;T<C.length-1;T++){(y=C[T+1]).state==d.PokerState.Front&&r.checkCanBeNext(C[T],y)&&k.push(y.index)}i.disOrderArray(k);var b=k.pop();for(T=0;T<C.length;T++){(y=C[T]).state==d.PokerState.Front&&y.index>=b&&(r.addToDesk(y,_,!1),C.splice(T,1),T--)}r.addToCache()}else if(s.length>0){for(f=s[a.Random.randomFloorToInt(0,s.length)],C=r.desk.get(f),k=[],T=-1;T<C.length-1;T++){(y=C[T+1]).state==d.PokerState.Front&&r.checkCanBeNext(C[T],y)&&k.push(y.index)}i.disOrderArray(k);for(b=k.pop(),T=0;T<C.length;T++){(y=C[T]).state==d.PokerState.Front&&y.index>=b&&(r.addToDesk(y,_,!1),C.splice(T,1),T--)}r.addToCache()}else if(n.length>0){g=n[a.Random.randomFloorToInt(0,n.length)],y=r.recycle.get(g).pop();r.addToDesk(y,_,!0),r.addToCache()}else console.error(" 2.2.nothing to return."),t=o}else{P=!0;_=m[0],f=-1;for(var M=0,R=s;M<R.length;M++){var w=R[M];(C=r.desk.get(w))[0].point==c.Poker.$_K&&C[0].state==d.PokerState.Front&&(f=w)}if(f>=0){for(C=r.desk.get(f),T=0;T<C.length;T++){y=C[T];r.addToDesk(y,_,!1),C.splice(T,1),T--}r.addToCache()}}m=[],r.desk.forEach(function(e,t){t.length>0&&t[t.length-1].state==d.PokerState.Back&&m.push(e)}),i.disOrderArray(m)}var F=r.ready.length+r.draw.length;if(r.ready.length+r.draw.length<24){var D=a.Random.randomFloorToInt(1,5);D=Math.min(24-F,D);for(var O=!1,x=function(){n=[],r.recycle.forEach(function(e,t){t.length>0&&n.push(e)}),i.disOrderArray(n),s=[],r.desk.forEach(function(t,o){0==e.isDeskComplete(t)&&o.length>1&&o[o.length-1].state==d.PokerState.Front&&o[o.length-2].state==d.PokerState.Front&&e.checkCanBeNext(o[o.length-2],o[o.length-1])&&s.push(t)}),i.disOrderArray(s);var l=!1,u=[];if(r.desk.forEach(function(t,o){if(o.length>0)if(o.length<=3&&o[0].state==d.PokerState.Front)if(o.length<=1)o[0].point==c.Poker.$_K&&(l=!0,u.push(t));else{for(var n=!0,i=1;i<o.length;i++){var r=o[i-1],a=o[i];0==e.checkCanBeNext(r,a)&&(n=!1)}n&&(l=!0,u.push(t))}else if(0==e.isDeskComplete(t)){for(var s=0,p=0,h=o;p<h.length;p++){(r=h[p]).state==d.PokerState.Front&&s++}2==s&&e.checkCanBeNext(o[o.length-2],o[o.length-1])&&(l=!0,u.push(t))}}),l&&u.length>0&&(s=u,i.disOrderArray(s)),a.Random.getRandom()>.5&&0==l&&1==O)if(n.length>0){var p=n[a.Random.randomFloorToInt(0,n.length)],h=r.recycle.get(p).pop();r.addToReady(h)}else if(s.length>0){var f=s[a.Random.randomFloorToInt(0,s.length)];h=r.desk.get(f).pop();r.addToReady(h)}else console.error(" 3.1.nothing to return."),t=o;else if(O=!0,s.length>0)if(l)for(;s.length>0;){var y=r.desk.get(s.pop());if(y.length<=1){h=y.pop();r.addToReady(h)}else if(y.length<=2);else for(;y.length>0&&r.ready.length+r.draw.length<24;){h=y.pop();if(r.addToReady(h),0==r.checkCanBeNext(y[y.length-1],h)||y[y.length-2]&&y[y.length-2].state==d.PokerState.Back)break}}else{f=s[a.Random.randomFloorToInt(0,s.length)],h=r.desk.get(f).pop();r.addToReady(h)}else if(n.length>0){p=n[a.Random.randomFloorToInt(0,n.length)],h=r.recycle.get(p).pop();r.addToReady(h)}else console.error(" 3.2.nothing to return."),t=o};D-- >0&&r.ready.length+r.draw.length<24;)x()}else console.log(" draw area is done.");r.desk.forEach(function(t,o){if(0==e.isDeskComplete(t)){for(var n=0,i=0,r=0,a=o;r<a.length;r++){a[r].state==d.PokerState.Front?n++:i++}1==n&&i>0&&o[o.length-1].state==d.PokerState.Front&&(o[o.length-1].state=d.PokerState.Back)}})},r=this;0==this.isReturnComplete()&&t++<o;)n();return!(t>=o)||(console.error(" loop over ",o),!1)}},t.prototype.isDeskComplete=function(e){var t=this.desk.get(e);if(0==e&&1==t.length)return!0;if(t.length>e+1)return!1;for(var o=0,n=0,i=t;n<i.length;n++){i[n].state==d.PokerState.Back&&o++}return o==e},t.prototype.isReturnComplete=function(){var e=!0;return this.recycle.forEach(function(t,o){o.length>0&&(e=!1)}),this.desk.forEach(function(t,o){if(0==t)o.length>1&&(e=!1);else if(o.length<t+1)e=!1;else{for(var n=0,i=0,r=o;i<r.length;i++){r[i].state==d.PokerState.Back&&n++}n<t&&(e=!1)}}),this.ready.length+this.draw.length<24&&(e=!1),e},t.prototype.returnToRecycle=function(){for(var e=this;null==this.recycle.get(0)[this.recycle.get(0).length-1]||this.recycle.get(0)[this.recycle.get(0).length-1].point<c.Poker.$_7;)this.desk.forEach(function(t,o){o.length>0&&e.checkRecycle(o[o.length-1])&&o.pop()});this.addToCache()},t.prototype.checkRecycle=function(e){var t=this;if(e.state==d.PokerState.Back||u.RecycleParents.indexOf(e.parent)>=0)return!1;var o=!1;return this.recycle.forEach(function(n,i){0==o&&t.checkCanBeRecycle(i[i.length-1],e)&&(i.push(e),o=!0,e.index=i.length-1,e.parent=u.RecycleParents[n],e.state=d.PokerState.Front)}),o},t.prototype.addToReady=function(e){if(this.ready.push(e),e.index=this.ready.length-1,e.state=d.PokerState.Front,e.parent=u.PokerParent.Ready,this.addToCache(),this.draw.length+this.ready.length>=24)for(;this.ready.length>0;)this.returnToDraw(),this.addToCache();else if(this.ready.length%3==0&&a.Random.getRandom()>.5)for(var t=a.Random.randomFloorToInt(1,4);t-- >0&&this.ready.length>0;)this.returnToDraw(),this.addToCache()},t.prototype.returnToDraw=function(){for(var e=3;e-- >0&&this.ready.length>0;){var t=this.ready.pop();this.draw.push(t),t.index=this.draw.length-1,t.state=d.PokerState.Back,t.parent=u.PokerParent.Draw}},t.prototype.addToDesk=function(e,t,o){void 0===o&&(o=!1),null==this.desk.get(t)&&this.desk.add(t,[]);var n=this.desk.get(t);if(e.index=n.length,n.push(e),e.parent=u.DeskParents[t],o)for(var i=0,r=n;i<r.length;i++){var a=r[i];a.index>=t?a.state=d.PokerState.Front:a.state=d.PokerState.Back}},t.prototype.getDeskBackCount=function(){var e=0;return this.desk.forEach(function(t,o){for(var n=0,i=o;n<i.length;n++){i[n].state==d.PokerState.Back&&e++}}),e},t.prototype.addToCache=function(){for(var e=[],t=0,o=this.draw;t<o.length;t++){var n=o[t];e.push({parent:n.parent,point:n.point,state:n.state,ID:n.ID,index:n.index,type:n.type})}for(var i=[],a=0,s=this.ready;a<s.length;a++){n=s[a];i.push({parent:n.parent,point:n.point,state:n.state,ID:n.ID,index:n.index,type:n.type})}var l=new r.HashMap;this.recycle.forEach(function(e,t){l.add(e,[]);for(var o=0,n=t;o<n.length;o++){var i=n[o];l.get(e).push({parent:i.parent,point:i.point,state:i.state,ID:i.ID,index:i.index,type:i.type})}});var c=new r.HashMap;this.desk.forEach(function(e,t){c.add(e,[]);for(var o=0,n=t;o<n.length;o++){var i=n[o];c.get(e).push({parent:i.parent,point:i.point,state:i.state,ID:i.ID,index:i.index,type:i.type})}}),this.stepCache.add(this.totalStepCount,{draw:e,ready:i,recycle:l,desk:c}),this.totalStepCount++,this.currentStep++},t.prototype.getCache=function(e){return e>this.totalStepCount?(console.error(" step over total size."),null):this.stepCache.get(e)},Object.defineProperty(t.prototype,"TotalStep",{get:function(){return this.totalStepCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentStep",{get:function(){return this.currentStep},enumerable:!0,configurable:!0}),t.prototype.getCurrentCache=function(){if(0!=this.stepCache.has(this.currentStep-1))return this.currentStep--,this.stepCache.get(this.currentStep)},t.prototype.getLastCache=function(){if(0!=this.stepCache.has(this.currentStep+1))return this.currentStep++,this.stepCache.get(this.currentStep)},t.prototype.getRandomCache=function(){for(var e=a.Random.getRandom(.45,.7),t=Math.floor(e*this.TotalStep),o=0;o++<100&&0==this.stepCache.has(t);)e=a.Random.getRandom(.45,.7),t=Math.floor(e*this.TotalStep);return o>=100&&(t=this.currentStep-1),this.currentStep=t,this.stepCache.get(this.currentStep)},t}(s.SingleTon());o.SolutionChecker=h,cc._RF.pop()},{"../../Utils/Celer/CelerSDK":"CelerSDK","../../Utils/Cocos":"Cocos","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../../Utils/ToSingleton":"ToSingleton","../Test/TestView":"TestView","./Poker/PokerModel":"PokerModel","./Poker/PokerParentModel":"PokerParentModel","./Poker/PokerStateModel":"PokerStateModel","./Poker/PokerUtil":"PokerUtil"}],SoundButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"6d699bXGkJBYb+wyjeQyALI","SoundButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=e("../../../Manager/AudioManager"),r=e("../../../Utils/Signal"),a=e("../../../View/SingleTouchView"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal)),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.updateState(),c.inst.addListener(this.updateState,this)},t.prototype.onTouchEnd=function(){i.gAudio.MusicVolume>0?(i.gAudio.setEffectVolume(0),i.gAudio.setMusicVolume(0)):(i.gAudio.setEffectVolume(1),i.gAudio.setMusicVolume(1)),c.inst.dispatch()},t.prototype.updateState=function(){var e=i.gAudio.MusicVolume;this.Sprite.spriteFrame=e>0?n.ResourceController.inst.getSoundEnable():n.ResourceController.inst.getSoundDisabled()},t=__decorate([l],t)}(a.default);o.default=u,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController","../../../Manager/AudioManager":"AudioManager","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView"}],SpecialTutorial:[function(e,t,o){"use strict";cc._RF.push(t,"8f41fFbd9RBYr0Dfb7WtlVs","SpecialTutorial"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Global/GameRule"),a=e("../../../Utils/Celer/CelerSDK"),s=e("../../../Utils/FrameAniBase"),l=e("../../../View/BaseView"),c=cc._decorator,u=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Background",{get:function(){return this.node.getChildByName("Background")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OK",{get:function(){return this.node.getChildByName("btn_confirm")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),setTimeout(function(){t.node.active=!1},0),n.GameStartSignal.inst.addListener(this.showTutorial,this)},t.prototype.showTutorial=function(){var e=this;if(1!=a.CelerSDK.inst.DifficultyLevel&&1!=this.node.active){this.OK.scale=0,this.OK.getComponent(cc.Button).interactable=!1,this.OK.stopAllActions(),i.GameStateController.inst.pause(!0);for(var t=null,o=0,n=this.Background.children;o<n.length;o++){var l=n[o];l.active=a.CelerSDK.inst.DifficultyLevel.toString()==l.name,l.getChildByName("Time").getComponent(cc.Label).string=Math.ceil(r.GetGameTime(a.CelerSDK.inst.DifficultyLevel)/60).toString(),l.getChildByName("Time").getComponent(cc.Label)._enableBold(!0),l.active&&(t=l.getComponent(s.default))}this.Show(function(){e.OK.runAction(cc.sequence(cc.delayTime(3),cc.scaleTo(.1,1),cc.callFunc(function(){t&&t.playOnLoop(),e.OK.getComponent(cc.Button).interactable=!0,e.OK.once(cc.Node.EventType.TOUCH_END,function(){i.GameStateController.inst.resume(),e.Hide()},e)})))})}},t=__decorate([u],t)}(l.default));o.default=d,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Global/GameRule":"GameRule","../../../Utils/Celer/CelerSDK":"CelerSDK","../../../Utils/FrameAniBase":"FrameAniBase","../../../View/BaseView":"BaseView"}],StartGameCommand:[function(e,t,o){"use strict";cc._RF.push(t,"1db594KvoJIVbc+cwfogrGn","StartGameCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Command/CommonSignal"),i=e("../../Model/PlayModelProxy"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){console.log("--------- excute StartGameCommand ---------"),i.PlayModelProxy.inst.initGametheme(),n.GameReadySignal.inst.dispatch()},t}(puremvc.SimpleCommand);o.StartGameCommand=r,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Model/PlayModelProxy":"PlayModelProxy"}],StepManager:[function(e,t,o){"use strict";cc._RF.push(t,"83709TvPtJOVayPDGaPh6Ov","StepManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.totalStep=[],this.curStep=[],this.loadTime={}}return e.prototype.register=function(e,t){this.completeCallback=e,this.totalStep=t;for(var o=0,n=t;o<n.length;o++){var i=n[o];this.loadTime[i]=Date.now()}},e.prototype.nextStep=function(e){if(this.totalStep.indexOf(e)<0)console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",e);else if(this.curStep.indexOf(e)>=0)console.warn(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",e);else{this.curStep.push(e),this.curStep.sort(function(e,t){return e>t?-1:1}),this.totalStep.sort(function(e,t){return e>t?-1:1});var t=this.curStep.join("-"),o=this.totalStep.join("-"),n=Date.now()-this.loadTime[e];console.log(" cur step:",t,", total step:",o,", cost time:",n," ms"),t==o&&(console.log(" step done"),this.totalStep.length=0,this.completeCallback(),this.completeCallback=null)}},e}();o.StepManager=n,cc._RF.pop()},{}],SubmitButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"7d5e6ERlcdIapmrVvugM7L/","SubmitButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../Model/PlayModelProxy"),r=e("../../../View/SingleTouchView"),a=e("../../Command/GamePlaySignal"),s=e("../Animation/SubmitTip"),l=e("../new/ToturialLayer"),c=cc._decorator,u=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),l.default.AddToturialStep(7,this.node,null,!0,function(){},function(){s.ShowSubmitTipSignal.inst.dispatchOne(!0)},function(){s.ShowSubmitTipSignal.inst.dispatchOne(!1)},!1)},t.prototype.onTouchEnd=function(){n.GameStateController.inst.isGameOver()||0==n.GameStateController.inst.isRoundStart()||(a.SubmitButtonClickSignal.inst.dispatchOne("Submit"==this.node.name),i.PlayModelProxy.inst.isOnTutorial&&l.TutorialNextStepSignal.inst.dispatch())},t=__decorate([u],t)}(r.default));o.default=d,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../View/SingleTouchView":"SingleTouchView","../../Command/GamePlaySignal":"GamePlaySignal","../Animation/SubmitTip":"SubmitTip","../new/ToturialLayer":"ToturialLayer"}],SubmitLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"f65c05YNytD2Zq3Ran+pohk","SubmitLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Controller/ResourceController"),a=e("../../../Manager/AudioManager"),s=e("../../../Model/PlayModelProxy"),l=e("../../../Utils/Signal"),c=e("../../../View/BaseView"),u=e("../../../View/SliderView"),d=e("../../Command/GamePlaySignal"),p=e("../new/ToturialLayer"),h=cc._decorator,f=h.ccclass,y=h.property,g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.EndNowSignal=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.HideSubmitLayerSignal=m;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Content=null,t.Array=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("ResumeButton")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndNow",{get:function(){return this.node.getChildByName("EndNow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return this.node.getChildByName("FreePauseCount").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseInfo",{get:function(){return this.node.getChildByName("PauseInfo").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VolumeSlider",{get:function(){return this.node.getChildByName("VolumeSlider").getComponent(u.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.Content._enableBold(!0),setTimeout(function(){e.node.active=!1,e.node.scale=1},0),d.SubmitButtonClickSignal.inst.addListenerOne(this.onShow,this),this.EndNow.on(cc.Node.EventType.TOUCH_END,this.endNow,this),this.Resume.on(cc.Node.EventType.TOUCH_END,this.OnResume,this),m.inst.addListener(function(){e.node.active&&e.OnResume()},this),this.VolumeSlider.onProgress=function(e){a.gAudio.setEffectVolume(e),a.gAudio.setMusicVolume(e)},p.default.AddToturialStep(8,this.EndNow,null,!0,function(){},function(){},function(){},!1)},t.prototype.endNow=function(){var e=this;if(s.PlayModelProxy.inst.isOnTutorial)return p.TutorialNextStepSignal.inst.dispatch(),void this.OnResume();g.inst.dispatch(),n.ButtonClickSignal.inst.dispatch(),setTimeout(function(){e.Hide()},0)},t.prototype.OnResume=function(){var e=this;i.GameStateController.inst.resume(),n.ButtonClickSignal.inst.dispatch(),setTimeout(function(){e.Hide()},0)},t.prototype.onShow=function(){var e=this;this.node.active||(this.Array.active=s.PlayModelProxy.inst.isOnTutorial,s.PlayModelProxy.inst.FreePauseCount<=0?(this.FreePauseCount.node.active=!1,this.PauseInfo.spriteFrame=r.ResourceController.inst.getAnimationAtlas("bg_pause_font2")):(this.FreePauseCount.node.active=!0,this.FreePauseCount.string=s.PlayModelProxy.inst.FreePauseCount.toString(),this.PauseInfo.spriteFrame=r.ResourceController.inst.getAnimationAtlas("bg_pause_font1")),this.Show(function(){e.VolumeSlider.Percent=a.gAudio.MusicVolume}),setTimeout(function(){e.VolumeSlider.Percent=a.gAudio.MusicVolume},0),i.GameStateController.inst.pause())},__decorate([y(cc.Label)],t.prototype,"Content",void 0),__decorate([y(cc.Node)],t.prototype,"Array",void 0),t=__decorate([f],t)}(c.default);o.default=P,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Manager/AudioManager":"AudioManager","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/BaseView":"BaseView","../../../View/SliderView":"SliderView","../../Command/GamePlaySignal":"GamePlaySignal","../new/ToturialLayer":"ToturialLayer"}],SubmitTip:[function(e,t,o){"use strict";cc._RF.push(t,"3aa5dCj959JU7OO+Wj7AsSz","SubmitTip"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../new/ToturialLayer"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.ShowSubmitTipSignal=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;s.inst.addListenerOne(function(t){e.node.active=t},this),setTimeout(function(){e.node.active=!1},0),i.default.AddToturialStep(7,this.node,null,!0,function(){},function(){},function(){},!1)},t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../new/ToturialLayer":"ToturialLayer"}],TestApp:[function(e,t,o){"use strict";cc._RF.push(t,"b219e3JEelF8qF2ISXZvtH0","TestApp"),Object.defineProperty(o,"__esModule",{value:!0});e("../../Command/CommonSignal"),e("../../Factory/GameFactory");var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.prototype.start=function(){this.node.removeComponent(o)},t=o=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Factory/GameFactory":"GameFactory"}],TestSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"2761dS0K89JwJjOcqk97q1o","TestSingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=e("../SingleTouchView"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onSetParent=function(e){console.error("parent:",e)},t.prototype.onTouchStart=function(){n.gFactory.putObj("TestNode",this.node)},t.prototype.onTouchEnd=function(){console.error("ontouchend")},t=__decorate([a],t)}(i.default));o.default=s,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../SingleTouchView":"SingleTouchView"}],TestView:[function(e,t,o){"use strict";cc._RF.push(t,"1d4b524i9VGt70GCYKNet8s","TestView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Command/CommonSignal"),i=e("../../Controller/GameStateController"),r=e("../../Utils/Random"),a=e("../../Utils/Signal"),s=e("../Model/GameLogic"),l=e("../Model/GamePlayModel"),c=cc._decorator,u=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.NextStepSignal=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.LastStepSignal=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.StepUpdateSignal=h;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canNext=!1,t.autoOpen=!1,t.nextPlayTime=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"SeedLabel",{get:function(){return this.node.getChildByName("RandomSeed").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LevelLabel",{get:function(){return this.node.getChildByName("Level").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"StepLabel",{get:function(){return this.node.getChildByName("Step").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonRoot",{get:function(){return this.node.getChildByName("button")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Next",{get:function(){return this.buttonRoot.getChildByName("btn_next")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Forward",{get:function(){return this.buttonRoot.getChildByName("btn_forward")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Auto",{get:function(){return this.buttonRoot.getChildByName("auto")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Tip",{get:function(){return this.buttonRoot.getChildByName("tip")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AutoLabel",{get:function(){return this.Auto.getChildByName("label").getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;setTimeout(function(){e.node.active=!1},0),n.GameStartSignal.inst.addListener(function(){e.node.active=!1},this),r.RandomSeedInitSignal.inst.addListenerOne(function(t){e.SeedLabel.string="randomSeed:"+t.toString()},this),s.LevelChangedSignal.inst.addListenerOne(function(t){e.LevelLabel.string="Level:"+t},this),h.inst.addListenerOne(function(t){e.StepLabel.string="Step:"+t},this),this.Next.on(cc.Node.EventType.TOUCH_END,function(){0==e.canNext||e.autoOpen||s.NextRoundSignal.inst.dispatch()},this),this.Forward.on(cc.Node.EventType.TOUCH_END,function(){0==e.canNext||e.autoOpen||p.inst.dispatch()},this),l.AfterGenLevelSignal.inst.addListener(function(){e.canNext=!0},this),l.BeforeGenLevelSignal.inst.addListener(function(){e.canNext=!1},this),this.Tip.on(cc.Node.EventType.TOUCH_END,function(){e.canNext&&!e.autoOpen&&d.inst.dispatch()},this),this.Auto.on(cc.Node.EventType.TOUCH_END,function(){e.canNext&&(e.autoOpen=!e.autoOpen,e.autoOpen&&(e.nextPlayTime=Date.now()+800))},this),n.GameOverSignal.inst.addListener(function(){e.autoOpen=!1,e.canNext=!1},this)},t.prototype.update=function(e){i.GameStateController.inst.isPause()||(this.autoOpen?(this.AutoLabel.string="autoplay(\u5f00)",Date.now()>=this.nextPlayTime&&(d.inst.dispatch(),this.nextPlayTime=Date.now()+800),this.Tip.color=cc.Color.GRAY,this.Forward.color=cc.Color.GRAY,this.Next.color=cc.Color.GRAY):(this.AutoLabel.string="autoplay(\u5173)",this.Tip.color=cc.Color.WHITE,this.Forward.color=cc.Color.WHITE,this.Next.color=cc.Color.WHITE))},t=__decorate([u],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../Model/GameLogic":"GameLogic","../Model/GamePlayModel":"GamePlayModel"}],Test:[function(e,t,o){"use strict";cc._RF.push(t,"df1af1sWs9HWZ8cYz9x0Gs9","Test"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.active=!1},t.prototype.start=function(){},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],ThemeView:[function(e,t,o){"use strict";cc._RF.push(t,"2b2d1k5+RZFrKLwiNmu7pk+","ThemeView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseView"),i=e("../../Global/Theme"),r=e("../../Command/CommonSignal"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){r.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},t.prototype.start=function(){},t.prototype.onThemeInit=function(e){this.node.active=this.node.name==i.Theme[e]},t=__decorate([s],t)}(n.default));o.default=l,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Global/Theme":"Theme","../../View/BaseView":"BaseView"}],Theme:[function(e,t,o){"use strict";cc._RF.push(t,"5fef4dbBENAfYW6Tw8oUA62","Theme"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Blue=0]="Blue",e[e.Green=1]="Green",e[e.Red=2]="Red"}(o.Theme||(o.Theme={})),cc._RF.pop()},{}],TimeEffectAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"603e6ws6zRH9IcpX4uo/ZlK","TimeEffectAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/FrameAniBase"),i=e("../Command/CommonSignal"),r=e("../Manager/AudioManager"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isPlayShake=!1,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.opacity=0,i.TimeAnimationStateChanged.inst.addListenerOne(this.onPlayStateChanged,this)},t.prototype.onPlayStateChanged=function(e){e?(0==this.isPlaying&&this.play(),0==this.isPlayShake&&(r.gAudio.playEffect("shake"),this.isPlayShake=!0)):this.stop()},t.prototype.start=function(){},t.prototype.play=function(){this.node.opacity=255,e.prototype.play.call(this)},t.prototype.stop=function(){this.node.opacity=0,e.prototype.stop.call(this)},t=__decorate([s],t)}(n.default));o.default=l,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Manager/AudioManager":"AudioManager","../Utils/FrameAniBase":"FrameAniBase"}],TimeIconView:[function(e,t,o){"use strict";cc._RF.push(t,"5c618yhw+lChoVzHSO1Nl7w","TimeIconView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.ShowTutorialSignal.inst.addListener(function(){e.node.active=!1},this),n.GameStartSignal.inst.addListener(function(){e.node.active=!0},this),n.TimeAnimationStateChanged.inst.addListenerOne(function(t){e.getComponent(cc.Sprite).spriteFrame=t?i.ResourceController.inst.getAltas("icon_timeorg"):i.ResourceController.inst.getAltas("icon_time")},this)},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController"}],TimeLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"8e78fIPKARBx69B005nUUwo","TimeLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),r=e("../../../Utils/Signal"),a=e("../../../Utils/Time"),s=e("../../../View/BaseView"),l=cc._decorator,c=l.ccclass,u=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.TimeInitSignal=u;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sec=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;n.UpdateTimeNumber.inst.addListenerOne(this.onTimeChanged,this),u.inst.addListenerOne(function(t){e.onTimeChanged(t)},this),n.ShowTutorialSignal.inst.addListener(function(){e.node.active=!1},this),n.GameStartSignal.inst.addListener(function(){e.node.active=!0},this)},t.prototype.onTimeChanged=function(e){var t=a.Time.timeFormat(e);"MinuteLabel"==this.node.name?this.Label.string=t.split("/")[0]:"SecondLabel"==this.node.name?this.Label.string=t.split("/")[1]:this.Label.string=t,this.Label.font=e>60?i.ResourceController.inst.getTimeWhiteFont():i.ResourceController.inst.getTimeRedFont();var o=Math.floor(e);o!=this.sec&&("MinuteLabel"==this.node.name||"MinuteLabel"!=this.node.name&&"SecondLabel"!=this.node.name)&&(this.sec=o,this.sec<=5&&n.CountDownSignal.inst.dispatch())},t.prototype.start=function(){},t=__decorate([c],t)}(s.default);o.default=d,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController","../../../Utils/Signal":"Signal","../../../Utils/Time":"Time","../../../View/BaseView":"BaseView"}],Time:[function(e,t,o){"use strict";cc._RF.push(t,"87a24xcV95AoII6L5W1ABoI","Time"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.timeFormat=function(e){var t=Math.floor(e/60),o=Math.floor(e%60),n=o.toString();return o<10&&(n="0"+o),t+"/"+n},e}();o.Time=n,cc._RF.pop()},{}],ToSingleton:[function(e,t,o){"use strict";cc._RF.push(t,"b07299nlSpOIIxOkIMBhUY9","ToSingleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleTon=function(){return function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),e}()},cc._RF.pop()},{}],ToturialLayer:[function(e,t,o){"use strict";cc._RF.push(t,"31d97rUJf9MPIl3F5Km6wKk","ToturialLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Model/PlayModelProxy"),r=e("../../../Utils/Cocos"),a=e("../../../Utils/Signal"),s=e("../../../View/BaseView"),l=e("../Animation/HandAnimation"),c=e("../UI/SubmitLayerView"),u=cc._decorator,d=u.ccclass,p=u.property,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.TutorialPrepareDoneSignal=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.TutorialNextStepSignal=f;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeCallback=null,t.tutorialAtlas=null,t.tutorialStart=null,t.tutorialEnd=null,t.currentStep=0,t}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"GuideHand",{get:function(){return this.node.getChildByName("GuideHand").getComponent(l.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Background",{get:function(){return this.node.getChildByName("Background")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Panel",{get:function(){return this.node.getChildByName("GuidePanel").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Skip",{get:function(){return this.node.getChildByName("btn_skip")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OK",{get:function(){return this.node.getChildByName("btn_ok")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),n.ShowTutorialSignal.inst.addListenerOne(this.showToturial,this),setTimeout(function(){t.node.active=!1},0),this.Background.on(cc.Node.EventType.TOUCH_CANCEL,this.onBlockTouchCancel,this),f.inst.addListener(function(){i.PlayModelProxy.inst.isOnTutorial&&t.nextStep()},this),this.Background.on(cc.Node.EventType.TOUCH_END,this.onBlockTouchEnd,this),this.Background.on(cc.Node.EventType.TOUCH_START,this.onBlockTouchStart,this),this.Background.on(cc.Node.EventType.TOUCH_MOVE,this.onBlockTouchMoved,this),this.OK.once(cc.Node.EventType.TOUCH_END,function(){t.OK.active=!1,t.nextStep()},this),this.Skip.on(cc.Node.EventType.TOUCH_END,function(){t.endTutorial()},this),this.OK.active=!1,this.Skip.active=!1,this.GuideHand.node.active=!1,h.inst.addListener(function(){t.OK.active=!0,t.Skip.active=!0},this)},t.prototype.evalStepAction=function(){var e=o.TutorialStep[this.currentStep];if(null!=e){for(var t=[],n=[],i=0,a=e.touches;i<a.length;i++){(d=a[i]).isAction&&n.unshift(d.node)}if(n.length>0){var s=void 0;s=e.touches.length>1?r.ConvertToNodeSpaceAR(n[1],this.GuideHand.node.parent):r.ConvertToNodeSpaceAR(n[0],this.GuideHand.node.parent),this.GuideHand.node.position=s}for(var l=!1,c=0,u=e.touches;c<u.length;c++){var d;if((d=u[c]).node.group="move",d.start(),d.isAction){l=!0;s=r.ConvertToNodeSpaceAR(d.node,this.GuideHand.node.parent);var p=r.Distance(s,this.GuideHand.node.position),h=cc.moveTo(p/550,s);t.push(h),1==t.length&&t.push(cc.fadeIn(.2)),3==t.length&&(t.push(cc.fadeOut(.2)),t.push(cc.delayTime(.3)))}}this.GuideHand.node.active=t.length>0,this.GuideHand.node.stopAllActions(),this.GuideHand.node.opacity=255,t.length>3?(this.GuideHand.stop(),this.GuideHand.getComponent(cc.Sprite).spriteFrame=this.tutorialAtlas.getSpriteFrame("am_guidehand1"),this.GuideHand.node.runAction(cc.repeatForever(cc.sequence(t)))):l&&this.GuideHand.playOnLoop()}},t.AddToturialStep=function(e,t,o,n,i,r,a,s,l,c){void 0===l&&(l=-1),null==this.TutorialStep[e]?this.TutorialStep[e]={touches:[{node:t,exceptNode:o,isButton:n,callback:i,start:r,end:a,isAction:s,blockEvent:c}]}:l>=0&&this.TutorialStep[e].touches[l]?(this.TutorialStep[e].touches[l].callback||(this.TutorialStep[e].touches[l].callback=i),this.TutorialStep[e].touches[l].start||(this.TutorialStep[e].touches[l].start=r),this.TutorialStep[e].touches[l].node||(this.TutorialStep[e].touches[l].node=t),this.TutorialStep[e].touches[l].exceptNode||(this.TutorialStep[e].touches[l].exceptNode=o),this.TutorialStep[e].touches[l].isButton||(this.TutorialStep[e].touches[l].isButton=n),this.TutorialStep[e].touches[l].end||(this.TutorialStep[e].touches[l].end=a),this.TutorialStep[e].touches[l].isAction||(this.TutorialStep[e].touches[l].isAction=s),this.TutorialStep[e].touches[l].blockEvent||(this.TutorialStep[e].touches[l].blockEvent=c)):this.TutorialStep[e].touches.push({node:t,exceptNode:o,isButton:n,callback:i,start:r,end:a,isAction:s,blockEvent:c})},t.prototype.nextStep=function(){var e=this,t=this.currentStep;if(this.GuideHand.node.active=!1,o.TutorialStep[t]){for(var n=0,i=o.TutorialStep[t].touches;n<i.length;n++){var r=i[n];r.end&&r.end(),r.node&&(r.node.group="default",r.node.zIndex=r.node.zIndex)}o.TutorialStep[t]=null}this.currentStep++,null!=o.TutorialStep[this.currentStep]?(this.Panel.spriteFrame=this.tutorialAtlas.getSpriteFrame("guide"+this.currentStep),this.Panel.node.y=-395,this.evalStepAction()):(this.Panel.node.y=135,this.Panel.spriteFrame=this.tutorialEnd,this.OK.active=!0,this.OK.once(cc.Node.EventType.TOUCH_END,function(){e.endTutorial()},this))},t.prototype.onBlockTouchStart=function(e){if(0!=i.PlayModelProxy.inst.isOnTutorial){var t=o.TutorialStep[this.currentStep];if(null!=t)for(var n=0,a=t.touches;n<a.length;n++){var s=a[n],l=s.exceptNode;r.GetBoxToWorld(s.node,l).contains(e.getLocation())&&!s.blockEvent&&(s.node.dispatchEvent(e),s.touchStarted=!0)}}},t.prototype.onBlockTouchEnd=function(e){if(0!=i.PlayModelProxy.inst.isOnTutorial){var t=o.TutorialStep[this.currentStep];if(null!=t)for(var n=0,r=t.touches;n<r.length;n++){var a=r[n];a.touchStarted&&(a.node.dispatchEvent(e),a.touchStarted=!1)}}},t.prototype.onBlockTouchMoved=function(e){if(0!=i.PlayModelProxy.inst.isOnTutorial){var t=o.TutorialStep[this.currentStep];if(null!=t)for(var n=0,r=t.touches;n<r.length;n++){var a=r[n];!a.isButton&&a.touchStarted&&(e.bubbles=!1,a.node.dispatchEvent(e))}}},t.prototype.onBlockTouchCancel=function(e){if(0!=i.PlayModelProxy.inst.isOnTutorial){var t=o.TutorialStep[this.currentStep];if(null!=t)for(var n=0,a=t.touches;n<a.length;n++){var s=a[n],l=s.exceptNode;if(r.GetBoxToWorld(s.node,l).contains(e.getLocation())&&s.touchStarted){var c=new cc.Event.EventCustom(e.getType(),!1);c.setUserData(s.callback),c.getID=function(){return 0},s.node.dispatchEvent(c),s.touchStarted=!1}}}},t.prototype.showToturial=function(e){this.node.active||(this.closeCallback=e,this.Show(),this.Panel.node.y=135,this.Panel.spriteFrame=this.tutorialStart,c.HideSubmitLayerSignal.inst.dispatch())},t.prototype.endTutorial=function(){for(var e=0,t=o.TutorialStep;e<t.length;e++){var n=t[e];if(n&&n.touches)for(var i=0,r=n.touches;i<r.length;i++){var a=r[i];a.end&&a.end(),a.node&&(a.node.group="default")}}o.TutorialStep.length=0,this.closeCallback&&(this.closeCallback(),this.closeCallback=null),c.HideSubmitLayerSignal.inst.dispatch(),this.Hide()},t.TutorialStep=[],__decorate([p(cc.SpriteAtlas)],t.prototype,"tutorialAtlas",void 0),__decorate([p(cc.SpriteFrame)],t.prototype,"tutorialStart",void 0),__decorate([p(cc.SpriteFrame)],t.prototype,"tutorialEnd",void 0),t=o=__decorate([d],t)}(s.default);o.default=y,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Cocos":"Cocos","../../../Utils/Signal":"Signal","../../../View/BaseView":"BaseView","../Animation/HandAnimation":"HandAnimation","../UI/SubmitLayerView":"SubmitLayerView"}],UpdateController:[function(e,t,o){"use strict";cc._RF.push(t,"b3cadc9oLxMlaTWSqS0DgLW","UpdateController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){var t=e.call(this)||this;return t.assetsManager=null,t.STORAGE_PATH=(window.jsb&&jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hot-update",t.MANIFEST_PAth="",t.isUpdating=!1,t.manifest=null,t.completeCallback=[],t.startCallback=[],t.errorCallback=[],t.progressCallback=[],t.init(),t}return __extends(t,e),t.prototype.init=function(){window.jsb&&(this.assetsManager=new jsb.AssetsManager(this.MANIFEST_PAth,this.STORAGE_PATH,this.versionCompareHandle),this.assetsManager.setVerifyCallback(this.verifyCallback.bind(this)),cc.sys.os===cc.sys.OS_ANDROID&&this.assetsManager.setMaxConcurrentTask(2))},t.prototype.setManifest=function(e){this.manifest=e},t.prototype.getVersion=function(){return null==this.assetsManager?"":null==this.assetsManager.getLocalManifest()?"":this.assetsManager.getLocalManifest().getVersion()},t.prototype.addCompleteCallback=function(e,t){this.completeCallback.push({target:t,callback:e})},t.prototype.addErrorCallback=function(e,t){this.errorCallback.push({target:e,callback:t})},t.prototype.addStartCallback=function(e,t){this.startCallback.push({target:e,callback:t})},t.prototype.addProgressCallback=function(e,t){this.progressCallback.push({target:e,callback:t})},t.prototype.triggeError=function(e,t){void 0===t&&(t=!1),this.onError(e,t)},t.prototype.onError=function(e,t){void 0===t&&(t=!1),console.log(" this.errorCallback:",this.errorCallback.length,"error:",e);for(var o=0,n=this.errorCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.onComplete=function(e,t){void 0===t&&(t=!1),console.log(" on update complete:",this.getVersion()),console.log("storagePath:",this.getStoragePath()),console.log("search path:",this.getSearchPaths());for(var o=function(o){setTimeout(function(){o.callback.apply(o.target,[e,t])},0)},n=0,i=this.completeCallback;n<i.length;n++){o(i[n])}},t.prototype.getStoragePath=function(){return this.assetsManager?this.assetsManager.getStoragePath():""},t.prototype.getSearchPaths=function(){return window.jsb?jsb.fileUtils.getSearchPaths():""},t.prototype.onStart=function(e,t){void 0===t&&(t=!1),console.log(" this.startCallback:",this.startCallback.length);for(var o=0,n=this.startCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.onProgress=function(e,t){for(var o=0,n=this.progressCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.loadCustomManifest=function(e){if(null!=this.assetsManager&&this.assetsManager.getState()==jsb.AssetsManager.State.UNINITED){var t=new jsb.Manifest(e,this.STORAGE_PATH);this.assetsManager.loadLocalManifest(t,this.STORAGE_PATH)}},t.prototype.checkForUpdate=function(){this.onComplete("no need to update.")},t.prototype.checkUpdateCallback=function(e){switch(console.log("checkUpdateCallback Code: "+e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:var t=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():" null",o=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null";this.onComplete("Already up to date with the latest remote version :"+t+", local version :"+o);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.isUpdating=!1;var n=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null",i=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():"null";if(console.log("New version found, old:",n,", new: ",i),"null"==n||"null"==i);else{console.log("storage path:",this.assetsManager.getStoragePath());var r=n.split(".")[0];i.split(".")[0]>r?this.onStart("new version found, go to store to download new app.",!0):(this.onStart("new version found, update process start.",!1),this.updateVersion())}break;default:return}},t.prototype.getUpdateDescription=function(){return""},t.prototype.updateVersion=function(){if(null!=this.assetsManager&&!this.isUpdating)if([jsb.AssetsManager.State.UPDATING,jsb.AssetsManager.State.UNZIPPING,jsb.AssetsManager.State.UP_TO_DATE].indexOf(this.assetsManager.getState())>=0)this.onComplete("no need to update: "+this.assetsManager.getState(),!1);else{if(this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifest.nativeUrl;cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this.assetsManager.loadLocalManifest(e)}this.assetsManager.setEventCallback(this.updateCallback.bind(this)),console.log(" start update ...:",this.assetsManager.getState()),this.assetsManager.update(),this.isUpdating=!0}},t.prototype.versionToInt=function(e){return parseInt(e.toString().split(".").join(""))},t.prototype.versionToString=function(e){return Math.floor(e/100)+"."+Math.floor(e/10)%10+"."+Math.floor(e)%10},t.prototype.updateCallback=function(e){var t=this,o=!1,n=!1,i=null;switch(console.log("update event code:",e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var r=e.getPercent();NaN!=r&&"number"==typeof r||(r=0),this.onProgress(e.getMessage()?"Updated file:"+e.getMessage():"Updating:"+(100*r).toFixed(0)+"%",r);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:i=function(){var e=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Already up to date with the latest remote version :"+e)},n=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:i=function(){var o=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Update finished. new : "+o+e.getMessage(),!0)},o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.onError("Update failed. "+e.getMessage(),!0);break;case jsb.EventAssetsManager.ERROR_UPDATING:this.onError("Asset update error: "+e.getAssetId()+", "+e.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.onError(e.getMessage())}if(n&&(this.assetsManager.setEventCallback(null),this.isUpdating=!1),o){this.assetsManager.setEventCallback(null);var a=jsb.fileUtils.getSearchPaths();console.log("old searchPaths:",a);var s=this.assetsManager.getLocalManifest().getSearchPaths();console.log("new path:",JSON.stringify(s));for(var l=0,c=s;l<c.length;l++){var u=c[l];a.indexOf(u)<0&&Array.prototype.unshift.apply(a,u)}cc.sys.localStorage.setItem("select-game",JSON.stringify(a)),jsb.fileUtils.setSearchPaths(a),console.log("new searchPaths:",JSON.stringify(a)),console.log(" paths storage:",cc.sys.localStorage.getItem("select-game"))}i&&i()},t.prototype.restart=function(){cc.audioEngine.stopAll(),cc.game.restart()},t.prototype.retry=function(){null!=this.assetsManager&&0==this.isUpdating&&this.assetsManager.downloadFailedAssets()},t.prototype.versionCompareHandle=function(e,t){cc.log("JS Custom Version Compare: version A is "+e+", version B is "+t);for(var o=e.split("."),n=t.split("."),i=0;i<o.length;++i){var r=parseInt(o[i]),a=parseInt(n[i]||"0");if(r!==a)return r-a}return n.length>o.length?-1:0},t.prototype.verifyCallback=function(e,t){var o=t.compressed,n=t.md5,i=t.path;t.size;return o?("Verification passed : "+i,!0):("Verification passed : "+i+" ("+n+")",!0)},t.prototype.destory=function(){this.assetsManager&&this.assetsManager.setEventCallback(null),this.startCallback=[],this.completeCallback=[],this.errorCallback=[],this.progressCallback=[]},t=__decorate([r],t)}(n.SingleTon()));o.default=a,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}]},{},["App","CommonSignal","GameStateController","ResourceController","GameFactory","GamePlaySignal","GameLogic","GamePlayModel","PokerModel","PokerParentModel","PokerPositionModel","PokerStateModel","PokerUtil","SolutionChecker","TestView","ArrayAniamtion","DrawAnimation","FireWorkAnimation","HandAnimation","Level2Animation","Level3Animation","RecycleAnimation","RedrawAnimation","SubmitTip","DrawButton","PrefabBaseView","PokerToucher","PokerToucherMediator","Desk","Draw","Ready","Recycle","Removed","PokerFrontView","PokerLockView","PokerPosMediator","PokerPosView","PokerRotationView","PokerScale","PokerSelectedView","PokerSpriteView","PokerStateMediator","PokerStateView","BlackView","CompleteView","HelpButtonView","MenuButtonView","MenuLayerView","MoveCountLabelView","ResultLayerView","RevertButtonView","ScoreLabelView","SoundButtonView","SpecialTutorial","SubmitButtonView","SubmitLayerView","TimeIconView","TimeLabelView","ToturialLayer","GameRule","Level","Theme","InititalCommand","LoadAudioCommand","LoadPrefabCommand","StartGameCommand","InitialFacade","LoadingPageMediator","LoadingView","ThemeView","AudioManager","StepManager","PlayModelProxy","UpdateController","CelerSDK","Cocos","FrameAniBase","HashMap","LogHandler","Random","Signal","Time","ToSingleton","BaseMediator","BaseView","GlobalSingleTouchMediator","GlobalSingleTouchView","HelpLayerMediator","HelpLayerView","NumberChangedView","SingleTouchMediator","SingleTouchView","SliderView","Test","FrontView","TestApp","TestSingleTouchView","TimeEffectAnimation","EaseBaseView","PositionView","RotationView","ScaleView","SkewView"]);