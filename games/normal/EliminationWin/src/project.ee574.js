window.__require=function e(t,o,n){function i(r,l){if(!o[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var c="function"==typeof __require&&__require;if(!l&&c)return c(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}}var u=o[r]={exports:{}};t[r][0].call(u.exports,function(e){return i(t[r][1][e]||e)},u,u.exports,e,t,o,n)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({ActionChecker:[function(e,t,o){"use strict";cc._RF.push(t,"a4228UfC+JNCbbVf9tobGas","ActionChecker"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Controller/GameStateController"),i=e("../../Model/PlayModelProxy"),a=e("../../Utils/HashMap"),r=e("../../Utils/Random"),l=e("../../Utils/Signal"),s=e("../../utils/ToSingleton"),c=e("../Diamond/DiamondPositionView"),u=e("./EliminationChecker"),p=e("./GameLogic"),d=e("./Map/MapType"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.DiamondRePosSignal=h;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.StartRefreshSignal=m;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.RefreshDoneSignal=f;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rainbowCount=0,t.tipIndex=[],t}return __extends(t,e),t.prototype.init=function(){var e=this;i.NextLevelSignal.inst.addListener(function(){e.clearRainbowCount()},this)},t.prototype.showTip=function(){},t.prototype.addRainbow=function(){this.rainbowCount++},t.prototype.reduceRainbow=function(){this.rainbowCount--,this.rainbowCount<0&&(this.rainbowCount=0)},t.prototype.clearRainbowCount=function(){this.rainbowCount=0},t.prototype.checkIsFrozon=function(e){if(this.tipIndex.length=0,this.rainbowCount>0){this.tipIndex[0]=[];for(var t=0,o=e;t<o.length;t++){(r=o[t])&&r.Type==d.DiamondType.Rainbow&&this.tipIndex[0].push(r.Index)}return!1}for(var n={},i=0,a=e;i<a.length;i++){var r;if(r=a[i])for(var l=0,s=d.GetCrossShapeIndex(r.Index,p.GameLogic.inst.IndexStart,p.GameLogic.inst.IndexEnd);l<s.length;l++){var c=s[l];if(!n[r.Index.toString()+"<->"+c.toString()]){var h=e[c];if(h)if(this.getCrossIndexColors(c,r.Index,e).indexOf(r.Color)){n[r.Index.toString()+"<->"+c.toString()]=!0,n[c.toString()+"<->"+r.Index.toString()]=!0;var m=p.GameLogic.inst.checkClear(r,h,!0);if(m&&m.length>0){for(var f=0,y=m;f<y.length;f++){var g=y[f];if([u.EliminationType.DiagonalClear,u.EliminationType.HorizonalClear,u.EliminationType.RainbowClear,u.EliminationType.SquareClear,u.EliminationType.VerticalClear].indexOf(g.type)<0){null==this.tipIndex[g.type]&&(this.tipIndex[g.type]=[]),r.Color==g.color&&this.tipIndex[g.type].push(r.Index),h.Color==g.color&&this.tipIndex[g.type].push(h.Index);for(var S=0,M=g.indexList;S<M.length;S++){var _=M[S];e[_]&&e[_].Color==g.color&&this.tipIndex[g.type].push(_)}}}return!1}}}}}return!0},t.prototype.checkIsClear=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t];if(n){var i=p.GameLogic.inst.checkClear(n,n,!0);if(i&&i.length>0)return!0}}return!1},t.prototype.getCrossIndexColors=function(e,t,o){for(var n=[],i=0,a=d.GetCrossShapeIndex(e,p.GameLogic.inst.IndexStart,p.GameLogic.inst.IndexEnd);i<a.length;i++){var r=a[i];if(r!=t){var l=o[r];l&&n.push(l.Color)}}return n},t.prototype.refreshMap=function(e){m.inst.dispatch();var t=Date.now();this.randomMap(e),console.log(" Map random cost ",Date.now()-t," ms"),n.GameStateController.inst.pause(!0),h.inst.dispatch(),setTimeout(function(){n.GameStateController.inst.resume(),f.inst.dispatch()},1e3*c.MapTime)},t.prototype.randomMap=function(e){for(var t=[],o=new a.HashMap,n=!0,l=!1,s=p.GameLogic.inst.IndexStart;s<p.GameLogic.inst.IndexEnd;s++){(C=e[s])&&(t.push(C.Index),o.has(C.Color)?o.get(C.Color).push(C):o.add(C.Color,[C]))}for(var c=0,h=t;c<h.length;c++){e[s=h[c]]=null}for(var m=0,f=0,y=t;f<y.length;f++){s=y[f];var g=o.keys.concat(),S=u.EliminationChecker.inst.getSkipColor(s,e,i.PlayModelProxy.inst.Level,i.PlayModelProxy.inst.Level,!0);if(S.length>0){for(var M=0;M<g.length;M++)S.indexOf(g[M])>=0&&(g.splice(M,1),M--);g.length<=0&&(l=!0,g=o.keys.concat())}for(var _=null;g.length>0;)if(_=g.splice(r.Random.randomFloorToInt(0,g.length),1)[0],0==o.has(_)||o.get(_).length<=0)o.remove(_);else{var C=o.get(_)[0];e[s]=C;var v=C.Index;C.Index=s;var T=!1;if(n)for(var b=0,P=d.GetCrossShapeIndex(s,p.GameLogic.inst.IndexStart,p.GameLogic.inst.IndexEnd);b<P.length;b++){var R=P[b];if(t.indexOf(R)>=0&&e[R]&&p.GameLogic.inst.checkClear(C,e[R],!0).length>0){n=!1,e[s]=null,C.Index=v,T=!0;break}}if(e[s]=null,C.Index=v,T)break;if(0==n||l)break}if(null==_||0==o.has(_)||o.get(_).length<=0)console.error(" cant find model by color:",_,d.DiamondColor[_],", index:",s);else{m++;C=o.get(_).pop();o.get(_).length<=0&&o.remove(_),e[s]=C,C.Index=s}}m<t.length&&console.error(" diamond miss when random map.",m,t.length),l&&this.randomMap(e)},Object.defineProperty(t.prototype,"TipIndex",{get:function(){for(var e=0,t=[u.EliminationType.Normal3,u.EliminationType.Merge4,u.EliminationType.Word,u.EliminationType.Rainbow,u.EliminationType.Peacock];e<t.length;e++){var o=t[e];if(this.tipIndex[o]&&this.tipIndex[o].length>0)return this.tipIndex[o]}return[]},enumerable:!0,configurable:!0}),t}(s.SingleTon());o.ActionChecker=y,cc._RF.pop()},{"../../Controller/GameStateController":"GameStateController","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../../utils/ToSingleton":"ToSingleton","../Diamond/DiamondPositionView":"DiamondPositionView","./EliminationChecker":"EliminationChecker","./GameLogic":"GameLogic","./Map/MapType":"MapType"}],AdController:[function(e,t,o){"use strict";cc._RF.push(t,"dbb04KnQ3hLBaByYwTfX2Cv","AdController"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasBind=!1,t.finishCallback={},t.failedCallback={},t.adCount=0,t.msgMap={},t.volume=0,t}return __extends(t,e),t.prototype.showAd=function(e,t,o){var n=this;0==this.hasBind&&this.bindCallback();var i=e+this.adCount;if(this.msgMap[i]=e,null==this.finishCallback[i]&&(this.finishCallback[i]=[]),this.finishCallback[i].push(t),null==this.failedCallback[i]&&(this.failedCallback[i]=[]),this.failedCallback[i].push(o),CELER_X)celerSDK.showAd(i);else if(cc.director.getScene()&&cc.director.getScene().getChildByName("Canvas")){var a=cc.director.getScene().getChildByName("Canvas");if(a.getChildByName("adNode"))return;var r=new cc.Node("adNode"),l=r.addComponent(cc.VideoPlayer);l.remoteURL="https://vicat.wang/GameRes/catcatcat.mp4",a.width=1464,a.height=2400,a.addChild(r),r.setPosition(0,0),this.volume=cc.audioEngine.getMusicVolume(),cc.audioEngine.setMusicVolume(0),l.node.on("ready-to-play",function(){console.log("ready-to-play"),r.width=1080,r.height=1920,l.play()},this),l.node.on("meta-loaded",function(){console.log("meta-loaded")},this),l.node.on("clicked",function(){if(console.log("clicked"),r.pauseCount++,r.pauseCount>=5){for(var e=document.getElementsByClassName("cocosVideo"),t=0;t<e.length;t++){var o=e.item(t);o&&o.remove()}setTimeout(function(){r.removeFromParent(!0),r.destroy(),n.onAddFaild(i)},0)}},this),l.node.on("playing",function(){console.log("playing")},this),r.pauseCount=0,l.node.on("paused",function(){if(console.log("paused"),r.pauseCount++,r.pauseCount>=5){for(var e=document.getElementsByClassName("cocosVideo"),t=0;t<e.length;t++){var o=e.item(t);o&&o.remove()}setTimeout(function(){r.removeFromParent(!0),r.destroy(),n.onAddFaild(i)},0)}},this),l.node.on("stopped",function(){console.log("stopped")},this),l.node.on("completed",function(){console.log("completed"),l.stop();for(var e=document.getElementsByClassName("cocosVideo"),t=0;t<e.length;t++){var o=e.item(t);o&&o.remove()}setTimeout(function(){r.removeFromParent(!0),r.destroy(),n.onAdFinish(i)},0)},this)}this.adCount++,console.log(" request ad:",i)},t.prototype.bindCallback=function(){this.hasBind=!0,CELER_X&&(celerSDK.onAdPlayFailed(this.onAddFaild.bind(this)),celerSDK.onAdPlayFinished(this.onAdFinish.bind(this)))},t.prototype.onAdFinish=function(e){if(this.finishCallback[e]){for(var t=0,o=this.finishCallback[e];t<o.length;t++){(0,o[t])(this.msgMap[e])}this.finishCallback[e]=null,this.failedCallback[e]=null,this.msgMap[e]=null}CELER_X||cc.audioEngine.setMusicVolume(this.volume)},t.prototype.onAddFaild=function(e){if(this.failedCallback[e]){for(var t=0,o=this.failedCallback[e];t<o.length;t++){(0,o[t])(this.msgMap[e])}this.failedCallback[e]=null,this.finishCallback[e]=null,this.msgMap[e]=null}CELER_X||cc.audioEngine.setMusicVolume(this.volume)},t}(e("../utils/ToSingleton").SingleTon());o.AdController=n,cc._RF.pop()},{"../utils/ToSingleton":"ToSingleton"}],AdLayer:[function(e,t,o){"use strict";cc._RF.push(t,"67391QyhbBGnpPQUpvrThZw","AdLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../Controller/AdController"),a=e("../Controller/GameStateController"),r=e("../table"),l=e("../Utils/Signal"),s=e("./FlyCnicornAd"),c=e("./WildAdButton"),u=cc._decorator,p=u.ccclass,d=u.property,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.AdFinishSignal=h,function(e){e[e.Cnicorn=0]="Cnicorn",e[e.Sun=1]="Sun"}(n=o.AdType||(o.AdType={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AdAtlas=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Panel",{get:function(){return this.node.getChildByName("NormalPanel")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WatchAd",{get:function(){return this.Panel.getChildByName("btn_get")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BackToGame",{get:function(){return this.Panel.getChildByName("btn_back")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content",{get:function(){return this.Panel.getChildByName("Content").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.Panel.getChildByName("bg_title_freeprop").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FailTip",{get:function(){return this.node.getChildByName("FailTip")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FailTipLabel",{get:function(){return this.FailTip.getChildByName("Label").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.node.active=!1,this.node.scale=1,c.WildAdButtonClick.inst.addListener(function(){e.Show(n.Sun)},this),s.FlyCnicornClickSignal.inst.addListener(function(){e.Show(n.Cnicorn)},this),this.BackToGame.on(cc.Node.EventType.TOUCH_END,function(){setTimeout(function(){e.node.active=!1,a.GameStateController.inst.resume(),s.default.ShowTimeRest=10},0)},this)},t.prototype.onAdFinish=function(e){var t=this;h.inst.dispatchOne(e),e==n[n.Sun]?CELER_X&&c.HideWildAdButtonSignal.inst.dispatch():CELER_X&&s.RemoveFlyCnicornSignal.inst.dispatch(),setTimeout(function(){t.node.active=!1,a.GameStateController.inst.resume()},0)},t.prototype.onAdFailed=function(e){var t=this;this.FailTip.active=!0,this.Panel.active=!1,e==n[n.Cnicorn]&&s.CnicornWatchFailSignal.inst.dispatch(),setTimeout(function(){t.node.active=!1,a.GameStateController.inst.resume()},2e3)},t.prototype.Show=function(e){var t=this;1!=this.node.active&&(a.GameStateController.inst.pause(!0),this.node.active=!0,this.FailTip.active=!1,this.Panel.active=!0,this.WatchAd.active=!0,this.FailTipLabel.string=lan.t(r.En_View.GuangGaoJieMian,r.En_ID.KanGuangGaoShiBai),e==n.Sun?(this.Title.spriteFrame=this.AdAtlas.getSpriteFrame("font_free"),this.WatchAd.getComponent(cc.Sprite).spriteFrame=this.AdAtlas.getSpriteFrame("btn_getprop"),this.Content.string=lan.t(r.En_View.GuangGaoJieMian,r.En_ID.JiangLiCaiHongBaoShi)):(this.Title.spriteFrame=this.AdAtlas.getSpriteFrame("font_add"),this.WatchAd.getComponent(cc.Sprite).spriteFrame=this.AdAtlas.getSpriteFrame("btn_addmoves"),this.Content.string=lan.t(r.En_View.GuangGaoJieMian,r.En_ID.JiangLiBuShu,["3"])),this.WatchAd.targetOff(this),this.WatchAd.once(cc.Node.EventType.TOUCH_END,function(){setTimeout(function(){t.WatchAd.active=!1},0),i.AdController.inst.showAd(n[e],function(e){console.log(" watch ad success:",e),t.onAdFinish(e)},function(e){console.log(" watch ad fail:",e),t.onAdFailed(e)})},this))},__decorate([d(cc.SpriteAtlas)],t.prototype,"AdAtlas",void 0),t=__decorate([p],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../Controller/AdController":"AdController","../Controller/GameStateController":"GameStateController","../Utils/Signal":"Signal","../table":"table","./FlyCnicornAd":"FlyCnicornAd","./WildAdButton":"WildAdButton"}],AdaptationWigetView:[function(e,t,o){"use strict";cc._RF.push(t,"4e5d6A0aNBHr7pctNWh6pyy","AdaptationWigetView"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=cc._decorator,a=i.ccclass,r=i.property;(function(e){e[e.Top=0]="Top",e[e.TopLeft=1]="TopLeft",e[e.TopRight=2]="TopRight",e[e.Bottom=3]="Bottom",e[e.BotLeft=4]="BotLeft",e[e.BotRight=5]="BotRight",e[e.Left=6]="Left",e[e.Right=7]="Right",e[e.Center=8]="Center"})(n=o.AlignType||(o.AlignType={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alignType=n.Center,t}return __extends(t,e),t.prototype.onLoad=function(){cc.sys.isMobile?window.addEventListener("resize",this.onResize.bind(this)):cc.view.on("canvas-resize",this.onResize,this),this.onResize()},t.prototype.onResize=function(){switch(this.alignType){case n.Top:this.alignTop();break;case n.TopLeft:this.alignTopLeft();break;case n.TopRight:this.alignTopRight();break;case n.Bottom:this.alignBottom();break;case n.BotLeft:this.alignBotLeft();break;case n.BotRight:this.alignBotRight();break;case n.Left:this.alignLeft();break;case n.Right:this.alignRight();break;case n.Center:this.alignCenter()}},t.prototype.alignTop=function(){var e=cc.view.getCanvasSize();this.node.anchorX=.5,this.node.anchorY=1,this.node.setPosition(this.LocalZero.add(cc.v2(e.width/this.UseRatio/2,e.height/this.UseRatio)))},t.prototype.alignTopLeft=function(){var e=cc.view.getCanvasSize();this.node.anchorX=0,this.node.anchorY=1,this.node.setPosition(this.LocalZero.add(cc.v2(0,e.height/this.UseRatio)))},t.prototype.alignTopRight=function(){var e=cc.view.getCanvasSize();this.node.anchorX=1,this.node.anchorY=1,this.node.setPosition(this.LocalZero.add(cc.v2(e.width/this.UseRatio,e.height/this.UseRatio)))},t.prototype.alignBottom=function(){var e=cc.view.getCanvasSize();this.node.anchorX=.5,this.node.anchorY=0,this.node.setPosition(this.LocalZero.add(cc.v2(e.width/this.UseRatio/2,0)))},t.prototype.alignBotLeft=function(){this.node.anchorX=0,this.node.anchorY=0,this.node.setPosition(this.LocalZero)},t.prototype.alignBotRight=function(){var e=cc.view.getCanvasSize();this.node.anchorX=1,this.node.anchorY=0,this.node.setPosition(this.LocalZero.add(cc.v2(e.width/this.UseRatio,0)))},t.prototype.alignLeft=function(){},t.prototype.alignRight=function(){},t.prototype.alignCenter=function(){},Object.defineProperty(t.prototype,"UseRatio",{get:function(){var e=cc.view.getCanvasSize(),t=cc.view.getDesignResolutionSize(),o=e.width/t.width,n=e.height/t.height;return Math.min(o,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LocalZero",{get:function(){var e=cc.view.getCanvasSize(),t=cc.view.getDesignResolutionSize(),o=e.width/t.width,n=e.height/t.height,i=Math.min(o,n),a=cc.v2(0,0);return a=o<n?cc.v2(0,-(e.height/i-t.height)/2):o>n?cc.v2(-(e.width/i-t.width)/2,0):cc.v2(0,0),this.node.parent.convertToNodeSpaceAR(a)},enumerable:!0,configurable:!0}),__decorate([r({type:cc.Enum(n)})],t.prototype,"alignType",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],App:[function(e,t,o){"use strict";cc._RF.push(t,"eaeeaWDD5pJfqkUameEwNsk","App"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Controller/ResourceController"),i=e("../GameRecorder/GameRecorder"),a=e("../Initialization/Facade/InitialFacade"),r=e("../Model/PlayModelProxy"),l=e("../Utils/HashMap"),s=cc._decorator,c=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UI=null,t.PauseUI=null,t.ResultUI=null,t.UIAnimation=null,t.GamePlayAnimation=null,t.Add=null,t.Sub=null,t.ShowScore=null,t.TimeRed=null,t.TimeWhite=null,t.Result=null,t}return __extends(t,e),t.prototype.onLoad=function(){console.log(" app onload "),this.UI&&n.ResourceController.inst.setAtlas(this.UI),this.PauseUI&&n.ResourceController.inst.setPauseAtlas(this.PauseUI),this.ResultUI&&n.ResourceController.inst.setResultAtlas(this.ResultUI),this.Result&&n.ResourceController.inst.setFont(n.Font.ResultScore,this.Result),this.Add&&n.ResourceController.inst.setFont(n.Font.AddScore,this.Add),this.Sub&&n.ResourceController.inst.setFont(n.Font.SubScore,this.Sub),this.ShowScore&&n.ResourceController.inst.setFont(n.Font.ShowScore,this.ShowScore),this.TimeRed&&n.ResourceController.inst.setFont(n.Font.TimeRed,this.TimeRed),this.TimeWhite&&n.ResourceController.inst.setFont(n.Font.TimeWhite,this.TimeWhite),this.UIAnimation&&n.ResourceController.inst.pushAnimationAtlas(n.AnimationType.UI,this.UIAnimation),this.GamePlayAnimation&&n.ResourceController.inst.pushAnimationAtlas(n.AnimationType.GamePlay,this.GamePlayAnimation),cc.game.setFrameRate(60),cc.debug.setDisplayStats(!CELER_X)},t.prototype.start=function(){i.GameRecorder.inst.init(),a.InitialFacade.inst.start()},t.prototype.update=function(e){r.PlayModelProxy.inst.addGameTime(-e)},t.TuneMatchMap=new l.HashMap,t.TuneRootMap=new l.HashMap,__decorate([u(cc.SpriteAtlas)],t.prototype,"UI",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"PauseUI",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"ResultUI",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"UIAnimation",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"GamePlayAnimation",void 0),__decorate([u(cc.Font)],t.prototype,"Add",void 0),__decorate([u(cc.Font)],t.prototype,"Sub",void 0),__decorate([u(cc.Font)],t.prototype,"ShowScore",void 0),__decorate([u(cc.Font)],t.prototype,"TimeRed",void 0),__decorate([u(cc.Font)],t.prototype,"TimeWhite",void 0),__decorate([u(cc.Font)],t.prototype,"Result",void 0),t=__decorate([c],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../Controller/ResourceController":"ResourceController","../GameRecorder/GameRecorder":"GameRecorder","../Initialization/Facade/InitialFacade":"InitialFacade","../Model/PlayModelProxy":"PlayModelProxy","../Utils/HashMap":"HashMap"}],AudioManager:[function(e,t,o){"use strict";cc._RF.push(t,"88c70Ktw0pBKKUTDtyQ2NkZ","AudioManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=e("../Command/CommonSignal"),a=e("../Controller/GameStateController"),r=e("../Utils/ToSingleton"),l=e("../Model/PlayModelProxy"),s=e("../GamePlay/Model/GameLogic"),c=e("../GamePlay/Model/DiamondModel"),u=e("../GamePlay/Model/GamePlayModel"),p=e("../GamePlay/View/Animation/Root/MergeRoot"),d=(e("../GamePlay/Model/Map/MapType"),e("../GamePlay/Model/BlockModel")),h=e("../GamePlay/View/UI/MoveFlyAnimation"),m=e("../GamePlay/View/UI/ResultLayerView"),f=e("../GamePlay/View/Animation/Root/LineRoot"),y=e("../GamePlay/View/Animation/Root/ComboWordRoot"),g=e("../GamePlay/Model/EliminationChecker");window.oncanplay&&(window.oncanplay=function(){_.canPlay=!0});var S="sounds/",M=100,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioID={},t.effectCount=0,t.clips=new n.HashMap,t.effectVolumeScale=1,t.musicVolumeScale=.8,t}return __extends(t,e),Object.defineProperty(t.prototype,"EffectCount",{get:function(){return this.effectCount},set:function(e){this.effectCount=e,this.effectCount=Math.max(0,this.effectCount)},enumerable:!0,configurable:!0}),t.prototype.init=function(e){var t=this;console.log(" start load AudioClip ");var o=this;cc.loader.loadRes(S+"bgm",cc.AudioClip,function(t,n){t?console.error(t):("string"==typeof n._audio&&cc.loader._cache&&cc.loader._cache[n._audio]&&cc.loader._cache[n._audio].buffer&&(n._audio=cc.loader._cache[n._audio].buffer),o.clips.add(n.name,n),e&&e(),o.playMusic("bgm",!0))}),cc.loader.loadResDir(S,function(e,o,n){if(e)console.error(e);else for(var i=0,a=o;i<a.length;i++){var r=a[i];"string"==typeof r._audio&&cc.loader._cache&&cc.loader._cache[r._audio]&&cc.loader._cache[r._audio].buffer&&(r._audio=cc.loader._cache[r._audio].buffer),t.clips.has(r.name)||t.clips.add(r.name,r)}}),this.bindSignal()},t.prototype.setEffectVolume=function(e){this.effectVolumeScale=1,cc.audioEngine.setEffectsVolume(e*this.effectVolumeScale)},t.prototype.setMusicVolume=function(e){this.musicVolumeScale=1,cc.audioEngine.setMusicVolume(e*this.musicVolumeScale)},Object.defineProperty(t.prototype,"EffectVolume",{get:function(){return cc.audioEngine.getEffectsVolume()/this.effectVolumeScale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MusicVolume",{get:function(){return cc.audioEngine.getMusicVolume()/this.musicVolumeScale},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){var e=this;this.setEffectVolume(1),this.setMusicVolume(1),i.UpdateTimeNumber.inst.addListenerOne(function(t){if(t>=30){if(cc.audioEngine.getState(e.audioID.bgm)==cc.audioEngine.AudioState.PLAYING)return;e.playMusic("bgm",!0)}else{if(cc.audioEngine.getState(e.audioID.bgm_30)==cc.audioEngine.AudioState.PLAYING)return;e.playMusic("bgm_30",!0)}},this),y.ShowComboWordSignal.inst.addListener(function(){if(s.GameLogic.inst.Combo<3);else switch(s.GameLogic.inst.Combo){case 3:e.playEffect("Great");break;case 4:e.playEffect("Wonderful");break;case 5:e.playEffect("Amazing");break;case 6:e.playEffect("Excellent");break;case 7:e.playEffect("Unbelievable b")}},this),l.StartCountSignal.inst.addListener(function(){e.playEffect("start_count")},this),i.ScoreCountingSignal.inst.addListener(function(){e.audioID.scoreCount||(M=0,e.playEffect("scoreCount",!1,function(){e.audioID.scoreCount=null}))},this),i.ShowSubmitSignal.inst.addListener(function(){e.audioID.scoreCount&&cc.audioEngine.stopEffect(e.audioID.scoreCount),e.playEffect("showSubmit")},this),i.OpenResultLayerSignal.inst.addListenerOne(function(t){t==a.RoundEndType.TimeUp?e.playEffect("show_result"):(a.RoundEndType.Complete,e.playEffect("show_result"))},this),m.PlayResultAnimationSignal.inst.addListener(function(){e.playEffect("result_animation")},this),i.PlayerScoreChanged.inst.addListenerThree(function(e,t,o){},this),s.PlayEliminationSignal.inst.addListenerOne(function(t){switch(t){case g.EliminationType.Normal3:e.playEffect("clear");break;case g.EliminationType.HorizonalClear:case g.EliminationType.VerticalClear:case g.EliminationType.DiagonalClear:case g.EliminationType.SquareClear:case g.EliminationType.PeacokClear:e.playEffect("merge_rainbow");break;case g.EliminationType.RainbowClear:e.playEffect("rainbow_break")}},this),f.PlayLineEffectSignal.inst.addListener(function(){},this),h.MoveFlySignal.inst.addListener(function(){e.playEffect("move_fly")},this),l.NextLevelSignal.inst.addListenerOne(function(e){},this),d.BlockLifeUpdateSignal.inst.addListenerTwo(function(t,o){setTimeout(function(o){t&&e.playEffect("block_life"+o)},o,t.Life)},this),s.ClearFailedSignal.inst.addListener(function(){e.playEffect("swapFail")},this),c.DiamondRemovedSignal.inst.addListener(function(){},this),u.GoldShowUpSignal.inst.addListener(function(){},this),p.OnDiamonMergeSignal.inst.addListenerOne(function(t){e.playEffect("merge_peacok")},this),s.AddMoveSignal.inst.addListener(function(){e.playEffect("merge")},this),u.GoldCountUpdateSignal.inst.addListenerOne(function(t){0!=t&&e.playEffect("clear_combo7")},this),i.ButtonClickSignal.inst.addListener(function(){e.playEffect("click")},this),i.CountDownSignal.inst.addListener(function(){e.playEffect("countDown")},this),i.GameOverSignal.inst.addListenerOne(function(t){switch(e.effectCount=0,t){case a.RoundEndType.Complete:e.playEffect("complete");break;case a.RoundEndType.TimeUp:e.playEffect("timeup");break;case a.RoundEndType.Over:default:e.playEffect("over")}},this)},t.prototype.playEffect=function(e,o,n){var i=this;if(void 0===o&&(o=!1),t.canPlay){if(!(this.effectCount>=15||M>0&&null!=this.audioID[e]||cc.audioEngine.getEffectsVolume()<=.05)){var a=this.clips.get(e);a?(this.audioID[e]=cc.audioEngine.playEffect(a,o),this.EffectCount++,cc.audioEngine.setFinishCallback(this.audioID[e],function(){i.audioID[e]=null,i.EffectCount--,n&&n()}),M>0&&setTimeout(function(){i.audioID[e]=null},M)):cc.loader.loadRes(S+e,cc.AudioClip,function(t,a){t?console.error(t):("string"==typeof a._audio&&cc.loader._cache&&cc.loader._cache[a._audio]&&cc.loader._cache[a._audio].buffer&&(a._audio=cc.loader._cache[a._audio].buffer),i.clips.add(a.name,a),i.audioID[e]=cc.audioEngine.playEffect(a,o),i.EffectCount++,cc.audioEngine.setFinishCallback(i.audioID[e],function(){n&&n(),i.audioID[e]=null,i.EffectCount--}),M>0&&setTimeout(function(){i.audioID[e]=null},M))})}}else this.bindTouch()},t.prototype.playMusic=function(e,o){var n=this;if(void 0===o&&(o=!0),!t.canPlay)return this.bindTouch(),void t.PlayedList.push({loop:!0,volume:1,clipName:e,supTime:Date.now(),skip:!1,isBgm:!0});var i=this.clips.get(e);i?this.audioID[e]=cc.audioEngine.playMusic(i,o):cc.loader.loadRes(S+e,cc.AudioClip,function(t,i){t?console.error(t):("string"==typeof i._audio&&cc.loader._cache&&cc.loader._cache[i._audio]&&cc.loader._cache[i._audio].buffer&&(i._audio=cc.loader._cache[i._audio].buffer),n.clips.add(i.name,i),n.audioID[e]=cc.audioEngine.playMusic(i,o))})},t.prototype.bindTouch=function(){if(!t.hasBindTouch){var e=this,o=function(){var n;for(cc.game.canvas.removeEventListener("touchstart",o),t.canPlay=!0;(n=t.PlayedList.pop())&&e.clips.get(n.clipName)&&!n.skip;)cc.audioEngine.playMusic(e.clips.get(n.clipName),n.loop)};t.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",o)}},t.PlayedList=[],t.canPlay=cc.sys.WIN32==cc.sys.platform,t.hasBindTouch=!1,t}(r.SingleTon());o.gAudio=_.inst,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","../GamePlay/Model/BlockModel":"BlockModel","../GamePlay/Model/DiamondModel":"DiamondModel","../GamePlay/Model/EliminationChecker":"EliminationChecker","../GamePlay/Model/GameLogic":"GameLogic","../GamePlay/Model/GamePlayModel":"GamePlayModel","../GamePlay/Model/Map/MapType":"MapType","../GamePlay/View/Animation/Root/ComboWordRoot":"ComboWordRoot","../GamePlay/View/Animation/Root/LineRoot":"LineRoot","../GamePlay/View/Animation/Root/MergeRoot":"MergeRoot","../GamePlay/View/UI/MoveFlyAnimation":"MoveFlyAnimation","../GamePlay/View/UI/ResultLayerView":"ResultLayerView","../Model/PlayModelProxy":"PlayModelProxy","../Utils/HashMap":"HashMap","../Utils/ToSingleton":"ToSingleton"}],BaseMediator:[function(e,t,o){"use strict";cc._RF.push(t,"a76c1ySm3tAQId4zbAsdr/d","BaseMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){console.error(" should override onRegister ")},t.prototype.onUnregister=function(){console.error(" should override onUnregister ")},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"6daedF7tVNJ3qN565kuohVZ","BaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=0},t.prototype.Show=function(e){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()})))},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.active=!1,e&&e()})))},t.prototype.OnClick=function(){},t.prototype.BindMedaitor=function(e){if(!this.node.getComponent(e)){var t=this.node.addComponent(e);return t.bind&&t.bind(this),t.onRegister&&t.onRegister(),t}console.warn(" this node already has the same component..")},t.prototype.UnbindMedaitor=function(e){var t=this.node.getComponent(e);if(t)return t.onUnregister&&t.onUnregister(),t.bind&&t.bind(null),this.node.removeComponent(e),t;console.warn(" component already removed..")},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],BlackView:[function(e,t,o){"use strict";cc._RF.push(t,"f7137KIFk5HzYzsbeidU/gx","BlackView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.GameOverSignal.inst.addListenerOne(function(t){t!=i.RoundEndType.Complete&&(e.node.active=!0)},this),this.node.active=!1},t.prototype.start=function(){},t=__decorate([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController"}],BlockIconUtil:[function(e,t,o){"use strict";var n,i,a,r,l;cc._RF.push(t,"b77f4AiqNlDKZs7Tf3g7jOz","BlockIconUtil"),Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../Controller/ResourceController"),c=e("../../Global/Theme"),u=e("../../Model/PlayModelProxy"),p=e("../../Utils/Random"),d=e("../Model/Map/MapType"),h=((n={})[c.Theme.Stone]={1:["bg_mud1","bg_mud2","bg_mud3","bg_mud4"],2:["bg_leaf1","bg_leaf2","bg_stone1","bg_stone2"]},n[c.Theme.Wood]={1:["bg_mud1","bg_mud2","bg_mud3","bg_mud4"],2:["bg_leaf1","bg_leaf2","bg_wood1","bg_wood2"]},n),m=((i={})[d.MapType.Grass]=((a={})[c.Theme.Stone]={1:["bg_mudgold1","bg_mudgold2"],2:["bg_leaf1","bg_leaf2"]},a[c.Theme.Wood]={1:["bg_mudgold1","bg_mudgold2"],2:["bg_leaf1","bg_leaf2"]},a),i[d.MapType.Stone]=((r={})[c.Theme.Stone]={1:["bg_mudgold1","bg_mudgold2"],2:["bg_stone1","bg_stone2"]},r[c.Theme.Wood]={1:["bg_mudgold1","bg_mudgold2"],2:["bg_wood1","bg_wood2"]},r),i[d.MapType.Soil]=((l={})[c.Theme.Stone]={1:["bg_mudgold1","bg_mudgold2"],2:["bg_leaf1","bg_leaf2"]},l[c.Theme.Wood]={1:["bg_mudgold1","bg_mudgold2"],2:["bg_leaf1","bg_leaf2"]},l),i);o.GetBlockIcon=function(e,t,o){if(t>2||t<1)return null;var n=[];return n=e>0?m[o][u.PlayModelProxy.inst.Theme][t]:h[u.PlayModelProxy.inst.Theme][t],s.ResourceController.inst.getAltas(n[p.Random.randomFloorToInt(0,n.length)])},cc._RF.pop()},{"../../Controller/ResourceController":"ResourceController","../../Global/Theme":"Theme","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Random":"Random","../Model/Map/MapType":"MapType"}],BlockIconView:[function(e,t,o){"use strict";cc._RF.push(t,"a8d8dNdlXVDza7y2ujGGLjz","BlockIconView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=e("../../Model/PlayModelProxy"),a=e("../Model/BlockModel"),r=e("../View/Game/PrefabBaseView"),l=e("./BlockIconUtil"),s=cc._decorator,c=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"LifeRoot",{get:function(){return this.node.getChildByName("Life")},enumerable:!0,configurable:!0}),t.prototype.onReuse=function(){this.initLifeIcon()},t.prototype.onUnuse=function(){this.model=null},t.prototype.initLifeIcon=function(){this.node.zIndex=0;for(var e=0,t=this.LifeRoot.children;e<t.length;e++){var o=t[e],n=parseInt(o.name);o.active=n<=this.model.Life,o.opacity=255,o.getComponent(cc.Sprite).spriteFrame=l.GetBlockIcon(this.model.GoldCount,n,this.model.Type)}},t.prototype.onLoad=function(){var e=this;a.BlockDestroySignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t.ID&&n.gFactory.putObj("Block",e.node)},this),a.BlockRemovedSignal.inst.addListenerThree(function(t,o,a){if(e.model&&e.model.ID==t){if(e.model.GoldCount>0&&o){var r=e.model.Index;setTimeout(function(){i.PlayModelProxy.inst.Model.addGoldCount(r)},a)}setTimeout(function(){n.gFactory.putObj("Block",e.node)},a)}},this),a.BlockLifeUpdateSignal.inst.addListenerTwo(this.onLifeChanged,this)},t.prototype.onLifeChanged=function(e,t){var o=this;this.model&&this.model.ID==e.ID&&setTimeout(function(){if(o.model)for(var e=0,t=o.LifeRoot.children;e<t.length;e++){var n=t[e],i=parseInt(n.name);n.active=i<=o.model.Life}},t)},t.prototype.updateZIndex=function(){},t=__decorate([c],t)}(r.default));o.default=u,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../../Model/PlayModelProxy":"PlayModelProxy","../Model/BlockModel":"BlockModel","../View/Game/PrefabBaseView":"PrefabBaseView","./BlockIconUtil":"BlockIconUtil"}],BlockMapRoot:[function(e,t,o){"use strict";cc._RF.push(t,"673baplHHBEG5cPqv2rq9Fb","BlockMapRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Factory/GameFactory"),i=e("../../Block/BlockIconView"),a=e("../../Model/BlockModel"),r=e("../../Model/Map/MapType"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){a.BlockCreateSignal.inst.addListenerOne(this.onBlockCreated,this)},t.prototype.onBlockCreated=function(e){var t=n.gFactory.getObj("Block",e),o=r.GetPosByIndex(e.Index);t.setPosition(o),this.node.addChild(t,e.Type==r.MapType.Soil?0:1),t.getComponent(i.default).updateZIndex()},t=__decorate([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../Factory/GameFactory":"GameFactory","../../Block/BlockIconView":"BlockIconView","../../Model/BlockModel":"BlockModel","../../Model/Map/MapType":"MapType"}],BlockModel:[function(e,t,o){"use strict";cc._RF.push(t,"25c21sjQDZEk4ziP+9+SKaZ","BlockModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Global/GameRule"),i=e("../../Model/PlayModelProxy"),a=e("../../Utils/HashMap"),r=e("../../Utils/Signal"),l=e("./GamePlayModel"),s=e("./Map/MapType"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.BlockRemovedSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.BlockLifeUpdateSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.BlockCreateSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.BlockDestroySignal=d;var h=function(){function e(t,o,n,i){this.id="",this.goldCount=0,this.life=0,this.index=0,this.type=null,e.objCount++,this.id="Block:"+e.objCount+":life:"+t+":gold:"+o+":index:"+n+":type:",s.MapType[i],this.life=t,this.index=n,this.goldCount=o,this.type=i,e.BlockMap.add(this.id,this)}return e.getBlockByID=function(e){return 0==this.BlockMap.has(e)?(console.error(" block not exist:",e),null):this.BlockMap.get(e)},e.createBlock=function(t,o,n,i){var a=new e(t,o,n,i);return p.inst.dispatchOne(a),a},Object.defineProperty(e.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Life",{get:function(){return this.life},enumerable:!0,configurable:!0}),e.prototype.setLife=function(e,t){this.life!=e&&(e<this.life&&(this.life>=2?i.PlayModelProxy.inst.Model.addPlayerScore(n.GetScoreByType(l.ScoreType.StoneAttack),l.ScoreType.StoneAttack,1,this.index):this.goldCount>0?i.PlayModelProxy.inst.Model.addPlayerScore(n.GetScoreByType(l.ScoreType.GoldAttack),l.ScoreType.GoldAttack,1,this.index):i.PlayModelProxy.inst.Model.addPlayerScore(n.GetScoreByType(l.ScoreType.BlockAttack),l.ScoreType.BlockAttack,1,this.index)),this.life=e,u.inst.dispatchTwo(this,t))},Object.defineProperty(e.prototype,"GoldCount",{get:function(){return this.goldCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Index",{get:function(){return this.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),e.prototype.removeSelf=function(t,o){void 0===t&&(t=!0),void 0===o&&(o=0),c.inst.dispatchThree(this.ID,t,o),e.BlockMap.remove(this.ID)},e.prototype.destroy=function(){d.inst.dispatchOne(this),e.BlockMap.remove(this.ID)},e.objCount=0,e.BlockMap=new a.HashMap,e}();o.BlockModel=h,cc._RF.pop()},{"../../Global/GameRule":"GameRule","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/HashMap":"HashMap","../../Utils/Signal":"Signal","./GamePlayModel":"GamePlayModel","./Map/MapType":"MapType"}],BlockRoot:[function(e,t,o){"use strict";cc._RF.push(t,"3721f2TGC1KJrAzHlRHIZse","BlockRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../../Utils/Signal"),a=e("../../../Model/BlockModel"),r=e("../../../Model/Map/MapType"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.PlayBlockBreakSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){a.BlockLifeUpdateSignal.inst.addListenerTwo(this.onBlockBreak,this)},t.prototype.onBlockBreak=function(e,t){var o=this;void 0===t&&(t=0),setTimeout(function(e,t){var i=n.gFactory.getObj("Effect",e.ID);i.setPosition(r.GetPosByIndex(e.Index)),o.node.addChild(i,e.Life),c.inst.dispatchTwo(e,t)},t,e,e.Life)},t=__decorate([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../../Utils/Signal":"Signal","../../../Model/BlockModel":"BlockModel","../../../Model/Map/MapType":"MapType"}],Box:[function(e,t,o){"use strict";cc._RF.push(t,"ce3e0iVD1ZOK5me0Qu+b4t2","Box"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/Map/MapType"),i=e("./Cell"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.setMap=function(e,t,o){console.log("Box level:",t);for(var a=0;a<e.length;a++)for(var r=e[a],l=this.node.children[a],s=0;s<r.length;s++){var c=r[s],u=l.children[s];u.active=c!=n.MapType.Empty,u.getComponent(i.default).setPos(a,s,e,t,o)}},t=__decorate([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../../../Model/Map/MapType":"MapType","./Cell":"Cell"}],BreakAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"0b94f3OEERBQJp1naKXMDMO","BreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.play=function(){this.node.opacity=255,e.prototype.play.call(this)},t.prototype.onComplete=function(){},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],CelerSDK:[function(e,t,o){"use strict";cc._RF.push(t,"34a72Ol/DRKJb0NyonTxi8g","CelerSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ToSingleton"),i=e("../LogHandler"),a=e("../Random"),r=e("../../Command/CommonSignal"),l=e("../../Model/PlayModelProxy"),s=e("../../Controller/GameStateController"),c=e("../../Ad/WildAdButton"),u=e("../../Ad/FlyCnicornAd"),p=e("../../Global/GameRule"),d=e("../../TableManager"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e("../Signal").BaseSignal);o.DifficultyLevelSignal=h;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alreadySubmit=!1,t.isNewPlayer=!0,t.celerStartCallback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"MatchID",{get:function(){return this.match.matchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MatchRandomSeed",{get:function(){return this.match.sharedRandomSeed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MatchInfo",{get:function(){return this.match},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DifficultyLevel",{get:function(){return this.match.difficultyLevel},enumerable:!0,configurable:!0}),t.prototype.init=function(e){this.alreadySubmit=!1,CELER_X&&celerSDK.onStart(this.onCelerStart.bind(this)),CELER_X&&celerSDK.provideScore(function(){return l.PlayModelProxy.inst.getTotalScore()}),this.celerStartCallback=e,i.LogHandler.inst.ready(),CELER_X&&i.LogHandler.inst.initLog(celerSDK.log)},t.prototype.celerXReady=function(){console.log(" invoke celerx.ready() "),CELER_X?celerSDK.ready():this.onCelerStart()},t.prototype.isNew=function(){return this.isNewPlayer},t.prototype.isOnCelerPlatform=function(){return CELER_X},t.prototype.onCelerStart=function(){console.log(" celerx onStart call"),this.match=CELER_X?celerSDK.getMatch():{matchId:"error : can not get id",shouldLaunchTutorial:!1,sharedRandomSeed:.9453751331737268,difficultyLevel:1,locale:"en_US"},console.log("match id:",this.match.matchId,", seed:",this.match.sharedRandomSeed),0==this.match.difficultyLevel&&(this.match.difficultyLevel=1),CELER_X||(this.match.difficultyLevel=2),h.inst.dispatchOne(this.match.difficultyLevel),2==this.match.difficultyLevel&&(c.HideWildAdButtonSignal.inst.dispatch(),u.RemoveFlyCnicornSignal.inst.dispatch()),this.defineLan(),a.Random.setRandomSeed(this.match.sharedRandomSeed),l.PlayModelProxy.inst.setTotalTime(p.GetTotalTime()),this.match&&this.match.shouldLaunchTutorial?(this.isNewPlayer=!0,c.HideWildAdButtonSignal.inst.dispatch(),u.RemoveFlyCnicornSignal.inst.dispatch()):this.isNewPlayer=!1,CELER_X?(1!=celerSDK.hasMethod("showAd")&&(c.HideWildAdButtonSignal.inst.dispatch(),u.RemoveFlyCnicornSignal.inst.dispatch()),celerSDK.onPause(function(){console.log(" on pause "),s.GameStateController.inst.isGameOver()||s.GameStateController.inst.isPause()||r.ShowPauseLayerSignal.inst.dispatch()}),celerSDK.onResume(function(){console.log(" on resume ")})):(cc.game.on(cc.game.EVENT_HIDE,function(){console.log(" on pause "),s.GameStateController.inst.isGameOver()||s.GameStateController.inst.isPause()||r.ShowPauseLayerSignal.inst.dispatch()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log(" on resume ")})),this.celerStartCallback&&(this.celerStartCallback(),this.celerStartCallback=null)},t.prototype.defineLan=function(){this.match.locale=this.match.locale||"en_US",lan.set(this.match.locale);var e={},t=null;t=d.TableManager.inst.getAll_En_Data();var o=this.match.locale.split("_")[0].charAt(0).toUpperCase()+this.match.locale.split("_")[0].substring(1);if(d.TableManager.inst["getAll_"+o+"_Data"]&&d.TableManager.inst["getAll_"+o+"_Data"]()&&(t=d.TableManager.inst["getAll_"+o+"_Data"]()),t){for(var n in t){var i=t[n];e[i.View]||(e[i.View]={}),e[i.View][i.ID]=i.Text}lan.define(this.match.locale,e)}},t.prototype.submitScore=function(e){this.alreadySubmit||(this.alreadySubmit=!0,console.log(" submit score:",e,", match id:",this.match),CELER_X?celerSDK.submitScore(e):window.location.reload())},Object.defineProperty(t.prototype,"isAndroidWeb",{get:function(){return cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_ANDROID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIOSWeb",{get:function(){return cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_IOS},enumerable:!0,configurable:!0}),t}(n.SingleTon());o.CelerSDK=m,cc._RF.pop()},{"../../Ad/FlyCnicornAd":"FlyCnicornAd","../../Ad/WildAdButton":"WildAdButton","../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Global/GameRule":"GameRule","../../Model/PlayModelProxy":"PlayModelProxy","../../TableManager":"TableManager","../LogHandler":"LogHandler","../Random":"Random","../Signal":"Signal","../ToSingleton":"ToSingleton"}],Cell:[function(e,t,o){"use strict";cc._RF.push(t,"fc9f3v9KNBLNb+hnrqNX6iz","Cell"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Global/GameRule"),i=e("../../../Model/Map/MapType"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"Left",{get:function(){return this.node.getChildByName("Left")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.node.getChildByName("Top")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){return this.node.getChildByName("Right")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bot",{get:function(){return this.node.getChildByName("Bot")},enumerable:!0,configurable:!0}),t.prototype.setPos=function(e,t,a,r,l){0==e&&0==t&&(o.map.push(a),o.level++),this.Top.active=this.Bot.active=this.Left.active=this.Right.active=!0,e>0&&(this.Top.active=a[e-1][t]==i.MapType.Empty);var s=a.length;if(0==e)if(n.IsUnlimitedLevel())if(o.level<=0)this.Top.active=!0;else{var c=o.map[o.level-1];this.Top.active=c[s-1][t]==i.MapType.Empty}else this.Top.active=0==r;e<a.length-1&&(this.Bot.active=a[e+1][t]==i.MapType.Empty),e==a.length-1&&(n.IsUnlimitedLevel()?this.Bot.active=!l||l[0][t]==i.MapType.Empty:this.Bot.active=2==r),t>0&&(this.Left.active=a[e][t-1]==i.MapType.Empty),t<a[0].length-1&&(this.Right.active=a[e][t+1]==i.MapType.Empty)},t.map=[],t.level=-1,t=o=__decorate([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../../../../Global/GameRule":"GameRule","../../../Model/Map/MapType":"MapType"}],Cocos:[function(e,t,o){"use strict";cc._RF.push(t,"d9795RGCWVCp5Zf4JNywPPb","Cocos"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Random");function i(e){return e&&e.getParent&&e.getParent()?e.getParent().convertToWorldSpaceAR(e.position):cc.v2(0,0)}o.GetWorldPosition=i,o.ConvertToNodeSpaceAR=function(e,t){if(!t)return cc.v2(0,0);var o=i(e);return t.convertToNodeSpaceAR(o)},o.Distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},o.AreaOf2CrossRect=function(e,t){var o=e.x,n=e.y,i=e.x+e.width,a=e.y+e.height,r=t.x,l=t.y,s=t.x+t.width,c=t.y+t.height;return Math.max(0,Math.min(i,s)-Math.max(o,r))*Math.max(0,Math.min(a,c)-Math.max(n,l))},o.disOrderArray=function(e){for(var t,o=0;o<e.length;++o){var i=n.Random.randomFloorToInt(0,e.length);t=[e[i],e[o]],e[o]=t[0],e[i]=t[1]}},o.Clamp=function(e,t,o){return Math.max(Math.min(e,t),o)},o.IndexToi=function(e,t){return Math.floor(e/t)},o.IndexToj=function(e,t){return e%t},cc._RF.pop()},{"./Random":"Random"}],ComboWordRoot:[function(e,t,o){"use strict";cc._RF.push(t,"ae477CIyhlEobaWLL5tnhGF","ComboWordRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Controller/ResourceController"),i=e("../../../../Factory/GameFactory"),a=e("../../../../Utils/Signal"),r=e("../../../Model/GameLogic"),l=cc._decorator,s=l.ccclass,c=(l.property,{3:"font_2great",4:"font_3wonderful",5:"font_4amazing",6:"font_5excellent",7:"font_6unbelievable"}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.ShowComboWordSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;u.inst.addListener(function(){if(console.log(" Combo:",r.GameLogic.inst.Combo),!(r.GameLogic.inst.Combo<3)){for(;e.node.childrenCount>0;)e.node.children[0].stopAllActions(),i.gFactory.putObj("Word",e.node.children[0]);var t=i.gFactory.getObj("Word");t.getComponent(cc.Sprite).spriteFrame=n.ResourceController.inst.getAltas(c[r.GameLogic.inst.Combo]),e.node.addChild(t),t.scale=0,t.opacity=255,t.stopAllActions(),t.runAction(cc.sequence(cc.scaleTo(.1,1.3),cc.scaleTo(.1,1.1),cc.delayTime(.7),cc.fadeOut(.3),cc.callFunc(function(){i.gFactory.putObj("Word",t)})))}},this)},t=__decorate([s],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../Controller/ResourceController":"ResourceController","../../../../Factory/GameFactory":"GameFactory","../../../../Utils/Signal":"Signal","../../../Model/GameLogic":"GameLogic"}],CommonSignal:[function(e,t,o){"use strict";cc._RF.push(t,"f95914FtRVEIaVFtfSVd+lO","CommonSignal"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Signal"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowPauseLayerSignal=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.HidePauseLayerSignal=a;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameThemeInit=r;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowHelpLayerSignal=l;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.HideHelpLayerSignal=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.OpenResultLayerSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowSubmitSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ScoreCountingSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ButtonClickSignal=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.TimeAnimationStateChanged=h;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.UpdateTimeNumber=m;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameReadySignal=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowTutorialSignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameStartSignal=g;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameOverSignal=S;var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GamePauseSignal=M;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.PlayerScoreChanged=_;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.NoviceScoreChanged=C;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.CountDownSignal=v,cc._RF.pop()},{"../Utils/Signal":"Signal"}],CompleteView:[function(e,t,o){"use strict";cc._RF.push(t,"ba3d1yfxbBDUoRT1kaH73rI","CompleteView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=e("../../../Controller/ResourceController"),r=e("../Animation/FireWorkAnimation"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Font",{get:function(){return this.node.getChildByName("Font").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Con",{get:function(){return this.node.getChildByName("Con")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FireWork",{get:function(){return this.node.getChildByName("FireWork").getComponent(r.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n.GameOverSignal.inst.addListenerOne(this.onGameOver,this),this.Font.node.active=!1,this.Con.active=!1},t.prototype.start=function(){this.FireWork.node.active=!1},t.prototype.onGameOver=function(e){this.Font.node.active=e!=i.RoundEndType.Complete;var t=2e3;switch(e){case i.RoundEndType.Complete:this.FireWork.node.active=!0,this.Con.active=!0,t=2500;break;case i.RoundEndType.Over:this.Font.spriteFrame=a.ResourceController.inst.getAnimationAtlas(a.AnimationType.UI,"font_gameover");break;case i.RoundEndType.TimeUp:this.Font.spriteFrame=a.ResourceController.inst.getAnimationAtlas(a.AnimationType.UI,"font_timeup");break;case i.RoundEndType.OutOfMove:this.Font.spriteFrame=a.ResourceController.inst.getAnimationAtlas(a.AnimationType.UI,"font_outofmove")}this.Font.node.active?(this.Font.node.scaleX=0,this.Font.node.runAction(cc.scaleTo(.1,1.2))):(this.FireWork.play(),this.Con.scale=0,this.Con.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.delayTime(.15),cc.scaleTo(.1,1)))),setTimeout(function(){n.OpenResultLayerSignal.inst.dispatchOne(e)},t)},t=__decorate([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../Animation/FireWorkAnimation":"FireWorkAnimation"}],DiamondDropChecker:[function(e,t,o){"use strict";cc._RF.push(t,"bd002AjJaZP2b7kPpccWgu0","DiamondDropChecker"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../Global/GameRule"),a=e("../../Model/PlayModelProxy"),r=e("../../Utils/HashMap"),l=e("../../Utils/Random"),s=e("../../Utils/Signal"),c=e("../../utils/ToSingleton"),u=e("./DiamondModel"),p=e("./GameLogic"),d=e("./Map/MapFactory"),h=e("./Map/MapType");function m(e,t,o){var n=d.MapFactory.inst.getMapByLevel(a.PlayModelProxy.inst.Level).mapType;return null==n[e][t]?(console.error("map exceed:",e,t),!0):n[e][t]==h.MapType.Empty||null!=p.GameLogic.inst.Blocks[o]}function f(e,t,o){return null==d.MapFactory.inst.getMapByLevel(a.PlayModelProxy.inst.Level).mapType[e][t]?(console.error("map exceed:",e,t),!0):null!=p.GameLogic.inst.Blocks[o]}(function(e){e[e.Up=0]="Up",e[e.Left=1]="Left",e[e.Right=2]="Right"})(n||(n={})),o.CheckIsStatic=m,o.CheckIsBlock=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.DiamondOnDropSignal=y;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.EmptyIndex=[],t.SkipIndex=[],t.gamePlay=null,t.loopCount=0,t.waitCount=0,t.delay=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"IndexStart",{get:function(){var e=h.MapLength/i.GetTotalLevel();return this.gamePlay.Level*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MapStarti",{get:function(){return 12*this.gamePlay.Level},enumerable:!0,configurable:!0}),t.prototype.bindGamePlay=function(e){var t=this;this.gamePlay=e,a.NextLevelSignal.inst.addListener(function(){t.EmptyIndex.length=0},this)},t.prototype.addToEmpty=function(e){for(var t=e.concat(),o=0;o<t.length;o++){var n=h.Index2i(t[o]-this.IndexStart),i=h.Index2j(t[o]-this.IndexStart);(this.EmptyIndex.indexOf(t[o])>=0||m(n,i,t[o]))&&(t.splice(o,1),o--)}this.EmptyIndex=this.EmptyIndex.concat(t)},t.prototype.clearEmpty=function(){this.EmptyIndex.length=0},t.prototype.removeFromEmpty=function(e){var t=this.EmptyIndex.indexOf(e);t>=0&&this.EmptyIndex.splice(t,1)},t.prototype.checkDiamondDrop=function(e,t){var o=this;void 0===t&&(t=0),this.delay=t,this.waitCount>0&&(console.error(" Drop Checker is busy."),this.waitCount++),this.waitCount++;var n=Date.now();this.loopCount=0,this.SkipIndex.length=0;for(var i=0,a=this.EmptyIndex;i<a.length;i++){var l=a[i];this.checkSkip(l)}if(this.SkipIndex.length>=this.EmptyIndex.length)return this.waitCount--,void(this.waitCount<0&&(console.error(" drop checker wait count < 0."),this.waitCount=0));var s=new r.HashMap;this.startCheck(e,s),s.forEach(function(e,t){y.inst.dispatchThree(e,t,o.delay)}),this.waitCount--,this.waitCount<0&&(console.error(" drop checker wait count < 0."),this.waitCount=0),!CELER_X&&console.log("Drop check cost :",Date.now()-n," ms"),this.waitCount>0&&(this.waitCount--,console.log(" check by wait."),this.checkDiamondDrop(e))},t.prototype.getNeedCheck=function(e){for(var t=[],o=0,n=this.EmptyIndex;o<n.length;o++){var i=n[o];0==this.isSkip(i)&&t.push(i)}return t.sort(function(e,t){return t-e}),t},t.prototype.startCheck=function(e,t){if(this.loopCount++,this.loopCount>=1e4)console.error("startCheck loop count:",this.loopCount);else{for(var o=0,i=this.EmptyIndex;o<i.length;o++){var a=i[o];this.checkSkip(a)}for(var r=this.getNeedCheck(n.Up),l=0,s=[],c=null;r.length>0;){a=r.pop();if(!this.checkSkip(a)){var u=h.Index2i(a);if(null==c)c=u;else if(c<u)break;var p=null;u<=this.MapStarti?(p=this.addNewDiamond(1,a,e,t),this.removeEmpty(a)):p=this.findUp(a,e,t),p?l++:s.push(a)}}if(l>0)this.startCheck(e,t);else if(this.startCheckSide(e,t))this.startCheck(e,t);else{for(var d=0,m=this.EmptyIndex;d<m.length;d++){a=m[d];this.checkSkip(a)}this.SkipIndex.length>=this.EmptyIndex.length||this.startCheck(e,t)}}},t.prototype.startCheckSide=function(e,t){for(var o=0,i=this.EmptyIndex;o<i.length;o++){var a=i[o];this.checkSkip(a)}for(var r=this.getNeedCheck(n.Left),l=!1,s=[n.Left,n.Right],c=null;r.length>0;){a=r.pop();if(!this.checkSkip(a)){var u=h.Index2i(a);if(null==c)c=u;else if(c<u)break;for(;s.length>0;){s.shift()==n.Left?this.findLeftSide(a,e,t)&&(l=!0,s.length=0):this.findRightSide(a,e,t)&&(l=!0,s.length=0)}}}return l},t.prototype.findLeftSide=function(e,t,o){var n=h.Index2i(e)-1,i=h.Index2j(e)-1;if(i<0)return!1;var a=h.ij2Index(n,i),r=h.Index2i(a-this.IndexStart),l=h.Index2j(a-this.IndexStart);if(m(r,l,a))return!1;if(f(r+1,l,e-1))return!1;var s=t[a];if(s){var c=h.Index2i(e-1-this.IndexStart),u=h.Index2j(e-1-this.IndexStart);return!(null==t[e-1]&&!m(c,u,e-1))&&(this.dropDiamond(s,e,t,o),!0)}return!1},t.prototype.findRightSide=function(e,t,o){var n=h.Index2i(e)-1,i=h.Index2j(e)+1;if(i>8)return!1;var a=h.ij2Index(n,i),r=h.Index2i(a-this.IndexStart),l=h.Index2j(a-this.IndexStart);if(m(r,l,a))return!1;if(f(r+1,l,e+1))return!1;var s=t[a];if(s){var c=h.Index2i(e+1-this.IndexStart),u=h.Index2j(e+1-this.IndexStart);return!(null==t[e+1]&&!m(c,u,e+1))&&(this.dropDiamond(s,e,t,o),!0)}return!1},t.prototype.isSkip=function(e){return this.SkipIndex.indexOf(e)>=0},t.prototype.findUp=function(e,t,o){var n=h.Index2i(e)-1,i=h.Index2j(e),a=t[h.ij2Index(n,i)];return a?(this.dropDiamond(a,e,t,o),a):null},t.prototype.checkSkip=function(e){var t=h.Index2i(e),o=h.Index2j(e),n=0,i=t-1;if(i<=h.Index2i(this.IndexStart))return!1;var a=h.Index2i(e-this.IndexStart),r=h.Index2j(e-this.IndexStart),l=h.ij2Index(i,o);(m(h.Index2i(l-this.IndexStart),h.Index2j(l-this.IndexStart),l)||this.isSkip(l))&&n++;var s=o-1,c=h.ij2Index(i,s),u=h.Index2i(c-this.IndexStart),p=h.Index2j(c-this.IndexStart);(s<0||m(u,p,c)||this.isSkip(c)||f(a,r-1,e-1))&&n++;var d=o+1,y=h.ij2Index(i,d),g=h.Index2i(y-this.IndexStart),S=h.Index2j(y-this.IndexStart);return(d>8||m(g,S,y)||this.isSkip(y)||f(a,r+1,e+1))&&n++,n>=3&&(this.addToSkip(e,e),!0)},t.prototype.addToSkip=function(e,t){this.SkipIndex.indexOf(e)<0&&this.SkipIndex.push(e)},t.prototype.dropDiamond=function(e,t,o,n){var i=e.Index;e.Index=t,o[t]&&console.error(" drop error:",i," to ",t,o[t].Index),o[t]=e,o[i]=null,this.EmptyIndex.push(i),this.removeEmpty(t),this.addToDrop(e.ID,i,t,0,n)},t.prototype.addNewDiamond=function(e,t,o,n){var i=h.GetColorPool()[l.Random.randomFloorToInt(0,h.GetColorPool().length)],a=u.DiamondModel.AddDiamond(h.DiamondType.Normal,i,t,e);return o[t]=a,this.addToDrop(a.ID,-h.Index2j(t),t,0,n),a},t.prototype.addToDrop=function(e,t,o,n,i){var a=i.get(e);a?(a.waitCount.push(n),a.way.push(o),a.from.push(t)):i.add(e,{waitCount:[n],way:[o],from:[t]})},t.prototype.removeEmpty=function(e){var t=this.EmptyIndex.indexOf(e);t>=0&&this.EmptyIndex.splice(t,1)},t.OpenCheck=!0,t}(c.SingleTon());o.DiamondDropChecker=g,cc._RF.pop()},{"../../Global/GameRule":"GameRule","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../../utils/ToSingleton":"ToSingleton","./DiamondModel":"DiamondModel","./GameLogic":"GameLogic","./Map/MapFactory":"MapFactory","./Map/MapType":"MapType"}],DiamondIconUtil:[function(e,t,o){"use strict";var n,i,a,r,l,s;cc._RF.push(t,"a10d1S861xE3oIivSCN7JT7","DiamondIconUtil"),Object.defineProperty(o,"__esModule",{value:!0});var c=e("../../Controller/ResourceController"),u=e("../Model/Map/MapType"),p=((n={})[u.DiamondColor.Blue]="jewels_blue",n[u.DiamondColor.Green]="jewels_green",n[u.DiamondColor.Purple]="jewels_purple",n[u.DiamondColor.Pink]="jewels_pink",n[u.DiamondColor.Yellow]="jewels_yellow",n[u.DiamondColor.Orange]="jewels_orange",n),d=((i={})[u.DiamondColor.Blue]="jewels_blues1",i[u.DiamondColor.Green]="jewels_greens1",i[u.DiamondColor.Purple]="jewels_purples1",i[u.DiamondColor.Pink]="jewels_pinks1",i[u.DiamondColor.Yellow]="jewels_yellows1",i[u.DiamondColor.Orange]="jewels_orange1",i),h=((a={})[u.DiamondColor.Blue]="jewels_blues2",a[u.DiamondColor.Green]="jewels_greens2",a[u.DiamondColor.Purple]="jewels_purples2",a[u.DiamondColor.Pink]="jewels_pinks2",a[u.DiamondColor.Yellow]="jewels_yellows2",a[u.DiamondColor.Orange]="jewels_orange2",a),m=((r={})[u.DiamondColor.Blue]="jewels_blues3",r[u.DiamondColor.Green]="jewels_greens3",r[u.DiamondColor.Purple]="jewels_purples3",r[u.DiamondColor.Pink]="jewels_pinks3",r[u.DiamondColor.Yellow]="jewels_yellows3",r[u.DiamondColor.Orange]="jewels_orange3",r),f=((l={})[u.DiamondColor.Blue]="jewels_blues4",l[u.DiamondColor.Green]="jewels_greens4",l[u.DiamondColor.Purple]="jewels_purples4",l[u.DiamondColor.Pink]="jewels_pinks4",l[u.DiamondColor.Yellow]="jewels_yellows4",l[u.DiamondColor.Orange]="jewels_orange4",l),y=((s={})[u.DiamondColor.Blue]="jewels_flight_blue",s[u.DiamondColor.Green]="jewels_flight_green",s[u.DiamondColor.Purple]="jewels_flight_purple",s[u.DiamondColor.Pink]="jewels_flight_pink",s[u.DiamondColor.Yellow]="jewels_flight_yellow",s[u.DiamondColor.Orange]="jewels_flight_orange",s);o.GetDiamonIconSprite=function(e,t){var o="";if(t==u.DiamondType.Normal)o=p[e];else if(t==u.DiamondType.Peacock)o=y[e];else if(t==u.DiamondType.Rainbow)o="jewels_rainbow";else switch(t){case u.DiamondType.Diagonal:o=m[e];break;case u.DiamondType.Horizonal:o=d[e];break;case u.DiamondType.Vertical:o=h[e];break;case u.DiamondType.Square:o=f[e]}return c.ResourceController.inst.getAltas(o)},cc._RF.pop()},{"../../Controller/ResourceController":"ResourceController","../Model/Map/MapType":"MapType"}],DiamondIconView:[function(e,t,o){"use strict";cc._RF.push(t,"377412tXfJAxqJR4ZlswAVg","DiamondIconView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=e("../Model/DiamondModel"),a=e("../Model/Map/MapType"),r=e("../View/Animation/Diamond/IdleAnimation"),l=e("../View/Game/PrefabBaseView"),s=e("./DiamondIconUtil"),c=cc._decorator,u=c.ccclass,p=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Icon",{get:function(){return this.node.getChildByName("Icon").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{get:function(){return this.node.getChildByName("Animation").getComponent(r.default)},enumerable:!0,configurable:!0}),t.prototype.onReuse=function(){this.Icon.node.opacity=255,this.updateView()},t.prototype.updateView=function(){var e=this;if(this.Icon.spriteFrame=s.GetDiamonIconSprite(this.model.Color,this.model.Type),[a.DiamondType.Peacock,a.DiamondType.Rainbow,a.DiamondType.Square].indexOf(this.model.Type)>=0){this.Animation.node.active=!0,this.Animation.PrefixName=r.Idle[this.model.Type].Prefix,this.Animation.FrameCount=r.Idle[this.model.Type].Count,this.Animation.Interval=r.Idle[this.model.Type].Rate,this.Animation.node.scale=r.Idle[this.model.Type].Scale;var t=r.Idle[this.model.Type].Loop,o=0;this.Animation.onComplete=function(){++o>=t&&t>0?(e.Animation.node.runAction(cc.fadeOut(.5)),o=0,setTimeout(function(){e.Animation.play()},2e3)):e.Animation.play()}}else this.Animation.node.active=!1},t.prototype.onUnuse=function(){CELER_X||(this.Icon.node.color=cc.Color.WHITE)},t.prototype.onLoad=function(){var e=this;i.DiamondRemovedSignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t.ID&&n.gFactory.putObj("Diamond",e.node)},this),i.DiamondDestorySignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t.ID&&n.gFactory.putObj("Diamond",e.node)},this),i.DiamondTypeChangedSignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t&&e.updateView()},this),CELER_X||i.UpdateLockStateSignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t.ID&&(e.model.isLock()?e.Icon.node.color=cc.Color.GRAY:e.Icon.node.color=cc.Color.WHITE)},this)},t=__decorate([u],t)}(l.default));o.default=p,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../Model/DiamondModel":"DiamondModel","../Model/Map/MapType":"MapType","../View/Animation/Diamond/IdleAnimation":"IdleAnimation","../View/Game/PrefabBaseView":"PrefabBaseView","./DiamondIconUtil":"DiamondIconUtil"}],DiamondMapRoot:[function(e,t,o){"use strict";var n;cc._RF.push(t,"f0759cFActBpI3BJXIMAzuM","DiamondMapRoot"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../Factory/GameFactory"),a=e("../../../Global/GameRule"),r=e("../../../Model/PlayModelProxy"),l=e("../../../Utils/Signal"),s=e("../../Model/DiamondModel"),c=e("../../Model/GamePlayModel"),u=e("../../Model/Map/MapType"),p=e("../Animation/Diamond/NormalBreakAnimation"),d=e("../Animation/Root/MergeRoot"),h=cc._decorator,m=h.ccclass,f=(h.property,(n={})[u.DiamondType.Diagonal]=c.ScoreType.MergeCross,n[u.DiamondType.Horizonal]=c.ScoreType.MergeLine,n[u.DiamondType.Vertical]=c.ScoreType.MergeLine,n[u.DiamondType.Square]=c.ScoreType.MergeSquare,n[u.DiamondType.Peacock]=c.ScoreType.MergePeacok,n[u.DiamondType.Rainbow]=c.ScoreType.MergeRainbow,n),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.TestDiamondRootScaleSignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;s.DiamondCreatedSignal.inst.addListenerThree(this.onDiamondCreated,this),s.DiamondAddSignal.inst.addListenerTwo(this.onDiamondAdd,this),y.inst.addListenerOne(function(t){e.node.scale=t},this)},t.prototype.onDiamondCreated=function(e,t,o){var n=this,a=i.gFactory.getObj("Diamond",e),r=u.GetPosByIndex(e.Index);a.setPosition(r),this.node.addChild(a,0),t>0?(a.scale=0,setTimeout(function(e,t){n.onDiamonShow(e,o,t)},t,a,e)):this.onDiamonShow(a,o,e)},t.prototype.onDiamonShow=function(e,t,o){e.scale=1,t&&(r.PlayModelProxy.inst.Model.addPlayerScore(a.GetScoreByType(f[o.Type]),f[o.Type],1,o.Index),d.OnDiamonMergeSignal.inst.dispatchTwo(o,p.AniType.Merge))},t.prototype.onDiamondAdd=function(e,t){var o=i.gFactory.getObj("Diamond",e),n=u.GetPosByIndex(e.Index);n.y=(5+t)*u.MapSize.height+u.MapSize.height/2,o.setPosition(n),this.node.addChild(o,0)},t=__decorate([m],t)}(cc.Component);o.DiamondMapRoot=g,cc._RF.pop()},{"../../../Factory/GameFactory":"GameFactory","../../../Global/GameRule":"GameRule","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../Model/DiamondModel":"DiamondModel","../../Model/GamePlayModel":"GamePlayModel","../../Model/Map/MapType":"MapType","../Animation/Diamond/NormalBreakAnimation":"NormalBreakAnimation","../Animation/Root/MergeRoot":"MergeRoot"}],DiamondModel:[function(e,t,o){"use strict";cc._RF.push(t,"ef98fftXJlLrIqmsYJQKA1r","DiamondModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Global/GameRule"),i=e("../../Model/PlayModelProxy"),a=e("../../Utils/HashMap"),r=e("../../Utils/Signal"),l=e("../View/Animation/Diamond/NormalBreakAnimation"),s=e("../View/Animation/Root/NormalRoot"),c=e("./ActionChecker"),u=e("./EliminationChecker"),p=e("./GamePlayModel"),d=e("./Map/MapType"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondTypeChangedSignal=h;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondColorChangedSignal=m;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondIndexChangedSignal=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondCreatedSignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondAddSignal=g;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondRemovedSignal=S;var M,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondLockSignal=_,function(e){e[e.None=0]="None",e[e.TrySwap=1]="TrySwap",e[e.SwapReturn=2]="SwapReturn",e[e.Drop=3]="Drop",e[e.Refesh=4]="Refesh",e[e.Merge=5]="Merge",e[e.PeacokFly=6]="PeacokFly"}(M=o.LockType||(o.LockType={}));var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.UpdateLockStateSignal=C;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.DiamondDestorySignal=v;var T=function(){function e(t,o,n){this.diamondType=null,this.color=null,this.index=0,this.id="",this.currentLock=M.None,this.oldLock=M.None,this.releaseCallback=null,this.isCleared=!1,e.objCount++,this.id=e.objCount+"-Diamond-"+n+"-"+d.DiamondColor[o]+"-"+d.DiamondType[t],this.index=n,this.diamondType=t,this.color=o,this.diamondType==d.DiamondType.Rainbow&&c.ActionChecker.inst.addRainbow(),e.DiamondModelMap.add(this.ID,this)}return e.getDiamondModelByID=function(e){return 0==this.DiamondModelMap.has(e)&&console.error("diamond model not exist, ",e),this.DiamondModelMap.get(e)},e.CreateDiamond=function(t,o,n,i,a){void 0===i&&(i=0),void 0===a&&(a=!1);var r=new e(t,o,n);return y.inst.dispatchThree(r,i,a),r},e.AddDiamond=function(t,o,n,i){var a=new e(t,o,n);return g.inst.dispatchTwo(a,i),a},e.prototype.clear=function(){this.isCleared=!0},Object.defineProperty(e.prototype,"Cleared",{get:function(){return this.isCleared},enumerable:!0,configurable:!0}),e.prototype.destory=function(){v.inst.dispatchOne(this),e.DiamondModelMap.remove(this.ID)},e.prototype.removeSelf=function(t,o){0!=e.DiamondModelMap.has(this.ID)&&(this.Type==d.DiamondType.Rainbow&&c.ActionChecker.inst.reduceRainbow(),[u.EliminationType.Merge4,u.EliminationType.Peacock,u.EliminationType.Rainbow,u.EliminationType.Word].indexOf(o.type)<0&&i.PlayModelProxy.inst.Model.addPlayerScore(n.GetScoreByType(p.ScoreType.Clear),p.ScoreType.Clear,1,this.index),S.inst.dispatchTwo(this,t),s.OnDiamondBreakSignal.inst.dispatchThree(this,t,o),o.type==u.EliminationType.RainbowClear&&this.Type!=d.DiamondType.Rainbow&&s.OnDiamondBreakSignal.inst.dispatchTwo(this,l.AniType.RainbowTo),e.DiamondModelMap.remove(this.ID))},Object.defineProperty(e.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Index",{get:function(){return this.index},set:function(e){this.index=e,f.inst.dispatchTwo(this.id,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.color},set:function(e){this.color=e,m.inst.dispatchTwo(this.id,this.color)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.diamondType},set:function(e){this.diamondType=e,h.inst.dispatchTwo(this.id,this.diamondType)},enumerable:!0,configurable:!0}),e.prototype.lock=function(e,t){return void 0===t&&(t=function(){}),!(this.currentLock>e)&&(this.oldLock=this.currentLock,this.oldLock==e||this.excuCallback(),this.currentLock,M.None,this.currentLock=e,this.releaseCallback=t,_.inst.dispatchOne(this.ID),!0)},e.prototype.excuCallback=function(){var e=this.releaseCallback;this.releaseCallback=null,e&&e()},e.prototype.unlock=function(e){this.currentLock==e&&(this.currentLock=M.None,this.excuCallback())},e.prototype.isLock=function(){return this.currentLock!=M.None},Object.defineProperty(e.prototype,"LockType",{get:function(){return M[this.currentLock]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OldLock",{get:function(){return M[this.oldLock]},enumerable:!0,configurable:!0}),e.objCount=0,e.DiamondModelMap=new a.HashMap,e}();o.DiamondModel=T,cc._RF.pop()},{"../../Global/GameRule":"GameRule","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/HashMap":"HashMap","../../Utils/Signal":"Signal","../View/Animation/Diamond/NormalBreakAnimation":"NormalBreakAnimation","../View/Animation/Root/NormalRoot":"NormalRoot","./ActionChecker":"ActionChecker","./EliminationChecker":"EliminationChecker","./GamePlayModel":"GamePlayModel","./Map/MapType":"MapType"}],DiamondPositionView:[function(e,t,o){"use strict";cc._RF.push(t,"d423eqvtcNGQ5hNGuugQPKL","DiamondPositionView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Controller/GameStateController"),i=e("../../Model/PlayModelProxy"),a=e("../../Utils/Signal"),r=e("../../View/Transform/PositionView"),l=e("../Model/ActionChecker"),s=e("../Model/DiamondDropChecker"),c=e("../Model/DiamondModel"),u=e("../Model/EliminationChecker"),p=e("../Model/GameLogic"),d=e("../Model/Map/MapType"),h=e("../View/Animation/Diamond/NormalBreakAnimation"),m=e("../View/Animation/EffectBase"),f=e("../View/Animation/Root/NormalRoot"),y=e("../View/Game/Map/MapRoot"),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.TrySwapDoneSignal=g;var S,M=cc._decorator,_=M.ccclass;M.property;(function(e){e[e.Normal=0]="Normal",e[e.Drop=1]="Drop",e[e.Drag=2]="Drag",e[e.Fly=3]="Fly"})(S=o.DiamondIndex||(o.DiamondIndex={})),o.DropTime=.07*d.GetTimeScale(),o.MergeTime=.01*d.GetTimeScale(),o.SwapTime=.1*d.GetTimeScale(),o.MapTime=.5*d.GetTimeScale(),o.PeacokFlyTime=.2*d.GetTimeScale(),o.ScaleTime=.1*d.GetTimeScale(),o.FlyWaitTime=.3*d.GetTimeScale();var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.ReadyCheckClearSignal=C;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t.diamondDrop=[],t.dropWay=[],t.waitCount=[],t.from=[],t.mergeWay=[],t.onLevelRuning=!1,t}var a;return __extends(t,e),a=t,t.prototype.reuse=function(e){this.model=e,this.onLevelRuning=!1},t.prototype.unuse=function(){this.node.targetOff(this),this.clearDrop(),this.clearMerge(),this.clear(),this.model=null,this.onStart=function(){}},t.prototype.onLoad=function(){var e=this;p.TrySwapDiamndSignal.inst.addListenerTwo(this.onTrySwapDiamond,this),p.ClearFailedSignal.inst.addListenerOne(this.onSwapFailed,this),p.ClearSuccessSignal.inst.addListenerThree(this.onClearSuccess,this),s.DiamondOnDropSignal.inst.addListenerThree(this.onDiamondDropDown,this),i.NextLevelSignal.inst.addListener(function(){e.onLevelRuning=!0},this),y.OnRunLevelDoneSignal.inst.addListener(function(){e.onLevelRuning=!1},this),l.DiamondRePosSignal.inst.addListener(this.onRepos,this)},t.prototype.onRepos=function(){var e=this;null==this.model||this.model.Cleared||this.model.Index<p.GameLogic.inst.IndexStart||this.model.Index>=p.GameLogic.inst.IndexEnd||this.model.lock(c.LockType.Refesh)&&(this.onStart=function(){e.model.LockType!=c.LockType[c.LockType.Refesh]&&console.error("repos onStart:",e.model.Index,e.model.LockType,", old:",e.model.OldLock)},this.onPositionChanged(d.GetPosByIndex(this.model.Index),n.GameStateController.inst.isReady?o.MapTime:0,function(){e.model.unlock(c.LockType.Refesh)}))},t.prototype.onDiamondDropDown=function(e,t,o){var n=this;if(void 0===o&&(o=0),this.model&&this.model.ID==e)if(this.diamondDrop.length>0)t.way[t.way.length-1]!=this.model.Index&&console.warn(this.model.Index,this.dropWay),this.diamondDrop.push({waitCount:t.waitCount.concat(),way:t.way.concat(),from:t.from.concat(),delay:o});else{this.diamondDrop.push({waitCount:t.waitCount.concat(),way:t.way.concat(),from:t.from.concat()});var i=-1;this.model.lock(c.LockType.Drop,function(){n.clearDrop(),i>=0&&clearTimeout(i)})?i=setTimeout(function(){i=-1,n.node.zIndex=S.Drop,n.doDropDown()},o):console.log(e,this.model.ID,this.model.Index," [onDiamondDropDown]model is lock by :",this.model.LockType,t,o)}},t.prototype.clearDrop=function(){this.diamondDrop.length=0,this.dropWay.length=0,this.from.length=0,this.waitCount.length=0},t.prototype.clearMerge=function(){this.mergeWay.length=0},t.prototype.doDropDown=function(e){var t=this;void 0===e&&(e=0),this.model.LockType!=c.LockType[c.LockType.Drop]&&console.error(" doDropDown :",this.model.Index,this.model.LockType,this.model.ID);var n=0;this.dropWay.length<=0&&(this.dropWay=this.diamondDrop[0].way,this.waitCount=this.diamondDrop[0].waitCount,this.from=this.diamondDrop[0].from,n=this.diamondDrop[0].delay||0);var i=this.dropWay[0],r=0,l=this.from[0];a.WaitMap[i.toString()]?(r=a.WaitMap[i.toString()],a.WaitMap[i.toString()]++):a.WaitMap[i.toString()]=1,d.Index2j(i)==d.Index2j(l)&&l>=0&&(r=0),setTimeout(function(){a.WaitMap[i.toString()]&&a.WaitMap[i.toString()]--},(r+1)*o.DropTime),this.onStart=function(){t.model.LockType!=c.LockType[c.LockType.Drop]&&console.error(" doDropDown onStart:",t.model.Index,t.model.LockType,", old:",t.model.OldLock),a.WaitMap[l.toString()]&&a.WaitMap[l.toString()]--},this.onPositionChanged(d.GetPosByIndex(i),o.DropTime,function(){t.dropWay.shift(),t.from.shift(),t.waitCount.shift(),t.dropWay.length<=0&&t.diamondDrop.length>0&&t.diamondDrop.shift(),t.diamondDrop.length<=0&&t.dropWay.length<=0?(t.node.zIndex=S.Normal,t.model.unlock(c.LockType.Drop),0==t.onLevelRuning&&C.inst.dispatchTwo(t.model,t.model)):t.doDropDown()},r*o.DropTime+n/1e3+e/1e3)},t.prototype.onSwapFailed=function(e){var t=this;null!=this.model&&e.indexOf(this.model.ID)>=0&&(this.node.zIndex=S.Normal,this.model.lock(c.LockType.SwapReturn)&&(this.onStart=function(){t.model.LockType!=c.LockType[c.LockType.SwapReturn]&&console.error(" swapfail onStart:",t.model.Index,t.model.LockType,", old:",t.model.OldLock)},this.onPositionChanged(d.GetPosByIndex(this.model.Index),o.SwapTime,function(){t.model.unlock(c.LockType.SwapReturn),C.inst.dispatchTwo(t.model,t.model)})))},t.prototype.onTrySwapDiamond=function(e,t){var n=this;if(null!=this.model&&(this.model.ID==e.ID||this.model.ID==t.ID)&&this.model.lock(c.LockType.TrySwap)){this.node.zIndex=S.Drag;var i=this.model.ID==e.ID?t.Index:e.Index;this.onStart=function(){},this.onPositionChanged(d.GetPosByIndex(i),o.SwapTime,function(){n.model.unlock(c.LockType.TrySwap)})}},t.prototype.onClearSuccess=function(e,t,n){var i=this;if(this.model&&e.indexOf(this.model.ID)>=0){if(this.model.Type==d.DiamondType.Peacock&&n.has(this.model.ID)&&this.model.lock(c.LockType.PeacokFly)){f.OnDiamondBreakSignal.inst.dispatchTwo(this.model,h.AniType.PeacokFly);var a=n.get(this.model.ID);return this.node.zIndex=S.Fly,this.onStart=function(){i.node.zIndex=S.Fly},void this.onPositionChanged(d.GetPosByIndex(a.Index),o.PeacokFlyTime,function(){i.model.Index=a.Index,i.node.zIndex=S.Normal,i.model.removeSelf(h.GetAniType(i.model.Type,t.type),t)},o.FlyWaitTime)}if(this.model.Type!=d.DiamondType.Normal)return void this.model.removeSelf(h.GetAniType(this.model.Type,t.type),t);t.indexMap&&t.indexMap[this.model.Index]||(t.indexMap||(t.indexMap={}),t.indexMap[this.model.Index]=[this.model.Index]),[u.EliminationType.Merge4,u.EliminationType.Peacock,u.EliminationType.Rainbow,u.EliminationType.Word].indexOf(t.type)>=0?(this.mergeWay.length>0?this.mergeWay=this.mergeWay.concat(t.indexMap[this.model.Index]):this.mergeWay=t.indexMap[this.model.Index],this.model.lock(c.LockType.Merge,function(){i.model&&i.model.removeSelf(h.GetAniType(i.model.Type,t.type),t)})&&this.onMerge(h.GetAniType(this.model.Type,t.type),t.type)):this.model.removeSelf(h.GetAniType(this.model.Type,t.type),t)}},t.prototype.onMerge=function(e,t){var n=this;this.onStart=function(){n.model.LockType!=c.LockType[c.LockType.Merge]&&console.error(" merge onStart:",n.model.Index,n.model.LockType,", old:",n.model.OldLock)},this.onPositionChanged(d.GetPosByIndex(this.mergeWay.shift()),o.MergeTime,function(){n.mergeWay.length>0?n.onMerge(e,t):n.model.unlock(c.LockType.Merge)})},t.prototype.onStep=function(){e.prototype.onStep.call(this),this.model&&m.OnNodeMovedSignal.inst.dispatchTwo(this.model.ID,this.node.position)},t.WaitMap={},t=a=__decorate([_],t)}(r.default);o.default=v,cc._RF.pop()},{"../../Controller/GameStateController":"GameStateController","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Signal":"Signal","../../View/Transform/PositionView":"PositionView","../Model/ActionChecker":"ActionChecker","../Model/DiamondDropChecker":"DiamondDropChecker","../Model/DiamondModel":"DiamondModel","../Model/EliminationChecker":"EliminationChecker","../Model/GameLogic":"GameLogic","../Model/Map/MapType":"MapType","../View/Animation/Diamond/NormalBreakAnimation":"NormalBreakAnimation","../View/Animation/EffectBase":"EffectBase","../View/Animation/Root/NormalRoot":"NormalRoot","../View/Game/Map/MapRoot":"MapRoot"}],DiamondScaleView:[function(e,t,o){"use strict";cc._RF.push(t,"e7c2fPo5SRPRLEnLcce+MVM","DiamondScaleView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/GlobalSingleTouch/GlobalSingleTouchMediator"),i=e("../../View/Transform/ScaleView"),a=e("../Model/ActionChecker"),r=e("../Model/DiamondModel"),l=e("../Model/GameLogic"),s=e("../View/Animation/Diamond/NormalBreakAnimation"),c=e("../View/Animation/Root/NormalRoot"),u=e("./DiamondPositionView"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t.isFly=!1,t}return __extends(t,e),t.prototype.reuse=function(e){this.model=e,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchedEnd,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchedEnd,this)},t.prototype.unuse=function(){this.node.targetOff(this),this.model=null,this.end(),this.node.scale=1,this.isFly=!1},t.prototype.onLoad=function(){l.ClearFailedSignal.inst.addListenerOne(this.clearFailed,this),r.DiamondLockSignal.inst.addListenerOne(this.onLock,this),c.PlayDiamondBreakSignal.inst.addListenerTwo(this.onFly,this),n.ShowTipSignal.inst.addListener(this.showTip,this)},t.prototype.showTip=function(){this.model&&a.ActionChecker.inst.TipIndex.indexOf(this.model.Index)>=0&&(this.node.stopAllActions(),this.node.runAction(cc.repeat(cc.sequence(cc.scaleTo(.2,1.16),cc.scaleTo(.2,1),cc.scaleTo(.2,1.16),cc.scaleTo(.2,1)),2)))},t.prototype.onStart=function(){this.node.stopAllActions()},t.prototype.onFly=function(e,t){var o=this;this.model&&t==s.AniType.PeacokFly&&e.ID==this.model.ID&&(this.isFly=!0,this.onScaleChanged(cc.v2(1.2,1.2),u.ScaleTime,function(){o.onScaleChanged(cc.v2(1,1),.1,function(){},u.FlyWaitTime)}))},t.prototype.onLock=function(e){this.model&&this.model.ID==e&&this.onScaleChanged(cc.v2(1,1),.1,function(){})},t.prototype.clearFailed=function(e){this.model&&e.indexOf(this.model.ID)>=0&&this.onScaleChanged(cc.v2(1,1),.1,function(){})},t.prototype.onTouchStart=function(e){if(this.model){if(this.model.isLock())return;this.onScaleChanged(cc.v2(1.2,1.2),.1,function(){})}},t.prototype.onTouchedEnd=function(e){this.model&&0==this.isFly&&this.onScaleChanged(cc.v2(1,1),.1,function(){})},t=__decorate([d],t)}(i.default));o.default=h,cc._RF.pop()},{"../../View/GlobalSingleTouch/GlobalSingleTouchMediator":"GlobalSingleTouchMediator","../../View/Transform/ScaleView":"ScaleView","../Model/ActionChecker":"ActionChecker","../Model/DiamondModel":"DiamondModel","../Model/GameLogic":"GameLogic","../View/Animation/Diamond/NormalBreakAnimation":"NormalBreakAnimation","../View/Animation/Root/NormalRoot":"NormalRoot","./DiamondPositionView":"DiamondPositionView"}],DiamondToucher:[function(e,t,o){"use strict";cc._RF.push(t,"e722b+tkVxH5LvtsIfyHjsT","DiamondToucher"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../Controller/GameStateController"),a=e("../../Utils/Signal"),r=e("../View/Game/PrefabBaseView"),l=e("../View/Interaction/DragPanel"),s=e("./DiamondPositionView"),c=cc._decorator,u=c.ccclass;c.property;(function(e){e[e.Right=0]="Right",e[e.Left=1]="Left",e[e.Down=2]="Down",e[e.Up=3]="Up"})(n=o.SwapDirection||(o.SwapDirection={}));var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.ReadyCheckSwapSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.TestClearSignal=d;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasDispatch=!1,t}var o;return __extends(t,e),o=t,t.prototype.onReuse=function(){this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchedEnd,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchedEnd,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchedStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this)},t.prototype.onUnuse=function(){this.node.targetOff(this),this.hasDispatch=!1,this.node.zIndex=s.DiamondIndex.Normal},t.prototype.onTouchedStart=function(e){!i.GameStateController.inst.isPause()&&i.GameStateController.inst.isRoundStart()&&(this.model.isLock()?CELER_X||console.log(" Index\uff1a",this.model.Index,", lock by:",this.model.LockType,", old:",this.model.OldLock):o.ClickClearOpen&&(!CELER_X||CELER_X&&MENU_SCENE)&&this.model?d.inst.dispatchOne([this.model.Index]):(this.hasDispatch=!1,this.node.zIndex=s.DiamondIndex.Drag))},t.prototype.onTouchedEnd=function(e){!i.GameStateController.inst.isPause()&&i.GameStateController.inst.isRoundStart()&&this.model&&(this.model.isLock()||(this.startCheck(),this.hasDispatch=!1))},t.prototype.onTouchMoved=function(e){!i.GameStateController.inst.isPause()&&i.GameStateController.inst.isRoundStart()&&this.model&&(this.model.isLock()||(this.node.zIndex=s.DiamondIndex.Drag,this.startCheck()))},t.prototype.startCheck=function(){o.ClickClearOpen||this.hasDispatch||(Math.abs(l.default.moveDelta.x)>Math.abs(l.default.moveDelta.y)?Math.abs(l.default.moveDelta.x)>=40&&(l.default.moveDelta.x>0?(this.hasDispatch=!0,p.inst.dispatchTwo(this.model,n.Right)):(p.inst.dispatchTwo(this.model,n.Left),this.hasDispatch=!0)):Math.abs(l.default.moveDelta.y)>=40&&(l.default.moveDelta.y>0?(p.inst.dispatchTwo(this.model,n.Down),this.hasDispatch=!0):(p.inst.dispatchTwo(this.model,n.Up),this.hasDispatch=!0)))},t.ClickClearOpen=!1,t=o=__decorate([u],t)}(r.default);o.default=h,cc._RF.pop()},{"../../Controller/GameStateController":"GameStateController","../../Utils/Signal":"Signal","../View/Game/PrefabBaseView":"PrefabBaseView","../View/Interaction/DragPanel":"DragPanel","./DiamondPositionView":"DiamondPositionView"}],DragPanel:[function(e,t,o){"use strict";cc._RF.push(t,"b83c5oIFglISr/eK93sS9aS","DragPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchedEnd,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchedEnd,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchedStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this),this.node._touchListener.swallowTouches=!1},t.prototype.onTouchedStart=function(e){!n.GameStateController.inst.isPause()&&n.GameStateController.inst.isRoundStart()&&(o.moveDelta=cc.v2(0,0))},t.prototype.onTouchedEnd=function(e){!n.GameStateController.inst.isPause()&&n.GameStateController.inst.isRoundStart()&&(o.moveDelta=cc.v2(0,0))},t.prototype.onTouchMoved=function(e){!n.GameStateController.inst.isPause()&&n.GameStateController.inst.isRoundStart()&&o.moveDelta.addSelf(e.getDelta())},t.moveDelta=cc.v2(0,0),t=o=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController"}],EaseBaseView:[function(e,t,o){"use strict";cc._RF.push(t,"fc226Q7q/NHwZUZiG7X+tIZ","EaseBaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../BaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetVal=new cc.Vec3(0,0,0),t.startTime=0,t.lastTime=0,t.completeCallback=null,t.callOnStart=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"CompleteCallback",{get:function(){return this.completeCallback},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"StartTime",{get:function(){return this.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastTime",{get:function(){return this.lastTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Target",{get:function(){return this.targetVal},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onStart=function(){},t.prototype.end=function(){null!=this.completeCallback&&(this.onComplete(),this.complete())},t.prototype.startUpdate=function(e,t,o,n){void 0===n&&(n=0),this.callOnStart=!1,this.targetVal=e,this.startTime=Date.now()+1e3*n,this.lastTime=1e3*t,this.completeCallback=o},t.prototype.complete=function(){if(this.startTime=this.lastTime=0,this.completeCallback){var e=this.completeCallback;this.completeCallback=null,e()}},t.prototype.clear=function(){this.startTime=this.lastTime=0},t.prototype.update=function(e){0!=this.startTime&&0!=this.canUpdate()&&(this.isComplete()?(this.onComplete(),this.complete()):this.canStart()&&(0==this.callOnStart&&(this.callOnStart=!0,this.onStart()),this.onStep()))},t.prototype.canStart=function(){return Date.now()>=this.startTime&&0!=this.startTime},t.prototype.isComplete=function(){return Date.now()>=this.startTime+this.lastTime},t.prototype.canUpdate=function(){return console.error("you should override this method."),!0},t.prototype.onStep=function(){},t.prototype.onComplete=function(){},t.prototype.ease=function(e,t){return this.lastTime<=0?t:(t-e)*(Date.now()-this.startTime)/this.lastTime+e},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"../BaseView":"BaseView"}],EffectBase:[function(e,t,o){"use strict";cc._RF.push(t,"626d8q5DuVB5ZWzroHl1X4j","EffectBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Factory/GameFactory"),i=e("../../../Model/PlayModelProxy"),a=e("../../../Utils/FrameAniBase"),r=e("../../../Utils/Signal"),l=e("./Diamond/NormalBreakAnimation"),s=cc._decorator,c=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.OnNodeMovedSignal=u;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="",t.type=l.AniType.None,t.fromIndex=0,t.toIndex=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FromIndex",{get:function(){return this.fromIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ToIndex",{get:function(){return this.toIndex},enumerable:!0,configurable:!0}),t.prototype.unuse=function(){this.id="",this.type=l.AniType.None,this.node.scale=1,this.node.rotation=0,this.node.width=0,this.node.height=0,this.fromIndex=0,this.toIndex=0,this.node.setAnchorPoint(.5,.5),this.stop(),this.node.getComponent(cc.Sprite).spriteFrame=null,this.node.getComponent(cc.Sprite).type=cc.Sprite.Type.SIMPLE,this.node.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW},t.prototype.reuse=function(e,t,o,n){void 0===o&&(o=0),void 0===n&&(n=0),this.id=e,this.type=t,this.node.getComponent(cc.Sprite).spriteFrame=null,this.fromIndex=o,this.toIndex=n},t.prototype.onComplete=function(){var e=this;this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.node.getComponent(cc.Sprite).spriteFrame=null,n.gFactory.putObj("Effect",e.node)})))},t.prototype.onStartPlay=function(){this.node.opacity=255},t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),u.inst.addListenerTwo(this.onNodeMoved,this),i.NextLevelSignal.inst.addListener(function(){t.node.parent&&(t.node.getComponent(cc.Sprite).spriteFrame=null,n.gFactory.putObj("Effect",t.node))},this)},t.prototype.onNodeMoved=function(e,t){this.ID&&this.ID==e&&this.node.setPosition(t)},t=__decorate([c],t)}(a.default);o.default=p,cc._RF.pop()},{"../../../Factory/GameFactory":"GameFactory","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/FrameAniBase":"FrameAniBase","../../../Utils/Signal":"Signal","./Diamond/NormalBreakAnimation":"NormalBreakAnimation"}],EffectMapRoot:[function(e,t,o){"use strict";cc._RF.push(t,"23dacFChgNEjLDhluwrnH0k","EffectMapRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Game/Map/MapRoot"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.OnMapMoveSignal.inst.addListenerOne(function(t){e.node.setPosition(t)},this)},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../Game/Map/MapRoot":"MapRoot"}],EffectRoot:[function(e,t,o){"use strict";cc._RF.push(t,"61ee9qLagpD+oTNmaZKnre0","EffectRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.EffectShowSignal=r;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,Object.defineProperty(t,"OPEN_EFFECT",{get:function(){return!!this.ins&&this.ins.node.active},set:function(e){this.ins&&!CELER_X&&(this.ins.node.active=e)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){o.ins=this,r.inst.addListenerOne(this.onShow,this)},t.prototype.onShow=function(e){this.node.active=e},t.ins=null,t=o=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../../Utils/Signal":"Signal"}],EliminationChecker:[function(e,t,o){"use strict";cc._RF.push(t,"ce3a9/fq9FItKkmyTVJS84x","EliminationChecker"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../Global/GameRule"),a=e("../../utils/ToSingleton"),r=e("./Map/MapType");(function(e){e[e.Normal3=0]="Normal3",e[e.Merge4=1]="Merge4",e[e.Word=2]="Word",e[e.Rainbow=3]="Rainbow",e[e.Peacock=4]="Peacock",e[e.VerticalClear=5]="VerticalClear",e[e.HorizonalClear=6]="HorizonalClear",e[e.DiagonalClear=7]="DiagonalClear",e[e.SquareClear=8]="SquareClear",e[e.PeacokClear=9]="PeacokClear",e[e.RainbowClear=10]="RainbowClear"})(n=o.EliminationType||(o.EliminationType={}));var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getElimination=function(e,t,o,a,l,s){void 0===s&&(s=!1);var c={},u=this.getSameColorIndex(e,t,o,a,l,c,s),p=r.MapLength/i.GetTotalLevel(),d=a*p,h=(l+1)*p,m=[],f=null,y=o[e];if(u.length>=3)if(y&&y.Type==r.DiamondType.Rainbow)f={color:t,colorStr:r.DiamondColor[t],indexList:this.getRainbowElimination(t,o,d,h,s).concat([e]),fromIndex:e,type:n.RainbowClear,indexMap:{}};else{for(var g={},S=0,M=u;S<M.length;S++){var _=M[S];if(_!=e)for(var C=_;null!=c[C]&&(null==g[_]?g[_]=[c[C]]:g[_].push(c[C]),c[C]!=e);)C=c[C]}this.checkPeacockClear(u)?(f={color:t,colorStr:r.DiamondColor[t],indexList:u,fromIndex:e,type:n.Peacock,indexMap:g},this.checkContainPeacok(f,o)):this.checkRainbowClear(u)?(f={color:t,colorStr:r.DiamondColor[t],indexList:u,fromIndex:e,type:n.Rainbow,indexMap:g},this.checkContainPeacok(f,o)):this.checkWordClear(u)?(f={color:t,colorStr:r.DiamondColor[t],indexList:u,fromIndex:e,type:n.Word,indexMap:g},this.checkContainPeacok(f,o)):this.checkMerge4Clear(u)?(f={color:t,colorStr:r.DiamondColor[t],indexList:u,fromIndex:e,type:n.Merge4,indexMap:g},this.checkContainPeacok(f,o)):this.checkNormalClear(u)&&(f={color:t,colorStr:r.DiamondColor[t],indexList:u,fromIndex:e,type:n.Normal3,indexMap:g})}else y&&y.Type==r.DiamondType.Rainbow&&(f={color:t,colorStr:r.DiamondColor[t],indexList:this.getRainbowElimination(t,o,d,h,s).concat([e]),fromIndex:e,type:n.RainbowClear,indexMap:{}});if(f){m.push(f);var v=this.getSpecialIndex(f.indexList,o,[],s);v.length>0&&this.checkSpecialElimination(v,[],f,o,m,d,h,s)}return m},t.prototype.checkContainPeacok=function(e,t){},t.prototype.getRainbowElimination=function(e,t,o,n,i){for(var a=[],l=o;l<n;l++){var s=t[l];s&&(0==s.isLock()||i)&&s.Color==e&&s.Type!=r.DiamondType.Rainbow&&a.push(s.Index)}return a},t.prototype.getSpecialIndex=function(e,t,o,n){for(var i=[],a=0,l=e;a<l.length;a++){var s=l[a],c=t[s];if(c&&(0==c.isLock()||n)&&[r.DiamondType.Diagonal,r.DiamondType.Horizonal,r.DiamondType.Square,r.DiamondType.Vertical,r.DiamondType.Rainbow].indexOf(c.Type)>=0){if(i.indexOf(s)>=0||o.indexOf(s)>=0)continue;i.push(s)}}return i},t.prototype.skipDiamond=function(e,t,o,n){for(var i=0;i<e.length;i++){var a=e[i];(t[a]&&t[a].isLock()&&0==n||o.indexList.indexOf(a)>=0)&&(e.splice(i,1),i--)}},t.prototype.checkSpecialElimination=function(e,t,o,i,a,l,s,c){if(!(e.length<=0)){for(var u=[];e.length>0;){var p=e.shift(),d=null,h=i[p],m=[];if(h&&(!h||!h.isLock()||0!=c)){switch(h.Type){case r.DiamondType.Diagonal:m=r.GetDiagonalIndex(p,l,s).indexList,this.skipDiamond(m,i,o,c),d={color:o.color,colorStr:o.colorStr,fromIndex:o.fromIndex,indexList:m,type:n.DiagonalClear,indexMap:{}};break;case r.DiamondType.Horizonal:m=r.GetHorizonalIndex(p),this.skipDiamond(m,i,o,c),d={color:o.color,colorStr:o.colorStr,fromIndex:o.fromIndex,indexList:m,type:n.HorizonalClear,indexMap:{}};break;case r.DiamondType.Square:m=r.GetSquareIndex(p,l,s),this.skipDiamond(m,i,o,c),d={color:o.color,colorStr:o.colorStr,fromIndex:o.fromIndex,indexList:m,type:n.SquareClear,indexMap:{}};break;case r.DiamondType.Vertical:m=r.GetVerticalIndex(p,l,s),this.skipDiamond(m,i,o,c),d={color:o.color,colorStr:o.colorStr,fromIndex:o.fromIndex,indexList:m,type:n.VerticalClear,indexMap:{}};break;case r.DiamondType.Rainbow:m=this.getRainbowElimination(o.color,i,l,s,c),d={color:o.color,colorStr:o.colorStr,fromIndex:o.fromIndex,indexList:m.concat([p]),type:n.RainbowClear,indexMap:{}}}if(d){t.push(p);for(var f=0,y=this.getSpecialIndex(m,i,t,c);f<y.length;f++){var g=y[f];u.indexOf(g)<0&&u.push(g)}a.push(d)}}}u.length>0&&this.checkSpecialElimination(u,t,o,i,a,l,s,c)}},t.prototype.getSameColorIndex=function(e,t,o,n,a,l,s){if(t==r.DiamondColor.None)return[];var c=[],u=r.MapLength/i.GetTotalLevel(),p=n*u,d=(a+1)*u;if(e>=d||e<p)return c;var h=o[e];if(0==s&&h&&h.isLock())return c;return c.push(e),function e(n){var i=r.Index2i(n),a=r.Index2j(n),u=r.ij2Index(i+1,a),h=r.ij2Index(i-1,a);i-1<0&&(h=p-1);var m=r.ij2Index(i,a-1);a-1<0&&(m=p-1);var f=r.ij2Index(i,a+1);a+1>8&&(f=p-1);var y=o[u],g=o[h],S=o[f],M=o[m];u>=p&&u<d&&y&&(0==y.isLock()||s)&&y.Color==t&&c.indexOf(u)<0&&(l[u]=n,c.push(u),e(u)),h>=p&&h<d&&g&&(0==g.isLock()||s)&&g.Color==t&&c.indexOf(h)<0&&(l[h]=n,c.push(h),e(h)),m>=p&&m<d&&M&&(0==M.isLock()||s)&&M.Color==t&&c.indexOf(m)<0&&(l[m]=n,c.push(m),e(m)),f>=p&&f<d&&S&&(0==S.isLock()||s)&&S.Color==t&&c.indexOf(f)<0&&(l[f]=n,c.push(f),e(f))}(e),c},t.prototype.checkNormalClear=function(e){if(e.length<3)return!1;if(e.length>3){for(var t={},o={},n=[],i=[],a=0,l=e;a<l.length;a++){var s=l[a],c=r.Index2i(s),u=r.Index2j(s);n.indexOf(c)<0&&n.push(c),i.indexOf(u)<0&&i.push(u),t[c]?t[c]++:t[c]=1,o[u]?o[u]++:o[u]=1}if(n.length>i.length)for(var p=0;p<e.length;p++){s=e[p];if(o[u=r.Index2j(s)]<=1){e.splice(p,1);break}}else for(p=0;p<e.length;p++){s=e[p];if(t[c=r.Index2i(s)]<=1){e.splice(p,1);break}}}var d=this.getMinMaxij(e);return d.Maxi-d.Mini==0||d.Maxj-d.Minj==0},t.prototype.checkMerge4Clear=function(e){if(e.length<4)return!1;var t=this.getMinMaxij(e);return t.Maxi-t.Mini==0||t.Maxj-t.Minj==0},t.prototype.checkWordClear=function(e){if(e.length<4)return!1;var t=this.getMinMaxij(e);if(t.Maxi-t.Mini==1&&t.Maxj-t.Minj>=2){for(var o=0,n=0,i=0,a=e;i<a.length;i++){var l=a[i],s=r.Index2i(l);s==t.Maxi&&n++,s==t.Mini&&o++}if(n==o)return!1}else if(t.Maxi-t.Mini>=2&&t.Maxj-t.Minj==1){for(var c=0,u=0,p=0,d=e;p<d.length;p++){l=d[p];var h=r.Index2j(l);h==t.Maxj&&u++,h==t.Minj&&c++}if(u==c)return!1}var m=0;if(t.Maxi-t.Mini==1&&t.Maxj-t.Minj>=2)for(var f=0,y=e;f<y.length;f++){l=y[f];2*r.Index2j(l)==t.Maxj+t.Minj&&m++}else if(t.Maxi-t.Mini>=2&&t.Maxj-t.Minj==1)for(var g=0,S=e;g<S.length;g++){l=S[g];2*r.Index2i(l)==t.Maxi+t.Mini&&m++}return!(m<2)&&(t.Maxi-t.Mini==1&&t.Maxj-t.Minj>=2||t.Maxi-t.Mini>=2&&t.Maxj-t.Minj==1)},t.prototype.checkRainbowClear=function(e){if(e.length<5)return!1;var t=this.getMinMaxij(e);return t.Maxi-t.Mini==0||t.Maxj-t.Minj==0},t.prototype.checkPeacockClear=function(e){if(e.length<5)return!1;var t=this.getMinMaxij(e);return t.Maxi-t.Mini>=1&&t.Maxj-t.Minj>=1},t.prototype.getMinMaxij=function(e){for(var t=-1e6,o=1e7,n=-1e7,i=1e7,a=0,l=e;a<l.length;a++){var s=l[a],c=r.Index2i(s),u=r.Index2j(s);t=Math.max(t,c),n=Math.max(n,u),o=Math.min(o,c),i=Math.min(i,u)}return{Maxi:t,Mini:o,Maxj:n,Minj:i}},t.prototype.getSkipColor=function(e,t,o,n,i){for(var a=[],l=r.GetColorPool(),s=0,c=l;s<c.length;s++){var u=c[s];this.getElimination(e,u,t,o,n,i).length>0&&a.indexOf(u)<0&&a.push(u)}return a.length>=l.length&&console.warn(" all skip."),a},t}(a.SingleTon());o.EliminationChecker=l,cc._RF.pop()},{"../../Global/GameRule":"GameRule","../../utils/ToSingleton":"ToSingleton","./Map/MapType":"MapType"}],FireWorkAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"fdcc6mLSFRPvZPIgAxSjpVB","FireWorkAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onComplete=function(){this.node.runAction(cc.fadeOut(.1))},t.prototype.play=function(){this.node.active=!0,this.node.opacity=255,e.prototype.play.call(this)},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],FlyAdCnicornAniamtion:[function(e,t,o){"use strict";cc._RF.push(t,"df82bE3jcpP0bURZ5D33BYC","FlyAdCnicornAniamtion"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/FrameAniBase"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"../Utils/FrameAniBase":"FrameAniBase"}],FlyCnicornAd:[function(e,t,o){"use strict";cc._RF.push(t,"36cb0yApqROmqNTDmiukrBP","FlyCnicornAd"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../Utils/Celer/CelerSDK"),a=e("../Utils/Signal"),r=cc._decorator,l=r.ccclass;r.property;(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"})(n=o.FlyOrigin||(o.FlyOrigin={}));var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.CnicornWatchFailSignal=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.RemoveFlyCnicornSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.FlyCnicornAdDispearSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.FlyCnicornClickSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.ShowFlyCnicornSignal=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"Fly",{get:function(){return this.node.getChildByName("Fly")},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e,t){console.log("ShowFlyCnicorn:",n[e]),this.node.opacity=255,this.Fly.opacity=255;var i=0;this.Fly.y=t,e=n.Right,this.Fly.scaleX=-1,this.Fly.x=940,i=-940,this.Fly.once(cc.Node.EventType.TOUCH_END,this.onAddTouch,this),this.Fly.runAction(cc.sequence(cc.moveTo(10,i,this.Fly.y),cc.spawn(cc.fadeOut(2),cc.moveBy(2,376*this.Fly.scaleX,0)),cc.callFunc(function(){u.inst.dispatch(),o.ShowTimeRest=10})))},t.prototype.unuse=function(){},t.prototype.onLoad=function(){var e=this;c.inst.addOnce(function(){d.inst.removeTarget(e),s.inst.removeTarget(e),e.node.removeFromParent(!0),e.node.destroy()},this),s.inst.addListener(function(){o.ShowTimeRest=10},this),o.ShowTimeRest=10,d.inst.addListenerTwo(function(t,o){console.log(" Show Cnicorn"),e.Fly.getNumberOfRunningActions()>0||e.reuse(n.Right,665.607)},this),0==i.CelerSDK.inst.isAndroidWeb&&c.inst.dispatch()},t.prototype.onAddTouch=function(e){this.Fly.stopAllActions(),this.Fly.runAction(cc.fadeOut(.2)),p.inst.dispatch()},t.prototype.update=function(e){},t.ShowTimeRest=0,t=o=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../Utils/Celer/CelerSDK":"CelerSDK","../Utils/Signal":"Signal"}],FrameAniBase:[function(e,t,o){"use strict";cc._RF.push(t,"6298cJI+OZK9J9ZyfrpqPP2","FrameAniBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,r=n.requireComponent,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Frames=null,t.PrefixName="",t.FrameCount=0,t.Interval=.05,t.Priority=0,t.Loop=!1,t.PlayOnLoad=!1,t.currentIndex=0,t.time=0,t.isPlay=!1,t.listener=[],t.complateEvent=[],t}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{set:function(e){this.Frames=e},enumerable:!0,configurable:!0}),t.prototype.onFocusInEditor=function(){},t.prototype.onLostFocusInEditor=function(){clearInterval(o.intervalID)},t.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},t.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,this.node.opacity=255,this.updateCurrentFrame(),0==this.isPlaying&&this.callEventComplete()},t.prototype.onStartPlay=function(){},t.prototype.playOnLoop=function(){this.Loop=!0,this.play()},t.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},t.prototype.pause=function(){this.isPlay=!1},t.prototype.resume=function(){this.isPlay=!0},t.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.updateCurrentFrame(),this.Loop=!1},t.prototype.updateCurrentFrame=function(){""!=this.PrefixName?this.Sprite.spriteFrame=this.Frames.getSpriteFrame(this.PrefixName+(this.currentIndex+1)):this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex]},t.prototype.onKeyFrame=function(e){},t.prototype.addKeyEventListener=function(e,t){this.listener.push({callback:e,target:t})},Object.defineProperty(t.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),t.prototype.clearAllListener=function(){return this.listener.length=0,this},t.prototype.onComplete=function(){this.node.runAction(cc.fadeOut(.2))},t.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var e=0,t=this.listener;e<t.length;e++){var o=t[e];o.callback.apply(o.target,[this.currentIndex,this.__classname__])}},t.prototype.callEventComplete=function(){this.isPlay=!1;for(var e=0,t=this.complateEvent;e<t.length;e++){var o=t[e];o.f.apply(o.target,[this.__classname__])}this.onComplete()},t.prototype.addCompleteEvent=function(e,t){this.complateEvent.push({f:e,target:t})},Object.defineProperty(t.prototype,"TotalFrameCount",{get:function(){return""!=this.PrefixName&&this.FrameCount>0?this.Loop?this.FrameCount:this.FrameCount+1:this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length+1:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),t.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},t.prototype.start=function(){},Object.defineProperty(t.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var e=0,t=this.getComponents(o);e<t.length;e++){var n=t[e];if(n.Priority>this.Priority&&n.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(0==this.currentIndex&&this.onStartPlay(),this.updateCurrentFrame(),this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.TotalFrameCount,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},t.prototype.update=function(e){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=e},t.aniName="FrameAniBase",t.intervalID=-1,__decorate([a(cc.SpriteAtlas)],t.prototype,"Frames",void 0),__decorate([a],t.prototype,"PrefixName",void 0),__decorate([a],t.prototype,"FrameCount",void 0),__decorate([a],t.prototype,"Interval",void 0),__decorate([a],t.prototype,"Priority",void 0),__decorate([a],t.prototype,"Loop",void 0),__decorate([a],t.prototype,"PlayOnLoad",void 0),t=o=__decorate([i,r(cc.Sprite)],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],FrontView:[function(e,t,o){"use strict";cc._RF.push(t,"a7fe8WWCZVPgYx/jpZQ6l8q","FrontView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.update=function(e){this.node.parent.scaleX>=0?this.node.scaleX=1:this.node.scaleX=0,this.node.parent.scaleY<0?this.node.scaleY=1:this.node.scaleY=0},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],GameFactory:[function(e,t,o){"use strict";cc._RF.push(t,"93d23kfnY1A76OtZSkIyJ5r","GameFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=function(){function e(e,t,o){this._pool=[],this.totalSize=0,this.initTime=[],this.completeHandler=o,this.template=e,this.totalSize=t,this.hashKey="ObjPool:"+this.template.name+" - "+this.totalSize,this.initPool(t)}return e.prototype.initPool=function(e,t){var o=this;if(void 0===t&&(t=!1),t)for(var n=0;n<e;++n){this.initTime.push(Date.now());var i=cc.instantiate(this.template);this.put(i)}else for(n=0;n<e;++n)this.initTime.push(Date.now()),setTimeout(function(){var e=cc.instantiate(o.template);o.put(e)},n)},e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy&&this._pool[t].destroy();this._pool.length=0},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){e.removeFromParent(!1);for(var t=0,o=e.getComponents(cc.Component);t<o.length;t++){var n=o[t];n&&n.unuse&&n.unuse.apply(n)}this._pool.push(e),this.completeHandler&&this.totalSize<=this._pool.length&&(this.completeHandler(),this.completeHandler=null)}},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this._pool.length-1;o<0&&this.initPool(1,!0),o=this._pool.length-1;var n=this._pool[o];this._pool.length=o;for(var i=0,a=n.getComponents(cc.Component);i<a.length;i++){var r=a[i];r&&r.reuse&&r.reuse.apply(r,arguments)}return n},e}(),a=function(){function e(){this.count=0,this.totalCount=0,this.objPool=new n.HashMap,this.startTime=0}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;this.doneCallback=e,this.startTime=Date.now(),cc.loader.loadResDir("prefabs/",cc.Prefab,function(e,o,n){if(e)console.error(" Game Factory init failed:",e);else{t.totalCount=o.length;for(var a=function(e){var n=o[e],a=n.name.split("."),r=a[0],l=a[1]?parseInt(a[1]):30;console.log(" init pool:",r,", count:",l),setTimeout(function(){var e=new i(n,l,t.addCount.bind(t));t.objPool.add(r,e)},10*e)},r=0;r<o.length;r++)a(r)}})},e.prototype.addCount=function(){this.count++,this.count>=this.totalCount&&(console.log(" factory cost time:",(Date.now()-this.startTime).toFixed(2)+"ms"),this.doneCallback&&(this.doneCallback(),this.doneCallback=null))},e.prototype.getObj=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return this.objPool.has(e)?(t=this.objPool.get(e)).get.apply(t,o):(console.error(" objPool dosen't exists this obj:",e),null)},e.prototype.putObj=function(e,t){if(this.objPool.has(e))return this.objPool.get(e).put(t);console.error(" objPool dosen't exists this obj:",e)},e}();o.gFactory=a.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],GameLogic:[function(e,t,o){"use strict";cc._RF.push(t,"dcc3dWQyb9Je6+vGzSbnbD2","GameLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Ad/AdLayer"),i=e("../../Global/GameRule"),a=e("../../Model/PlayModelProxy"),r=e("../../Utils/Cocos"),l=e("../../Utils/HashMap"),s=e("../../Utils/Random"),c=e("../../Utils/Signal"),u=e("../../utils/ToSingleton"),p=e("../../View/Test"),d=e("../Diamond/DiamondPositionView"),h=e("../Diamond/DiamondToucher"),m=e("../View/Animation/Diamond/NormalBreakAnimation"),f=e("../View/Animation/Root/ComboWordRoot"),y=e("../View/Animation/Root/MergeRoot"),g=e("../View/Game/Map/MapRoot"),S=e("./ActionChecker"),M=e("./BlockModel"),_=e("./DiamondDropChecker"),C=e("./DiamondModel"),v=e("./EliminationChecker"),T=e("./GamePlayModel"),b=e("./Map/MapFactory"),P=e("./Map/MapType"),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.RestartCountSignal=R;var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.TrySwapDiamndSignal=x;var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.ClearFailedSignal=L;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.ClearSuccessSignal=w;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.DiamondDropSignal=F;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.ComboUpdateSignal=G;var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.AddMoveSignal=k;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.PlayEliminationSignal=D;var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gamePlay=null,t.diamonds=[],t.blocks=[],t.peacokBlocks=new l.HashMap,t.peacokBlocksLife2=new l.HashMap,t.restartCount=0,t.totalGoldCount=new l.HashMap,t.combo=0,t.comboLimitTime=0,t.comboLastTime=0,t.clearCdTime=i.ClearCDLimitTime,t.eliminationType=null,t.needDestoryDiamonds=[],t.needDestroyBlocks=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"EliminationType",{get:function(){return this.eliminationType},set:function(e){null==this.eliminationType?this.eliminationType=e:e>this.eliminationType&&(this.eliminationType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ClearCD",{get:function(){return this.clearCdTime},set:function(e){this.clearCdTime=e,this.clearCdTime<=0&&(this.clearCdTime=i.ClearCDLimitTime,null!=this.eliminationType&&D.inst.dispatchOne(this.eliminationType),this.eliminationType=null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ComboLimitTime",{get:function(){return this.comboLimitTime},set:function(e){0!=e&&this.comboLimitTime<=0&&(this.ComboLastTime=0),this.comboLimitTime=e,this.comboLimitTime<=0&&(this.comboLastTime>=.5&&(this.comboLastTime<=1?this.Combo=3:this.comboLastTime<=1.5?this.Combo=4:this.comboLastTime<=1.8?this.Combo=5:this.comboLastTime<=2?this.Combo=6:this.Combo=7,f.ShowComboWordSignal.inst.dispatch()),this.ComboLastTime=0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ComboLastTime",{get:function(){return this.comboLastTime},set:function(e){this.comboLastTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Combo",{get:function(){return this.combo},set:function(e){this.combo=e,this.combo=Math.min(this.combo,7),G.inst.dispatchOne(this.combo)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Blocks",{get:function(){return this.blocks},enumerable:!0,configurable:!0}),t.prototype.addPeacokBlocks=function(e,t){this.peacokBlocks.has(t)?this.peacokBlocks.get(t).indexOf(e)<0&&this.peacokBlocks.get(t).push(e):this.peacokBlocks.add(t,[e])},t.prototype.removePeacokBlocks=function(e,t){if(this.peacokBlocks.has(t)){var o=this.peacokBlocks.get(t).indexOf(e);o>=0&&this.peacokBlocks.get(t).splice(o,1)}},t.prototype.addPeacokBlocksLife2=function(e,t){this.peacokBlocksLife2.has(t)?this.peacokBlocksLife2.get(t).indexOf(e)<0&&this.peacokBlocksLife2.get(t).push(e):this.peacokBlocksLife2.add(t,[e])},t.prototype.removePeacokBlocksLife2=function(e,t){if(this.peacokBlocksLife2.has(t)){var o=this.peacokBlocksLife2.get(t).indexOf(e);o>=0&&this.peacokBlocksLife2.get(t).splice(o,1)}},t.prototype.getTotalGoldCount=function(e){return this.totalGoldCount.get(e)||0},t.prototype.bindGamePlay=function(e){this.gamePlay=e,S.ActionChecker.inst.init(),CELER_X||p.TestReStartSignal.inst.addListener(this.restart,this),h.TestClearSignal.inst.addListenerOne(this.testClear,this),h.ReadyCheckSwapSignal.inst.addListenerTwo(this.trySwapDiamond,this),d.ReadyCheckClearSignal.inst.addListenerTwo(this.onReadyCheckClear,this),g.OnRunLevelDoneSignal.inst.addListener(this.onMapMovedDone,this),n.AdFinishSignal.inst.addListenerOne(this.onAdFinish,this),T.ReadyNextLevelSignal.inst.addListenerOne(this.initNextLevelGameData,this)},t.prototype.onAdFinish=function(e){if(console.log(" ad finish:",e),e==n.AdType[n.AdType.Sun]){for(var t=[],o=this.IndexStart;o<this.IndexEnd;o++)this.diamonds[o]&&this.diamonds[o].Type==P.DiamondType.Normal&&t.push(o);var a=t[s.Random.randomFloorToInt(0,t.length)];this.diamonds[a]&&(this.diamonds[a].Color=P.DiamondColor.None,this.diamonds[a].Type=P.DiamondType.Rainbow,y.OnDiamonMergeSignal.inst.dispatchTwo(this.diamonds[a],m.AniType.Merge))}else this.gamePlay.MoveCount+=i.GetMoveCountBonus(),k.inst.dispatchOne(i.GetMoveCountBonus())},t.prototype.onReadyCheckClear=function(e,t){var o=this.checkClear(e,t);o&&o.length>0&&(this.doSwap(e,t),this.doClear(o,0))},t.prototype.doSwap=function(e,t){var o;console.log("swap:",e.ID,e.Index," - ",t.ID,t.Index);var n=e.Index,i=t.Index;e.Index=i,t.Index=n,o=[this.diamonds[i],this.diamonds[n]],this.diamonds[n]=o[0],this.diamonds[i]=o[1]},t.prototype.trySwapDiamond=function(e,t){var o=this,n=-1,i=P.Index2i(e.Index),a=P.Index2j(e.Index);switch(t){case h.SwapDirection.Down:i-1>=0&&(n=P.ij2Index(i-1,a));break;case h.SwapDirection.Up:n=P.ij2Index(i+1,a);break;case h.SwapDirection.Left:a-1>=0&&(n=P.ij2Index(i,a-1));break;case h.SwapDirection.Right:a+1<=8&&(n=P.ij2Index(i,a+1))}if(!(e.Index<this.IndexStart||e.Index>=this.IndexEnd)){var r=this.diamonds[n];if(r&&0==r.isLock()){if(r.Index<this.IndexStart||r.Index>=this.IndexEnd)return;var l=this.checkClear(e,r);x.inst.dispatchTwo(e,r),l&&l.length>0?(this.doSwap(e,r),this.doClear(l,1e3*d.SwapTime+10),setTimeout(function(){o.gamePlay.MoveCount--},1e3*d.SwapTime+20)):setTimeout(function(){L.inst.dispatchOne([e.ID,r.ID])},1e3*d.SwapTime+10)}}},t.prototype.getGoldBlocks=function(){var e=[],t=this.peacokBlocks.get(this.gamePlay.Level);if(t&&t.length>0)for(var o=0,n=t;o<n.length;o++){var i=n[o];this.blocks[i]&&1==this.blocks[i].Life&&this.blocks[i].GoldCount>0&&e.push(this.blocks[i])}if(e.length<=0){var a=this.peacokBlocksLife2.get(this.gamePlay.Level);if(a&&a.length>0)for(var r=0,l=a;r<l.length;r++){i=l[r];this.blocks[i]&&2==this.blocks[i].Life&&this.blocks[i].GoldCount>0&&e.push(this.blocks[i])}}return e},t.prototype.doClear=function(e,t){var o=this;Date.now();console.log("do clear:",e.length);var n=v.EliminationType.Normal3;if(e&&e.length>0){for(var a=function(e){if(e){var i=[];e.typeStr=v.EliminationType[e.type],_.DiamondDropChecker.inst.addToEmpty(e.indexList);var a={},c=[];e.type>=n&&(n=e.type);for(var u=0,p=e.indexList;u<p.length;u++){var h=p[u],m=null!=s.diamonds[h];if(s.diamonds[h]){var f=s.diamonds[h].ID;s.diamonds[h].clear(),c.push(f),s.diamonds[h].Type==P.DiamondType.Peacock&&(i.push(s.diamonds[h]),v.EliminationType.PeacokClear>=n&&(n=v.EliminationType.PeacokClear)),s.diamonds[h]=null}s.checkBlockClear(h,a,e,t,m)}var y=new l.HashMap;if(i.length>0){var g=s.getGoldBlocks();if(g.length>0){r.disOrderArray(g);for(var S=0,M=i;S<M.length;S++){var C=M[S];if(g.length<=0)break;var T=g.pop();T&&(y.add(C.ID,T),s.checkBlockClear(T.Index,{},null,1e3*(d.PeacokFlyTime+d.FlyWaitTime),!1)),g.length<=0&&(g=s.getGoldBlocks())}}}t<=0?(w.inst.dispatchThree(c,e,y),s.EliminationType=n):setTimeout(function(){w.inst.dispatchThree(c,e,y),o.EliminationType=n},t),s.mergeDiamond(e,t)}},s=this,c=0,u=e;c<u.length;c++){a(u[c])}_.DiamondDropChecker.inst.checkDiamondDrop(this.diamonds,t),S.ActionChecker.inst.checkIsFrozon(this.diamonds)?(console.log("Map Frozon."),setTimeout(function(){o.refreshMap()},1e3*d.DropTime+t)):!CELER_X&&console.log("Map OK.")}t>0?setTimeout(function(){o.ComboLimitTime=i.ComboLimitTime},t):this.ComboLimitTime=i.ComboLimitTime},t.prototype.testClear=function(e){for(var t=this,o=[],n=0,i=e;n<i.length;n++){var a=i[n];if(this.diamonds[a]){if(!(a<this.IndexStart||a>=this.IndexEnd)){var r=this.diamonds[a];o.push({color:r.Color,colorStr:P.DiamondColor[r.Color],fromIndex:r.Index,indexList:[a],type:v.EliminationType.Normal3,indexMap:{}})}}else console.warn(" diamond not exist:",a)}this.doClear(o,0),setTimeout(function(){t.gamePlay.MoveCount--},10)},t.prototype.checkBlockClear=function(e,o,n,i,a){if(void 0===i&&(i=0),void 0===a&&(a=!0),0!=t.CHECK_BLOCK||CELER_X){var r=0,l=P.GetCrossShapeIndex(e,this.IndexStart,this.IndexEnd);0==a&&(l.length=0),l.indexOf(e)<0&&l.push(e);for(var s=0,c=l;s<c.length;s++){var u=c[s],p=this.blocks[u];p&&!o[p.ID]&&(o[p.ID]=!0,p.Life>=2&&this.removePeacokBlocksLife2(u,this.gamePlay.Level),p.setLife(p.Life-1,i),p.Life<=0?(p.GoldCount>0&&r++,this.blocks[u]=null,_.DiamondDropChecker.inst.addToEmpty([u]),p.removeSelf(!0,i)):1==p.Life&&p.GoldCount>0&&this.addPeacokBlocks(u,this.gamePlay.Level))}return r}},t.prototype.checkClear=function(e,t,o){var n,i;if(void 0===o&&(o=!1),null==e||null==t)return[];var a=e.Index,r=t.Index;if(null==this.diamonds[a]||null==this.diamonds[r])return[];if(a<this.IndexStart||a>=this.IndexEnd||r<this.IndexStart||r>=this.IndexEnd)return[];var l=P.GetCrossShapeIndex(e.Index,this.IndexStart,this.IndexEnd);if(a!=r&&l.indexOf(r)<0)return[];e.Index=r,t.Index=a,n=[this.diamonds[r],this.diamonds[a]],this.diamonds[a]=n[0],this.diamonds[r]=n[1];var s=[],c=[];if(e.Type==t.Type&&t.Type==P.DiamondType.Rainbow);else{var u=P.DiamondColor.None;e.Type!=P.DiamondType.Rainbow&&t.Type!=P.DiamondType.Rainbow||(u=e.Color==P.DiamondColor.None?t.Color:e.Color,e.Type==P.DiamondType.Rainbow?e.Index:t.Index),s=v.EliminationChecker.inst.getElimination(a,t.Type==P.DiamondType.Rainbow?u:this.diamonds[a].Color,this.diamonds,this.gamePlay.Level,this.gamePlay.Level,o),a!=r&&t.Type!=P.DiamondType.Rainbow&&(c=v.EliminationChecker.inst.getElimination(r,e.Type==P.DiamondType.Rainbow?u:this.diamonds[r].Color,this.diamonds,this.gamePlay.Level,this.gamePlay.Level,o))}var p=s.concat(c);return i=[this.diamonds[r],this.diamonds[a]],this.diamonds[a]=i[0],this.diamonds[r]=i[1],e.Index=a,t.Index=r,p.length>0?p:[]},Object.defineProperty(t.prototype,"IndexStart",{get:function(){var e=P.MapLength/i.GetTotalLevel();return this.gamePlay.Level*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IndexEnd",{get:function(){var e=P.MapLength/i.GetTotalLevel();return(this.gamePlay.Level+1)*e},enumerable:!0,configurable:!0}),t.prototype.getIndexStart=function(e){return e*(P.MapLength/i.GetTotalLevel())},t.prototype.getIndexEnd=function(e){return(e+1)*(P.MapLength/i.GetTotalLevel())},Object.defineProperty(t.prototype,"Starti",{get:function(){return 12*this.gamePlay.Level},enumerable:!0,configurable:!0}),t.prototype.getStarti=function(e){return 12*e},t.prototype.restart=function(e){void 0===e&&(e=!1),console.log("restart:",e),e&&(b.MapFactory.inst.reset(),a.StartInitMapSignal.inst.dispatch()),_.DiamondDropChecker.inst.clearEmpty(),this.totalGoldCount.clear();for(var t=0,o=this.diamonds;t<o.length;t++){var n=o[t];n&&n.removeSelf(m.AniType.Normal,{type:v.EliminationType.Normal3,color:n.Color,colorStr:P.DiamondColor[n.Color],fromIndex:n.Index,indexList:[n.Index],indexMap:null})}for(var i=0,r=this.blocks;i<r.length;i++){var l=r[i];l&&l.removeSelf(!1)}this.initMap(),this.restartCount++,R.inst.dispatchOne(this.restartCount)},t.prototype.mergeDiamond=function(e,t){var o=[];switch(e.type){case v.EliminationType.Word:for(;o.length<100;)o.push(P.DiamondType.Diagonal),o.push(P.DiamondType.Square),o.push(P.DiamondType.Square),o.push(P.DiamondType.Square),o.push(P.DiamondType.Square);r.disOrderArray(o);break;case v.EliminationType.Merge4:o=[P.DiamondType.Horizonal,P.DiamondType.Vertical];break;case v.EliminationType.Rainbow:o=[P.DiamondType.Rainbow];break;case v.EliminationType.Peacock:o=[P.DiamondType.Peacock]}if(o.length>0){var n=e.color,i=o[s.Random.randomFloorToInt(0,o.length)];i==P.DiamondType.Rainbow&&(n=P.DiamondColor.None);var a=C.DiamondModel.CreateDiamond(i,n,e.fromIndex,t,!0);this.diamonds[e.fromIndex]=a,_.DiamondDropChecker.inst.removeFromEmpty(a.Index)}},t.prototype.initDiamondByRandom=function(){i.IsUnlimitedLevel()||(this.initDiamondData(0,i.GetTotalLevel()),this.diamonds.length!=P.MapLength&&console.error("map length error!"))},t.prototype.initDiamondData=function(e,t){this.diamonds.length=0;for(var o=P.MapLength/i.GetTotalLevel(),n=e;n<t;++n)for(var a=n*o;a<(n+1)*o;a++){var r=P.GetColorPool(),l=n*o,c=P.Index2i(a-l),u=P.Index2j(a-l);if(b.MapFactory.inst.getMapByLevel(n).mapType[c][u]==P.MapType.Free){for(var p=0,d=v.EliminationChecker.inst.getSkipColor(a,this.diamonds,e,t,!0);p<d.length;p++){var h=d[p],m=r.indexOf(h);m>=0&&r.splice(m,1)}r.length<=0&&(console.warn(" color pool null"),r=P.GetColorPool()),this.diamonds[a]=C.DiamondModel.CreateDiamond(P.GetInitDiamondType(),r[s.Random.randomFloorToInt(0,r.length)],a)}else this.diamonds[a]=null}},t.prototype.initBlockByMapConfig=function(){this.gamePlay.TotalGoldCount=0,i.IsUnlimitedLevel()||this.initBlockData(0,i.GetTotalLevel())},t.prototype.initBlockData=function(e,t){this.blocks.length=0,this.blocks.length=P.MapLength;for(var o=P.MapLength/i.GetTotalLevel(),n=e;n<t;++n){var a=b.MapFactory.inst.getMapByLevel(n),l=n*o,s=a.block.GoldNum;this.gamePlay.TotalGoldCount+=s;for(var c=[],u=0;u<a.mapType.length;u++)for(var p=a.mapType[u],d=0;d<p.length;d++){var h=p[d],m=P.ij2Index(u,d)+l;h==P.MapType.Grass||h==P.MapType.Stone?(this.blocks[m]=M.BlockModel.createBlock(2,1,m,h),this.addPeacokBlocksLife2(m,n),s--,this.totalGoldCount.get(n)?this.totalGoldCount.add(n,this.totalGoldCount.get(n)+1):this.totalGoldCount.add(n,1)):h==P.MapType.Empty?this.blocks[m]=null:h==P.MapType.Soil&&c.push(m)}for(r.disOrderArray(c);c.length>0;){m=c.pop();s>0?(s--,this.totalGoldCount.get(n)?this.totalGoldCount.add(n,this.totalGoldCount.get(n)+1):this.totalGoldCount.add(n,1),this.blocks[m]=M.BlockModel.createBlock(1,1,m,P.MapType.Soil),this.addPeacokBlocks(m,n)):this.blocks[m]=M.BlockModel.createBlock(1,0,m,P.MapType.Soil)}}},t.prototype.initMap=function(){i.IsUnlimitedLevel()||(this.diamonds.length=0,this.blocks.length=0,this.gamePlay.MoveCount=i.GetTotalMoves(),this.initDiamondByRandom(),this.initBlockByMapConfig(),S.ActionChecker.inst.checkIsFrozon(this.diamonds)?(console.log("initMap  Frozon."),this.refreshMap()):console.log("initMap OK."))},t.prototype.initNextLevelGameData=function(e){if(i.IsUnlimitedLevel()){console.log("InitNextLevelGameData:",e);for(var t=0,o=this.diamonds;t<o.length;t++){var n=o[t];n&&this.needDestoryDiamonds.push(n)}for(var a=0,r=this.Blocks;a<r.length;a++){var l=r[a];l&&this.needDestroyBlocks.push(l)}this.initDiamondData(e,e+1),this.initBlockData(e,e+1),0==e&&(S.ActionChecker.inst.checkIsFrozon(this.diamonds)?(console.log("initMap  Frozon."),this.refreshMap()):console.log("initMap OK."))}},t.prototype.onMapMovedDone=function(){if(i.IsUnlimitedLevel()){for(;this.needDestoryDiamonds.length>0;)this.needDestoryDiamonds.pop().destory();for(;this.needDestroyBlocks.length>0;)this.needDestroyBlocks.pop().destroy()}this.gamePlay.Level>0&&(S.ActionChecker.inst.checkIsFrozon(this.diamonds)?(console.log("Map move done, initMap  Frozon."),this.refreshMap()):console.log("initMap OK."))},t.prototype.refreshMap=function(){S.ActionChecker.inst.refreshMap(this.diamonds)},t.CHECK_BLOCK=!0,t}(u.SingleTon());o.GameLogic=B,cc._RF.pop()},{"../../Ad/AdLayer":"AdLayer","../../Global/GameRule":"GameRule","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Cocos":"Cocos","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../../View/Test":"Test","../../utils/ToSingleton":"ToSingleton","../Diamond/DiamondPositionView":"DiamondPositionView","../Diamond/DiamondToucher":"DiamondToucher","../View/Animation/Diamond/NormalBreakAnimation":"NormalBreakAnimation","../View/Animation/Root/ComboWordRoot":"ComboWordRoot","../View/Animation/Root/MergeRoot":"MergeRoot","../View/Game/Map/MapRoot":"MapRoot","./ActionChecker":"ActionChecker","./BlockModel":"BlockModel","./DiamondDropChecker":"DiamondDropChecker","./DiamondModel":"DiamondModel","./EliminationChecker":"EliminationChecker","./GamePlayModel":"GamePlayModel","./Map/MapFactory":"MapFactory","./Map/MapType":"MapType"}],GamePlayModel:[function(e,t,o){"use strict";cc._RF.push(t,"3a3dbMmjXZDlbutv0S4vxKQ","GamePlayModel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../Global/Theme"),a=e("../../Global/GameRule"),r=e("../../Command/CommonSignal"),l=e("../../Global/Level"),s=e("../../Utils/Random"),c=e("../../Utils/Signal"),u=e("../View/UI/RevertButtonView"),p=e("../View/UI/MoveCountLabelView"),d=e("../../Controller/GameStateController"),h=e("../View/UI/SubmitLayerView"),m=e("../../Model/PlayModelProxy"),f=e("./GameLogic"),y=e("./DiamondDropChecker"),g=e("../View/UI/MoveFlyAnimation"),S=e("./Map/MapFactory");(function(e){e[e.Clear=0]="Clear",e[e.MergeLine=1]="MergeLine",e[e.MergeCross=2]="MergeCross",e[e.MergeSquare=3]="MergeSquare",e[e.MergePeacok=4]="MergePeacok",e[e.MergeRainbow=5]="MergeRainbow",e[e.BlockAttack=6]="BlockAttack",e[e.StoneAttack=7]="StoneAttack",e[e.GoldAttack=8]="GoldAttack",e[e.GoldGain=9]="GoldGain",e[e.TimeBonus=10]="TimeBonus",e[e.StepBonus=11]="StepBonus",e[e.PauseCost=12]="PauseCost"})(n=o.ScoreType||(o.ScoreType={}));var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.GameTypeInitSignal=M;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.RevertButtonStateChangedSignal=_;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.BallSortDoneSignal=C;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.GoldCountUpdateSignal=v;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.GoldShowUpSignal=T;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(c.BaseSignal);o.ReadyNextLevelSignal=b;var P=function(){function e(){this.level=0,this.playerScore=0,this.noviceScore=0,this.gameTime=a.GetTotalTime(),this.pauseCount=0,this.pauseScore=0,this.streak=0,this.totalStreak=0,this.maxSteak=0,this.moveCount=0,this.totalGoldCount=0,this.goldCount=0,this.currentGoldCount=0,this.playerScoreMap={},this.reverts=[],this.init()}return e.prototype.init=function(){var e=this;f.GameLogic.inst.bindGamePlay(this),y.DiamondDropChecker.inst.bindGamePlay(this),u.RevertSignal.inst.addListener(this.revertAction,this),h.EndNowSignal.inst.addListener(this.onEndNow,this),r.GameOverSignal.inst.addListenerOne(function(t){e.moveCount>0&&t==d.RoundEndType.Complete&&(e.addPlayerScore(a.GetScoreByType(n.StepBonus)*e.moveCount,n.StepBonus,1,-1),p.MoveCountChangedSignal.inst.dispatchOne(0),g.MoveFlySignal.inst.dispatch())},this)},Object.defineProperty(e.prototype,"Time",{get:function(){return this.gameTime},set:function(e){this.gameTime=e,this.gameTime=Math.max(0,this.gameTime)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return this.theme},set:function(e){console.log("set game theme:",i.Theme[e]),this.theme=e,r.GameThemeInit.inst.dispatchOne(this.theme)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this.level},set:function(e){console.log("set game Level:",e),this.level=e,this.currentGoldCount=0,b.inst.dispatchOne(this.level),m.NextLevelSignal.inst.dispatchOne(this.level)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentGoldCount",{get:function(){return this.currentGoldCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GoldCount",{get:function(){return this.goldCount},enumerable:!0,configurable:!0}),e.prototype.addGoldCount=function(e){this.goldCount++,this.currentGoldCount++,T.inst.dispatchTwo(this.goldCount,e),this.addPlayerScore(a.GetScoreByType(n.GoldGain),n.GoldGain,1,e),this.checkIsNextLevel()},e.prototype.checkIsNextLevel=function(){this.currentGoldCount>=f.GameLogic.inst.getTotalGoldCount(this.level)&&(e.IS_RUN_LEVEL||CELER_X)&&(S.MapFactory.inst.clearCurrentMap(),this.Level++,this.Level>=a.GetTotalLevel()&&!a.IsUnlimitedLevel()&&d.GameStateController.inst.roundEnd(d.RoundEndType.Complete))},Object.defineProperty(e.prototype,"TotalScore",{get:function(){return Math.max(this.Timebonus+this.ScoreSpread+this.playerScore,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Timebonus",{get:function(){return a.IsUnlimitedLevel()?0:Math.floor((this.moveCount*this.goldCount/this.totalGoldCount*2.5+.5)*this.Time)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScoreSpread",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerScore",{get:function(){return this.playerScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MoveCount",{get:function(){return this.moveCount},set:function(e){this.moveCount=e,p.MoveCountChangedSignal.inst.dispatchOne(this.moveCount),this.moveCount<=0&&0==d.GameStateController.inst.isGameOver()&&!a.IsUnlimitedLevel()&&d.GameStateController.inst.roundEnd(d.RoundEndType.OutOfMove)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalGoldCount",{get:function(){return this.totalGoldCount},set:function(e){this.totalGoldCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseScore",{get:function(){return this.pauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NoviceScore",{get:function(){return this.noviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalCombo",{get:function(){return this.totalStreak},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseCount",{get:function(){return this.pauseCount},enumerable:!0,configurable:!0}),e.prototype.onEndNow=function(){this.checkCompleteScore(),d.GameStateController.inst.roundEnd(d.RoundEndType.Over)},e.prototype.addRevert=function(e){CELER_X&&(this.reverts.length=0),this.reverts.push(e),_.inst.dispatchOne(!0)},e.prototype.revertAction=function(){},e.prototype.checkCompleteScore=function(){},e.prototype.initGametheme=function(){var e=l.Level.getThemeRandomPool(this.Level);this.Theme=e[Math.floor(s.Random.getRandom()*e.length)]},e.prototype.initGameData=function(){console.log("init game data."),this.goldCount=0,v.inst.dispatchOne(this.goldCount),f.GameLogic.inst.initMap(),this.Level=0},e.prototype.addPlayerScore=function(e,t,o,n){if(void 0===o&&(o=1),void 0===n&&(n=-1),0!=e){null==this.playerScoreMap[t]&&(this.playerScoreMap[t]=0),this.playerScoreMap[t]+=e;var i=this.playerScore;return this.playerScore+=e,e>0||this.resetCombo(),this.playerScore=Math.max(this.playerScore,0),r.PlayerScoreChanged.inst.dispatchFour(this.playerScore,e,o,n),this.playerScore-i}},e.prototype.addNoviceScore=function(e,t){void 0===t&&(t=1),this.noviceScore+=e,this.noviceScore=Math.max(this.noviceScore,0),r.NoviceScoreChanged.inst.dispatchThree(this.noviceScore,e,t)},e.prototype.getScoreByType=function(e){return"number"!=typeof this.playerScoreMap[e]?0:this.playerScoreMap[e]},e.prototype.addPauseCount=function(){this.pauseCount++,console.log("pause count:",this.pauseCount),this.pauseCount>a.FreePauseLimit&&this.addPlayerScore(-a.GetScoreByType(n.PauseCost),n.PauseCost)},e.prototype.resetCombo=function(){this.streak=0},e.prototype.addStreak=function(){this.streak++,this.totalStreak++,this.maxSteak=Math.max(this.maxSteak,this.streak)},e.prototype.dump=function(){},e.IS_RUN_LEVEL=!0,e}();o.GamePlayModel=P,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Global/GameRule":"GameRule","../../Global/Level":"Level","../../Global/Theme":"Theme","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../View/UI/MoveCountLabelView":"MoveCountLabelView","../View/UI/MoveFlyAnimation":"MoveFlyAnimation","../View/UI/RevertButtonView":"RevertButtonView","../View/UI/SubmitLayerView":"SubmitLayerView","./DiamondDropChecker":"DiamondDropChecker","./GameLogic":"GameLogic","./Map/MapFactory":"MapFactory"}],GamePlaySignal:[function(e,t,o){"use strict";cc._RF.push(t,"6a923XZO3BHe6UfcoANFeWX","GamePlaySignal"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e("../../Utils/Signal").BaseSignal);o.SubmitButtonClickSignal=n,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],GameRecorder:[function(e,t,o){"use strict";cc._RF.push(t,"46f2dagdDRJBLTWeuQLW3r/","GameRecorder"),Object.defineProperty(o,"__esModule",{value:!0});var n="http://192.168.100.69:2021/",i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RATE=6,t.frameCount=0,t}return __extends(t,e),t.prototype.init=function(){var e=this;CELER_X||cc.sys.isMobile||this.sendRequest(n,"Login").then(function(t){console.log("response:",t),e.register()}).catch(function(e){console.warn("err:",e)})},t.prototype.register=function(){cc.director.on(cc.Director.EVENT_AFTER_DRAW,this.onGameDrawed,this)},t.prototype.onGameDrawed=function(){if(this.frameCount++,!(this.frameCount<this.RATE)){this.frameCount=0;var e=document.getElementsByTagName("canvas")[0];this.sendRequest(n+"capture",e.toDataURL("image/jpeg",.1))}},t.prototype.sendRequest=function(e,t){return new Promise(function(o,n){var i=cc.loader.getXMLHttpRequest();i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(i.status>=200&&i.status<300?o(i.responseText):n(i.status))},i.timeout=5e3,i.open("POST",e),i.send(t)})},t}(e("../utils/ToSingleton").SingleTon());o.GameRecorder=i,cc._RF.pop()},{"../utils/ToSingleton":"ToSingleton"}],GameRule:[function(e,t,o){"use strict";cc._RF.push(t,"58c53me7vtEdKVK7W6RnNQo","GameRule"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../GamePlay/Model/GamePlayModel"),i=e("../GamePlay/Model/Map/MapType"),a=e("../Model/PlayModelProxy"),r=e("../Utils/Celer/CelerSDK");function l(){switch(r.CelerSDK.inst.DifficultyLevel){case 1:case 2:default:return 1}}o.DrawDebug=!1,o.FreePauseLimit=3,o.GetTotalTime=function(){return CELER_X?90:900},o.GetScoreByType=function(e){switch(e){case n.ScoreType.Clear:return 5*l();case n.ScoreType.MergeCross:case n.ScoreType.MergeLine:case n.ScoreType.MergeSquare:return 20*l();case n.ScoreType.MergeRainbow:case n.ScoreType.MergePeacok:return 30*l();case n.ScoreType.BlockAttack:return 2*l();case n.ScoreType.GoldAttack:return 5*l();case n.ScoreType.StoneAttack:return 3*l();case n.ScoreType.GoldGain:case n.ScoreType.PauseCost:return 500*l();case n.ScoreType.StepBonus:return 100*l()}return 0},o.GetTotalMoves=function(){return 30},o.GetIndexOffset=function(){var e=i.MapLength/2;return a.PlayModelProxy.inst.Level*e},o.GetTotalLevel=function(){return 2},o.GetMoveCountBonus=function(){return 3},o.ClearCDLimitTime=.05,o.ComboLimitTime=.4,o.GetUSDScale=function(){return r.CelerSDK.inst.MatchInfo&&r.CelerSDK.inst.MatchInfo.ratio?r.CelerSDK.inst.MatchInfo.ratio:1},o.IsUnlimitedLevel=function(){return[2].indexOf(r.CelerSDK.inst.DifficultyLevel)>=0},o.GetScoreScale=l,cc._RF.pop()},{"../GamePlay/Model/GamePlayModel":"GamePlayModel","../GamePlay/Model/Map/MapType":"MapType","../Model/PlayModelProxy":"PlayModelProxy","../Utils/Celer/CelerSDK":"CelerSDK"}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"b768b1DCFpC4aef+tHUAH/Y","GameStateController"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../Utils/ToSingleton"),a=e("../Command/CommonSignal"),r=e("../Model/PlayModelProxy");(function(e){e[e.Complete=0]="Complete",e[e.Over=1]="Over",e[e.TimeUp=2]="TimeUp",e[e.OutOfMove=3]="OutOfMove"})(n=o.RoundEndType||(o.RoundEndType={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pauseCount=0,t.roundstart=!1,t.isReady=!1,t.isOver=!1,t.currentRound=0,t.onResumeCallbacks=[],t}return __extends(t,e),t.prototype.start=function(){this.pauseCount=0},t.prototype.canStart=function(){return this.isReady},t.prototype.roundStart=function(){this.isOver||(console.log(" round start:",++this.currentRound),this.roundstart=!0)},t.prototype.roundEnd=function(e){console.log("round end :",n[e]),this.roundstart=!1,this.isOver=!0,a.GameOverSignal.inst.dispatchOne(e)},t.prototype.isRoundStart=function(){return this.roundstart},t.prototype.pause=function(e){void 0===e&&(e=!1),0==this.isPause()&&(this.onResumeCallbacks.length=0,a.GamePauseSignal.inst.dispatch(),e||this.onResumeCallbacks.push(function(){r.PlayModelProxy.inst.addPauseCount()})),this.pauseCount++},t.prototype.testEndComplete=function(){this.roundEnd(n.Complete)},t.prototype.testEndTimeUp=function(){r.PlayModelProxy.inst.addGameTime(-1e12)},t.prototype.clearResumeCallback=function(){this.onResumeCallbacks.length=0},t.prototype.resume=function(){if(this.pauseCount--,console.assert(this.pauseCount>=0," pause count smaller than 0!!!"),this.pauseCount=Math.max(this.pauseCount,0),this.pauseCount<=0){for(var e=0,t=this.onResumeCallbacks;e<t.length;e++){(0,t[e])()}this.onResumeCallbacks.length=0}},t.prototype.isPause=function(){return this.pauseCount>0},t.prototype.addResumeCallback=function(e){this.onResumeCallbacks||(this.onResumeCallbacks=[]),this.onResumeCallbacks.push(e)},t.prototype.isGameOver=function(){return this.isOver},t}(i.SingleTon());o.GameStateController=l,!CELER_X&&(window.GameState=l.inst),cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Model/PlayModelProxy":"PlayModelProxy","../Utils/ToSingleton":"ToSingleton"}],GetGoldAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"9bfb9XO/ppIjZZUGNuzDh2v","GetGoldAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=e("../../Model/GamePlayModel"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.opacity=0,i.GoldCountUpdateSignal.inst.addListenerOne(function(e){t.isPlaying||0==e||t.play()},this)},t=__decorate([r],t)}(n.default));o.default=l,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase","../../Model/GamePlayModel":"GamePlayModel"}],GlobalSingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"50484YTu+lAFp2acGVLgU7t","GlobalSingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Controller/GameStateController"),i=e("../../Utils/Signal"),a=e("../SingleTouchMediator"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.ShowTipSignal=s;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=0,t}return __extends(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.node._touchListener.swallowTouches=!1},t.prototype.onTouchStart=function(e){n.GameStateController.inst.canStart()&&0==n.GameStateController.inst.isRoundStart()&&n.GameStateController.inst.roundStart(),this.time=0},t.prototype.onTouchMove=function(e){this.time=0},t.prototype.onTouchEnd=function(e){this.time=0},t.prototype.onTouchCancel=function(e){this.time=0},t.prototype.update=function(e){this.time+=e,this.time>=3&&(this.time=0,s.inst.dispatch())},t=__decorate([l],t)}(a.default);o.default=c,cc._RF.pop()},{"../../Controller/GameStateController":"GameStateController","../../Utils/Signal":"Signal","../SingleTouchMediator":"SingleTouchMediator"}],GlobalSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"4cc97bBcEZPu7Haxk0HdV9+","GlobalSingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../BaseView"),i=e("./GlobalSingleTouchMediator"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.BindMedaitor(i.default)},t.prototype.start=function(){},t=__decorate([r],t)}(n.default));o.default=l,cc._RF.pop()},{"../BaseView":"BaseView","./GlobalSingleTouchMediator":"GlobalSingleTouchMediator"}],GoldIconView:[function(e,t,o){"use strict";cc._RF.push(t,"bdeeatpa0lNJ5R1hbYunDuJ","GoldIconView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Model/GamePlayModel"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.GoldCountUpdateSignal.inst.addListenerOne(function(t){0==t||e.node.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.delayTime(.2),cc.scaleTo(.1,1)))},this)},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../Model/GamePlayModel":"GamePlayModel"}],GoldLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"30a8bAtofdMboZ4/0/DjP68","GoldLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/NumberChangedView"),i=e("../../Model/GamePlayModel"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),i.GoldCountUpdateSignal.inst.addListenerOne(function(e){0==e?t.Label.string="0":t.onNumberChanged(e)},this)},t=__decorate([r],t)}(n.default));o.default=l,cc._RF.pop()},{"../../../View/NumberChangedView":"NumberChangedView","../../Model/GamePlayModel":"GamePlayModel"}],GoldRoot:[function(e,t,o){"use strict";cc._RF.push(t,"7476eSxQn5OHZ14YC0sm/ew","GoldRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Factory/GameFactory"),i=e("../../../Global/GameRule"),a=e("../../../Utils/Cocos"),r=e("../../Model/GamePlayModel"),l=e("../../Model/Map/MapType"),s=cc._decorator,c=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UpGold=null,t}return __extends(t,e),t.prototype.onLoad=function(){r.GoldShowUpSignal.inst.addListenerTwo(this.onGoldShow,this)},t.prototype.onGoldShow=function(e,t){var o=n.gFactory.getObj("Gold");o.setPosition(l.GetPosByIndex(t-i.GetIndexOffset())),this.node.addChild(o),o.opacity=255,o.scale=.5,o.runAction(cc.sequence(cc.scaleTo(.1,1),cc.delayTime(.1),cc.spawn(cc.scaleTo(.5,.7),cc.moveTo(.5,a.ConvertToNodeSpaceAR(this.UpGold,this.node))),cc.fadeOut(.1),cc.callFunc(function(){r.GoldCountUpdateSignal.inst.dispatchOne(e),n.gFactory.putObj("Gold",o)})))},__decorate([u(cc.Node)],t.prototype,"UpGold",void 0),t=__decorate([c],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../Factory/GameFactory":"GameFactory","../../../Global/GameRule":"GameRule","../../../Utils/Cocos":"Cocos","../../Model/GamePlayModel":"GamePlayModel","../../Model/Map/MapType":"MapType"}],GridMap:[function(e,t,o){"use strict";cc._RF.push(t,"cd1bdSO+ZxEbZM3o5LodGaw","GridMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../BonusParty/MapInfo"),i=e("../../../../Global/GameRule"),a=e("../../../../Model/PlayModelProxy"),r=e("../../../Model/GamePlayModel"),l=e("../../../Model/Map/MapFactory"),s=e("./Box"),c=e("./MapRoot"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.level1Map=null,t.level2Map=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"MapRoot",{get:function(){return this.node.getChildByName("MapRoot")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.level1Map=this.MapRoot.children[0].getComponent(s.default),this.level2Map=this.MapRoot.children[1].getComponent(s.default),a.StartInitMapSignal.inst.addListener(this.initMap,this),a.NextLevelSignal.inst.addListenerOne(function(e){},this),r.ReadyNextLevelSignal.inst.addListenerOne(function(t){i.IsUnlimitedLevel()&&(n.MapNameUpdateSignal.inst.dispatchTwo(l.MapFactory.inst.getMap()[0].name,l.MapFactory.inst.getNextMap()[0].name),l.MapFactory.inst.reset(),0!=t&&e.level2Map.setMap(l.MapFactory.inst.getMap()[0].mapType,0,l.MapFactory.inst.getNextMap()[0].mapType))},this),c.OnRunLevelDoneSignal.inst.addListener(function(){var t;if(i.IsUnlimitedLevel()){var o=Math.abs(e.level1Map.node.y-e.level2Map.node.y);e.level1Map.node.y-=o+c.ReadyOffset,t=[e.level2Map,e.level1Map],e.level1Map=t[0],e.level2Map=t[1]}},this)},t.prototype.initMap=function(){i.IsUnlimitedLevel()?this.level1Map.setMap(l.MapFactory.inst.getMap()[0].mapType,0,l.MapFactory.inst.getNextMap()[0].mapType):(this.level1Map.setMap(l.MapFactory.inst.getMap()[0].mapType,0),this.level2Map.setMap(l.MapFactory.inst.getMap()[1].mapType,1))},t.prototype.start=function(){},t=__decorate([p],t)}(cc.Component));o.default=d,cc._RF.pop()},{"../../../../BonusParty/MapInfo":"MapInfo","../../../../Global/GameRule":"GameRule","../../../../Model/PlayModelProxy":"PlayModelProxy","../../../Model/GamePlayModel":"GamePlayModel","../../../Model/Map/MapFactory":"MapFactory","./Box":"Box","./MapRoot":"MapRoot"}],GridUtil:[function(e,t,o){"use strict";cc._RF.push(t,"8ed47lZW5tLWYuOMXgo3GBi","GridUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.GridRange={i:{max:11,min:0},j:{max:8,min:0}};var n=function(){function e(){}return e.copyGrid=function(e){return{i:e.i,j:e.j}},e.GetHorizontalWayByOrigin=function(e){for(var t=[],n={i:e.i,j:e.j};--n.j>=o.GridRange.j.min;)t.push(this.copyGrid(n));for(var i={i:e.i,j:e.j};++i.j<=o.GridRange.j.max;)t.push(this.copyGrid(i));return t},e.GetVerticalWayByOrigin=function(e){for(var t=[],n={i:e.i,j:e.j};++n.i<=o.GridRange.i.max;)t.push(this.copyGrid(n));for(var i={i:e.i,j:e.j};--i.i>=o.GridRange.i.min;)t.push(this.copyGrid(i));return t},e.GetDiagonalWayByOrigin=function(e){for(var t=[],n={i:e.i,j:e.j};++n.i<=o.GridRange.i.max&&--n.j>=o.GridRange.j.min;)t.push(this.copyGrid(n));for(var i={i:e.i,j:e.j};++i.i<=o.GridRange.i.max&&++i.j<=o.GridRange.j.max;)t.push(this.copyGrid(i));for(var a={i:e.i,j:e.j};--a.i>=o.GridRange.i.min&&--a.j>=o.GridRange.j.min;)t.push(this.copyGrid(a));for(var r={i:e.i,j:e.j};--r.i>=o.GridRange.i.min&&++r.j<=o.GridRange.j.max;)t.push(this.copyGrid(r));return t},e.GetSquaredWayByOrigin=function(e){for(var t=[],n={i:e.i,j:e.j};++n.i<=o.GridRange.i.max&&--n.j>=o.GridRange.j.min;){t.push(this.copyGrid(n));break}for(var i={i:e.i,j:e.j};++i.i<=o.GridRange.i.max&&++i.j<=o.GridRange.j.max;){t.push(this.copyGrid(i));break}for(var a={i:e.i,j:e.j};--a.i>=o.GridRange.i.min&&--a.j>=o.GridRange.j.min;){t.push(this.copyGrid(a));break}for(var r={i:e.i,j:e.j};--r.i>=o.GridRange.i.min&&++r.j<=o.GridRange.j.max;){t.push(this.copyGrid(r));break}for(var l={i:e.i,j:e.j};++l.j<=o.GridRange.j.max;){t.push(this.copyGrid(l));break}for(var s={i:e.i,j:e.j};--s.j>=o.GridRange.j.min;){t.push(this.copyGrid(s));break}for(var c={i:e.i,j:e.j};--c.i>=o.GridRange.i.min;){t.push(this.copyGrid(c));break}for(var u={i:e.i,j:e.j};++u.i<=o.GridRange.i.max;){t.push(this.copyGrid(u));break}return t},e}();o.GridUtil=n,cc._RF.pop()},{}],HashMap:[function(e,t,o){"use strict";cc._RF.push(t,"4b0e7DzcRNJnZXTYCWgDaDU","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._list=new Array,this.clear()}return e.prototype.getIndexByKey=function(e){for(var t=this._list.length,o=0;o<t;o++){if(this._list[o].key==e)return o}return-1},e.prototype.keyOf=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];if(n.value.hashKey&&e.hashKey&&n.value.hashKey===e.hashKey||n.value==e)return n.key}return null},Object.defineProperty(e.prototype,"keys",{get:function(){for(var e=new Array,t=0,o=this._list;t<o.length;t++){var n=o[t];n&&e.push(n.key)}return e},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var o={key:e,value:t},n=this.getIndexByKey(e);-1!=n?this._list[n]=o:this._list.push(o)},Object.defineProperty(e.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.getIndexByKey(e);if(-1!=t){var o=this._list[t];return this._list.splice(t,1),o}return null},e.prototype.has=function(e){return-1!=this.getIndexByKey(e)},e.prototype.get=function(e){var t=this.getIndexByKey(e);return-1!=t?this._list[t].value:null},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.sort=function(e){this._list.sort(e)},e.prototype.forEachKeyValue=function(e){for(var t=this._list.length,o=0;o<t;o++){e(this._list[o])}},e.prototype.forEach=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];e(n.key,n.value)}},e.prototype.clear=function(){this._list=[]},e}();o.HashMap=n,cc._RF.pop()},{}],HelpButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"55938+NxDZMXZHVR36gYzbo","HelpButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=e("../../../View/SingleTouchView"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||(n.ShowHelpLayerSignal.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t=__decorate([l],t)}(a.default));o.default=s,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../View/SingleTouchView":"SingleTouchView"}],HelpLayerMediator:[function(e,t,o){"use strict";cc._RF.push(t,"ab216iOmFFBBo7YhihjIFYL","HelpLayerMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseMediator"),i=e("../Command/CommonSignal"),a=e("../Controller/GameStateController"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeCallback=null,t}return __extends(t,e),t.prototype.onRegister=function(){i.ShowHelpLayerSignal.inst.addListenerOne(this.showHelp,this),i.ShowTutorialSignal.inst.addListenerOne(this.showGuide,this),i.HideHelpLayerSignal.inst.addListenerOne(this.hideGuide,this)},t.prototype.showHelp=function(e){this.View.isShowed()||(a.GameStateController.inst.pause(),this.closeCallback=e,this.View.Show())},t.prototype.showGuide=function(e){this.View.isShowed()||(a.GameStateController.inst.pause(!0),this.closeCallback=e,this.View.Show(null,!0))},t.prototype.hideGuide=function(){0!=this.View.isShowed()&&(a.GameStateController.inst.resume(),this.View.Hide(this.closeCallback),this.closeCallback=null)},t=__decorate([l],t)}(n.default));o.default=s,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","./BaseMediator":"BaseMediator"}],HelpLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"7de5dV5nLxKg6SXhg1Pqw8Z","HelpLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./BaseView"),a=e("./HelpLayerMediator"),r=e("../Command/CommonSignal"),l=e("../GamePlay/View/new/Page"),s=cc._decorator,c=s.ccclass,u=s.property;(function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"})(n||(n={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=n.Hide,t.Next=null,t.Close=null,t.GuidePage=null,t.TotalPage=null,t.Page=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.BindMedaitor(a.default),this.state=n.Hide,this.node.scale=1,this.node.active=!1,this.GuidePage.node.on("page-turning",this.onPageChanged,this),this.Close.on(cc.Node.EventType.TOUCH_END,this.close,this),this.Next.on(cc.Node.EventType.TOUCH_END,this.next,this)},t.prototype.start=function(){},t.prototype.close=function(){r.ButtonClickSignal.inst.dispatch(),r.HideHelpLayerSignal.inst.dispatch()},t.prototype.next=function(){r.ButtonClickSignal.inst.dispatch(),this.GuidePage.scrollToPage((this.GuidePage.getCurrentPageIndex()+1)%this.GuidePage.content.childrenCount,0),this.onPageChanged()},t.prototype.onPageChanged=function(){this.TotalPage&&(this.TotalPage.string=this.GuidePage.content.childrenCount.toString()),this.Page&&(this.Page.string=(this.GuidePage.getCurrentPageIndex()+1).toString()),this.GuidePage.content.children[this.GuidePage.getCurrentPageIndex()].getComponent(l.default)&&this.GuidePage.content.children[this.GuidePage.getCurrentPageIndex()].getComponent(l.default).play(),this.GuidePage.getCurrentPageIndex()>=this.GuidePage.content.childrenCount-1||this.GuidePage.content.children[this.GuidePage.getCurrentPageIndex()+1]&&0==this.GuidePage.content.children[this.GuidePage.getCurrentPageIndex()+1].active?(this.Next.active=!1,this.Close.active=!0):(this.Next.active=!0,this.Close.active=!1)},t.prototype.isShowed=function(){return this.state==n.Show},t.prototype.Show=function(e,t){if(void 0===t&&(t=!1),!this.isShowed())if(this.state=n.Show,this.node.active=!0,this.node.stopAllActions(),this.node.scale=0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()}))),this.Next.active=!0,this.Close.active=!1,this.GuidePage.scrollToPage(0,0),this.onPageChanged(),t)for(var o=0,i=this.GuidePage.content.children;o<i.length;o++){(l=i[o]).active="HideOnTutorial"!=l.name}else for(var a=0,r=this.GuidePage.content.children;a<r.length;a++){var l;(l=r[a]).active=!0}},t.prototype.Hide=function(e){var t=this;0!=this.isShowed()&&(this.state=n.Hide,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.scale=1,e&&e(),t.node.active=!1}))))},__decorate([u(cc.Node)],t.prototype,"Next",void 0),__decorate([u(cc.Node)],t.prototype,"Close",void 0),__decorate([u(cc.PageView)],t.prototype,"GuidePage",void 0),__decorate([u(cc.Label)],t.prototype,"TotalPage",void 0),__decorate([u(cc.Label)],t.prototype,"Page",void 0),t=__decorate([c],t)}(i.default);o.default=p,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../GamePlay/View/new/Page":"Page","./BaseView":"BaseView","./HelpLayerMediator":"HelpLayerMediator"}],HelpTextView:[function(e,t,o){"use strict";cc._RF.push(t,"375cbrKEx9FUoCFnGcONuAu","HelpTextView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Command/CommonSignal"),i=e("../table"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasRender=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"richText",{get:function(){return this.getComponent(cc.RichText)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n.ShowHelpLayerSignal.inst.addListener(this.renderText,this),n.ShowTutorialSignal.inst.addListener(this.renderText,this)},t.prototype.renderText=function(){this.text?this.text.string=lan.t(i.En_View.BangZhuJieMian,i.En_ID.BangZhuYeMian1+parseInt(this.node.name),["2","+100"]):this.richText&&(this.richText.string=lan.t(i.En_View.BangZhuJieMian,i.En_ID.BangZhuYeMian1+parseInt(this.node.name),["2","+100"]))},t=__decorate([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../table":"table"}],IdleAnimation:[function(e,t,o){"use strict";var n;cc._RF.push(t,"af1b4BfzXBPnqYMAIuUyOYz","IdleAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../../Utils/FrameAniBase"),a=e("../../../Model/Map/MapType"),r=cc._decorator,l=r.ccclass;r.property;o.Idle=((n={})[a.DiamondType.Rainbow]={Count:6,Prefix:"ae_bling_spejewels",Rate:.15,Loop:0,Scale:2},n[a.DiamondType.Peacock]={Count:6,Prefix:"ae_bling_spejewels",Rate:.15,Loop:0,Scale:2},n[a.DiamondType.Square]={Count:4,Prefix:"ae_bling_lightjewels",Rate:.15,Loop:1,Scale:4},n);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this),this.node.opacity=255},t=__decorate([l],t)}(i.default);o.default=s,cc._RF.pop()},{"../../../../Utils/FrameAniBase":"FrameAniBase","../../../Model/Map/MapType":"MapType"}],InitialFacade:[function(e,t,o){"use strict";cc._RF.push(t,"cbbbcO7od5PrqaPNOs8dFh3","InitialFacade"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Command/InititalCommand"),i=e("../Command/StartGameCommand"),a=e("../Command/LoadAudioCommand"),r=e("../Command/LoadPrefabCommand"),l=e("../../Utils/Celer/CelerSDK"),s=e("../../Manager/StepManager"),c=e("../Command/LoadJsonCommand"),u=function(){function e(e){this.stepMgr=new s.StepManager,this.facade=puremvc.Facade.getInstance(e)}return Object.defineProperty(e,"inst",{get:function(){return this.instance?this.instance:this.instance=new e(e.MULTITON_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Facade",{get:function(){return console.assert(null!==this.facade," facade is null"),this.facade},enumerable:!0,configurable:!0}),e.prototype.register=function(){var t=this;this.facade.registerCommand(e.INITIALIZATION,n.InitialCommand),this.facade.registerCommand(e.START_UP,i.StartGameCommand),l.CelerSDK.inst.init(function(){t.facade.sendNotification(e.START_UP,t)}),this.stepMgr.register(function(){l.CelerSDK.inst.celerXReady()},e.TOTAL_STEPS)},e.prototype.unregister=function(){this.facade.removeCommand(e.INITIALIZATION),this.facade.removeCommand(e.START_UP)},e.prototype.start=function(){this.register(),this.facade.sendNotification(e.INITIALIZATION,this)},e.prototype.step=function(e){console.log(" initialization step:",e),this.stepMgr.nextStep(e)},e.MULTITON_KEY="INITIAL_FCADE",e.INITIALIZATION="initialization",e.START_UP="startup",e.TOTAL_STEPS=[a.LoadAudioCommand.STEP,r.LoadPrefabCommand.STEP,c.LoadJsonCommand.STEP],e}();o.InitialFacade=u,cc._RF.pop()},{"../../Manager/StepManager":"StepManager","../../Utils/Celer/CelerSDK":"CelerSDK","../Command/InititalCommand":"InititalCommand","../Command/LoadAudioCommand":"LoadAudioCommand","../Command/LoadJsonCommand":"LoadJsonCommand","../Command/LoadPrefabCommand":"LoadPrefabCommand","../Command/StartGameCommand":"StartGameCommand"}],InititalCommand:[function(e,t,o){"use strict";cc._RF.push(t,"a28caT/H41F74cWxJYqN9pz","InititalCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./LoadPrefabCommand"),i=e("./LoadAudioCommand"),a=e("./LoadJsonCommand"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initializeMacroCommand=function(){this.addSubCommand(n.LoadPrefabCommand),this.addSubCommand(i.LoadAudioCommand),this.addSubCommand(a.LoadJsonCommand)},t}(puremvc.MacroCommand);o.InitialCommand=r,cc._RF.pop()},{"./LoadAudioCommand":"LoadAudioCommand","./LoadJsonCommand":"LoadJsonCommand","./LoadPrefabCommand":"LoadPrefabCommand"}],LeafBreakAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"9d18e8rt7BPM4oVAhnYcbc9","LeafBreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/Map/MapType"),i=e("../EffectBase"),a=e("../Root/BlockRoot"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this),this.node.scale=2},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),a.PlayBlockBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){this.ID&&this.ID==e.ID&&e.Type==n.MapType.Grass&&t>=1&&this.play()},t=__decorate([l],t)}(i.default));o.default=s,cc._RF.pop()},{"../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/BlockRoot":"BlockRoot"}],LevelLight:[function(e,t,o){"use strict";cc._RF.push(t,"c8446hc8zlCFYfxexq3LYzw","LevelLight"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Celer/CelerSDK"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.DifficultyLevelSignal.inst.addListenerOne(function(t){switch(t){case 1:e.node.active=!0;break;case 2:e.node.active=!1}},this)},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../Utils/Celer/CelerSDK":"CelerSDK"}],LevelProgressView:[function(e,t,o){"use strict";cc._RF.push(t,"ab55bq0SKlCI6wpMG7plPIK","LevelProgressView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Global/GameRule"),i=e("../../../Model/PlayModelProxy"),a=e("../../../Utils/Celer/CelerSDK"),r=cc._decorator,l=r.ccclass,s=(r.property,[0,0,1,1.9]),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Line",{get:function(){return this.node.getChildByName("Line")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Tag",{get:function(){return this.node.getChildByName("Tag")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;a.DifficultyLevelSignal.inst.addListenerOne(function(t){switch(t){case 1:e.node.active=!0;break;case 2:e.node.active=!1}},this),i.NextLevelSignal.inst.addListenerOne(this.onLevelChanged,this);for(var t=0,o=this.Tag.children;t<o.length;t++){o[t].active=!1}this.Line.scaleX=0},t.prototype.onLevelChanged=function(e){var t=this;if(!n.IsUnlimitedLevel()){this.Line.stopAllActions();var o=s[e];this.Line.runAction(cc.sequence(cc.scaleTo(Math.abs(o-this.Line.scaleX)/5,o,1),cc.callFunc(function(){for(var o=0,n=t.Tag.children;o<n.length;o++){var i=n[o];i.active=e>=parseInt(i.name)}})))}},t=__decorate([l],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../Global/GameRule":"GameRule","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Celer/CelerSDK":"CelerSDK"}],Level:[function(e,t,o){"use strict";cc._RF.push(t,"3db54FVK6dM2Ik/+eMmSgop","Level"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Cocos"),i=e("./Theme"),a=function(){function e(){}return e.getThemeRandomPool=function(e){for(;this.pool.length<120;)this.pool.push(i.Theme.Wood),this.pool.push(i.Theme.Stone);return n.disOrderArray(this.pool),this.pool},e.pool=[],e}();o.Level=a,cc._RF.pop()},{"../Utils/Cocos":"Cocos","./Theme":"Theme"}],LightRoot:[function(e,t,o){"use strict";cc._RF.push(t,"0bce0abRsxJ9rETP02tcE+l","LightRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../Model/Map/MapType"),a=e("../Diamond/NormalBreakAnimation"),r=e("./NormalRoot"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){r.OnDiamondBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){if(t!=a.AniType.None&&!([a.AniType.Peacok,a.AniType.RainbowFrom,a.AniType.RainbowTo].indexOf(t)<0)){var o=n.gFactory.getObj("Effect",e.ID,t);o.setPosition(i.GetPosByIndex(e.Index)),this.node.addChild(o),r.PlayDiamondBreakSignal.inst.dispatchTwo(e,t)}},t=__decorate([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../Model/Map/MapType":"MapType","../Diamond/NormalBreakAnimation":"NormalBreakAnimation","./NormalRoot":"NormalRoot"}],LineBreakAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"2b7adaChfhI9rYGtLLJ5Ii0","LineBreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/Map/MapType"),i=e("../EffectBase"),a=e("../Root/LineRoot"),r=e("./NormalBreakAnimation"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this),this.node.height=100},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),a.PlayLineEffectSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){t!=r.AniType.None&&e.ID==this.ID&&t==this.Type&&(this.play(),this.Interval=.07,this.Interval*=n.GetTimeScale())},t=__decorate([s],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/LineRoot":"LineRoot","./NormalBreakAnimation":"NormalBreakAnimation"}],LineRoot:[function(e,t,o){"use strict";cc._RF.push(t,"b81978r+adF45cVLv3pOdWo","LineRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../../Model/PlayModelProxy"),a=e("../../../../Utils/Signal"),r=e("../../../Model/GameLogic"),l=e("../../../Model/Map/MapType"),s=e("../../Game/Map/MapRoot"),c=e("../Diamond/NormalBreakAnimation"),u=e("./NormalRoot"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.PlayLineEffectSignal=h;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){u.OnDiamondBreakSignal.inst.addListenerThree(this.onBreak,this)},t.prototype.onBreak=function(e,t,o){if(!([l.DiamondType.Diagonal,l.DiamondType.Horizonal,l.DiamondType.Vertical].indexOf(e.Type)<0)){switch(t=c.AniType.Line,e.Type){case l.DiamondType.Diagonal:var a=l.GetDiagonalIndex(e.Index,r.GameLogic.inst.IndexStart,r.GameLogic.inst.IndexEnd),u=[a.center13,a.center24];if(u)for(var p=0,d=u;p<d.length;p++){var m=d[p],f=n.gFactory.getObj("Effect",e.ID,t);f.setPosition(m.pos),f.rotation=m.rotation,f.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,f.width=m.count*Math.SQRT2*120,f.width+=120,this.node.addChild(f)}break;case l.DiamondType.Horizonal:var y=n.gFactory.getObj("Effect",e.ID,t);y.setPosition(0,l.GetPosByIndex(e.Index).y),y.rotation=0,y.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,y.width=1080,y.width+=120,this.node.addChild(y);break;case l.DiamondType.Vertical:var g=n.gFactory.getObj("Effect",e.ID,t);g.setPosition(l.GetPosByIndex(e.Index).x,-i.PlayModelProxy.inst.Level*s.ReadyOffset),g.rotation=90,g.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,g.width=1440,g.width+=120,this.node.addChild(g)}h.inst.dispatchTwo(e,t)}},t=__decorate([d],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../../Model/PlayModelProxy":"PlayModelProxy","../../../../Utils/Signal":"Signal","../../../Model/GameLogic":"GameLogic","../../../Model/Map/MapType":"MapType","../../Game/Map/MapRoot":"MapRoot","../Diamond/NormalBreakAnimation":"NormalBreakAnimation","./NormalRoot":"NormalRoot"}],LoadAudioCommand:[function(e,t,o){"use strict";cc._RF.push(t,"d4f3eGYUlBES5d8aEvuPQna","LoadAudioCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Manager/AudioManager"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){if(e){var o=e.getBody();o&&o.step&&n.gAudio.init(function(){o.step(t.STEP)})}},t.STEP="LoadAudio",t}(puremvc.SimpleCommand);o.LoadAudioCommand=i,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager"}],LoadJsonCommand:[function(e,t,o){"use strict";cc._RF.push(t,"a8ceflQ6kFFcbxjBXqDT3ec","LoadJsonCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../TableManager"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){n.TableManager.inst.startLoad("/json",function(){if(e){var o=e.getBody();o&&o.step&&o.step(t.STEP)}})},t.STEP="LoadJson",t}(puremvc.SimpleCommand);o.LoadJsonCommand=i,cc._RF.pop()},{"../../TableManager":"TableManager"}],LoadPrefabCommand:[function(e,t,o){"use strict";cc._RF.push(t,"8b33fPnvCZEJ7bc/zCVv9My","LoadPrefabCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){n.gFactory.init(function(){if(e){var o=e.getBody();o&&o.step&&o.step(t.STEP)}})},t.STEP="LoadPrefab",t}(puremvc.SimpleCommand);o.LoadPrefabCommand=i,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory"}],LoadingPageMediator:[function(e,t,o){"use strict";cc._RF.push(t,"359acCsI6FNpLUAuWOw+Fv4","LoadingPageMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseMediator"),i=e("../../Utils/Celer/CelerSDK"),a=e("../../Command/CommonSignal"),r=e("../../Model/PlayModelProxy"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=3e3,t.startTime=0,t}return __extends(t,e),t.prototype.onRegister=function(){this.startTime=Date.now(),a.GameReadySignal.inst.addOnce(this.onGameReady,this)},t.prototype.onGameReady=function(){var e=this;a.ShowTutorialSignal.inst.dispatch(),a.HideHelpLayerSignal.inst.dispatch();var t=Date.now()-this.startTime;console.log(" -- game init done, hide loading page: ",t),t<=this.time?setTimeout(function(){e.View.Hide(function(){e.startGame()})},this.time-t):this.View.Hide(function(){e.startGame()})},t.prototype.startGame=function(){i.CelerSDK.inst.isNew()?a.ShowTutorialSignal.inst.dispatchOne(function(){r.PlayModelProxy.inst.gameReadyShow()}):r.PlayModelProxy.inst.gameReadyShow()},t.prototype.onDestroy=function(){},t=__decorate([s],t)}(n.default));o.default=c,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Model/PlayModelProxy":"PlayModelProxy","../../Utils/Celer/CelerSDK":"CelerSDK","../../View/BaseMediator":"BaseMediator"}],LoadingView:[function(e,t,o){"use strict";cc._RF.push(t,"dfec6LZreJCaa8QdaMxRAO/","LoadingView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseView"),i=e("./LoadingPageMediator"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=1,this.node.opacity=255,this.BindMedaitor(i.default)},t.prototype.start=function(){},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.node.active=!1,e()})))},t=__decorate([r],t)}(n.default));o.default=l,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],LogHandler:[function(e,t,o){"use strict";cc._RF.push(t,"a4747QIvUBIo6Ktpx/xQwuB","LogHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var o=e.call(this)||this;if(o.logFunc=console.log,o.logMsg=null,o.frameTimes=0,o.now=0,o.Frame=20,o.totalFrames=0,o.startTime=0,window.addEventListener)for(var n=0,i=t.LISTENNING_EVENTS;n<i.length;n++){var a=i[n],r="trigger"+a.charAt(0).toLocaleUpperCase()+a.substring(1);o[r]&&"function"==typeof o[r]&&window.addEventListener(a,o[r].bind(o))}return o}return __extends(t,e),t.prototype.dumpFrameInfo=function(){var e=(Date.now()-this.startTime)/1e3,t=e/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",e+"s"," , per frame cost time ave:"+t+"s")},t.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLog.apply(this,e),this.sendLog()},t.prototype.ready=function(){console.log(t.VERSION)},t.prototype.initLog=function(e){var o=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){o.frameTimes=0,o.now=Date.now(),o.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){o.frameTimes++,o.totalFrames++,o.frameTimes>=o.Frame&&(o.frameTimes=0,o.now=Date.now())},this),this.logFunc=e,window.consoleError=console.error,window.consoleWarn=console.warn,window.consoleLog=console.log,window.consoleAssert=console.assert,console.error=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[ERROR]"].concat(o))},console.warn=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[WARN]"].concat(o))},console.log=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[INFO]"].concat(o))},console.assert=function(e){for(var o,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];e||(o=t.inst).log.apply(o,["[ASSERT ERROR]"].concat(n))}},t.prototype.formatLogArguments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o="",n=0;n<arguments.length;n++){var i=typeof arguments[n];"string"==i||"number"==i?o+=" "+arguments[n]:"object"==i?o+=" "+JSON.stringify(arguments[n]):"boolean"==i&&arguments[n].toString&&(o+=arguments[n].toString())}return o},t.prototype.addLog=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==this.logMsg&&(this.logMsg={});var n=this.formatLogArguments.apply(this,e),i=this.getFullTime(new Date);this.logMsg[i]=t.VERSION+n},t.prototype.getFullTime=function(e){var t="";t+=e.getFullYear();var o=e.getMonth()+1;t+="-"+(o>=10?o:"0"+o);var n=e.getDate();t+="-"+(n>=10?n:"0"+n);var i=e.getHours();t+="  "+(i>=10?i:"0"+i);var a=e.getMinutes();t+=":"+(a>=10?a:"0"+a);var r=e.getSeconds();return t+=":"+(r>=10?r:"0"+r)},t.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},t.prototype.triggerClose=function(e){this.addLog("triggerClose"),this.sendLog()},t.prototype.triggerLoad=function(e){this.addLog("triggerLoad"),this.sendLog()},t.prototype.triggerUnload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerOnunload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerError=function(e){this.addLog("triggerError"),this.addLog(e.message),this.sendLog()},t.prototype.triggerFocus=function(e){this.addLog("triggerFocus"),this.sendLog()},t.prototype.triggerBlur=function(e){this.addLog("triggerBlur"),this.sendLog()},t.prototype.triggerAbort=function(e){this.addLog("triggerAbort"),this.sendLog()},t.prototype.triggerSuspend=function(e){this.addLog("triggerSuspend"),this.sendLog()},t.prototype.beforeunload=function(e){this.addLog("beforeunload"),this.sendLog()},t.VERSION=window.GAME_VERSION||" --- ",t.LISTENNING_EVENTS=["error"],t}(e("./ToSingleton").SingleTon());o.LogHandler=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],MapFactory:[function(e,t,o){"use strict";cc._RF.push(t,"2fc07yXv/JNl6wG+G0dAyQs","MapFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Global/GameRule"),i=e("../../../table"),a=e("../../../TableManager"),r=e("../../../Utils/Cocos"),l=e("../../../Utils/Random"),s=e("../../../Utils/ToSingleton"),c=e("./MapType"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mapPool=[],t.currentMap=null,t.nextMap=null,t.readyNextMap=null,t}return __extends(t,e),t.prototype.init=function(){var e=a.TableManager.inst.getAll_Level_Data();for(var t in e){var o=parseInt(t);if(n.IsUnlimitedLevel()){if(-1!=o)continue}else if(-1==o)continue;var l=e[t];this.mapPool[o]=[];for(var s=0,u=l.Map;s<u.length;s++){var p=u[s],d=[],h=a.TableManager.inst["getAll_"+p+"_Data"](),m=a.TableManager.inst["get"+p](0).GoldCount,f=[];if(h){for(var y in h){for(var g=h[y],S=0;S<g.Type.length;S++)g.Type[S]==i.Map1_1_Type.Tu&&f.push(c.ij2Index(parseInt(y),S));d.push(g.Type.concat())}for(var M=20;M-- >0;)this.mapPool[o].push({mapType:d.concat(),block:{GoldNum:m,GoldRandom:[]},name:p})}}r.disOrderArray(this.mapPool[o])}},t.prototype.getMap=function(){if(null==this.currentMap){if(this.readyNextMap)return this.currentMap=this.readyNextMap,this.readyNextMap=null,this.currentMap;this.currentMap=[];var e=a.TableManager.inst.getAll_Level_Data();for(var t in e){var o=parseInt(t);if(n.IsUnlimitedLevel()){if(-1!=o)continue}else if(-1==o)continue;var i=l.Random.randomFloorToInt(0,this.mapPool[o].length),r=this.mapPool[o][i];console.log(o,"random map:",r.name),this.currentMap.push(r)}}return this.currentMap},t.prototype.getMapByLevel=function(e){return n.IsUnlimitedLevel()&&(e=0),this.getMap()[e]},t.prototype.getNextMap=function(){if(null==this.nextMap){this.nextMap=[];var e=a.TableManager.inst.getAll_Level_Data();for(var t in e){var o=parseInt(t);if(n.IsUnlimitedLevel()){if(-1!=o)continue}else if(-1==o)continue;var i=l.Random.randomFloorToInt(0,this.mapPool[o].length),r=this.mapPool[o][i];console.log(o,"random next map:",r.name),this.nextMap.push(r)}}return this.nextMap},t.prototype.reset=function(){n.IsUnlimitedLevel()?(this.readyNextMap=this.getNextMap(),this.nextMap=null):this.currentMap=null},t.prototype.clearCurrentMap=function(){this.currentMap=null},t}(s.SingleTon());o.MapFactory=u,cc._RF.pop()},{"../../../Global/GameRule":"GameRule","../../../TableManager":"TableManager","../../../Utils/Cocos":"Cocos","../../../Utils/Random":"Random","../../../Utils/ToSingleton":"ToSingleton","../../../table":"table","./MapType":"MapType"}],MapInfo:[function(e,t,o){"use strict";cc._RF.push(t,"6f8cdG8ulJFHo1hU+XtPCu9","MapInfo"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Model/PlayModelProxy"),i=e("../Utils/Signal"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.MapNameUpdateSignal=l;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Next",{get:function(){return this.node.getChildByName("NextLevel")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.node.active=!CELER_X,this.getComponent(cc.Label).string="",l.inst.addListenerTwo(function(t,o){e.getComponent(cc.Label).string="Current Map: "+t.replace("_","-")+", Next Map: "+o.replace("_","-")},this),this.Next.on(cc.Node.EventType.TOUCH_END,function(){n.PlayModelProxy.inst.testNextLevel()},this)},t=__decorate([r],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../Model/PlayModelProxy":"PlayModelProxy","../Utils/Signal":"Signal"}],MapRoot:[function(e,t,o){"use strict";cc._RF.push(t,"d809ee/x6dIkp5SqLZvj4Jo","MapRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Controller/GameStateController"),i=e("../../../../Global/GameRule"),a=e("../../../../Model/PlayModelProxy"),r=e("../../../../Utils/Signal"),l=e("../../../../View/Transform/PositionView"),s=cc._decorator,c=s.ccclass;s.property;o.MapMoveTime=(CELER_X,1),o.ReadyOffset=1427.234;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.ShowMapByLevelSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.StepMapOffsetSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.OnRunLevelDoneSignal=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.OnMapMoveSignal=h;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startY=0,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.startY=this.node.y,a.NextLevelSignal.inst.addListenerOne(function(e){0==e&&t.node.y==t.startY||t.onNextLevel(e,o.MapMoveTime,function(){d.inst.dispatch()})},this),u.inst.addListenerThree(this.onNextLevel,this),CELER_X||p.inst.addListenerOne(function(e){t.onPositionChanged(t.node.position.add(cc.v2(0,e)),0,function(){})},this)},t.prototype.onNextLevel=function(e,t,a){void 0===t&&(t=o.MapMoveTime),void 0===a&&(a=function(){}),e>=i.GetTotalLevel()&&!i.IsUnlimitedLevel()?console.log(" Game Complete."):(null!=this.CompleteCallback&&this.complete(),n.GameStateController.inst.pause(!0),this.onPositionChanged(cc.v2(0,e*o.ReadyOffset),t,function(){n.GameStateController.inst.resume(),a()}))},t.prototype.onStep=function(){e.prototype.onStep.call(this),h.inst.dispatchOne(this.node.position)},t=__decorate([c],t)}(l.default);o.default=m,cc._RF.pop()},{"../../../../Controller/GameStateController":"GameStateController","../../../../Global/GameRule":"GameRule","../../../../Model/PlayModelProxy":"PlayModelProxy","../../../../Utils/Signal":"Signal","../../../../View/Transform/PositionView":"PositionView"}],MapType:[function(e,t,o){"use strict";cc._RF.push(t,"c594aOifmFFpqUmlfAqn4vv","MapType"),Object.defineProperty(o,"__esModule",{value:!0});var n,i,a=e("../../../Utils/Random"),r=e("../../View/Game/Map/MapRoot");(function(e){e[e.Empty=1]="Empty",e[e.Free=2]="Free",e[e.Soil=3]="Soil",e[e.Stone=4]="Stone",e[e.Grass=5]="Grass"})(o.MapType||(o.MapType={})),function(e){e[e.Normal=0]="Normal",e[e.Horizonal=1]="Horizonal",e[e.Vertical=2]="Vertical",e[e.Square=3]="Square",e[e.Diagonal=4]="Diagonal",e[e.Rainbow=5]="Rainbow",e[e.Peacock=6]="Peacock"}(n=o.DiamondType||(o.DiamondType={})),function(e){e[e.None=1]="None",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Blue=4]="Blue",e[e.Pink=5]="Pink",e[e.Purple=6]="Purple",e[e.Orange=7]="Orange"}(i=o.DiamondColor||(o.DiamondColor={}));var l=function(){function e(){}return e.Pool=[],e}();function s(e){return Math.floor(e/9)}function c(e){return e%9}function u(e,t){return 9*e+t}function p(e,t,o){var n=[],i=s(e),a=c(e),r=i-1;if(r>=0){var l=u(r,a);l>=t&&l<o&&n.push(l)}var p=u(i+1,a);p>=t&&p<o&&n.push(p);var d=a-1;if(d>=0){var h=u(i,d);h>=t&&h<o&&n.push(h)}var m=a+1;if(m<=8){var f=u(i,m);f>=t&&f<o&&n.push(f)}return n}function d(e){var t=s(e),o=c(e),n=r.ReadyOffset/12,i=(o-4)*n,a=0;return a=5==t?n/2:t<5?(5-t)*n+(5-t)/Math.abs(5-t)*(n/2):(5-t+1)*n+(5-t)/Math.abs(5-t)*(n/2),cc.v2(i,a)}o.ColorPool=l,o.GetColorPool=function(){return(!l.Pool||l.Pool.length<=0)&&(l.Pool=[[i.Blue,i.Green,i.Orange,i.Pink,i.Purple],[i.Blue,i.Green,i.Pink,i.Purple,i.Yellow]][a.Random.randomFloorToInt(0,2)],console.log(" ColorPool.Pool:",l.Pool)),l.Pool.concat()},o.MapSize=cc.size(119,119),o.MapIJ={MaxI:9,MaxJ:12},o.MapLength=o.MapIJ.MaxI*o.MapIJ.MaxJ*2,o.Index2i=s,o.Index2j=c,o.ij2Index=u,o.GetDiagonalIndex=function(e,t,o){var n={indexList:[],center13:{pos:cc.v2(0,0),rotation:-45,count:0,i:0,j:0},center24:{pos:cc.v2(0,0),rotation:45,count:0,i:0,j:0}},i=s(t),a=s(o),r=s(e),l=c(e),p=r,h=l,m=r,f=r,y=l,g=r,S=[];for(h=l;--p>=i&&--h>=0;){var M=u(p,h);n.indexList.push(M),S.push(M),n.center24.count++}for(h<0&&p++,y=l;++y<9&&++g<a;){var _=u(g,y);n.indexList.push(_),S.push(_),n.center24.count++}g>=a&&y--,S.push(e),n.center24.count++,n.center24.j=(Math.max(0,h)+Math.min(8,y))/2;for(var C=0,v=S;C<v.length;C++){var T=v[C];if(c(T)==Math.floor(n.center24.j)){n.center24.i=s(T);break}}var b=u(Math.floor(n.center24.i),Math.floor(n.center24.j));n.center24.count%2==0?n.center24.pos=d(b).addSelf(cc.v2(60,-60)):n.center24.pos=d(b);var P=[];for(P.push(e),n.center13.count++,h=l;--h>=0&&++m<a;){var R=u(m,h);n.indexList.push(R),n.center13.count++,P.push(R)}for(m>=a&&h++,y=l;--f>=i&&++y<9;){var x=u(f,y);n.indexList.push(x),n.center13.count++,P.push(x)}y>=9&&f++,n.center13.j=(Math.max(0,h)+Math.min(8,y))/2;for(var L=0,w=P;L<w.length;L++){var F=w[L];if(c(F)==Math.floor(n.center13.j)){n.center13.i=s(F);break}}var G=u(Math.floor(n.center13.i),Math.floor(n.center13.j));return n.center13.count%2==0?n.center13.pos=d(G).addSelf(cc.v2(60,60)):n.center13.pos=d(G),n},o.GetHorizonalIndex=function(e){for(var t=[],o=s(e),n=c(e);--n>=0;)t.push(u(o,n));for(n=c(e);++n<=8;)t.push(u(o,n));return t},o.GetVerticalIndex=function(e,t,o){for(var n=[],i=s(t),a=s(o),r=s(e),l=c(e);--r>=i;)n.push(u(r,l));for(r=s(e);++r<a;)n.push(u(r,l));return n},o.GetSquareIndex=function(e,t,o){var n=p(e,t,o),i=s(t),a=s(o),r=s(e),l=c(e),d=r-1,h=r+1,m=l+1,f=l-1;return d>=i&&f>=0&&n.push(u(d,f)),d>=i&&m<=8&&n.push(u(d,m)),h<a&&f>=0&&n.push(u(h,f)),h<a&&m<=8&&n.push(u(h,m)),n},o.GetCrossShapeIndex=p,o.GetPosByIndex=d,o.GetTimeScale=function(){return CELER_X,1},o.GetInitDiamondType=function(){return n.Normal},cc._RF.pop()},{"../../../Utils/Random":"Random","../../View/Game/Map/MapRoot":"MapRoot"}],MenuButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"28073o37LNPKaWTUfECMch5","MenuButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=e("../../../Utils/Signal"),r=e("../../../View/SingleTouchView"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.MenuButtonClickSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||(c.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t.prototype.start=function(){},t=__decorate([s],t)}(r.default);o.default=u,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView"}],MenuLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"85bd9XHwOpA8pPYE/vCkvEe","MenuLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=e("../../../Global/GameRule"),r=e("../../../Model/PlayModelProxy"),l=e("../../../table"),s=e("../../../View/BaseView"),c=e("../../Model/GamePlayModel"),u=e("./MenuButtonView"),p=e("./SubmitLayerView"),d=cc._decorator,h=d.ccclass,m=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("ResumeButton")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndNow",{get:function(){return this.node.getChildByName("EndNow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content",{get:function(){return this.node.getChildByName("Content").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;u.MenuButtonClickSignal.inst.addListener(this.onShow,this),n.ShowPauseLayerSignal.inst.addListener(function(){t.onShow()},this),this.Resume.on(cc.Node.EventType.TOUCH_END,function(){i.GameStateController.inst.resume(),n.ButtonClickSignal.inst.dispatch(),t.Hide()},this),this.EndNow.on(cc.Node.EventType.TOUCH_END,function(){t.Hide(),n.ButtonClickSignal.inst.dispatch(),p.EndNowSignal.inst.dispatch()},this),e.prototype.onLoad.call(this),this.node.active=!1},t.prototype.onShow=function(){this.node.active||(r.PlayModelProxy.inst.FreePauseCount<=0?this.Content.string=lan.t(l.En_View.ZanTingJieMian,l.En_ID.ZanTingKouFen,[""+a.GetScoreByType(c.ScoreType.PauseCost)]):this.Content.string=lan.t(l.En_View.ZanTingJieMian,l.En_ID.MianFeiZanTing,[r.PlayModelProxy.inst.FreePauseCount.toString(),""+a.GetScoreByType(c.ScoreType.PauseCost)]),this.Show(),i.GameStateController.inst.pause())},t.prototype.start=function(){},t=__decorate([h],t)}(s.default));o.default=m,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Global/GameRule":"GameRule","../../../Model/PlayModelProxy":"PlayModelProxy","../../../View/BaseView":"BaseView","../../../table":"table","../../Model/GamePlayModel":"GamePlayModel","./MenuButtonView":"MenuButtonView","./SubmitLayerView":"SubmitLayerView"}],MergeAnimation:[function(e,t,o){"use strict";var n;cc._RF.push(t,"009722VdURCBKr/u5er1+8S","MergeAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../Model/Map/MapType"),a=e("../EffectBase"),r=e("../Root/MergeRoot"),l=cc._decorator,s=l.ccclass,c=(l.property,(n={})[i.DiamondType.Rainbow]={Count:8,Prefix:"ae_merge",Scale:4},n[i.DiamondType.Peacock]={Count:6,Prefix:"ae_merge_spe",Scale:4},n[i.DiamondType.Horizonal]={Count:6,Prefix:"ae_merge_spe",Scale:4},n[i.DiamondType.Vertical]={Count:6,Prefix:"ae_merge_spe",Scale:4},n[i.DiamondType.Diagonal]={Count:6,Prefix:"ae_merge_spe",Scale:4},n[i.DiamondType.Square]={Count:6,Prefix:"ae_merge_spe",Scale:4},n),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),r.PlayDiamondMergeSignal.inst.addListenerTwo(this.onMerge,this)},t.prototype.onMerge=function(e,t){if(e.Type!=i.DiamondType.Normal&&e.ID==this.ID&&t==this.Type){var o=c[e.Type];this.PrefixName=o.Prefix,this.FrameCount=o.Count,this.node.scale=o.Scale,this.play()}},t=__decorate([s],t)}(a.default);o.default=u,cc._RF.pop()},{"../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/MergeRoot":"MergeRoot"}],MergeRoot:[function(e,t,o){"use strict";cc._RF.push(t,"ef119V3BTlPWKs9PYwkMqLS","MergeRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../../Utils/Signal"),a=e("../../../Model/Map/MapType"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.OnDiamonMergeSignal=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayDiamondMergeSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){s.inst.addListenerTwo(this.onMerge,this)},t.prototype.onMerge=function(e,t){var o=n.gFactory.getObj("Effect",e.ID,t);o.setPosition(a.GetPosByIndex(e.Index)),this.node.addChild(o),c.inst.dispatchTwo(e,t)},t=__decorate([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../../Utils/Signal":"Signal","../../../Model/Map/MapType":"MapType"}],MoveCountLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"523c3oc4AhAw43gNtGFJ99Y","MoveCountLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=e("../../../Utils/Signal"),r=e("../../../View/NumberChangedView"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.MoveCountChangedSignal=c;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=0,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),n.GameOverSignal.inst.addListenerOne(function(e){t.type=e},this),this.STEP=1e5,c.inst.addListenerOne(function(e){t.type==i.RoundEndType.Complete&&0!=e||(0==e&&i.GameStateController.inst.isGameOver()?t.onNumberChanged(e):t.setNumber(e))},this)},t.prototype.update=function(t){this.time+=t,this.time<.1||(this.time=0,e.prototype.update.call(this,t))},t=__decorate([s],t)}(r.default);o.default=u,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/NumberChangedView":"NumberChangedView"}],MoveCountLabel:[function(e,t,o){"use strict";cc._RF.push(t,"3b005nM2ZpFEoGPYvlb8CaH","MoveCountLabel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Celer/CelerSDK"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.DifficultyLevelSignal.inst.addListenerOne(function(t){switch(t){case 1:e.node.active=!0;break;case 2:e.node.active=!1}},this)},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../Utils/Celer/CelerSDK":"CelerSDK"}],MoveFlyAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"bd522nUCEpCJZU2DyAtX9Qk","MoveFlyAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=e("../../../Utils/Signal"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.MoveFlySignal=l;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.opacity=0,this.Interval=.1,l.inst.addListener(function(){t.isPlaying||t.play()},this)},t=__decorate([r],t)}(n.default);o.default=s,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase","../../../Utils/Signal":"Signal"}],MudBreakAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"654a2LBIdJPdb3NSUS/lOeo","MudBreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../EffectBase"),i=e("../Root/BlockRoot"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this),this.node.scale=2},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.PlayBlockBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){this.ID&&this.ID==e.ID&&t<1&&this.play()},t=__decorate([r],t)}(n.default));o.default=l,cc._RF.pop()},{"../EffectBase":"EffectBase","../Root/BlockRoot":"BlockRoot"}],NormalBreakAnimation:[function(e,t,o){"use strict";var n,i,a,r,l,s;cc._RF.push(t,"6e7abVPhg9KJ5CuC+I+KC79","NormalBreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var c,u=e("../../../Model/EliminationChecker"),p=e("../../../Model/Map/MapType"),d=e("../EffectBase"),h=e("../Root/NormalRoot"),m=cc._decorator,f=m.ccclass;m.property;function y(e,t){return[c.Peacok,c.RainbowFrom,c.RainbowTo,c.PeacokFly].indexOf(e)>=0?o.BreakAnimation[e]:o.BreakAnimation[e][t]}(function(e){e[e.None=0]="None",e[e.Normal=1]="Normal",e[e.Vertical=2]="Vertical",e[e.Horizonal=3]="Horizonal",e[e.Square=4]="Square",e[e.Cross=5]="Cross",e[e.Peacok=6]="Peacok",e[e.PeacokFly=7]="PeacokFly",e[e.RainbowTo=8]="RainbowTo",e[e.RainbowFrom=9]="RainbowFrom",e[e.RainbowLightLine=10]="RainbowLightLine",e[e.Merge=11]="Merge",e[e.Line=12]="Line"})(c=o.AniType||(o.AniType={})),o.BreakAnimation=((n={})[c.Peacok]={Count:8,Prefix:"ae_goldlight",Scale:4,Interval:.05},n[c.PeacokFly]={Count:8,Prefix:"ae_flightgo",Scale:4,Interval:.05},n[c.RainbowFrom]={Count:8,Prefix:"ae_light_rainbow",Scale:4,Interval:.08},n[c.RainbowTo]={Count:6,Prefix:"ae_dispear_jewel",Scale:4,Interval:.08},n[c.Normal]=((i={})[p.DiamondColor.Blue]={Count:6,Prefix:"ae_blue",Scale:2,Interval:.05},i[p.DiamondColor.Green]={Count:6,Prefix:"ae_green",Scale:2,Interval:.05},i[p.DiamondColor.Pink]={Count:6,Prefix:"ae_pink",Scale:2,Interval:.05},i[p.DiamondColor.Purple]={Count:6,Prefix:"ae_purple",Scale:2,Interval:.05},i[p.DiamondColor.Yellow]={Count:6,Prefix:"ae_yellow",Scale:2,Interval:.05},i[p.DiamondColor.Orange]={Count:6,Prefix:"ae_orange",Scale:2,Interval:.05},i),n[c.Cross]=((a={})[p.DiamondColor.Blue]={Count:8,Prefix:"ae_blue_overlap",Scale:2,Interval:.05},a[p.DiamondColor.Green]={Count:8,Prefix:"ae_green_jiaocha",Scale:2,Interval:.05},a[p.DiamondColor.Pink]={Count:8,Prefix:"ae_pink_jiaocha",Scale:2,Interval:.05},a[p.DiamondColor.Purple]={Count:8,Prefix:"ae_purple_jiaocha",Scale:2,Interval:.05},a[p.DiamondColor.Yellow]={Count:8,Prefix:"ae_yellow_jiaocha",Scale:2,Interval:.05},a[p.DiamondColor.Orange]={Count:8,Prefix:"ae_orange_jiaocha",Scale:2,Interval:.05},a),n[c.Horizonal]=((r={})[p.DiamondColor.Blue]={Count:8,Prefix:"ae_blue_heng",Scale:2,Interval:.05},r[p.DiamondColor.Green]={Count:8,Prefix:"ae_green_heng",Scale:2,Interval:.05},r[p.DiamondColor.Pink]={Count:8,Prefix:"ae_pink_heng",Scale:2,Interval:.05},r[p.DiamondColor.Purple]={Count:8,Prefix:"ae_purple_heng",Scale:2,Interval:.05},r[p.DiamondColor.Yellow]={Count:8,Prefix:"ae_yellow_heng",Scale:2,Interval:.05},r[p.DiamondColor.Orange]={Count:8,Prefix:"ae_orange_heng",Scale:2,Interval:.05},r),n[c.Square]=((l={})[p.DiamondColor.Blue]={Count:7,Prefix:"ae_nine",Scale:4,Interval:.05},l[p.DiamondColor.Green]={Count:7,Prefix:"ae_nine",Scale:4,Interval:.05},l[p.DiamondColor.Pink]={Count:7,Prefix:"ae_nine",Scale:4,Interval:.05},l[p.DiamondColor.Purple]={Count:7,Prefix:"ae_nine",Scale:4,Interval:.05},l[p.DiamondColor.Yellow]={Count:7,Prefix:"ae_nine",Scale:4,Interval:.05},l[p.DiamondColor.Orange]={Count:7,Prefix:"ae_nine",Scale:4,Interval:.05},l),n[c.Vertical]=((s={})[p.DiamondColor.Blue]={Count:8,Prefix:"ae_blue_shu",Scale:2,Interval:.05},s[p.DiamondColor.Green]={Count:8,Prefix:"ae_green_shu",Scale:2,Interval:.05},s[p.DiamondColor.Pink]={Count:8,Prefix:"ae_pink_shu",Scale:2,Interval:.05},s[p.DiamondColor.Purple]={Count:8,Prefix:"ae_purple_shu",Scale:2,Interval:.05},s[p.DiamondColor.Yellow]={Count:8,Prefix:"ae_yellow_shu",Scale:2,Interval:.05},s[p.DiamondColor.Orange]={Count:8,Prefix:"ae_orange_shu",Scale:2,Interval:.05},s),n),o.GetAniType=function(e,t){var o=c.Normal;switch(e){case p.DiamondType.Diagonal:o=c.Cross;break;case p.DiamondType.Horizonal:o=c.Horizonal;break;case p.DiamondType.Vertical:o=c.Vertical;break;case p.DiamondType.Normal:o=c.Normal;break;case p.DiamondType.Peacock:o=c.Peacok;break;case p.DiamondType.Rainbow:o=c.RainbowFrom;break;case p.DiamondType.Square:o=c.Square}return o==c.Normal&&[u.EliminationType.Merge4,u.EliminationType.Peacock,u.EliminationType.Word,u.EliminationType.Rainbow].indexOf(t)>=0&&(o=c.None),o},o.GetFrameInfo=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),h.PlayDiamondBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){if(t!=c.None&&t!=c.RainbowLightLine&&t!=c.Line&&e.ID==this.ID&&t==this.Type){var o=y(t,e.Color);this.FrameCount=o.Count,this.PrefixName=o.Prefix,this.node.scale=o.Scale,this.Interval=o.Interval||.05,this.Interval*=p.GetTimeScale(),this.play()}},t=__decorate([f],t)}(d.default);o.default=g,cc._RF.pop()},{"../../../Model/EliminationChecker":"EliminationChecker","../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/NormalRoot":"NormalRoot"}],NormalRoot:[function(e,t,o){"use strict";cc._RF.push(t,"23d39Wi7f5DZKbH5wPlx2n7","NormalRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../../Utils/Signal"),a=e("../../../Model/Map/MapType"),r=e("../Diamond/NormalBreakAnimation"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.PlayDiamondBreakSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.OnDiamondBreakSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){u.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){if(t!=r.AniType.None&&!([r.AniType.Square,r.AniType.Peacok,r.AniType.RainbowFrom,r.AniType.RainbowTo].indexOf(t)>=0)){var o=n.gFactory.getObj("Effect",e.ID,t);o.setPosition(a.GetPosByIndex(e.Index)),this.node.addChild(o),c.inst.dispatchTwo(e,t)}},t=__decorate([s],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../../Utils/Signal":"Signal","../../../Model/Map/MapType":"MapType","../Diamond/NormalBreakAnimation":"NormalBreakAnimation"}],NumberChangedView:[function(e,t,o){"use strict";cc._RF.push(t,"5f2acutWoZLka/VldveJWjk","NumberChangedView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.num=0,t.showNum=0,t.step=0,t.label=null,t.action=!0,t.STEP=60,t.scale=1,t.preFix="",t.callback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.label?this.label:this.label=this.node.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.setNumber=function(e){this.showNum=e,this.num=e,1==this.scale?this.Label.string=this.preFix+e.toString():this.Label.string=this.preFix+(e/this.scale).toFixed(2)},t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onStep=function(e){},t.prototype.onNumberChanged=function(e,t){if(this.num=e,this.callback=t,this.num!=this.showNum){var o=this.num-this.showNum;this.step=o>0?Math.ceil(o/this.STEP):Math.floor(o/this.STEP),this.action&&this.node.runAction(cc.sequence(cc.scaleTo(.1,1.4),cc.delayTime(.05),cc.scaleTo(.1,1)))}else this.step=0},t.prototype.update=function(e){this.num!=this.showNum&&(this.showNum+=this.step,this.onStep(this.step),(this.showNum>this.num&&this.step>0||this.showNum<this.num&&this.step<0)&&(this.showNum=this.num,this.step=0)),Math.abs(this.num-this.showNum)<=Math.abs(this.step)&&this.callback&&"function"==typeof this.callback&&(this.callback(),this.callback=null),1==this.scale?this.Label.string=this.showNum>=0?this.preFix+this.showNum.toString():this.preFix+"/"+Math.abs(this.showNum).toString():this.Label.string=this.showNum>=0?this.preFix+(this.showNum/this.scale).toFixed(2):this.preFix+"/"+Math.abs(this.showNum/this.scale).toFixed(2)},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"./BaseView":"BaseView"}],Page:[function(e,t,o){"use strict";cc._RF.push(t,"5ab38aDYzFDBobaWEcqAEr3","Page"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BreakAnimation"),i=cc._decorator,a=i.ccclass,r=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.DiamondRoot=null,t.BreakAnimation=null,t.ScoreRoot=null,t.Blue=null,t.Green=null,t.blueFrom=null,t.greenFrom=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.blueFrom=this.Blue.position.clone(),this.greenFrom=this.Green.position.clone()},t.prototype.play=function(){this.showDiamond(),this.swapDiamond()},t.prototype.showDiamond=function(){this.Blue.setPosition(this.blueFrom),this.Green.setPosition(this.greenFrom),this.DiamondRoot.active=!0;for(var e=0,t=this.DiamondRoot.children;e<t.length;e++){t[e].stopAllActions()}for(var o=0,n=this.ScoreRoot.children;o<n.length;o++){n[o].stopAllActions()}this.BreakAnimation.active=!1,this.ScoreRoot.active=!1},t.prototype.swapDiamond=function(){var e=this;this.Blue.runAction(cc.sequence(cc.delayTime(.5),cc.moveTo(.1,this.greenFrom),cc.delayTime(.2),cc.callFunc(function(){e.playBreak()}))),this.Green.runAction(cc.sequence(cc.delayTime(.5),cc.moveTo(.1,this.blueFrom),cc.callFunc(function(){})))},t.prototype.playBreak=function(){var e=this;this.DiamondRoot.active=!1,this.BreakAnimation.active=!0;for(var t=!1,o=function(o){o.getComponent(n.default).play(),o.getComponent(n.default).onComplete=t?function(){}:function(){o.runAction(cc.sequence(cc.fadeOut(.2),cc.delayTime(1),cc.callFunc(function(){e.play()})))},t=!0},i=0,a=this.BreakAnimation.children;i<a.length;i++){o(s=a[i])}this.ScoreRoot.active=!0;for(var r=0,l=this.ScoreRoot.children;r<l.length;r++){var s;(s=l[r]).opacity=255,s.stopAllActions(),s.scale=0,s.runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.2,1),cc.scaleTo(.1,.5),cc.fadeOut(.1),cc.callFunc(function(){})))}},__decorate([r(cc.Node)],t.prototype,"DiamondRoot",void 0),__decorate([r(cc.Node)],t.prototype,"BreakAnimation",void 0),__decorate([r(cc.Node)],t.prototype,"ScoreRoot",void 0),__decorate([r(cc.Node)],t.prototype,"Blue",void 0),__decorate([r(cc.Node)],t.prototype,"Green",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./BreakAnimation":"BreakAnimation"}],PassLevelAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"ac04acnG61H+o23THxvIwuF","PassLevelAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Global/GameRule"),i=e("../../../Model/PlayModelProxy"),a=e("../../../Utils/FrameAniBase"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.opacity=0,i.NextLevelSignal.inst.addListenerOne(function(e){n.IsUnlimitedLevel()||e.toString()==t.node.name&&t.play()},this)},t=__decorate([l],t)}(a.default));o.default=s,cc._RF.pop()},{"../../../Global/GameRule":"GameRule","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/FrameAniBase":"FrameAniBase"}],PlayModelProxy:[function(e,t,o){"use strict";cc._RF.push(t,"50835VU6k9M3pgXsJbG5zxG","PlayModelProxy"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=e("../Controller/GameStateController"),a=e("../GamePlay/Model/GamePlayModel"),r=e("../Command/CommonSignal"),l=e("../Global/GameRule"),s=e("../Utils/Signal"),c=e("../GamePlay/View/Game/Map/MapRoot"),u=e("../GamePlay/View/Game/DiamondMapRoot"),p=e("../Utils/Celer/CelerSDK"),d=e("../Ad/FlyCnicornAd"),h=e("../Ad/WildAdButton"),m=e("../GamePlay/Model/GameLogic"),f=e("../GamePlay/Model/Map/MapFactory"),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.NextLevelSignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.StartInitMapSignal=g;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.StartCountSignal=S;var M=function(e){function t(){var t=e.call(this)||this;return t.isGameOver=!1,t.playerModel=null,t.hasStartCount=!1,t.bindSignal(),t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.playerModel?this.playerModel:this.playerModel=new a.GamePlayModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeLeft",{get:function(){return this.Model.Time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlayerScore",{get:function(){return this.Model.PlayerScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MoveCount",{get:function(){return this.Model.MoveCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NoviceScore",{get:function(){return this.Model.NoviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointSpread",{get:function(){return this.Model.ScoreSpread},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Model.Timebonus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Theme",{get:function(){return this.Model.Theme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this.Model.Level},set:function(e){this.Model.Level=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseScore",{get:function(){return this.Model.PauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return Math.max(0,l.FreePauseLimit-this.Model.PauseCount)},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){},t.prototype.initGametheme=function(){g.inst.dispatch(),this.Model.initGametheme()},t.prototype.getTotalScore=function(){return this.Model.TotalScore},t.prototype.addPauseCount=function(){this.Model.addPauseCount()},t.prototype.setTotalTime=function(e){this.Model.Time=e,r.UpdateTimeNumber.inst.dispatchOne(this.Model.Time)},t.prototype.addGameTime=function(e){i.GameStateController.inst.isPause()||0==i.GameStateController.inst.isRoundStart()||this.isGameOver||(0==this.hasStartCount&&(this.hasStartCount=!0,S.inst.dispatch()),this.Model.Time+=e,m.GameLogic.inst.ClearCD+=e,m.GameLogic.inst.ComboLimitTime>0&&(m.GameLogic.inst.ComboLastTime+=Math.abs(e),m.GameLogic.inst.ComboLimitTime+=e),d.default.ShowTimeRest>0&&(d.default.ShowTimeRest+=e,d.default.ShowTimeRest<=0&&d.ShowFlyCnicornSignal.inst.dispatch()),r.UpdateTimeNumber.inst.dispatchOne(this.Model.Time),r.TimeAnimationStateChanged.inst.dispatchOne(this.Model.Time<=30),this.Model.Time<=0&&(this.Model.checkCompleteScore(),i.GameStateController.inst.roundEnd(i.RoundEndType.TimeUp)))},t.prototype.getScoreByType=function(e){return this.Model.getScoreByType(e)},t.prototype.dump=function(){this.Model.dump()},t.prototype.init=function(){this.Model.initGameData()},t.prototype.gameReadyToStart=function(){r.GameStartSignal.inst.dispatch(),i.GameStateController.inst.isReady=!0,console.log("gameReadyToStart"),h.WildButtonReadySignal.inst.dispatch()},t.prototype.gameReadyShow=function(){var e=this;0==p.CelerSDK.inst.isNew()?this.gameReadyToStart():c.ShowMapByLevelSignal.inst.dispatchThree(1,1.5,function(){c.ShowMapByLevelSignal.inst.dispatchThree(0,1.5,function(){e.gameReadyToStart()})})},t.prototype.testNextLevel=function(){f.MapFactory.inst.clearCurrentMap(),this.Level>=l.GetTotalLevel()&&!l.IsUnlimitedLevel()?this.Level=0:this.Level++},t.prototype.testScale=function(e){u.TestDiamondRootScaleSignal.inst.dispatchOne(e)},t.prototype.testGameComplete=function(){setTimeout(function(){i.GameStateController.inst.roundEnd(i.RoundEndType.Complete)},200)},t.prototype.testGameOver=function(){i.GameStateController.inst.roundEnd(i.RoundEndType.Over)},t.prototype.testTimeUp=function(){i.GameStateController.inst.roundEnd(i.RoundEndType.TimeUp)},t.prototype.testOutOfMove=function(){i.GameStateController.inst.roundEnd(i.RoundEndType.OutOfMove)},t}(n.SingleTon());o.PlayModelProxy=M,!CELER_X&&(window.Game=M.inst),cc._RF.pop()},{"../Ad/FlyCnicornAd":"FlyCnicornAd","../Ad/WildAdButton":"WildAdButton","../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","../GamePlay/Model/GameLogic":"GameLogic","../GamePlay/Model/GamePlayModel":"GamePlayModel","../GamePlay/Model/Map/MapFactory":"MapFactory","../GamePlay/View/Game/DiamondMapRoot":"DiamondMapRoot","../GamePlay/View/Game/Map/MapRoot":"MapRoot","../Global/GameRule":"GameRule","../Utils/Celer/CelerSDK":"CelerSDK","../Utils/Signal":"Signal","../Utils/ToSingleton":"ToSingleton"}],PositionView:[function(e,t,o){"use strict";cc._RF.push(t,"416f296ZMZPEaWAE2E6IRlj","PositionView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startPos=cc.Vec2.ZERO,t}return __extends(t,e),Object.defineProperty(t.prototype,"TargetPos",{get:function(){return cc.v2(this.Target.x,this.Target.y)},enumerable:!0,configurable:!0}),t.prototype.canUpdate=function(){return!0},t.prototype.onLoad=function(){0},t.prototype.start=function(){},t.prototype.onPositionChanged=function(e,t,o,n){void 0===n&&(n=0),this.startPos=this.node.position.clone(),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.x=this.ease(this.startPos.x,this.Target.x),this.node.y=this.ease(this.startPos.y,this.Target.y)},t.prototype.onComplete=function(){this.node.setPosition(cc.v2(this.Target.x,this.Target.y))},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],PrefabBaseView:[function(e,t,o){"use strict";cc._RF.push(t,"f24ed/ng45Kt5VKvqibEbvg","PrefabBaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.reuse=function(e){this.model=e,this.onReuse()},t.prototype.unuse=function(){this.model,this.model=null,this.onUnuse()},t.prototype.onReuse=function(){console.warn(" should override onReuse.")},t.prototype.onUnuse=function(){console.warn(" should override onUnuse.")},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],RainbowLineAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"bb1e90nZJFCDL9epNNbtguq","RainbowLineAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../../Utils/Cocos"),a=e("../../../Model/Map/MapType"),r=e("../EffectBase"),l=e("../Root/NormalRoot"),s=e("./NormalBreakAnimation"),c=cc._decorator,u=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loopCount=0,t}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),l.PlayDiamondBreakSignal.inst.addListenerThree(this.onBreak,this)},t.prototype.onComplete=function(){var e=this;this.loopCount++,this.loopCount>=5?this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.node.getComponent(cc.Sprite).spriteFrame=null,n.gFactory.putObj("Effect",e.node)}))):this.play()},t.prototype.onBreak=function(e,t,o){if(t!=s.AniType.None&&t==s.AniType.RainbowLightLine&&e.ID+o.toString()==this.ID&&t==this.Type){this.node.scale=1,this.Interval=.05,this.Interval*=a.GetTimeScale(),this.node.height=120;var n=a.GetPosByIndex(this.FromIndex),r=a.GetPosByIndex(this.ToIndex);this.node.width=i.Distance(n,r)/this.node.scale*1.05;var l=a.Index2i(this.FromIndex),c=a.Index2j(this.FromIndex),u=a.Index2i(this.ToIndex),p=a.Index2j(this.ToIndex),d=0,h=0;l==u?d=c<p?0:180:c==p?d=l<u?90:-90:(h=(r.y-n.y)/(r.x-n.x),d=r.x<n.x?180-Math.atan(h)/2/Math.PI*360:360-Math.atan(h)/2/Math.PI*360),this.node.rotation=d,this.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,this.loopCount=0,this.play()}},t=__decorate([u],t)}(r.default));o.default=p,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../../Utils/Cocos":"Cocos","../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/NormalRoot":"NormalRoot","./NormalBreakAnimation":"NormalBreakAnimation"}],RainbowRoot:[function(e,t,o){"use strict";cc._RF.push(t,"2dc3cG/uZhOQoCjxz1OcgMZ","RainbowRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../Model/EliminationChecker"),a=e("../../../Model/Map/MapType"),r=e("../Diamond/NormalBreakAnimation"),l=e("./NormalRoot"),s=cc._decorator,c=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){l.OnDiamondBreakSignal.inst.addListenerThree(this.onBreak,this)},t.prototype.onBreak=function(e,t,o){if(o&&o.type==i.EliminationType.RainbowClear&&t==r.AniType.RainbowFrom){t=r.AniType.RainbowLightLine;for(var s=0,c=o.indexList;s<c.length;s++){var u=c[s],p=n.gFactory.getObj("Effect",e.ID+(this.node.childrenCount+1),t,e.Index,u);p.anchorX=0,p.anchorY=.5;var d=a.GetPosByIndex(e.Index);p.setPosition(d),this.node.addChild(p),l.PlayDiamondBreakSignal.inst.dispatchThree(e,t,this.node.childrenCount)}}},t=__decorate([c],t)}(cc.Component));o.default=u,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../Model/EliminationChecker":"EliminationChecker","../../../Model/Map/MapType":"MapType","../Diamond/NormalBreakAnimation":"NormalBreakAnimation","./NormalRoot":"NormalRoot"}],Random:[function(e,t,o){"use strict";cc._RF.push(t,"114f9Vox8JGQbohBr4HFlkf","Random"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e("./Signal").BaseSignal);o.RandomSeedInitSignal=n;var i=function(){function e(){}return e.seededRandom=function(e,t,o){return t+1e6*((1711*e+88888)%302654/302654+(1722*e+55555)%302665/302665+(1755*e+23333)%302766/302766)%1e6/1e6*(o-t)},e.getRandom=function(e,t){void 0===e&&(e=0),void 0===t&&(t=1);var o=this.randomSeed,n=this.seededRandom(o,e,t),i=Math.floor(this.seededRandom(o,1,302766));return this.randomSeed+=i,n},e.setRandomSeed=function(e){console.log(" set random seed:",e),this.randomSeed=e,this.sharedSeed=e,n.inst.dispatchOne(e)},e.randomRoundToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.round(this.getRandom(e,t))},e.randomFloorToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.floor(this.getRandom(e,t))},e.randomCeilToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.ceil(this.getRandom(e,t))},e.clamp=function(e,t,o){return Math.max(t,Math.min(e,o))},e.randomSeed=Math.random(),e.sharedSeed=Math.random(),e}();o.Random=i,cc._RF.pop()},{"./Signal":"Signal"}],RefreshAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"1ad361urNBGPJomNNLQmXGu","RefreshAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../Utils/FrameAniBase"),a=e("../../Model/ActionChecker"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.opacity=0,a.StartRefreshSignal.inst.addListener(function(){0!=n.GameStateController.inst.isReady&&t.play()},this)},t.prototype.onStartPlay=function(){this.node.opacity=255},t.prototype.onComplete=function(){this.node.runAction(cc.fadeOut(.1))},t=__decorate([l],t)}(i.default));o.default=s,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../Utils/FrameAniBase":"FrameAniBase","../../Model/ActionChecker":"ActionChecker"}],ResourceController:[function(e,t,o){"use strict";cc._RF.push(t,"d264b/eizRMLqzXH1k4Oll+","ResourceController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=e("../Utils/HashMap");o.Title={Complete:"font_complete",TimeUp:"font_timeup",Over:"font_gameover",OutOfMove:"font_outofmove"},o.PauseFont={HasFree:"bg_pause_font1",NoneFree:"bg_pause_font2"},o.Font={TotalScore:"totalScore",ResultScore:"resultScore",TimeWhite:"TimeWhite",TimeRed:"TimeRed",AddScore:"addScore",SubScore:"subScore",ShowScore:"showScore"},function(e){e[e.UI=0]="UI",e[e.GamePlay=1]="GamePlay"}(o.AnimationType||(o.AnimationType={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontMap=new i.HashMap,t.UIAtlas=null,t.ResultAtlas=null,t.PauseAtlas=null,t.Animations=new i.HashMap,t}return __extends(t,e),t.prototype.setFont=function(e,t){this.fontMap.add(e,t)},t.prototype.setAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.UIAtlas=e},t.prototype.setResultAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.ResultAtlas=e},t.prototype.setPauseAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.PauseAtlas=e},t.prototype.getTitleSprite=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.getResultSprite=function(e){return this.ResultAtlas.getSpriteFrame(e)},t.prototype.getAltas=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.getPauseAtlas=function(e){return this.PauseAtlas.getSpriteFrame(e)},t.prototype.pushAnimationAtlas=function(e,t){console.assert(null!=t,"animation atlas is null!"),this.Animations.add(e,t)},t.prototype.getAnimationAtlas=function(e,t){return this.Animations.get(e).getSpriteFrame(t)},t.prototype.getAddScoreFont=function(){return this.fontMap.get(o.Font.AddScore)},t.prototype.getSubScoreFont=function(){return this.fontMap.get(o.Font.SubScore)},t.prototype.getSoundDisabled=function(){return this.PauseAtlas.getSpriteFrame("btn_nosound")},t.prototype.getSoundEnable=function(){return this.PauseAtlas.getSpriteFrame("btn_sound")},t.prototype.getPauseFont=function(e){return this.PauseAtlas.getSpriteFrame(e)},t.prototype.getTimeRedFont=function(){return this.fontMap.get(o.Font.TimeRed)},t.prototype.getTimeWhiteFont=function(){return this.fontMap.get(o.Font.TimeWhite)},t}(n.SingleTon());o.ResourceController=a,cc._RF.pop()},{"../Utils/HashMap":"HashMap","../Utils/ToSingleton":"ToSingleton"}],ResultAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"3ae5283yuFOVr64ADyd/C0J","ResultAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/FrameAniBase"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"../Utils/FrameAniBase":"FrameAniBase"}],ResultLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"ba2b7WYGTNEqazUlmB5rAul","ResultLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/BaseView"),i=e("../../../View/NumberChangedView"),a=e("../../../Command/CommonSignal"),r=e("../../../Controller/GameStateController"),l=e("../../../Controller/ResourceController"),s=e("../../../Model/PlayModelProxy"),c=e("../../../Utils/Celer/CelerSDK"),u=e("../../Model/GamePlayModel"),p=e("../../../Animation/ResultAnimation"),d=e("../../../Utils/Signal"),h=e("../../../table"),m=e("../../../Global/GameRule"),f=cc._decorator,y=f.ccclass,g=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(d.BaseSignal));o.PlayResultAnimationSignal=g;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CountTotal=5,t.count=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Root",{get:function(){return this.node.getChildByName("Root")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content",{get:function(){return this.Root.getChildByName("Content").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.Root.getChildByName("Title").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalScore",{get:function(){return this.Root.getChildByName("TotalScore").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Root.getChildByName("TimeBonus").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Score",{get:function(){return this.Root.getChildByName("ScoreLabel").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GoldsScore",{get:function(){return this.Root.getChildByName("GoldsScore").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GoldCount",{get:function(){return this.Root.getChildByName("GoldCount").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Submit",{get:function(){return this.Root.getChildByName("Submit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResultAnimation",{get:function(){return this.Root.getChildByName("TitleAnimation").getComponent(p.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.active=!1,this.node.scale=1,a.OpenResultLayerSignal.inst.addListenerOne(this.onGameOver,this)},t.prototype.onGameOver=function(e){console.log("Open result:",r.RoundEndType[e]),this.Submit.scale=0,this.Content.string=lan.t(h.En_View.JieSuanJieMian,h.En_ID.BaoShiDeFen),e==r.RoundEndType.TimeUp?this.Title.spriteFrame=l.ResourceController.inst.getResultSprite(l.Title.TimeUp):e==r.RoundEndType.Complete?this.Title.spriteFrame=l.ResourceController.inst.getResultSprite(l.Title.Complete):e==r.RoundEndType.OutOfMove?this.Title.spriteFrame=l.ResourceController.inst.getResultSprite(l.Title.OutOfMove):this.Title.spriteFrame=l.ResourceController.inst.getResultSprite(l.Title.Over),this.Title.node.scale=0,this.Root.scale=0,this.node.active=!0,this.ResultAnimation.node.opacity=0,this.Root.runAction(cc.sequence(cc.scaleTo(.1,.9,1.3),cc.scaleTo(.1,1.2,.9),cc.scaleTo(.1,1,1),cc.callFunc(this.showInfo.bind(this))))},Object.defineProperty(t.prototype,"Count",{get:function(){return this.count},set:function(e){var t=this;this.count!=e&&(this.count=e,console.log("count:",this.Count),this.Count>=this.CountTotal&&(a.ShowSubmitSignal.inst.dispatch(),this.Submit.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){t.Submit.once(cc.Node.EventType.TOUCH_END,function(){c.CelerSDK.inst.submitScore(s.PlayModelProxy.inst.getTotalScore())},t),CELER_X&&setTimeout(function(){c.CelerSDK.inst.submitScore(s.PlayModelProxy.inst.getTotalScore())},5e3)})))))},enumerable:!0,configurable:!0}),t.prototype.showInfo=function(){var e=this;this.Count=0,this.TotalScore.STEP=150,this.TimeBonus.STEP=150,this.Score.STEP=150,this.GoldCount.STEP=2,this.GoldsScore.STEP=100;var t=function(){a.ScoreCountingSignal.inst.dispatch()};this.TimeBonus.onStep=t,this.TotalScore.onStep=t,this.Score.onStep=t,this.GoldCount.onStep=t,this.GoldsScore.onStep=t,this.Title.node.runAction(cc.sequence(cc.scaleTo(.1,1.5),cc.scaleTo(.1,1),cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))),this.ResultAnimation.onComplete=function(){e.ResultAnimation.node.runAction(cc.fadeOut(.1))},this.ResultAnimation.node.opacity=255,g.inst.dispatch(),this.ResultAnimation.play(),m.IsUnlimitedLevel()?this.Count++:this.TimeBonus.onNumberChanged(s.PlayModelProxy.inst.TimeBonus,function(){e.Count++,console.log("TimeBonus Done")}),this.TotalScore.onNumberChanged(s.PlayModelProxy.inst.getTotalScore(),function(){e.Count++,console.log("TotalScore Done")}),this.Score.onNumberChanged(s.PlayModelProxy.inst.getTotalScore()-s.PlayModelProxy.inst.Model.getScoreByType(u.ScoreType.GoldGain)-s.PlayModelProxy.inst.TimeBonus,function(){e.Count++,console.log("Score Done")}),this.GoldCount.onNumberChanged(s.PlayModelProxy.inst.Model.GoldCount,function(){e.Count++,console.log("GoldCount Done")}),this.GoldsScore.onNumberChanged(s.PlayModelProxy.inst.Model.getScoreByType(u.ScoreType.GoldGain),function(){e.Count++,console.log("GoldsScore Done")})},t=__decorate([y],t)}(n.default);o.default=S,cc._RF.pop()},{"../../../Animation/ResultAnimation":"ResultAnimation","../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Global/GameRule":"GameRule","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Celer/CelerSDK":"CelerSDK","../../../Utils/Signal":"Signal","../../../View/BaseView":"BaseView","../../../View/NumberChangedView":"NumberChangedView","../../../table":"table","../../Model/GamePlayModel":"GamePlayModel"}],RevertButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"3e84eq+F3NMM5PkgzsJHXMl","RevertButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../Utils/Signal"),a=e("../../../View/SingleTouchView"),r=e("../../Model/GamePlayModel"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.RevertSignal=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Button",{get:function(){return this.getComponent(cc.Button)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.Button.interactable=!1,r.RevertButtonStateChangedSignal.inst.addListenerOne(this.onButtonStateChanged,this)},t.prototype.onTouchEnd=function(){n.GameStateController.inst.isGameOver()||0==n.GameStateController.inst.isRoundStart()||0!=this.Button.interactable&&(console.log("revert"),c.inst.dispatch())},t.prototype.onButtonStateChanged=function(e){this.Button.interactable=e},t=__decorate([s],t)}(a.default);o.default=u,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../../Model/GamePlayModel":"GamePlayModel"}],RotationView:[function(e,t,o){"use strict";cc._RF.push(t,"f3329CeqRdN6ZoUyx7znT4N","RotationView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startRotation=0,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.canUpdate=function(){return!0},t.prototype.start=function(){},t.prototype.onRotationChanged=function(e,t,o,n){void 0===n&&(n=0),this.startRotation=this.node.rotation,this.startUpdate(new cc.Vec3(e,e,e),t,o,n)},t.prototype.onStep=function(){this.node.rotation=this.ease(this.startRotation,this.Target.x)},t.prototype.onComplete=function(){this.node.setRotation(this.Target.x)},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],ScaleView:[function(e,t,o){"use strict";cc._RF.push(t,"b6981r0u55OyqSF4preRXtY","ScaleView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startScale=cc.Vec2.ZERO,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.canUpdate=function(){return!0},t.prototype.start=function(){},t.prototype.onScaleChanged=function(e,t,o,n){void 0===n&&(n=0),this.startScale=cc.v2(this.node.scaleX,this.node.scaleY),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.scaleX=this.ease(this.startScale.x,this.Target.x),this.node.scaleY=this.ease(this.startScale.y,this.Target.y)},t.prototype.onComplete=function(){this.node.scaleX=this.Target.x,this.node.scaleY=this.Target.y},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],ScoreFloat:[function(e,t,o){"use strict";cc._RF.push(t,"9a0bdeGuRVNJo7rEuZpmiZ9","ScoreFloat"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return __extends(t,e),t.prototype.start=function(){},__decorate([a(cc.Label)],t.prototype,"label",void 0),__decorate([a],t.prototype,"text",void 0),t=__decorate([i],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],ScoreLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"5857dLL+ulDqKijkly4V/xN","ScoreLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),a=e("../../../Factory/GameFactory"),r=e("../../../Model/PlayModelProxy"),l=e("../../../Utils/Signal"),s=e("../../../View/NumberChangedView"),c=e("../../Model/GameLogic"),u=e("../../Model/Map/MapType"),p=e("../Game/Map/MapRoot"),d=cc._decorator,h=d.ccclass,m=d.property,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.UpdateUSDLabelSignal=f;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScoreFloatRoot=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.PlayerScoreChanged.inst.addListenerFour(this.onScoreChanged,this),c.AddMoveSignal.inst.addListenerOne(function(t){var o=a.gFactory.getObj("AddScore"),n=o.getComponent(cc.Label);n.font=i.ResourceController.inst.getAddScoreFont(),e.ScoreFloatRoot.addChild(o),n.string="/"+Math.abs(t),o.setPosition(-154.255,766.764),o.opacity=255,o.scale=0;o.runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.2,1.2),cc.delayTime(0),cc.scaleTo(.1,1),cc.fadeOut(.1),cc.callFunc(function(){a.gFactory.putObj("AddScore",o)})))},this)},t.prototype.onScoreChanged=function(e,t,o,n){var l=this;if(null==this.ScoreFloatRoot||t<0)this.onNumberChanged(e);else{var s=a.gFactory.getObj("AddScore"),c=s.getComponent(cc.Label);c.font=t>=0?i.ResourceController.inst.getAddScoreFont():i.ResourceController.inst.getSubScoreFont(),c.string="/"+Math.abs(t),this.ScoreFloatRoot.addChild(s);var d=cc.v2(0,0),h=0,m=1;n>=0?(d=u.GetPosByIndex(n),s.anchorX=.5,d.addSelf(cc.v2(0,r.PlayModelProxy.inst.Level*p.ReadyOffset))):(h=.5,m=.8,s.anchorX=0,d=cc.v2(-86.602,825)),s.setPosition(d),s.opacity=255,s.scale=0,s.runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.2,1.3*m),cc.delayTime(h),cc.scaleTo(.1,1.1*m),cc.fadeOut(.2),cc.callFunc(function(){a.gFactory.putObj("AddScore",s)}))),setTimeout(function(){l.onNumberChanged(e),f.inst.dispatchOne(r.PlayModelProxy.inst.PlayerScore)},500)}},__decorate([m(cc.Node)],t.prototype,"ScoreFloatRoot",void 0),t=__decorate([h],t)}(s.default);o.default=y,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController","../../../Factory/GameFactory":"GameFactory","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/NumberChangedView":"NumberChangedView","../../Model/GameLogic":"GameLogic","../../Model/Map/MapType":"MapType","../Game/Map/MapRoot":"MapRoot"}],Signal:[function(e,t,o){"use strict";cc._RF.push(t,"5e03fyVNOZPs7lLvT6ttunM","Signal"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listenerMap=[],t.onceListenerMap=[],t}return __extends(t,e),t.prototype.doDispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.excuteListener.apply(this,e),this.excuteOnce.apply(this,e)},t.prototype.excuteListener=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.listenerMap&&this.listenerMap.length>0)for(var o=0,n=this.listenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}},t.prototype.excuteOnce=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var o=0,n=this.onceListenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}this.onceListenerMap.length=0}},t.prototype.listen=function(e,t){this.listenerMap.push({callback:e,target:t})},t.prototype.listenOnce=function(e,t){this.onceListenerMap.push({callback:e,target:t})},t.prototype.removeListener=function(e,t){if(this.listenerMap&&this.listenerMap.length>0)for(var o=0;o<this.listenerMap.length;++o){var n=this.listenerMap[o];n.callback==e&&n.target==t&&(this.listenerMap.splice(o,1),--o)}},t.prototype.removeTarget=function(e){if(this.listenerMap&&this.listenerMap.length>0)for(var t=0;t<this.listenerMap.length;++t){this.listenerMap[t].target==e&&(this.listenerMap.splice(t,1),--t)}},t.prototype.dispatch=function(){this.doDispatch(null)},t.prototype.dispatchOne=function(e){this.doDispatch(e)},t.prototype.dispatchTwo=function(e,t){this.doDispatch(e,t)},t.prototype.dispatchThree=function(e,t,o){this.doDispatch(e,t,o)},t.prototype.dispatchFour=function(e,t,o,n){this.doDispatch(e,t,o,n)},t.prototype.dispatchFive=function(e,t,o,n,i){this.doDispatch(e,t,o,n,i)},t.prototype.addListener=function(e,t){this.listen(e,t)},t.prototype.addOnce=function(e,t){this.listenOnce(e,t)},t.prototype.addListenerOne=function(e,t){this.listen(e,t)},t.prototype.addListenerTwo=function(e,t){this.listen(e,t)},t.prototype.addListenerThree=function(e,t){this.listen(e,t)},t.prototype.addListenerFour=function(e,t){this.listen(e,t)},t.prototype.addListenerFive=function(e,t){this.listen(e,t)},t.prototype.addOnceOne=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceTwo=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceThree=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFour=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFive=function(e,t){this.listenOnce(e,t)},t}(e("./ToSingleton").SingleTon());o.BaseSignal=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],SingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"e1695pPIshGg5cBwRP4Oun7","SingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){this.node.targetOff(this),this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.onUnregister=function(){this.node.targetOff(this)},t.prototype.touchStart=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch start  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();this.touchid=e.getID(),this.onTouchStart(e)},t.prototype.touchMove=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchMove(e)):e.stopPropagation()},t.prototype.touchEnd=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch end  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchEnd(e),this.OnClick()):e.stopPropagation()},t.prototype.touchCancel=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch cancel  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchCancel(e)):e.stopPropagation()},t.prototype.OnClick=function(){},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],SingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"85688DQVyhPRqaAh/y2/Qug","SingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.start=function(){},t.prototype.touchStart=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchStart(e)):console.log(this.node.name," touch start  touchid is different! ")},t.prototype.touchMove=function(e){null!==this.touchid&&this.touchid!==e.getID()||(this.touchid=e.getID(),this.onTouchMove(e))},t.prototype.touchEnd=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchEnd(e)):console.log(this.node.name," touch end  touchid is different! ")},t.prototype.touchCancel=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchCancel(e)):console.log(this.node.name," touch cancel  touchid is different! ")},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"./BaseView":"BaseView"}],SkewView:[function(e,t,o){"use strict";cc._RF.push(t,"dec79oJ2D1Ju7yCFAAR3rSI","SkewView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startSkew=cc.Vec2.ZERO,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.start=function(){},t.prototype.canUpdate=function(){return!0},t.prototype.onSkewChanged=function(e,t,o,n){void 0===n&&(n=0),this.startSkew=cc.v2(this.node.skewX,this.node.skewY),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.skewX=this.ease(this.startSkew.x,this.Target.x),this.node.skewY=this.ease(this.startSkew.y,this.Target.y)},t.prototype.onComplete=function(){this.node.skewX=this.Target.x,this.node.skewY=this.Target.y},t=__decorate([a],t)}(n.default));o.default=r,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],SliderView:[function(e,t,o){"use strict";cc._RF.push(t,"2c746YFJCxKFJ34ypIaA1v3","SliderView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Random"),i=cc._decorator,a=i.ccclass,r=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Progress=null,t.Slider=null,t.totalLength=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Percent",{get:function(){return this.Slider.progress},set:function(e){this.Slider.progress=n.Random.clamp(e,0,1),this.Progress.width=this.Slider.node.width*this.Slider.progress},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.Slider.node.on("slide",this.onSlided,this),this.totalLength=this.Progress.width,this.Slider.node.width=this.totalLength},t.prototype.onSlided=function(){this.Progress.width=this.totalLength*this.Slider.progress,this.onProgress&&this.onProgress(this.Slider.progress)},t.prototype.start=function(){},t.prototype.onProgress=function(e){},__decorate([r(cc.Node)],t.prototype,"Progress",void 0),__decorate([r(cc.Slider)],t.prototype,"Slider",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../Utils/Random":"Random"}],SoundButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"6d699bXGkJBYb+wyjeQyALI","SoundButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=e("../../../Manager/AudioManager"),a=e("../../../Utils/Signal"),r=e("../../../View/SingleTouchView"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal)),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.updateState(),c.inst.addListener(this.updateState,this)},t.prototype.onTouchEnd=function(){i.gAudio.MusicVolume>0?(i.gAudio.setEffectVolume(0),i.gAudio.setMusicVolume(0)):(i.gAudio.setEffectVolume(1),i.gAudio.setMusicVolume(1)),c.inst.dispatch()},t.prototype.updateState=function(){var e=i.gAudio.MusicVolume;this.Sprite.spriteFrame=e>0?n.ResourceController.inst.getSoundEnable():n.ResourceController.inst.getSoundDisabled()},t=__decorate([s],t)}(r.default);o.default=u,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController","../../../Manager/AudioManager":"AudioManager","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView"}],SquareRoot:[function(e,t,o){"use strict";cc._RF.push(t,"0c72cYd41dAOq6y5zbdPK83","SquareRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Factory/GameFactory"),i=e("../../../Model/Map/MapType"),a=e("../Diamond/NormalBreakAnimation"),r=e("./NormalRoot"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){r.OnDiamondBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){if(t!=a.AniType.None&&t==a.AniType.Square){var o=n.gFactory.getObj("Effect",e.ID,t);o.setPosition(i.GetPosByIndex(e.Index)),this.node.addChild(o),r.PlayDiamondBreakSignal.inst.dispatchTwo(e,t)}},t=__decorate([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../../Factory/GameFactory":"GameFactory","../../../Model/Map/MapType":"MapType","../Diamond/NormalBreakAnimation":"NormalBreakAnimation","./NormalRoot":"NormalRoot"}],StartGameCommand:[function(e,t,o){"use strict";cc._RF.push(t,"1db594KvoJIVbc+cwfogrGn","StartGameCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Command/CommonSignal"),i=e("../../GamePlay/Model/Map/MapFactory"),a=e("../../Model/PlayModelProxy"),r=(CELER_X,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){console.log("--------- excute StartGameCommand ---------"),i.MapFactory.inst.init(),a.PlayModelProxy.inst.initGametheme(),this.normalInit(),n.GameReadySignal.inst.dispatch()},t.prototype.testInit=function(){console.log("test init ."),a.PlayModelProxy.inst.init()},t.prototype.normalInit=function(){console.log("normal init ."),a.PlayModelProxy.inst.init()},t}(puremvc.SimpleCommand));o.StartGameCommand=r,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../GamePlay/Model/Map/MapFactory":"MapFactory","../../Model/PlayModelProxy":"PlayModelProxy"}],StepManager:[function(e,t,o){"use strict";cc._RF.push(t,"83709TvPtJOVayPDGaPh6Ov","StepManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.totalStep=[],this.curStep=[],this.loadTime={}}return e.prototype.register=function(e,t){this.completeCallback=e,this.totalStep=t;for(var o=0,n=t;o<n.length;o++){var i=n[o];this.loadTime[i]=Date.now()}},e.prototype.nextStep=function(e){if(this.totalStep.indexOf(e)<0)console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",e);else if(this.curStep.indexOf(e)>=0)console.warn(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",e);else{this.curStep.push(e),this.curStep.sort(function(e,t){return e>t?-1:1}),this.totalStep.sort(function(e,t){return e>t?-1:1});var t=this.curStep.join("-"),o=this.totalStep.join("-"),n=Date.now()-this.loadTime[e];console.log(" cur step:",t,", total step:",o,", cost time:",n," ms"),t==o&&(console.log(" step done"),this.totalStep.length=0,this.completeCallback(),this.completeCallback=null)}},e}();o.StepManager=n,cc._RF.pop()},{}],StoneBreakAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"55740DyeqNL4KgOVFGSlQmZ","StoneBreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Global/Theme"),i=e("../../../../Model/PlayModelProxy"),a=e("../../../Model/Map/MapType"),r=e("../EffectBase"),l=e("../Root/BlockRoot"),s=cc._decorator,c=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this),this.node.scale=2},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),l.PlayBlockBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){this.ID&&this.ID==e.ID&&e.Type==a.MapType.Stone&&i.PlayModelProxy.inst.Theme==n.Theme.Stone&&t>=1&&this.play()},t=__decorate([c],t)}(r.default));o.default=u,cc._RF.pop()},{"../../../../Global/Theme":"Theme","../../../../Model/PlayModelProxy":"PlayModelProxy","../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/BlockRoot":"BlockRoot"}],SubmitButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"7d5e6ERlcdIapmrVvugM7L/","SubmitButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../View/SingleTouchView"),a=e("../../Command/GamePlaySignal"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){n.GameStateController.inst.isGameOver()||0==n.GameStateController.inst.isRoundStart()||a.SubmitButtonClickSignal.inst.dispatchOne("Submit"==this.node.name)},t=__decorate([l],t)}(i.default));o.default=s,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../View/SingleTouchView":"SingleTouchView","../../Command/GamePlaySignal":"GamePlaySignal"}],SubmitLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"f65c05YNytD2Zq3Ran+pohk","SubmitLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),a=e("../../../Controller/ResourceController"),r=e("../../../Model/PlayModelProxy"),l=e("../../../Utils/Signal"),s=e("../../../View/BaseView"),c=e("../../Command/GamePlaySignal"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal));o.EndNowSignal=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("ResumeButton")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndNow",{get:function(){return this.node.getChildByName("EndNow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return this.node.getChildByName("FreePauseCount").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseInfo",{get:function(){return this.node.getChildByName("PauseInfo").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;setTimeout(function(){e.node.active=!1,e.node.scale=1},0),c.SubmitButtonClickSignal.inst.addListenerOne(this.onShow,this),this.EndNow.on(cc.Node.EventType.TOUCH_END,this.endNow,this),this.Resume.on(cc.Node.EventType.TOUCH_END,this.OnResume,this)},t.prototype.endNow=function(){var e=this;d.inst.dispatch(),n.ButtonClickSignal.inst.dispatch(),setTimeout(function(){e.Hide()},0)},t.prototype.OnResume=function(){var e=this;i.GameStateController.inst.resume(),n.ButtonClickSignal.inst.dispatch(),setTimeout(function(){e.Hide()},0)},t.prototype.onShow=function(){this.node.active||(r.PlayModelProxy.inst.FreePauseCount<=0?(this.FreePauseCount.node.active=!1,this.PauseInfo.spriteFrame=a.ResourceController.inst.getAltas("font_pauseno")):(this.FreePauseCount.node.active=!0,this.FreePauseCount.string=r.PlayModelProxy.inst.FreePauseCount.toString(),this.PauseInfo.spriteFrame=a.ResourceController.inst.getAltas("font_pausehave")),this.Show(),i.GameStateController.inst.pause())},t=__decorate([p],t)}(s.default);o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal"}],TableManager:[function(e,t,o){"use strict";cc._RF.push(t,"0dcdc3JitFOGKDKFwUK65LH","TableManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.load=e.JSON_URL&&""!=e.JSON_URL?cc.loader.load.bind(cc.loader):cc.loader.loadRes.bind(cc.loader),this.fileFormat=e.JSON_URL&&""!=e.JSON_URL?".json?time="+Date.now():"",this.total=0,this.complete=0,this.En={},this.Es={},this.Fil={},this.Id={},this.In={},this.Level={},this.Map10_1={},this.Map10_2={},this.Map1_1={},this.Map1_2={},this.Map2_1={},this.Map2_2={},this.Map3_1={},this.Map3_2={},this.Map4_1={},this.Map4_2={},this.Map5_1={},this.Map5_2={},this.Map6_1={},this.Map6_2={},this.Map7_1={},this.Map7_2={},this.Map8_1={},this.Map8_2={},this.Map9_1={},this.Map9_2={},this.Pt={},this.Tl={}}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.startLoad=function(t,o,n){this.completeCallback=o,this.progressCallback=n;var i=this;console.log("Base URL:",e.JSON_URL),this.load(e.JSON_URL+t.trim().split("/").join("")+"/file_list"+this.fileFormat,function(e,o){if(e)console.error(e.errorMessage);else{var n="Array"==o.constructor.name?o:o.json;this.total=n.length;for(var a=0,r=n;a<r.length;a++){var l=r[a];i.loadJson(t.trim().split("/").join("")+"/"+l.replace(".json",""))}}}.bind(this))},e.prototype.loadJson=function(t){console.log("start load:"+t);var o=this,n=t.split("/")[1];n=n.charAt(0).toUpperCase()+n.slice(1,n.length),this.load(e.JSON_URL+t+this.fileFormat,function(e,t){if(e)console.error(e.errorMessage);else{for(var i=0,a="Array"==t.constructor.name?t:t.json;i<a.length;i++){var r=a[i];o[n][r.ID]=r}o.completeLoad()}}.bind(this))},e.prototype.completeLoad=function(){this.complete++,this.progressCallback&&this.progressCallback(this.complete/this.total),this.complete>=this.total&&this.completeCallback&&this.completeCallback()},e.prototype.getEn=function(e){return this.En[e]?this.En[e]:(console.error("En \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_En_Data=function(){return this.En},e.prototype.getEs=function(e){return this.Es[e]?this.Es[e]:(console.error("Es \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Es_Data=function(){return this.Es},e.prototype.getFil=function(e){return this.Fil[e]?this.Fil[e]:(console.error("Fil \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Fil_Data=function(){return this.Fil},e.prototype.getId=function(e){return this.Id[e]?this.Id[e]:(console.error("Id \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Id_Data=function(){return this.Id},e.prototype.getIn=function(e){return this.In[e]?this.In[e]:(console.error("In \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_In_Data=function(){return this.In},e.prototype.getLevel=function(e){return this.Level[e]?this.Level[e]:(console.error("Level \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Level_Data=function(){return this.Level},e.prototype.getMap10_1=function(e){return this.Map10_1[e]?this.Map10_1[e]:(console.error("Map10_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map10_1_Data=function(){return this.Map10_1},e.prototype.getMap10_2=function(e){return this.Map10_2[e]?this.Map10_2[e]:(console.error("Map10_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map10_2_Data=function(){return this.Map10_2},e.prototype.getMap1_1=function(e){return this.Map1_1[e]?this.Map1_1[e]:(console.error("Map1_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map1_1_Data=function(){return this.Map1_1},e.prototype.getMap1_2=function(e){return this.Map1_2[e]?this.Map1_2[e]:(console.error("Map1_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map1_2_Data=function(){return this.Map1_2},e.prototype.getMap2_1=function(e){return this.Map2_1[e]?this.Map2_1[e]:(console.error("Map2_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map2_1_Data=function(){return this.Map2_1},e.prototype.getMap2_2=function(e){return this.Map2_2[e]?this.Map2_2[e]:(console.error("Map2_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map2_2_Data=function(){return this.Map2_2},e.prototype.getMap3_1=function(e){return this.Map3_1[e]?this.Map3_1[e]:(console.error("Map3_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map3_1_Data=function(){return this.Map3_1},e.prototype.getMap3_2=function(e){return this.Map3_2[e]?this.Map3_2[e]:(console.error("Map3_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map3_2_Data=function(){return this.Map3_2},e.prototype.getMap4_1=function(e){return this.Map4_1[e]?this.Map4_1[e]:(console.error("Map4_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map4_1_Data=function(){return this.Map4_1},e.prototype.getMap4_2=function(e){return this.Map4_2[e]?this.Map4_2[e]:(console.error("Map4_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map4_2_Data=function(){return this.Map4_2},e.prototype.getMap5_1=function(e){return this.Map5_1[e]?this.Map5_1[e]:(console.error("Map5_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map5_1_Data=function(){return this.Map5_1},e.prototype.getMap5_2=function(e){return this.Map5_2[e]?this.Map5_2[e]:(console.error("Map5_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map5_2_Data=function(){return this.Map5_2},e.prototype.getMap6_1=function(e){return this.Map6_1[e]?this.Map6_1[e]:(console.error("Map6_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map6_1_Data=function(){return this.Map6_1},e.prototype.getMap6_2=function(e){return this.Map6_2[e]?this.Map6_2[e]:(console.error("Map6_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map6_2_Data=function(){return this.Map6_2},e.prototype.getMap7_1=function(e){return this.Map7_1[e]?this.Map7_1[e]:(console.error("Map7_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map7_1_Data=function(){return this.Map7_1},e.prototype.getMap7_2=function(e){return this.Map7_2[e]?this.Map7_2[e]:(console.error("Map7_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map7_2_Data=function(){return this.Map7_2},e.prototype.getMap8_1=function(e){return this.Map8_1[e]?this.Map8_1[e]:(console.error("Map8_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map8_1_Data=function(){return this.Map8_1},e.prototype.getMap8_2=function(e){return this.Map8_2[e]?this.Map8_2[e]:(console.error("Map8_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map8_2_Data=function(){return this.Map8_2},e.prototype.getMap9_1=function(e){return this.Map9_1[e]?this.Map9_1[e]:(console.error("Map9_1 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map9_1_Data=function(){return this.Map9_1},e.prototype.getMap9_2=function(e){return this.Map9_2[e]?this.Map9_2[e]:(console.error("Map9_2 \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Map9_2_Data=function(){return this.Map9_2},e.prototype.getPt=function(e){return this.Pt[e]?this.Pt[e]:(console.error("Pt \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Pt_Data=function(){return this.Pt},e.prototype.getTl=function(e){return this.Tl[e]?this.Tl[e]:(console.error("Tl \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Tl_Data=function(){return this.Tl},e.JSON_URL="",e}();o.TableManager=n,cc._RF.pop()},{}],TestApp:[function(e,t,o){"use strict";cc._RF.push(t,"b219e3JEelF8qF2ISXZvtH0","TestApp"),Object.defineProperty(o,"__esModule",{value:!0});e("../../Command/CommonSignal"),e("../../Factory/GameFactory");var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.prototype.start=function(){this.node.removeComponent(o)},t=o=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Factory/GameFactory":"GameFactory"}],TestMove:[function(e,t,o){"use strict";cc._RF.push(t,"4f148+x0MNI1q0QAc63W54P","TestMove"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Controller/GameStateController"),i=e("../GamePlay/View/Game/Map/MapRoot"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){CELER_X?(this.node.removeFromParent(!0),this.node.destroy()):this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){0!=n.GameStateController.inst.isReady&&i.StepMapOffsetSignal.inst.dispatchOne(e.getDeltaY())},this)},t=__decorate([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../Controller/GameStateController":"GameStateController","../GamePlay/View/Game/Map/MapRoot":"MapRoot"}],TestSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"2761dS0K89JwJjOcqk97q1o","TestSingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=e("../SingleTouchView"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onSetParent=function(e){console.error("parent:",e)},t.prototype.onTouchStart=function(){n.gFactory.putObj("TestNode",this.node)},t.prototype.onTouchEnd=function(){console.error("ontouchend")},t=__decorate([r],t)}(i.default));o.default=l,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../SingleTouchView":"SingleTouchView"}],Test:[function(e,t,o){"use strict";cc._RF.push(t,"df1af1sWs9HWZ8cYz9x0Gs9","Test"),Object.defineProperty(o,"__esModule",{value:!0});e("../Controller/GameStateController"),e("../GamePlay/Diamond/DiamondToucher"),e("../GamePlay/Model/ActionChecker"),e("../GamePlay/Model/GameLogic"),e("../GamePlay/Model/GamePlayModel"),e("../GamePlay/View/Animation/EffectRoot"),e("../Model/PlayModelProxy"),e("../Utils/Random");var n=e("../Utils/Signal"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.TestReStartSignal=r;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshing=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"RandomSeed",{get:function(){return this.node.getChildByName("RandomSeed")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RestartCount",{get:function(){return this.node.getChildByName("RestartCount")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Next",{get:function(){return this.node.getChildByName("Next")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NextMap",{get:function(){return this.node.getChildByName("NextMap")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TestClear",{get:function(){return this.node.getChildByName("TestClear")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CheckDrop",{get:function(){return this.node.getChildByName("CheckDrop")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CheckBlock",{get:function(){return this.node.getChildByName("CheckBlock")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{get:function(){return this.node.getChildByName("Animation")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){return this.node.active=!CELER_X,this.node.removeComponent(cc.Sprite),this.node.opacity=255,this.node.removeFromParent(!0),void this.node.destroy()},t.prototype.start=function(){},t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../Controller/GameStateController":"GameStateController","../GamePlay/Diamond/DiamondToucher":"DiamondToucher","../GamePlay/Model/ActionChecker":"ActionChecker","../GamePlay/Model/GameLogic":"GameLogic","../GamePlay/Model/GamePlayModel":"GamePlayModel","../GamePlay/View/Animation/EffectRoot":"EffectRoot","../Model/PlayModelProxy":"PlayModelProxy","../Utils/Random":"Random","../Utils/Signal":"Signal"}],ThemeView:[function(e,t,o){"use strict";cc._RF.push(t,"2b2d1k5+RZFrKLwiNmu7pk+","ThemeView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseView"),i=e("../../Global/Theme"),a=e("../../Command/CommonSignal"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){a.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},t.prototype.start=function(){},t.prototype.onThemeInit=function(e){this.node.active=this.node.name==i.Theme[e]},t=__decorate([l],t)}(n.default));o.default=s,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Global/Theme":"Theme","../../View/BaseView":"BaseView"}],Theme:[function(e,t,o){"use strict";cc._RF.push(t,"5fef4dbBENAfYW6Tw8oUA62","Theme"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Wood=0]="Wood",e[e.Stone=1]="Stone"}(o.Theme||(o.Theme={})),cc._RF.pop()},{}],TimeEffectAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"603e6ws6zRH9IcpX4uo/ZlK","TimeEffectAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/FrameAniBase"),i=e("../Command/CommonSignal"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.opacity=0,i.TimeAnimationStateChanged.inst.addListenerOne(this.onPlayStateChanged,this)},t.prototype.onPlayStateChanged=function(e){e?0==this.isPlaying&&this.play():this.stop()},t.prototype.start=function(){},t.prototype.play=function(){this.node.opacity=255,e.prototype.play.call(this)},t.prototype.stop=function(){this.node.opacity=0,e.prototype.stop.call(this)},t=__decorate([r],t)}(n.default));o.default=l,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Utils/FrameAniBase":"FrameAniBase"}],TimeLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"8e78fIPKARBx69B005nUUwo","TimeLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),a=e("../../../Utils/Time"),r=e("../../../View/BaseView"),l=cc._decorator,s=l.ccclass,c=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sec=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n.UpdateTimeNumber.inst.addListenerOne(this.onTimeChanged,this)},t.prototype.onTimeChanged=function(e){var t=a.Time.timeFormat(e);"MinuteLabel"==this.node.name?this.Label.string=t.split("/")[0]:"SecondLabel"==this.node.name?this.Label.string=t.split("/")[1]:this.Label.string=t,this.Label.font=e>30?i.ResourceController.inst.getTimeWhiteFont():i.ResourceController.inst.getTimeRedFont();var o=Math.floor(e);o!=this.sec&&("MinuteLabel"==this.node.name||"MinuteLabel"!=this.node.name&&"SecondLabel"!=this.node.name)&&(this.sec=o,this.sec<=5&&n.CountDownSignal.inst.dispatch())},t.prototype.start=function(){},t=__decorate([s],t)}(r.default));o.default=c,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController","../../../Utils/Time":"Time","../../../View/BaseView":"BaseView"}],Time:[function(e,t,o){"use strict";cc._RF.push(t,"87a24xcV95AoII6L5W1ABoI","Time"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.timeFormat=function(e){var t=Math.floor(e/60),o=Math.floor(e%60),n=o.toString();return o<10&&(n="0"+o),t+"/"+n},e}();o.Time=n,cc._RF.pop()},{}],ToSingleton:[function(e,t,o){"use strict";cc._RF.push(t,"b07299nlSpOIIxOkIMBhUY9","ToSingleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleTon=function(){return function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),e}()},cc._RF.pop()},{}],USDLabel:[function(e,t,o){"use strict";cc._RF.push(t,"06222pMAjpJTb5aCH+3wLBt","USDLabel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../GamePlay/View/UI/ScoreLabelView"),i=e("../Global/GameRule"),a=e("../Model/PlayModelProxy"),r=e("../Utils/Celer/CelerSDK"),l=e("../View/NumberChangedView"),s=cc._decorator,c=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),n.UpdateUSDLabelSignal.inst.addListenerOne(this.onScoreChanged,this),r.DifficultyLevelSignal.inst.addListenerOne(function(e){switch(e){case 1:t.node.active=!1;break;case 2:t.node.active=!0}},this),this.scale=100,this.preFix="$ ",this.setNumber(0)},t.prototype.onScoreChanged=function(e){this.onNumberChanged(Math.floor(a.PlayModelProxy.inst.PlayerScore*this.scale*i.GetUSDScale()))},t=__decorate([c],t)}(l.default));o.default=u,cc._RF.pop()},{"../GamePlay/View/UI/ScoreLabelView":"ScoreLabelView","../Global/GameRule":"GameRule","../Model/PlayModelProxy":"PlayModelProxy","../Utils/Celer/CelerSDK":"CelerSDK","../View/NumberChangedView":"NumberChangedView"}],UpTitle:[function(e,t,o){"use strict";cc._RF.push(t,"99872N0ksJGGZXcSd9N7i2n","UpTitle"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Celer/CelerSDK"),i=cc._decorator,a=i.ccclass,r=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Atlas=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;n.DifficultyLevelSignal.inst.addListenerOne(function(t){switch(t){case 1:e.Sprite.spriteFrame=e.Atlas.getSpriteFrame("bg_uptitle");break;case 2:e.Sprite.spriteFrame=e.Atlas.getSpriteFrame("bg_uptitle_bonus")}},this)},__decorate([r(cc.SpriteAtlas)],t.prototype,"Atlas",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../Utils/Celer/CelerSDK":"CelerSDK"}],UpdateController:[function(e,t,o){"use strict";cc._RF.push(t,"b3cadc9oLxMlaTWSqS0DgLW","UpdateController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){var t=e.call(this)||this;return t.assetsManager=null,t.STORAGE_PATH=(window.jsb&&jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hot-update",t.MANIFEST_PAth="",t.isUpdating=!1,t.manifest=null,t.completeCallback=[],t.startCallback=[],t.errorCallback=[],t.progressCallback=[],t.init(),t}return __extends(t,e),t.prototype.init=function(){window.jsb&&(this.assetsManager=new jsb.AssetsManager(this.MANIFEST_PAth,this.STORAGE_PATH,this.versionCompareHandle),this.assetsManager.setVerifyCallback(this.verifyCallback.bind(this)),cc.sys.os===cc.sys.OS_ANDROID&&this.assetsManager.setMaxConcurrentTask(2))},t.prototype.setManifest=function(e){this.manifest=e},t.prototype.getVersion=function(){return null==this.assetsManager?"":null==this.assetsManager.getLocalManifest()?"":this.assetsManager.getLocalManifest().getVersion()},t.prototype.addCompleteCallback=function(e,t){this.completeCallback.push({target:t,callback:e})},t.prototype.addErrorCallback=function(e,t){this.errorCallback.push({target:e,callback:t})},t.prototype.addStartCallback=function(e,t){this.startCallback.push({target:e,callback:t})},t.prototype.addProgressCallback=function(e,t){this.progressCallback.push({target:e,callback:t})},t.prototype.triggeError=function(e,t){void 0===t&&(t=!1),this.onError(e,t)},t.prototype.onError=function(e,t){void 0===t&&(t=!1),console.log(" this.errorCallback:",this.errorCallback.length,"error:",e);for(var o=0,n=this.errorCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.onComplete=function(e,t){void 0===t&&(t=!1),console.log(" on update complete:",this.getVersion()),console.log("storagePath:",this.getStoragePath()),console.log("search path:",this.getSearchPaths());for(var o=function(o){setTimeout(function(){o.callback.apply(o.target,[e,t])},0)},n=0,i=this.completeCallback;n<i.length;n++){o(i[n])}},t.prototype.getStoragePath=function(){return this.assetsManager?this.assetsManager.getStoragePath():""},t.prototype.getSearchPaths=function(){return window.jsb?jsb.fileUtils.getSearchPaths():""},t.prototype.onStart=function(e,t){void 0===t&&(t=!1),console.log(" this.startCallback:",this.startCallback.length);for(var o=0,n=this.startCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.onProgress=function(e,t){for(var o=0,n=this.progressCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.loadCustomManifest=function(e){if(null!=this.assetsManager&&this.assetsManager.getState()==jsb.AssetsManager.State.UNINITED){var t=new jsb.Manifest(e,this.STORAGE_PATH);this.assetsManager.loadLocalManifest(t,this.STORAGE_PATH)}},t.prototype.checkForUpdate=function(){this.onComplete("no need to update.")},t.prototype.checkUpdateCallback=function(e){switch(console.log("checkUpdateCallback Code: "+e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:var t=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():" null",o=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null";this.onComplete("Already up to date with the latest remote version :"+t+", local version :"+o);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.isUpdating=!1;var n=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null",i=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():"null";if(console.log("New version found, old:",n,", new: ",i),"null"==n||"null"==i);else{console.log("storage path:",this.assetsManager.getStoragePath());var a=n.split(".")[0];i.split(".")[0]>a?this.onStart("new version found, go to store to download new app.",!0):(this.onStart("new version found, update process start.",!1),this.updateVersion())}break;default:return}},t.prototype.getUpdateDescription=function(){return""},t.prototype.updateVersion=function(){if(null!=this.assetsManager&&!this.isUpdating)if([jsb.AssetsManager.State.UPDATING,jsb.AssetsManager.State.UNZIPPING,jsb.AssetsManager.State.UP_TO_DATE].indexOf(this.assetsManager.getState())>=0)this.onComplete("no need to update: "+this.assetsManager.getState(),!1);else{if(this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifest.nativeUrl;cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this.assetsManager.loadLocalManifest(e)}this.assetsManager.setEventCallback(this.updateCallback.bind(this)),console.log(" start update ...:",this.assetsManager.getState()),this.assetsManager.update(),this.isUpdating=!0}},t.prototype.versionToInt=function(e){return parseInt(e.toString().split(".").join(""))},t.prototype.versionToString=function(e){return Math.floor(e/100)+"."+Math.floor(e/10)%10+"."+Math.floor(e)%10},t.prototype.updateCallback=function(e){var t=this,o=!1,n=!1,i=null;switch(console.log("update event code:",e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var a=e.getPercent();NaN!=a&&"number"==typeof a||(a=0),this.onProgress(e.getMessage()?"Updated file:"+e.getMessage():"Updating:"+(100*a).toFixed(0)+"%",a);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:i=function(){var e=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Already up to date with the latest remote version :"+e)},n=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:i=function(){var o=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Update finished. new : "+o+e.getMessage(),!0)},o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.onError("Update failed. "+e.getMessage(),!0);break;case jsb.EventAssetsManager.ERROR_UPDATING:this.onError("Asset update error: "+e.getAssetId()+", "+e.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.onError(e.getMessage())}if(n&&(this.assetsManager.setEventCallback(null),this.isUpdating=!1),o){this.assetsManager.setEventCallback(null);var r=jsb.fileUtils.getSearchPaths();console.log("old searchPaths:",r);var l=this.assetsManager.getLocalManifest().getSearchPaths();console.log("new path:",JSON.stringify(l));for(var s=0,c=l;s<c.length;s++){var u=c[s];r.indexOf(u)<0&&Array.prototype.unshift.apply(r,u)}cc.sys.localStorage.setItem("select-game",JSON.stringify(r)),jsb.fileUtils.setSearchPaths(r),console.log("new searchPaths:",JSON.stringify(r)),console.log(" paths storage:",cc.sys.localStorage.getItem("select-game"))}i&&i()},t.prototype.restart=function(){cc.audioEngine.stopAll(),cc.game.restart()},t.prototype.retry=function(){null!=this.assetsManager&&0==this.isUpdating&&this.assetsManager.downloadFailedAssets()},t.prototype.versionCompareHandle=function(e,t){cc.log("JS Custom Version Compare: version A is "+e+", version B is "+t);for(var o=e.split("."),n=t.split("."),i=0;i<o.length;++i){var a=parseInt(o[i]),r=parseInt(n[i]||"0");if(a!==r)return a-r}return n.length>o.length?-1:0},t.prototype.verifyCallback=function(e,t){var o=t.compressed,n=t.md5,i=t.path;t.size;return o?("Verification passed : "+i,!0):("Verification passed : "+i+" ("+n+")",!0)},t.prototype.destory=function(){this.assetsManager&&this.assetsManager.setEventCallback(null),this.startCallback=[],this.completeCallback=[],this.errorCallback=[],this.progressCallback=[]},t=__decorate([a],t)}(n.SingleTon()));o.default=r,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}],WildAdAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"a477475bJVCr55eJoQUua8c","WildAdAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/FrameAniBase"),i=e("../Utils/Signal"),a=cc._decorator,r=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.WildAdAnimationIsPlaySignal=l;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isStart=!1,t}return __extends(t,e),t.prototype.onStartPlay=function(){var e=this;l.inst.dispatchOne(!0),0==this.isStart&&(this.isStart=!0,setTimeout(function(){e.isStart=!1,e.stop(),e.node.opacity=0,setTimeout(function(){e.node.opacity=255,e.Loop=!0,e.play()},8e3)},2e3))},t.prototype.onComplete=function(){l.inst.dispatchOne(!1)},t=__decorate([r],t)}(n.default);o.default=s,cc._RF.pop()},{"../Utils/Signal":"Signal","../utils/FrameAniBase":"FrameAniBase"}],WildAdButton:[function(e,t,o){"use strict";cc._RF.push(t,"465d6JCvm9NEa4D+PNSyYjD","WildAdButton"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Signal"),i=cc._decorator,a=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.HideWildAdButtonSignal=r;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.WildAdButtonClick=l;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.WildButtonReadySignal=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.active=cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_ANDROID,this.node.parent.active=this.node.active,this.node.scale=0,s.inst.addOnce(function(){console.log(" Wild button :",e.node.active),e.node.active&&(e.node.getComponent(cc.Button).transition=cc.Button.Transition.NONE,e.node.runAction(cc.sequence(cc.scaleTo(.1,1),cc.callFunc(function(){e.node.getComponent(cc.Button).transition=cc.Button.Transition.SCALE,e.node.getComponent(cc.Button).zoomScale=.94,e.node.on(cc.Node.EventType.TOUCH_END,function(){l.inst.dispatch()},e)}))))},this),r.inst.addListener(function(){e.node.active=!1,e.node.parent.active=!1},this)},t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../Utils/Signal":"Signal"}],WoodBreakAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"1652apF4FZFmYJ33HhpO22S","WoodBreakAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../../Global/Theme"),i=e("../../../../Model/PlayModelProxy"),a=e("../../../Model/Map/MapType"),r=e("../EffectBase"),l=e("../Root/BlockRoot"),s=cc._decorator,c=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onStartPlay=function(){e.prototype.onStartPlay.call(this),this.node.scale=2},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),l.PlayBlockBreakSignal.inst.addListenerTwo(this.onBreak,this)},t.prototype.onBreak=function(e,t){this.ID&&this.ID==e.ID&&e.Type==a.MapType.Stone&&i.PlayModelProxy.inst.Theme==n.Theme.Wood&&t>=1&&this.play()},t=__decorate([c],t)}(r.default));o.default=u,cc._RF.pop()},{"../../../../Global/Theme":"Theme","../../../../Model/PlayModelProxy":"PlayModelProxy","../../../Model/Map/MapType":"MapType","../EffectBase":"EffectBase","../Root/BlockRoot":"BlockRoot"}],table:[function(e,t,o){"use strict";cc._RF.push(t,"f4ed2LT641ClapudKL64DXV","table"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen",e[e.BonusParty=15]="BonusParty"}(o.En_ID||(o.En_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian",e[e.XinShouZhiYin=800]="XinShouZhiYin"}(o.En_View||(o.En_View={})),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen"}(o.Es_ID||(o.Es_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian"}(o.Es_View||(o.Es_View={})),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen"}(o.Fil_ID||(o.Fil_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian"}(o.Fil_View||(o.Fil_View={})),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen"}(o.Id_ID||(o.Id_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian"}(o.Id_View||(o.Id_View={})),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen"}(o.In_ID||(o.In_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian"}(o.In_View||(o.In_View={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map10_1_Type||(o.Map10_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map10_2_Type||(o.Map10_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map1_1_Type||(o.Map1_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map1_2_Type||(o.Map1_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map2_1_Type||(o.Map2_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map2_2_Type||(o.Map2_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map3_1_Type||(o.Map3_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map3_2_Type||(o.Map3_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map4_1_Type||(o.Map4_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map4_2_Type||(o.Map4_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map5_1_Type||(o.Map5_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map5_2_Type||(o.Map5_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map6_1_Type||(o.Map6_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map6_2_Type||(o.Map6_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map7_1_Type||(o.Map7_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map7_2_Type||(o.Map7_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map8_1_Type||(o.Map8_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map8_2_Type||(o.Map8_2_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map9_1_Type||(o.Map9_1_Type={})),function(e){e[e.Kong=1]="Kong",e[e.Pu=2]="Pu",e[e.Tu=3]="Tu",e[e.Shi=4]="Shi",e[e.Cao=5]="Cao"}(o.Map9_2_Type||(o.Map9_2_Type={})),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen"}(o.Pt_ID||(o.Pt_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian"}(o.Pt_View||(o.Pt_View={})),function(e){e[e.KanGuangGaoShiBai=1]="KanGuangGaoShiBai",e[e.JiangLiBuShu=2]="JiangLiBuShu",e[e.JiangLiCaiHongBaoShi=3]="JiangLiCaiHongBaoShi",e[e.ZanTingMiaoShu=4]="ZanTingMiaoShu",e[e.MianFeiZanTing=5]="MianFeiZanTing",e[e.ZanTingKouFen=6]="ZanTingKouFen",e[e.BangZhuYeMian1=7]="BangZhuYeMian1",e[e.BangZhuYeMian2=8]="BangZhuYeMian2",e[e.BangZhuYeMian3=9]="BangZhuYeMian3",e[e.BangZhuYeMian4=10]="BangZhuYeMian4",e[e.BaoShiDeFen=11]="BaoShiDeFen",e[e.JinKuaiDeFen=12]="JinKuaiDeFen",e[e.ShiJianJiaCheng=13]="ShiJianJiaCheng",e[e.ZongDeFen=14]="ZongDeFen"}(o.Tl_ID||(o.Tl_ID={})),function(e){e[e.ZanTingJieMian=400]="ZanTingJieMian",e[e.BangZhuJieMian=500]="BangZhuJieMian",e[e.JieSuanJieMian=600]="JieSuanJieMian",e[e.GuangGaoJieMian=700]="GuangGaoJieMian"}(o.Tl_View||(o.Tl_View={})),cc._RF.pop()},{}]},{},["AdLayer","FlyCnicornAd","WildAdButton","FlyAdCnicornAniamtion","ResultAnimation","WildAdAnimation","App","LevelLight","MapInfo","MoveCountLabel","USDLabel","UpTitle","CommonSignal","AdController","GameStateController","ResourceController","GameFactory","BlockIconUtil","BlockIconView","GamePlaySignal","DiamondIconUtil","DiamondIconView","DiamondPositionView","DiamondScaleView","DiamondToucher","ActionChecker","BlockModel","DiamondDropChecker","DiamondModel","EliminationChecker","GameLogic","GamePlayModel","GridUtil","MapFactory","MapType","LeafBreakAnimation","MudBreakAnimation","StoneBreakAnimation","WoodBreakAnimation","IdleAnimation","LineBreakAnimation","MergeAnimation","NormalBreakAnimation","RainbowLineAnimation","EffectBase","EffectMapRoot","EffectRoot","FireWorkAnimation","RefreshAnimation","BlockRoot","ComboWordRoot","LightRoot","LineRoot","MergeRoot","NormalRoot","RainbowRoot","SquareRoot","BlockMapRoot","DiamondMapRoot","GoldRoot","Box","Cell","GridMap","MapRoot","PrefabBaseView","DragPanel","BlackView","CompleteView","GetGoldAnimation","GoldIconView","GoldLabelView","HelpButtonView","LevelProgressView","MenuButtonView","MenuLayerView","MoveCountLabelView","MoveFlyAnimation","PassLevelAnimation","ResultLayerView","RevertButtonView","ScoreLabelView","SoundButtonView","SubmitButtonView","SubmitLayerView","TimeLabelView","BreakAnimation","Page","ScoreFloat","GameRecorder","GameRule","Level","Theme","InititalCommand","LoadAudioCommand","LoadJsonCommand","LoadPrefabCommand","StartGameCommand","InitialFacade","LoadingPageMediator","LoadingView","ThemeView","AudioManager","StepManager","PlayModelProxy","TableManager","UpdateController","CelerSDK","Cocos","FrameAniBase","HashMap","LogHandler","Random","Signal","Time","ToSingleton","AdaptationWigetView","BaseMediator","BaseView","GlobalSingleTouchMediator","GlobalSingleTouchView","HelpLayerMediator","HelpLayerView","HelpTextView","NumberChangedView","SingleTouchMediator","SingleTouchView","SliderView","Test","TestMove","FrontView","TestApp","TestSingleTouchView","TimeEffectAnimation","EaseBaseView","PositionView","RotationView","ScaleView","SkewView","table"]);