window.__require=function t(e,o,n){function a(s,r){if(!o[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+s+"'")}}var p=o[s]={exports:{}};e[s][0].call(p.exports,function(t){return a(e[s][1][t]||t)},p,p.exports,t,e,o,n)}return o[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<n.length;s++)a(n[s]);return a}({App:[function(t,e,o){"use strict";cc._RF.push(e,"eaeeaWDD5pJfqkUameEwNsk","App"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Initialization/Facade/InitialFacade"),a=cc._decorator,i=a.ccclass,s=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){console.log(" app onload ")},e.prototype.start=function(){n.InitialFacade.inst.start()},e=__decorate([i],e)}(cc.Component));o.default=s,cc._RF.pop()},{"../Initialization/Facade/InitialFacade":"InitialFacade"}],AudioManager:[function(t,e,o){"use strict";cc._RF.push(e,"88c70Ktw0pBKKUTDtyQ2NkZ","AudioManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Utils/HashMap");window.oncanplay&&(window.oncanplay=function(){i.canPlay=!0});var a="sounds/",i=function(){function t(){this.audioID={},this.clips=new n.HashMap}return Object.defineProperty(t,"inst",{get:function(){return this.ins?this.ins:this.ins=new t},enumerable:!0,configurable:!0}),t.prototype.init=function(t){var e=this;console.warn(" start load AudioClip ");var o=this;cc.loader.loadRes(a+"bgm",cc.AudioClip,function(e,n){e?console.error(e):(o.clips.add(n.name,n),t&&t())}),cc.loader.loadRes(a+"mouse_bgm",function(t,e){t?console.error(t):o.clips.add(e.name,e)}),cc.loader.loadRes(a+"bgm_30",function(t,e){t?console.error(t):o.clips.add(e.name,e)}),cc.loader.loadResDir(a,function(t,o,n){if(t)console.error(t);else for(var a=0,i=o;a<i.length;a++){var s=i[a];e.clips.has(s.name)||e.clips.add(s.name,s)}})},t.prototype.playEffect=function(e,o,n){var i=this;if(void 0===o&&(o=!1),t.canPlay){if(!(cc.audioEngine.getEffectsVolume()<=.05)){var s=this.clips.get(e);s?(this.audioID[e]=cc.audioEngine.playEffect(s,o),cc.audioEngine.setFinishCallback(this.audioID[e],function(){n&&n()})):cc.loader.loadRes(a+e,cc.AudioClip,function(t,a){t?console.error(t):(i.clips.add(a.name,a),i.audioID[e]=cc.audioEngine.playEffect(a,o),cc.audioEngine.setFinishCallback(i.audioID[e],function(){n&&n()}))})}}else this.bindTouch()},t.prototype.playMusic=function(e,o){var n=this;if(void 0===o&&(o=!0),!t.canPlay)return this.bindTouch(),void t.PlayedList.push({loop:!0,volume:1,clipName:e,supTime:Date.now(),skip:!1,isBgm:!0});var i=this.clips.get(e);i?cc.audioEngine.playMusic(i,o):cc.loader.loadRes(a+e,cc.AudioClip,function(t,e){t?console.error(t):("string"==typeof e._audio&&cc.loader._cache&&cc.loader._cache[e._audio]&&cc.loader._cache[e._audio].buffer&&(e._audio=cc.loader._cache[e._audio].buffer),n.clips.add(e.name,e),cc.audioEngine.playMusic(e,o))})},t.prototype.bindTouch=function(){if(!t.hasBindTouch){var e=this,o=function(){var n;for(cc.game.canvas.removeEventListener("touchstart",o),t.canPlay=!0;(n=t.PlayedList.pop())&&e.clips.get(n.clipName)&&!n.skip;)cc.audioEngine.playMusic(e.clips.get(n.clipName),n.loop)};t.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",o)}},t.PlayedList=[],t.canPlay=!1,t.hasBindTouch=!1,t}();o.gAudio=i.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],BaseMediator:[function(t,e,o){"use strict";cc._RF.push(e,"a76c1ySm3tAQId4zbAsdr/d","BaseMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./BaseView"),a=cc._decorator,i=a.ccclass,s=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"View",{get:function(){return null==this.view&&(this.view=this.getComponent(n.default)),this.view},enumerable:!0,configurable:!0}),e.prototype.onRegister=function(){},e=__decorate([i],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./BaseView":"BaseView"}],BaseView:[function(t,e,o){"use strict";cc._RF.push(e,"6daedF7tVNJ3qN565kuohVZ","BaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=0},e.prototype.Show=function(){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1)))},e.prototype.Hide=function(){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.active=!1})))},e.prototype.OnClick=function(){},e.prototype.BindMedaitor=function(t){var e=this.node.addComponent(t);return e.onRegister&&e.onRegister(),e},e=__decorate([a],e)}(cc.Component));o.default=i,cc._RF.pop()},{}],CelerSDK:[function(t,e,o){"use strict";cc._RF.push(e,"34a72Ol/DRKJb0NyonTxi8g","CelerSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../ToSingleton"),a=t("../LogHandler"),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alreadySubmit=!1,e.isNewPlayer=!0,e.celerStartCallback=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"MatchID",{get:function(){return this.match.matchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MatchRandomSeed",{get:function(){return this.match.sharedRandomSeed},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.alreadySubmit=!1,CELER_X&&celerSDK.onStart(this.onCelerStart.bind(this)),CELER_X&&celerSDK.provideScore(function(){return 0}),this.celerStartCallback=t,CELER_X&&a.LogHandler.inst.initLog(celerSDK.log)},e.prototype.celerXReady=function(){console.log(" invoke celerx.ready() "),CELER_X?celerSDK.ready():this.onCelerStart()},e.prototype.isNew=function(){return this.isNewPlayer},e.prototype.isOnCelerPlatform=function(){return CELER_X},e.prototype.onCelerStart=function(){console.log(" celerx onStart call"),this.match=CELER_X?celerSDK.getMatch():{matchId:"error : can not get id",shouldLaunchTutorial:!1,sharedRandomSeed:1,difficultyLevel:0},console.log("match id:",this.match.matchId,", seed:",this.match.sharedRandomSeed),this.match&&this.match.shouldLaunchTutorial?this.isNewPlayer=!0:this.isNewPlayer=!1,this.celerStartCallback&&(this.celerStartCallback(),this.celerStartCallback=null)},e.prototype.submitScore=function(t){this.alreadySubmit||(this.alreadySubmit=!0,console.log(" submit score:",t,", match id:",this.match.matchId),CELER_X&&celerSDK.submitScore(t))},e}(n.SingleTon());o.CelerSDK=i,cc._RF.pop()},{"../LogHandler":"LogHandler","../ToSingleton":"ToSingleton"}],FacadeGlobal:[function(t,e,o){"use strict";cc._RF.push(e,"c46cfDkM7pInYAeGAk610m1","FacadeGlobal"),cc._RF.pop()},{}],FrameAniBase:[function(t,e,o){"use strict";cc._RF.push(e,"6298cJI+OZK9J9ZyfrpqPP2","FrameAniBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,s=n.executeInEditMode,r=n.requireComponent,c=n.playOnFocus,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Frames=null,e.Interval=.1,e.Priority=0,e.Loop=!1,e.PlayOnLoad=!1,e.currentIndex=0,e.time=0,e.isPlay=!1,e.listener=[],e.complateEvent=[],e}var o;return __extends(e,t),o=e,Object.defineProperty(e.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Animation",{set:function(t){this.Frames=t},enumerable:!0,configurable:!0}),e.prototype.onFocusInEditor=function(){this.time=this.Interval,o.intervalID=setInterval(this.update.bind(this),.016,.016)},e.prototype.onLostFocusInEditor=function(){clearInterval(o.intervalID)},e.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},e.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,0==this.isPlaying&&this.callEventComplete()},e.prototype.playOnLoop=function(){this.Loop=!0,this.play()},e.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},e.prototype.pause=function(){this.isPlay=!1},e.prototype.resume=function(){this.isPlay=!0},e.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.Loop=!1},e.prototype.onKeyFrame=function(t){},e.prototype.addKeyEventListener=function(t,e){this.listener.push({callback:t,target:e})},Object.defineProperty(e.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),e.prototype.clearAllListener=function(){return this.listener.length=0,this},e.prototype.onComplete=function(){},e.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var t=0,e=this.listener;t<e.length;t++){var o=e[t];o.callback.apply(o.target,[this.currentIndex,this.__classname__])}},e.prototype.callEventComplete=function(){this.onComplete();for(var t=0,e=this.complateEvent;t<e.length;t++){var o=e[t];o.f.apply(o.target,[this.__classname__])}},e.prototype.addCompleteEvent=function(t,e){this.complateEvent.push({f:t,target:e})},Object.defineProperty(e.prototype,"TotalFrameCount",{get:function(){return this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),e.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},e.prototype.start=function(){},Object.defineProperty(e.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var t=0,e=this.getComponents(o);t<e.length;t++){var n=e[t];if(n.Priority>this.Priority&&n.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex],this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.Frames.getSpriteFrames().length,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},e.prototype.update=function(t){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=t},e.aniName="FrameAniBase",e.intervalID=-1,__decorate([i(cc.SpriteAtlas)],e.prototype,"Frames",void 0),__decorate([i],e.prototype,"Interval",void 0),__decorate([i],e.prototype,"Priority",void 0),__decorate([i],e.prototype,"Loop",void 0),__decorate([i],e.prototype,"PlayOnLoad",void 0),e=o=__decorate([a,s,c,r(cc.Sprite)],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],GameFactory:[function(t,e,o){"use strict";cc._RF.push(e,"93d23kfnY1A76OtZSkIyJ5r","GameFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Utils/HashMap"),a=function(){function t(t,e,o){this._pool=[],this.totalSize=0,this.initTime=[],this.completeHandler=o,this.template=t,this.totalSize=e,this.hashKey="ObjPool:"+this.template.name+" - "+this.totalSize,this.initPool(e)}return t.prototype.initPool=function(t,e){var o=this;if(void 0===e&&(e=!1),e)for(var n=0;n<t;++n){this.initTime.push(Date.now());var a=cc.instantiate(this.template);this.put(a)}else for(n=0;n<t;++n)this.initTime.push(Date.now()),setTimeout(function(){var t=cc.instantiate(o.template);o.put(t)},n)},t.prototype.size=function(){return this._pool.length},t.prototype.clear=function(){for(var t=this._pool.length,e=0;e<t;++e)this._pool[e].destroy&&this._pool[e].destroy();this._pool.length=0},t.prototype.put=function(t){if(t&&-1===this._pool.indexOf(t)){t.removeFromParent(!1);for(var e=0,o=t.getComponents(cc.Component);e<o.length;e++){var n=o[e];n&&n.unuse&&n.unuse.apply(n)}this._pool.push(t),this.completeHandler&&this.totalSize<=this._pool.length&&(this.completeHandler(),this.completeHandler=null)}},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=this._pool.length-1;o<0&&(console.warn(" last < 0 "),this.initPool(1,!0)),o=this._pool.length-1;var n=this._pool[o];this._pool.length=o;for(var a=0,i=n.getComponents(cc.Component);a<i.length;a++){var s=i[a];s&&s.reuse&&s.reuse.apply(s,arguments)}return n},t}(),i=function(){function t(){this.count=0,this.totalCount=0,this.objPool=new n.HashMap,this.startTime=0}return Object.defineProperty(t,"inst",{get:function(){return this.ins?this.ins:this.ins=new t},enumerable:!0,configurable:!0}),t.prototype.init=function(t){var e=this;this.doneCallback=t,this.startTime=Date.now(),cc.loader.loadResDir("prefabs/",cc.Prefab,function(t,o,n){if(t)console.error(" Game Factory init failed:",t);else{e.totalCount=o.length;for(var i=function(t){var n=o[t],i=n.name.split("."),s=i[0],r=i[1]?parseInt(i[1]):30;console.log(" init pool:",s,", count:",r),setTimeout(function(){var t=new a(n,r,e.addCount.bind(e));e.objPool.add(s,t)},10*t)},s=0;s<o.length;s++)i(s)}})},t.prototype.addCount=function(){this.count++,this.count>=this.totalCount&&(console.log(" factory cost time:",(Date.now()-this.startTime).toFixed(2)+"ms"),this.doneCallback&&(this.doneCallback(),this.doneCallback=null))},t.prototype.getObj=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return this.objPool.has(t)?this.objPool.get(t).get(e):(console.error(" objPool dosen't exists this obj:",t),null)},t.prototype.putObj=function(t,e){if(this.objPool.has(t))return this.objPool.get(t).put(e);console.error(" objPool dosen't exists this obj:",t)},t}();o.gFactory=i.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],HashMap:[function(t,e,o){"use strict";cc._RF.push(e,"4b0e7DzcRNJnZXTYCWgDaDU","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this._list=new Array,this.clear()}return t.prototype.getIndexByKey=function(t){for(var e=this._list.length,o=0;o<e;o++){if(this._list[o].key==t)return o}return-1},t.prototype.keyOf=function(t){for(var e=this._list.length,o=0;o<e;o++){var n=this._list[o];if(n.value.hashKey&&t.hashKey&&n.value.hashKey===t.hashKey||n.value==t)return n.key}return null},Object.defineProperty(t.prototype,"keys",{get:function(){for(var t=new Array,e=0,o=this._list;e<o.length;e++){var n=o[e];n&&t.push(n.key)}return t},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){var o={key:t,value:e},n=this.getIndexByKey(t);-1!=n?this._list[n]=o:this._list.push(o)},Object.defineProperty(t.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){var e=this.getIndexByKey(t);if(-1!=e){var o=this._list[e];return this._list.splice(e,1),o}return null},t.prototype.has=function(t){return-1!=this.getIndexByKey(t)},t.prototype.get=function(t){var e=this.getIndexByKey(t);return-1!=e?this._list[e].value:null},Object.defineProperty(t.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),t.prototype.sort=function(t){this._list.sort(t)},t.prototype.forEachKeyValue=function(t){for(var e=this._list.length,o=0;o<e;o++){t(this._list[o])}},t.prototype.forEach=function(t){for(var e=this._list.length,o=0;o<e;o++){var n=this._list[o];t(n.key,n.value)}},t.prototype.clear=function(){this._list=[]},t}();o.HashMap=n,cc._RF.pop()},{}],InitialFacade:[function(t,e,o){"use strict";cc._RF.push(e,"cbbbcO7od5PrqaPNOs8dFh3","InitialFacade"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Command/InititalCommond"),a=t("../Command/StartGameCommond"),i=t("../Command/LoadAudioCommond"),s=t("../Command/LoadPrefabCommond"),r=t("../../Utils/Celer/CelerSDK"),c=function(){function t(t){this.loadTime={},this.steps=[],this.facade=puremvc.Facade.getInstance(t)}return Object.defineProperty(t,"inst",{get:function(){return this.instance?this.instance:this.instance=new t(t.MULTITON_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Facade",{get:function(){return console.assert(null!==this.facade," facade is null"),this.facade},enumerable:!0,configurable:!0}),t.prototype.register=function(){var e=this;this.facade.registerCommand(t.INITIALIZATION,n.InitialCommond),this.facade.registerCommand(t.START_UP,a.StartGameCommond),r.CelerSDK.inst.init(function(){e.facade.sendNotification(t.START_UP,e)})},t.prototype.unregister=function(){this.facade.removeCommand(t.INITIALIZATION),this.facade.removeCommand(t.START_UP)},t.prototype.start=function(){this.register();for(var e=0,o=t.TOTAL_STEPS;e<o.length;e++){var n=o[e];this.loadTime[n]=Date.now()}this.facade.sendNotification(t.INITIALIZATION,this)},t.prototype.step=function(e){if(console.log(" initialization step:",e),this.steps.indexOf(e)<0){this.steps.push(e),this.steps.sort(),t.TOTAL_STEPS.sort();var o=this.steps.join("-"),n=t.TOTAL_STEPS.join("-");console.log(" cur-steps\uff1a",o,", total:",n,", ",e," cost:",(Date.now()-this.loadTime[e]).toFixed(2),"ms"),n===o&&(r.CelerSDK.inst.isOnCelerPlatform()?r.CelerSDK.inst.celerXReady():this.facade.sendNotification(t.START_UP,this))}},t.MULTITON_KEY="INITIAL_FCADE",t.INITIALIZATION="initialization",t.START_UP="startup",t.TOTAL_STEPS=[i.LoadAudioCommond.STEP,s.LoadPrefabCommond.STEP],t}();o.InitialFacade=c,cc._RF.pop()},{"../../Utils/Celer/CelerSDK":"CelerSDK","../Command/InititalCommond":"InititalCommond","../Command/LoadAudioCommond":"LoadAudioCommond","../Command/LoadPrefabCommond":"LoadPrefabCommond","../Command/StartGameCommond":"StartGameCommond"}],InititalCommond:[function(t,e,o){"use strict";cc._RF.push(e,"a28caT/H41F74cWxJYqN9pz","InititalCommond"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./LoadPrefabCommond"),a=t("./LoadAudioCommond"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initializeMacroCommand=function(){this.addSubCommand(n.LoadPrefabCommond),this.addSubCommand(a.LoadAudioCommond)},e}(puremvc.MacroCommand);o.InitialCommond=i,cc._RF.pop()},{"./LoadAudioCommond":"LoadAudioCommond","./LoadPrefabCommond":"LoadPrefabCommond"}],LoadAudioCommond:[function(t,e,o){"use strict";cc._RF.push(e,"d4f3eGYUlBES5d8aEvuPQna","LoadAudioCommond"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){if(t){var o=t.getBody();o&&o.step&&o.step(e.STEP)}},e.STEP="LoadAudio",e}(puremvc.SimpleCommand);o.LoadAudioCommond=n,cc._RF.pop()},{}],LoadPrefabCommond:[function(t,e,o){"use strict";cc._RF.push(e,"8b33fPnvCZEJ7bc/zCVv9My","LoadPrefabCommond"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../Factory/GameFactory"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){n.gFactory.init(function(){if(t){var o=t.getBody();o&&o.step&&o.step(e.STEP)}})},e.STEP="LoadPrefab",e}(puremvc.SimpleCommand);o.LoadPrefabCommond=a,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory"}],LogHandler:[function(t,e,o){"use strict";cc._RF.push(e,"a4747QIvUBIo6Ktpx/xQwuB","LogHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(t){function e(){var o=t.call(this)||this;if(o.logFunc=console.log,o.logMsg=null,o.frameTimes=0,o.now=0,o.Frame=20,o.totalFrames=0,o.startTime=0,window.addEventListener)for(var n=0,a=e.LISTENNING_EVENTS;n<a.length;n++){var i=a[n],s="trigger"+i.charAt(0).toLocaleUpperCase()+i.substring(1);o[s]&&"function"==typeof o[s]&&window.addEventListener(i,o[s].bind(o))}return o}return __extends(e,t),e.prototype.dumpFrameInfo=function(){var t=(Date.now()-this.startTime)/1e3,e=t/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",t+"s"," , per frame cost time ave:"+e+"s")},e.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addLog.apply(this,t),this.sendLog()},e.prototype.initLog=function(t){var o=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){o.frameTimes=0,o.now=Date.now(),o.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){o.frameTimes++,o.totalFrames++,o.frameTimes>=o.Frame&&(o.frameTimes=0,o.now=Date.now())},this),this.logFunc=t,console.error=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(t=e.inst).log.apply(t,["[ERROR]"].concat(o))},console.warn=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(t=e.inst).log.apply(t,["[WARN]"].concat(o))},console.log=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(t=e.inst).log.apply(t,["[INFO]"].concat(o))}},e.prototype.formatLogArguments=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var o="",n=0;n<arguments.length;n++){var a=typeof arguments[n];"string"==a||"number"==a?o+=" "+arguments[n]:"object"==a?o+=" "+JSON.stringify(arguments[n]):"boolean"==a&&arguments[n].toString&&(o+=arguments[n].toString())}return o},e.prototype.addLog=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null==this.logMsg&&(this.logMsg={});var n=this.formatLogArguments.apply(this,t),a=this.getFullTime(new Date);this.logMsg[a]=e.VERSION+n},e.prototype.getFullTime=function(t){var e="";e+=t.getFullYear();var o=t.getMonth()+1;e+="-"+(o>=10?o:"0"+o);var n=t.getDate();e+="-"+(n>=10?n:"0"+n);var a=t.getHours();e+="  "+(a>=10?a:"0"+a);var i=t.getMinutes();e+=":"+(i>=10?i:"0"+i);var s=t.getSeconds();return e+=":"+(s>=10?s:"0"+s)},e.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},e.prototype.triggerClose=function(t){this.addLog("triggerClose"),this.sendLog()},e.prototype.triggerLoad=function(t){this.addLog("triggerLoad"),this.sendLog()},e.prototype.triggerUnload=function(t){this.addLog("triggerUnload"),this.sendLog()},e.prototype.triggerOnunload=function(t){this.addLog("triggerUnload"),this.sendLog()},e.prototype.triggerError=function(t){this.addLog("triggerError"),this.addLog(t.message),this.sendLog()},e.prototype.triggerFocus=function(t){this.addLog("triggerFocus"),this.sendLog()},e.prototype.triggerBlur=function(t){this.addLog("triggerBlur"),this.sendLog()},e.prototype.triggerAbort=function(t){this.addLog("triggerAbort"),this.sendLog()},e.prototype.triggerSuspend=function(t){this.addLog("triggerSuspend"),this.sendLog()},e.prototype.beforeunload=function(t){this.addLog("beforeunload"),this.sendLog()},e.VERSION="DominoCash version 1 : ",e.LISTENNING_EVENTS=["error"],e}(t("./ToSingleton").SingleTon());o.LogHandler=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],MainScene:[function(t,e,o){"use strict";cc._RF.push(e,"bb115JQb0ZMfLouNAXV3ENp","MainScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Initialization/Facade/InitialFacade"),a=cc._decorator,i=a.ccclass,s=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.InitialFacade.inst.start()},e.prototype.start=function(){},e=__decorate([i],e)}(cc.Component));o.default=s,cc._RF.pop()},{"../Initialization/Facade/InitialFacade":"InitialFacade"}],Random:[function(t,e,o){"use strict";cc._RF.push(e,"114f9Vox8JGQbohBr4HFlkf","Random"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.seededRandom=function(t,e,o){return e+1e6*((1711*t+88888)%302654/302654+(1722*t+55555)%302665/302665+(1755*t+23333)%302766/302766)%1e6/1e6*(o-e)},t.getRandom=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);var o=this.randomSeed,n=this.seededRandom(o,t,e),a=Math.floor(this.seededRandom(o,1,302766));return this.randomSeed+=a,n},t.setRandomSeed=function(t){this.randomSeed=t,this.sharedSeed=t},t.randomRoundToInt=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),Math.round(this.getRandom(t,e))},t.randomSeed=0,t.sharedSeed=0,t}();o.Random=n,cc._RF.pop()},{}],Signal:[function(t,e,o){"use strict";cc._RF.push(e,"5e03fyVNOZPs7lLvT6ttunM","Signal"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listenerMap=[],e.onceListenerMap=[],e}return __extends(e,t),e.prototype.doDispatch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.excuteListener.apply(this,t),this.excuteOnce.apply(this,t)},e.prototype.excuteListener=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.listenerMap&&this.listenerMap.length>0)for(var o=0,n=this.listenerMap;o<n.length;o++){var a=n[o];a.callback.apply(a.target,t)}},e.prototype.excuteOnce=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var o=0,n=this.onceListenerMap;o<n.length;o++){var a=n[o];a.callback.apply(a.target,t)}this.onceListenerMap.length=0}},e.prototype.listen=function(t,e){this.listenerMap.push({callback:t,target:e})},e.prototype.listenOnce=function(t,e){this.onceListenerMap.push({callback:t,target:e})},e.prototype.removeListener=function(t,e){if(this.listenerMap&&this.listenerMap.length>0)for(var o=0;o<this.listenerMap.length;++o){var n=this.listenerMap[o];n.callback==t&&n.target==e&&(this.listenerMap.splice(o,1),--o)}},e.prototype.removeTarget=function(t){if(this.listenerMap&&this.listenerMap.length>0)for(var e=0;e<this.listenerMap.length;++e){this.listenerMap[e].target==t&&(this.listenerMap.splice(e,1),--e)}},e.prototype.dispatch=function(){this.doDispatch(null)},e.prototype.dispatchOne=function(t){this.doDispatch(t)},e.prototype.dispatchTwo=function(t,e){this.doDispatch(t,e)},e.prototype.dispatchThree=function(t,e,o){this.doDispatch(t,e,o)},e.prototype.dispatchFour=function(t,e,o,n){this.doDispatch(t,e,o,n)},e.prototype.dispatchFive=function(t,e,o,n,a){this.doDispatch(t,e,o,n,a)},e.prototype.addListener=function(t,e){this.listen(t,e)},e.prototype.addOnce=function(t,e){this.listenOnce(t,e)},e.prototype.addListenerOne=function(t,e){this.listen(t,e)},e.prototype.addListenerTwo=function(t,e){this.listen(t,e)},e.prototype.addListenerThree=function(t,e){this.listen(t,e)},e.prototype.addListenerFour=function(t,e){this.listen(t,e)},e.prototype.addListenerFive=function(t,e){this.listen(t,e)},e.prototype.addOnceOne=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceTwo=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceThree=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceFour=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceFive=function(t,e){this.listenOnce(t,e)},e}(t("./ToSingleton").SingleTon());o.BaseSignal=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],StartGameCommond:[function(t,e,o){"use strict";cc._RF.push(e,"1db594KvoJIVbc+cwfogrGn","StartGameCommond"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){console.log("--------- excute StartGameCommond ---------")},e}(puremvc.SimpleCommand);o.StartGameCommond=n,cc._RF.pop()},{}],StepManager:[function(t,e,o){"use strict";cc._RF.push(e,"83709TvPtJOVayPDGaPh6Ov","StepManager");(function(){function t(){this.totalStep=[],this.curStep=[]}t.prototype.register=function(t,e){this.completeCallback=t,this.totalStep=e},t.prototype.nextStep=function(t){this.totalStep.indexOf(t)<0?console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",t):this.curStep.indexOf(t)>=0?console.warn(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",t):(this.curStep.push(t),this.curStep.sort(function(t,e){return t>e?-1:1}),this.totalStep.sort(function(t,e){return t>e?-1:1}),console.log(" cur step:",this.curStep.join(",")),console.log(" total step:",this.totalStep.join(",")),this.curStep.join(",")==this.totalStep.join(",")&&(console.log(" step done"),this.totalStep.length=0,this.completeCallback(),this.completeCallback=null))}})();cc._RF.pop()},{}],Time:[function(t,e,o){"use strict";cc._RF.push(e,"87a24xcV95AoII6L5W1ABoI","Time"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.timeFormat=function(t){var e=Math.floor(t/60),o=Math.floor(t%60),n="00";return o<10&&(n="0"+o),e+"/"+n},t}();o.Time=n,cc._RF.pop()},{}],ToSingleton:[function(t,e,o){"use strict";cc._RF.push(e,"b07299nlSpOIIxOkIMBhUY9","ToSingleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleTon=function(){return function(){function t(){}return Object.defineProperty(t,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),t}()},cc._RF.pop()},{}],UpdateController:[function(t,e,o){"use strict";cc._RF.push(e,"b3cadc9oLxMlaTWSqS0DgLW","UpdateController"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Utils/ToSingleton"),a=cc._decorator,i=a.ccclass,s=(a.property,function(t){function e(){var e=t.call(this)||this;return e.assetsManager=null,e.STORAGE_PATH=(window.jsb&&jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hot-update",e.MANIFEST_PAth="",e.isUpdating=!1,e.manifest=null,e.completeCallback=[],e.startCallback=[],e.errorCallback=[],e.progressCallback=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){window.jsb&&(this.assetsManager=new jsb.AssetsManager(this.MANIFEST_PAth,this.STORAGE_PATH,this.versionCompareHandle),this.assetsManager.setVerifyCallback(this.verifyCallback.bind(this)),cc.sys.os===cc.sys.OS_ANDROID&&this.assetsManager.setMaxConcurrentTask(2))},e.prototype.setManifest=function(t){this.manifest=t},e.prototype.getVersion=function(){return null==this.assetsManager?"":null==this.assetsManager.getLocalManifest()?"":this.assetsManager.getLocalManifest().getVersion()},e.prototype.addCompleteCallback=function(t,e){this.completeCallback.push({target:e,callback:t})},e.prototype.addErrorCallback=function(t,e){this.errorCallback.push({target:t,callback:e})},e.prototype.addStartCallback=function(t,e){this.startCallback.push({target:t,callback:e})},e.prototype.addProgressCallback=function(t,e){this.progressCallback.push({target:t,callback:e})},e.prototype.triggeError=function(t,e){void 0===e&&(e=!1),this.onError(t,e)},e.prototype.onError=function(t,e){void 0===e&&(e=!1),console.log(" this.errorCallback:",this.errorCallback.length,"error:",t);for(var o=0,n=this.errorCallback;o<n.length;o++){var a=n[o];a.callback.apply(a.target,[t,e])}},e.prototype.onComplete=function(t,e){void 0===e&&(e=!1),console.log(" on update complete:",this.getVersion()),console.log("storagePath:",this.getStoragePath()),console.log("search path:",this.getSearchPaths());for(var o=function(o){setTimeout(function(){o.callback.apply(o.target,[t,e])},0)},n=0,a=this.completeCallback;n<a.length;n++){o(a[n])}},e.prototype.getStoragePath=function(){return this.assetsManager?this.assetsManager.getStoragePath():""},e.prototype.getSearchPaths=function(){return window.jsb?jsb.fileUtils.getSearchPaths():""},e.prototype.onStart=function(t,e){void 0===e&&(e=!1),console.log(" this.startCallback:",this.startCallback.length);for(var o=0,n=this.startCallback;o<n.length;o++){var a=n[o];a.callback.apply(a.target,[t,e])}},e.prototype.onProgress=function(t,e){for(var o=0,n=this.progressCallback;o<n.length;o++){var a=n[o];a.callback.apply(a.target,[t,e])}},e.prototype.loadCustomManifest=function(t){if(null!=this.assetsManager&&this.assetsManager.getState()==jsb.AssetsManager.State.UNINITED){var e=new jsb.Manifest(t,this.STORAGE_PATH);this.assetsManager.loadLocalManifest(e,this.STORAGE_PATH)}},e.prototype.checkForUpdate=function(){if(null!=this.assetsManager){if(this.isUpdating)return"Version update is on process...";if(console.log(" start check for update ..."),this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var t=this.manifest.nativeUrl;console.log(" native url:",t),cc.loader.md5Pipe&&(t=cc.loader.md5Pipe.transformURL(t)),this.assetsManager.loadLocalManifest(t)}if(!this.assetsManager.getLocalManifest()||!this.assetsManager.getLocalManifest().isLoaded())return this.onError("Failed to load local manifest ..."),"Failed to load local manifest ...";this.assetsManager.setEventCallback(this.checkUpdateCallback.bind(this)),this.assetsManager.checkUpdate(),this.isUpdating=!0}else this.onComplete("no need to update.")},e.prototype.checkUpdateCallback=function(t){switch(console.log("checkUpdateCallback Code: "+t.getEventCode()),t.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:var e=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():" null",o=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null";this.onComplete("Already up to date with the latest remote version :"+e+", local version :"+o);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.isUpdating=!1;var n=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null",a=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():"null";if(console.log("New version found, old:",n,", new: ",a),"null"==n||"null"==a);else{console.log("storage path:",this.assetsManager.getStoragePath());var i=n.split(".")[0];a.split(".")[0]>i?this.onStart("new version found, go to store to download new app.",!0):(this.onStart("new version found, update process start.",!1),this.updateVersion())}break;default:return}},e.prototype.getUpdateDescription=function(){return""},e.prototype.updateVersion=function(){if(null!=this.assetsManager&&!this.isUpdating)if([jsb.AssetsManager.State.UPDATING,jsb.AssetsManager.State.UNZIPPING,jsb.AssetsManager.State.UP_TO_DATE].indexOf(this.assetsManager.getState())>=0)this.onComplete("no need to update: "+this.assetsManager.getState(),!1);else{if(this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var t=this.manifest.nativeUrl;cc.loader.md5Pipe&&(t=cc.loader.md5Pipe.transformURL(t)),this.assetsManager.loadLocalManifest(t)}this.assetsManager.setEventCallback(this.updateCallback.bind(this)),console.log(" start update ...:",this.assetsManager.getState()),this.assetsManager.update(),this.isUpdating=!0}},e.prototype.versionToInt=function(t){return parseInt(t.toString().split(".").join(""))},e.prototype.versionToString=function(t){return Math.floor(t/100)+"."+Math.floor(t/10)%10+"."+Math.floor(t)%10},e.prototype.updateCallback=function(t){var e=this,o=!1,n=!1,a=null;switch(console.log("update event code:",t.getEventCode()),t.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var i=t.getPercent();NaN!=i&&"number"==typeof i||(i=0),this.onProgress(t.getMessage()?"Updated file:"+t.getMessage():"Updating:"+(100*i).toFixed(0)+"%",i);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:a=function(){var t=e.assetsManager.getRemoteManifest()?e.assetsManager.getRemoteManifest().getVersion():" null";e.onComplete("Already up to date with the latest remote version :"+t)},n=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:a=function(){var o=e.assetsManager.getRemoteManifest()?e.assetsManager.getRemoteManifest().getVersion():" null";e.onComplete("Update finished. new : "+o+t.getMessage(),!0)},o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.onError("Update failed. "+t.getMessage(),!0);break;case jsb.EventAssetsManager.ERROR_UPDATING:this.onError("Asset update error: "+t.getAssetId()+", "+t.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.onError(t.getMessage())}if(n&&(this.assetsManager.setEventCallback(null),this.isUpdating=!1),o){this.assetsManager.setEventCallback(null);var s=jsb.fileUtils.getSearchPaths();console.log("old searchPaths:",s);var r=this.assetsManager.getLocalManifest().getSearchPaths();console.log("new path:",JSON.stringify(r));for(var c=0,l=r;c<l.length;c++){var p=l[c];s.indexOf(p)<0&&Array.prototype.unshift.apply(s,p)}cc.sys.localStorage.setItem("select-game",JSON.stringify(s)),jsb.fileUtils.setSearchPaths(s),console.log("new searchPaths:",JSON.stringify(s)),console.log(" paths storage:",cc.sys.localStorage.getItem("select-game"))}a&&a()},e.prototype.restart=function(){cc.audioEngine.stopAll(),cc.game.restart()},e.prototype.retry=function(){null!=this.assetsManager&&0==this.isUpdating&&this.assetsManager.downloadFailedAssets()},e.prototype.versionCompareHandle=function(t,e){cc.log("JS Custom Version Compare: version A is "+t+", version B is "+e);for(var o=t.split("."),n=e.split("."),a=0;a<o.length;++a){var i=parseInt(o[a]),s=parseInt(n[a]||"0");if(i!==s)return i-s}return n.length>o.length?-1:0},e.prototype.verifyCallback=function(t,e){var o=e.compressed,n=e.md5,a=e.path;e.size;return o?("Verification passed : "+a,!0):("Verification passed : "+a+" ("+n+")",!0)},e.prototype.destory=function(){this.assetsManager&&this.assetsManager.setEventCallback(null),this.startCallback=[],this.completeCallback=[],this.errorCallback=[],this.progressCallback=[]},e=__decorate([i],e)}(n.SingleTon()));o.default=s,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}]},{},["App","GameFactory","FacadeGlobal","InititalCommond","LoadAudioCommond","LoadPrefabCommond","StartGameCommond","InitialFacade","MainScene","AudioManager","StepManager","UpdateController","CelerSDK","FrameAniBase","HashMap","LogHandler","Random","Signal","Time","ToSingleton","BaseMediator","BaseView"]);