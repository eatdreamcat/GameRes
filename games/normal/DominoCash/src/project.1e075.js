window.__require=function e(t,o,i){function n(a,r){if(!o[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(s)return s(c,!0);throw new Error("Cannot find module '"+a+"'")}}var d=o[a]={exports:{}};t[a][0].call(d.exports,function(e){return n(t[a][1][e]||e)},d,d.exports,e,t,o,i)}return o[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<i.length;a++)n(i[a]);return n}({AICardRootMediator:[function(e,t,o){"use strict";cc._RF.push(t,"c4ada55MoZOXLMlauB7AaZA","AICardRootMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Model/DominoModel"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.DispatchAIDomino.inst.addListenerFour(this.onDispatchDomino,this),n.PlaceDominoDone.inst.addListener(this.onPlacedDone,this)},t.prototype.onPlacedDone=function(){this.View.updatePos()},t.prototype.onDispatchDomino=function(e,t,o,i){void 0===i&&(i=0),s.DominoModel.getDominoByID(t).setState(s.DominoState.Back),this.View.addDomino(e,t,o,i)},t.prototype.onUnregister=function(){},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel"}],AICardRootView:[function(e,t,o){"use strict";cc._RF.push(t,"2cb3dA6rJhNvJZr2QVIvF+K","AICardRootView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("../../../Utils/Cocos"),s=e("./AICardRootMediator"),a=e("../../Command/GamePlaySignal"),r=e("../../Model/DominoModel"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.childOffset=cc.v2(10,0),t}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=.7,this.BindMedaitor(s.default)},t.prototype.start=function(){},t.prototype.updatePos=function(){this.node.children.sort(function(e,t){return e.x-t.x});for(var e=0;e<this.node.childrenCount;e++){var t=this.getTargetPos(cc.v2(0,0),e+1,this.node.children[e].width,this.node.children[e].height);this.node.children[e].runAction(cc.moveTo(.1,t))}},t.prototype.getTargetPos=function(e,t,o,i){return t>7&&t<=14?(e.addSelf(this.childOffset.mul(t%8)),e.addSelf(cc.v2(o,0).mul(t%8+1)).addSelf(cc.v2(15,.3*i))):t<=7?(e.addSelf(this.childOffset.mul(t).addSelf(cc.v2(.2*o,.5*i))),e.addSelf(cc.v2(o,0).mul(t).addSelf(cc.v2(.3*o,0)))):(e.addSelf(this.childOffset.mul(t%15)),e.addSelf(cc.v2(o,0).mul(t%15)).addSelf(cc.v2(60,0))),e},t.prototype.addDomino=function(e,t,o,i){var s=this;void 0===i&&(i=0);var c=cc.v2(0,0);e.getParent()&&(c=n.ConvertToNodeSpaceAR(this.node,e.getParent()),c=this.getTargetPos(c,o,e.width,e.height)),e.zIndex=cc.macro.MAX_ZINDEX,e.runAction(cc.sequence(cc.delayTime(i),cc.spawn(cc.moveTo(.2,c),cc.scaleTo(.2,.7)),cc.callFunc(function(){e.scale=1;var o=cc.v2(0,0);o=s.getTargetPos(o,s.node.childrenCount+1,e.width,e.height),e.setParent(s.node),e.zIndex=s.node.childrenCount,e.setPosition(o),a.DispatchDoneSignal.inst.dispatchTwo(t,r.DominoOwner.AI)})))},t=__decorate([l],t)}(i.default));o.default=d,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./AICardRootMediator":"AICardRootMediator"}],AIController:[function(e,t,o){"use strict";cc._RF.push(t,"87a36JMbMhNRrLiR0Ptz4mB","AIController"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/ToSingleton"),n=e("../Facade/PlayerModelProxy"),s=e("../../Utils/Random"),a=e("../Command/GamePlaySignal"),r=e("../Model/DominoModel"),c=e("../View/DominoControl/DominoNodePool"),l=e("./GameStateController"),d=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.doPlace=function(){console.log("ai place");var e=n.PlayerModelProxy.inst.getAIDominos();if(n.PlayerModelProxy.inst.getDeskDominos().length<=0){console.log("\u9996\u6b21");for(var t="",o=0,i=0,c=e;i<c.length;i++){var l=c[i];l.isMirror()&&l.BotPoint>=o&&(o=l.BotPoint,t=l.ID)}return""==t&&(t=e[Math.floor(s.Random.getRandom()*e.length)].ID),console.log("Ai ready to place:",t,", target:","root"),(g=r.DominoModel.getDominoByID(t)).setState(r.DominoState.Front),void a.AISelectedDomino.inst.dispatchTwo(t,"root")}for(var d=[],h=[],u=0,p=e;u<p.length;u++){var g=p[u],f=n.PlayerModelProxy.inst.getCanConnectedDominos(g.ID);f.length>0&&(d.push(g.ID),h.push(f))}if(console.log("ai:",d,", target:",h),d.length>0&&h.length>0){var m=Math.floor(s.Random.getRandom(0,d.length)),D=d[m],y=h[m],M=y[Math.floor(s.Random.getRandom(0,y.length))];console.log("Ai ready to place:",D,", target:",M),(g=r.DominoModel.getDominoByID(D)).setState(r.DominoState.Front),a.AISelectedDomino.inst.dispatchTwo(D,M)}else console.warn("\u6ca1\u6709\u53ef\u4ee5\u653e\u7f6e\u7684\u724c"),a.SkipActionThisTurn.inst.dispatchOne(n.PlayerModelProxy.inst.Turn),a.ActionDoneThisTurn.inst.dispatchOne(-1)},t.prototype.doDraw=function(){console.log("ai draw");var e=n.PlayerModelProxy.inst.getStackDominos();if(e.length>0){var t=e[Math.floor(s.Random.getRandom(0,e.length))].ID,o=c.default.getDomino(t);a.DispatchAIDomino.inst.dispatchFour(o,t,n.PlayerModelProxy.inst.getAIDominos().length,.2),n.PlayerModelProxy.inst.drawDomino(t,r.DominoOwner.AI)}else console.warn("\u6ca1\u6709\u724c\u53ef\u4ee5\u62bd")},t.prototype.placeDomino=function(){n.PlayerModelProxy.inst.gameOver()?console.log(" AI place, game over"):l.GameStateController.inst.isPause()?l.GameStateController.inst.addResumeCallback(function(){setTimeout(function(){t.inst.doPlace()},500+s.Random.getRandom(0,1e3))}):this.doPlace()},t.prototype.drawDomino=function(){var e=this;n.PlayerModelProxy.inst.gameOver()?console.log(" AI draw, game over"):l.GameStateController.inst.isPause()?l.GameStateController.inst.addResumeCallback(function(){setTimeout(function(){e.doDraw()},200)}):this.doDraw()},t}(i.SingleTon());o.AIController=d,cc._RF.pop()},{"../../Utils/Random":"Random","../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal","../Facade/PlayerModelProxy":"PlayerModelProxy","../Model/DominoModel":"DominoModel","../View/DominoControl/DominoNodePool":"DominoNodePool","./GameStateController":"GameStateController"}],App:[function(e,t,o){"use strict";cc._RF.push(t,"eaeeaWDD5pJfqkUameEwNsk","App"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Initialization/Facade/InitialFacade"),n=e("../GamePlay/Controller/ResourceController"),s=e("../GamePlay/Facade/PlayerModelProxy"),a=cc._decorator,r=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameUIAtlas=null,t.MatchNumberAltas=null,t.MatchPointAltas1=null,t.MatchPointAltas2=null,t.MatchPointAltas3=null,t.MatchPointAltas4=null,t.MatchPointAltas5=null,t.MatchPointAltas6=null,t.MatchPointAltas7=null,t.FontAtlas=null,t.Red=null,t.Gold=null,t}return __extends(t,e),t.prototype.onLoad=function(){console.log(" app onload "),n.ResourceController.inst.setAtlas(this.GameUIAtlas),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Number[1],this.MatchNumberAltas),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[1],this.MatchPointAltas1),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[2],this.MatchPointAltas2),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[3],this.MatchPointAltas3),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[4],this.MatchPointAltas4),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[5],this.MatchPointAltas5),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[6],this.MatchPointAltas6),n.ResourceController.inst.addMatchAtlas(n.MatchAtlas.Sweet[7],this.MatchPointAltas7),n.ResourceController.inst.setFontAtlas(this.FontAtlas),n.ResourceController.inst.setFont(n.ScoreFont.Gold,this.Gold),n.ResourceController.inst.setFont(n.ScoreFont.Red,this.Red)},t.prototype.start=function(){i.InitialFacade.inst.start()},t.prototype.update=function(e){s.PlayerModelProxy.inst.addGameTime(-e)},__decorate([c(cc.SpriteAtlas)],t.prototype,"GameUIAtlas",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchNumberAltas",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas1",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas2",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas3",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas4",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas5",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas6",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"MatchPointAltas7",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"FontAtlas",void 0),__decorate([c(cc.Font)],t.prototype,"Red",void 0),__decorate([c(cc.Font)],t.prototype,"Gold",void 0),t=__decorate([r],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../GamePlay/Controller/ResourceController":"ResourceController","../GamePlay/Facade/PlayerModelProxy":"PlayerModelProxy","../Initialization/Facade/InitialFacade":"InitialFacade"}],AudioManager:[function(e,t,o){"use strict";cc._RF.push(t,"88c70Ktw0pBKKUTDtyQ2NkZ","AudioManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Utils/HashMap"),n=e("../GamePlay/Command/GamePlaySignal"),s=e("../GamePlay/Controller/GameStateController"),a=e("../GamePlay/Model/GameRule");window.oncanplay&&(window.oncanplay=function(){c.canPlay=!0});var r="sounds/",c=function(){function e(){this.audioID={},this.clips=new i.HashMap,this.effectVolumeScale=1.5,this.musicVolumeScale=1.5}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;console.warn(" start load AudioClip ");var o=this;cc.loader.loadRes(r+"bgm",cc.AudioClip,function(t,i){t?console.error(t):(o.clips.add(i.name,i),e&&e(),o.playMusic("bgm",!0))}),cc.loader.loadRes(r+"bgm_30",function(e,t){e?console.error(e):o.clips.add(t.name,t)}),cc.loader.loadResDir(r,function(e,o,i){if(e)console.error(e);else for(var n=0,s=o;n<s.length;n++){var a=s[n];t.clips.has(a.name)||t.clips.add(a.name,a)}}),this.bindSignal()},e.prototype.setEffectVolume=function(e){cc.audioEngine.setEffectsVolume(e*this.effectVolumeScale)},e.prototype.setMusicVolume=function(e){cc.audioEngine.setMusicVolume(e*this.musicVolumeScale)},Object.defineProperty(e.prototype,"EffectVolume",{get:function(){return cc.audioEngine.getEffectsVolume()/this.effectVolumeScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MusicVolume",{get:function(){return cc.audioEngine.getMusicVolume()/this.musicVolumeScale},enumerable:!0,configurable:!0}),e.prototype.bindSignal=function(){var e=this;this.setEffectVolume(1),this.setMusicVolume(1),n.UpdateTimeNumber.inst.addListenerOne(function(t){if(t>=30){if(cc.audioEngine.getState(e.audioID.bgm)==cc.audioEngine.AudioState.PLAYING)return;e.playMusic("bgm",!0)}else{if(cc.audioEngine.getState(e.audioID.bgm_30)==cc.audioEngine.AudioState.PLAYING)return;e.playMusic("bgm_30",!0)}},this),n.ReadyDispatchDominoSignal.inst.addListener(function(){e.playEffect("roundStart")},this),n.PlaceDominoDone.inst.addListener(function(){e.playEffect("place_card")},this),n.PlayMatchAnimation.inst.addListener(function(){e.playEffect("match")},this),n.SkipActionThisTurn.inst.addListener(function(){e.playEffect("pass")},this),n.PlayerReleasedDomino.inst.addListenerTwo(function(t,o){o&&e.playEffect("cancel")},this),n.PlayerSelectedDomino.inst.addListener(function(){e.playEffect("touchcard")},this),n.OpenDominoBagEffectSignal.inst.addListener(function(){e.playEffect("open_bag")},this),n.RoundStartSignal.inst.addListener(function(){},this),n.RoundEndSignal.inst.addListenerOne(function(t){s.GameOverType.indexOf(t)>=0||e.playEffect("roundEnd")},this),n.ScoreCountingSignal.inst.addListener(function(){e.audioID.scoreCount||e.playEffect("scoreCount",!1,function(){e.audioID.scoreCount=null})},this),n.ShowSubmitSignal.inst.addListener(function(){e.audioID.scoreCount&&cc.audioEngine.stopEffect(e.audioID.scoreCount),e.playEffect("showSubmit")},this),n.OpenResultLayerSignal.inst.addListenerOne(function(t){t==s.RoundEndType.TimeUp?e.playEffect("timeup"):e.playEffect("complete")},this),n.PlaySpineSignal.inst.addListener(function(){e.playEffect("spine")},this),n.DrawCardSignal.inst.addListener(function(){e.playEffect("drawCard")},this),n.AddScoreSignal.inst.addListenerTwo(function(t,o){if(t==a.Turn.Player||t==a.Turn.AI)switch(o){case 1:if(e.audioID.getScore)return;e.playEffect("getScore",!1,function(){e.audioID.getScore=null});break;case 2:if(e.audioID.doubleScore)return;e.playEffect("doubleScore",!1,function(){e.audioID.doubleScore=null});break;case 3:if(e.audioID.thribleScore)return;e.playEffect("thribleScore",!1,function(){e.audioID.thribleScore=null})}},this),n.GamePauseSignal.inst.addListener(function(){e.playEffect("pause")},this),n.ButtonClickSignal.inst.addListener(function(){e.playEffect("pause")},this),n.CountDownSignal.inst.addListener(function(){e.playEffect("countDown")},this)},e.prototype.playEffect=function(t,o,i){var n=this;if(void 0===o&&(o=!1),e.canPlay){if(!(cc.audioEngine.getEffectsVolume()<=.05)){var s=this.clips.get(t);s?(this.audioID[t]=cc.audioEngine.playEffect(s,o),cc.audioEngine.setFinishCallback(this.audioID[t],function(){i&&i()})):cc.loader.loadRes(r+t,cc.AudioClip,function(e,s){e?console.error(e):(n.clips.add(s.name,s),n.audioID[t]=cc.audioEngine.playEffect(s,o),cc.audioEngine.setFinishCallback(n.audioID[t],function(){i&&i()}))})}}else this.bindTouch()},e.prototype.playMusic=function(t,o){var i=this;if(void 0===o&&(o=!0),!e.canPlay)return this.bindTouch(),void e.PlayedList.push({loop:!0,volume:1,clipName:t,supTime:Date.now(),skip:!1,isBgm:!0});var n=this.clips.get(t);n?this.audioID[t]=cc.audioEngine.playMusic(n,o):cc.loader.loadRes(r+t,cc.AudioClip,function(e,n){e?console.error(e):("string"==typeof n._audio&&cc.loader._cache&&cc.loader._cache[n._audio]&&cc.loader._cache[n._audio].buffer&&(n._audio=cc.loader._cache[n._audio].buffer),i.clips.add(n.name,n),i.audioID[t]=cc.audioEngine.playMusic(n,o))})},e.prototype.bindTouch=function(){if(!e.hasBindTouch){var t=this,o=function(){var i;for(cc.game.canvas.removeEventListener("touchstart",o),e.canPlay=!0;(i=e.PlayedList.pop())&&t.clips.get(i.clipName)&&!i.skip;)cc.audioEngine.playMusic(t.clips.get(i.clipName),i.loop)};e.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",o)}},e.PlayedList=[],e.canPlay=cc.sys.WIN32==cc.sys.platform,e.hasBindTouch=!1,e}();o.gAudio=c.inst,cc._RF.pop()},{"../GamePlay/Command/GamePlaySignal":"GamePlaySignal","../GamePlay/Controller/GameStateController":"GameStateController","../GamePlay/Model/GameRule":"GameRule","../Utils/HashMap":"HashMap"}],BagOpenAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"23680h8HXFHR6QL3t6I2XCH","BagOpenAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../../Utils/FrameAniBase"),n=e("../../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.opacity=0,n.OpenDominoBagSignal.inst.addListener(this.openBag,this)},t.prototype.openBag=function(){this.node.opacity=255,this.play()},t.prototype.onComplete=function(){this.node.runAction(cc.fadeOut(.2))},t.aniName="BagOpenAnimation",t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../../Utils/FrameAniBase":"FrameAniBase","../../../Command/GamePlaySignal":"GamePlaySignal"}],BaseMediator:[function(e,t,o){"use strict";cc._RF.push(t,"a76c1ySm3tAQId4zbAsdr/d","BaseMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){console.error(" should override onRegister ")},t.prototype.onUnregister=function(){console.error(" should override onUnregister ")},t=__decorate([n],t)}(cc.Component));o.default=s,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"6daedF7tVNJ3qN565kuohVZ","BaseView"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=0},t.prototype.Show=function(e){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()})))},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.active=!1,e&&e()})))},t.prototype.OnClick=function(){},t.prototype.BindMedaitor=function(e){if(!this.node.getComponent(e)){var t=this.node.addComponent(e);return t.bind&&t.bind(this),t.onRegister&&t.onRegister(),t}console.warn(" this node already has the same component..")},t.prototype.UnbindMedaitor=function(e){var t=this.node.getComponent(e);if(t)return t.onUnregister&&t.onUnregister(),t.bind&&t.bind(null),this.node.removeComponent(e),t;console.warn(" component already removed..")},t=__decorate([n],t)}(cc.Component));o.default=s,cc._RF.pop()},{}],BlingAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"c37c8OiuC9Mm5Hid6ace6P2","BlingAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../Animation/MatchAnimation"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../../Animation/MatchAnimation":"MatchAnimation"}],BoneyardView:[function(e,t,o){"use strict";cc._RF.push(t,"b154euTdL5OGYwXKvvOY1je","BoneyardView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./NumberChangedView"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.BoneyardCountChanged.inst.addListenerOne(this.onNumberChanged,this)},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal","./NumberChangedView":"NumberChangedView"}],BottomLightView:[function(e,t,o){"use strict";cc._RF.push(t,"88825tsQwtLJ6rY2ihd3GCu","BottomLightView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("../../Command/GamePlaySignal"),s=e("../../Model/GameRule"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.PlayTurnChanged.inst.addListenerOne(this.onTurnChanged,this),this.node.opacity=255,this.node.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(1,100),cc.fadeTo(.5,255))))},t.prototype.onTurnChanged=function(e){if(e==s.Turn.Player){if(this.node.opacity>0)return;this.node.stopAllActions(),this.node.opacity=255,this.node.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.5,100),cc.fadeTo(1,255))))}else this.node.stopAllActions(),this.node.opacity=0},t.prototype.start=function(){},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GameRule":"GameRule"}],CardBagView:[function(e,t,o){"use strict";cc._RF.push(t,"88a63Q6wgZO+oBZDp1W3w5V","CardBagView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.scale=1,n.BoneyardCountChanged.inst.addListenerOne(function(){e.node.stopAllActions(),e.node.runAction(cc.sequence(cc.scaleTo(.05,1.2),cc.scaleTo(.05,1)))},this),n.OpenDominoBagSignal.inst.addListener(this.onBagOpen,this),n.CloseDominoBagSignal.inst.addListener(this.onBagClose,this)},t.prototype.onBagOpen=function(){this.node.runAction(cc.sequence(cc.delayTime(.3),cc.fadeOut(.2)))},t.prototype.onBagClose=function(){this.node.runAction(cc.sequence(cc.delayTime(.3),cc.fadeIn(.2)))},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal"}],CardDrawRootMediator:[function(e,t,o){"use strict";cc._RF.push(t,"fad0fFFWGBMpYnfZ9Ni9q3J","CardDrawRootMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Model/DominoModel"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.DispatchStackDomino.inst.addListenerFour(this.onAddDomino,this),n.OpenDominoBagSignal.inst.addListenerOne(this.openBag,this),n.CloseDominoBagSignal.inst.addListener(this.closeBag,this)},t.prototype.closeBag=function(){this.View.closeBag(function(){})},t.prototype.openBag=function(e){this.View.openBag(e)},t.prototype.onAddDomino=function(e,t,o,i){void 0===i&&(i=0);s.DominoModel.getDominoByID(t);this.View.addDomino(e,t,o,i)},t.prototype.onUnregister=function(){},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel"}],CardDrawRootView:[function(e,t,o){"use strict";cc._RF.push(t,"03d56Urg/VFFrfQp6Xd0sWN","CardDrawRootView"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../../View/BaseView"),s=e("./CardDrawRootMediator"),a=e("../../../Utils/Cocos"),r=e("../../Command/GamePlaySignal"),c=e("../../Model/DominoModel"),l=e("../../Facade/PlayerModelProxy"),d=e("../../Model/GameRule"),h=cc._decorator,u=h.ccclass;h.property;(function(e){e[e.Open=0]="Open",e[e.Close=1]="Close"})(i||(i={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.childOffset=cc.v2(-20,0),t.bagClosePos=cc.v2(177,535),t.bagOpenPos=cc.v2(0,239),t.state=i.Close,t.closeTimeout=-1,t}return __extends(t,e),Object.defineProperty(t.prototype,"CardRoot",{get:function(){return this.node.getChildByName("CardRoot")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Light",{get:function(){return this.node.getChildByName("Light")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.scale=0,this.BindMedaitor(s.default),this.node.active=!1,this.node.setPosition(this.bagClosePos)},t.prototype.start=function(){},t.prototype.closeBag=function(e){var t=this;if(this.state==i.Close)return this.node.setPosition(this.bagClosePos),this.node.scaleX=0,void e();console.log("close bag"),this.node.runAction(cc.sequence(cc.delayTime(.4),cc.scaleTo(.2,0,1),cc.moveTo(0,this.bagClosePos),cc.callFunc(function(){}))),this.closeTimeout=setTimeout(function(){t.state=i.Close,e(),t.node.setPosition(t.bagClosePos),t.node.active=!1,t.node.scaleX=0},600)},t.prototype.openBag=function(e){var t=this;this.state!=i.Open?(r.OpenDominoBagEffectSignal.inst.dispatch(),this.Light.active=l.PlayerModelProxy.inst.Turn==d.Turn.Player,this.Light.active&&(this.Light.stopAllActions(),this.Light.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.5,100),cc.fadeTo(1,255))))),console.log("open bag"),-1!=this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=-1,this.node.scaleX=0),this.node.stopAllActions(),this.node.active=!0,this.node.runAction(cc.sequence(cc.delayTime(.3),cc.moveTo(0,this.bagOpenPos),cc.scaleTo(.1,1.2,1),cc.scaleTo(.1,1,1),cc.callFunc(function(){}))),setTimeout(function(){t.state=i.Open,e()},500)):e()},t.prototype.addDomino=function(e,t,o,i){var n=this;void 0===i&&(i=0);var s=cc.v2(0,0);e.getParent()&&(s=a.ConvertToNodeSpaceAR(this.CardRoot,e.getParent()));var l=cc.v2(-this.node.width/2,0);l.addSelf(this.childOffset.mul((o-1)%7+1)),l.addSelf(cc.v2(e.width,0).mul((o-1)%7).add(cc.v2(.75*e.width,0))),o-1>=7&&l.addSelf(cc.v2(0,.6*e.height+20)),l.addSelf(cc.v2(15,-55)),e.runAction(cc.sequence(cc.delayTime(i),cc.spawn(cc.moveTo(.2,s),cc.scaleTo(.2,.6)),cc.callFunc(function(){e.setParent(n.CardRoot),e.setPosition(l),r.BoneyardCountChanged.inst.dispatchOne(o),r.DispatchDoneSignal.inst.dispatchTwo(t,c.DominoOwner.Stack)})))},t=__decorate([u],t)}(n.default);o.default=p,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DominoModel":"DominoModel","../../Model/GameRule":"GameRule","./CardDrawRootMediator":"CardDrawRootMediator"}],CelerSDK:[function(e,t,o){"use strict";cc._RF.push(t,"34a72Ol/DRKJb0NyonTxi8g","CelerSDK"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../ToSingleton"),n=e("../LogHandler"),s=e("../Random"),a=e("../../GamePlay/Facade/PlayerModelProxy"),r=e("../../GamePlay/Command/GamePlaySignal"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alreadySubmit=!1,t.isNewPlayer=!0,t.celerStartCallback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"MatchID",{get:function(){return this.match.matchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MatchRandomSeed",{get:function(){return this.match.sharedRandomSeed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DifficultyLevel",{get:function(){return this.match.difficultyLevel},enumerable:!0,configurable:!0}),t.prototype.init=function(e){this.alreadySubmit=!1,CELER_X&&celerSDK.onStart(this.onCelerStart.bind(this)),CELER_X&&celerSDK.provideScore(function(){return a.PlayerModelProxy.inst.getTotalScore()}),this.celerStartCallback=e,n.LogHandler.inst.ready(),CELER_X?n.LogHandler.inst.initLog(celerSDK.log):console.log("v 1.5")},t.prototype.celerXReady=function(){console.log(" invoke celerx.ready() "),CELER_X?celerSDK.ready():this.onCelerStart()},t.prototype.isNew=function(){return this.isNewPlayer},t.prototype.isOnCelerPlatform=function(){return CELER_X},t.prototype.onCelerStart=function(){console.log(" celerx onStart call"),this.match=CELER_X?celerSDK.getMatch():{matchId:"error : can not get id",shouldLaunchTutorial:Math.random()>.3,sharedRandomSeed:Math.random(),difficultyLevel:0},console.log("match id:",this.match.matchId,", seed:",this.match.sharedRandomSeed),s.Random.setRandomSeed(this.match.sharedRandomSeed),a.PlayerModelProxy.inst.Level=this.match.difficultyLevel,this.match&&this.match.shouldLaunchTutorial?this.isNewPlayer=!0:this.isNewPlayer=!1,CELER_X?(celerSDK.onPause(function(){console.log(" on pause "),r.ShowPauseLayerSignal.inst.dispatch()}),celerSDK.onResume(function(){console.log(" on resume ")})):(cc.game.on(cc.game.EVENT_HIDE,function(){console.log(" on pause "),r.ShowPauseLayerSignal.inst.dispatch()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log(" on resume ")})),this.celerStartCallback&&(this.celerStartCallback(),this.celerStartCallback=null)},t.prototype.submitScore=function(e){this.alreadySubmit||(this.alreadySubmit=!0,console.log(" submit score:",e,", match id:",this.match.matchId),CELER_X?celerSDK.submitScore(e):window.location.reload())},t}(i.SingleTon());o.CelerSDK=c,cc._RF.pop()},{"../../GamePlay/Command/GamePlaySignal":"GamePlaySignal","../../GamePlay/Facade/PlayerModelProxy":"PlayerModelProxy","../LogHandler":"LogHandler","../Random":"Random","../ToSingleton":"ToSingleton"}],ChildBotParentBot:[function(e,t,o){"use strict";cc._RF.push(t,"cee5aytv+ZMapnYbSpVMo03","ChildBotParentBot"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildBot(s.DominoPointPos.Bottom,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildBotParentBot] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildBotParentBot] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Top(e,t,!1,c,!1,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Bottom(e,t,!0,c,!1,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Left(e,t,!0,c,!1,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Right(e,t,!1,c,!1,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),t.BotFree=!1,0==t.Rotation?(e.Rotation=180,e.x=t.x,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Bot,o)):180==t.Rotation?(e.Rotation=0,e.x=t.x,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Top,o)):90==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o)):(e.Rotation=90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o))},e}();o.ChildBotParentBot=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildBotParentMid:[function(e,t,o){"use strict";cc._RF.push(t,"9b0caVE6u1Byrj4tC3r3WAd","ChildBotParentMid"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildBot(s.DominoPointPos.Mid,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildBotParentMid] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildBotParentMid] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Top(e,t,!1,c,!0,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Bottom(e,t,!0,c,!0,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Left(e,t,!0,c,!0,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Right(e,t,!1,c,!0,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),0==t.Rotation||180==t.Rotation?t.RightFree?(0==t.Rotation?(e.Rotation=90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.width/2+i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=-90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.width/2-i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Left,o)),t.RightFree=!1,e.BotFree=!1):t.LeftFree?(180==t.Rotation?(e.Rotation=90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.width/2+i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=-90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.width/2-i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Left,o)),t.LeftFree=!1,e.BotFree=!1):t.BotFree?(0==t.Rotation?(e.Rotation=180,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)):(e.Rotation=0,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)),t.BotFree=!1,e.BotFree=!1):t.TopFree&&(180==t.Rotation?(e.Rotation=180,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)):(e.Rotation=0,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)),t.TopFree=!1):90!=t.Rotation&&-90!=t.Rotation||(t.LeftFree?(90==t.Rotation?(e.Rotation=0,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)):(e.Rotation=180,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)),t.LeftFree=!1):t.RightFree?(-90==t.Rotation?(e.Rotation=0,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)):(e.Rotation=180,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)),t.RightFree=!1):t.TopFree?(-90==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o)):(e.Rotation=90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o)),t.TopFree=!1):t.BotFree&&(90==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o)):(e.Rotation=90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o)),t.BotFree=!1))},e}();o.ChildBotParentMid=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildBotParentTop:[function(e,t,o){"use strict";cc._RF.push(t,"96beb9/AJVMYqw/C9/Bw9Sh","ChildBotParentTop"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildBot(s.DominoPointPos.Top,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildBotParentTop] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildBotParentTop] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Top(e,t,!1,c,!1,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Bottom(e,t,!0,c,!1,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Left(e,t,!0,c,!1,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Right(e,t,!1,c,!1,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),t.TopFree=!1,0==t.Rotation?(e.Rotation=0,e.x=t.x,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,e.BotFree=!1,this.CheckDirection(e,t,i.PadPos.Top,o)):180==t.Rotation?(e.Rotation=180,e.x=t.x,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,e.BotFree=!1,this.CheckDirection(e,t,i.PadPos.Bot,o)):90==t.Rotation?(e.Rotation=90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,e.BotFree=!1,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=-90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o))},e}();o.ChildBotParentTop=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildMidParentBot:[function(e,t,o){"use strict";cc._RF.push(t,"6e710Zb0OlMq557jS8Z1557","ChildMidParentBot"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildMid(s.DominoPointPos.Bottom,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildMidParentBot] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildMidParentBot] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Mirror_Horizontal_To_Vertical_Pos_Top(e,t,c,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Mirror_Horizontal_To_Vertical_Pos_Bottom(e,t,c,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Mirror_Vertical_To_Horizontal_Pos_Left(e,t,c,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Mirror_Vertical_To_Horizontal_Pos_Right(e,t,c,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),t.BotFree=!1,0==t.Rotation?(e.Rotation=-90,e.x=t.x,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Bot,o)):180==t.Rotation?(e.Rotation=90,e.x=t.x,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Top,o)):90==t.Rotation?(e.Rotation=0,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Left,o)):(e.Rotation=180,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Right,o))},e}();o.ChildMidParentBot=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildMidParentTop:[function(e,t,o){"use strict";cc._RF.push(t,"b7d8cmm3CtPpKBhOjLxRKlh","ChildMidParentTop"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildMid(s.DominoPointPos.Top,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildMidParentTop] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildMidParentTop] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Mirror_Horizontal_To_Vertical_Pos_Top(e,t,c,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Mirror_Horizontal_To_Vertical_Pos_Bottom(e,t,c,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Mirror_Vertical_To_Horizontal_Pos_Left(e,t,c,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Mirror_Vertical_To_Horizontal_Pos_Right(e,t,c,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),t.TopFree=!1,0==t.Rotation?(e.Rotation=-90,e.x=t.x,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Top,o)):180==t.Rotation?(e.Rotation=90,e.x=t.x,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Bot,o)):90==t.Rotation?(e.Rotation=0,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=180,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,this.CheckDirection(e,t,i.PadPos.Left,o))},e}();o.ChildMidParentTop=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildTopParentBot:[function(e,t,o){"use strict";cc._RF.push(t,"86bf41zo1lIHogjFVOa1Z31","ChildTopParentBot"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildTop(s.DominoPointPos.Bottom,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildTopParentBot] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildTopParentBot] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Top(e,t,!0,c,!1,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Bottom(e,t,!1,c,!1,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Left(e,t,!1,c,!1,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Right(e,t,!0,c,!1,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),t.BotFree=!1,0==t.Rotation?(e.Rotation=0,e.x=t.x,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Bot,o)):180==t.Rotation?(e.Rotation=180,e.x=t.x,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Top,o)):90==t.Rotation?(e.Rotation=90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o)):(e.Rotation=-90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o))},e}();o.ChildTopParentBot=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildTopParentMid:[function(e,t,o){"use strict";cc._RF.push(t,"aece7JicT5IAKn5k52xT4sv","ChildTopParentMid"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildTop(s.DominoPointPos.Mid,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildTopParentMid] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildTopParentMid] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Top(e,t,!0,c,!0,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Bottom(e,t,!1,c,!0,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Left(e,t,!1,c,!0,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Right(e,t,!0,c,!0,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),0==t.Rotation||180==t.Rotation?t.RightFree?(0==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.width/2+i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.width/2-i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Left,o)),t.RightFree=!1):t.LeftFree?(180==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.width/2+i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.width/2-i.DeskCheckModel.DOMINO_SIZE.height/2,this.CheckDirection(e,t,i.PadPos.Left,o)),t.LeftFree=!1):t.BotFree?(0==t.Rotation?(e.Rotation=0,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)):(e.Rotation=180,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)),t.BotFree=!1):t.TopFree&&(180==t.Rotation?(e.Rotation=0,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)):(e.Rotation=180,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)),t.TopFree=!1):90!=t.Rotation&&-90!=t.Rotation||(t.LeftFree?(90==t.Rotation?(e.Rotation=180,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)):(e.Rotation=0,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)),t.LeftFree=!1):t.RightFree?(-90==t.Rotation?(e.Rotation=180,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height/2+i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Top,o)):(e.Rotation=0,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height/2-i.DeskCheckModel.DOMINO_SIZE.width/2,e.x=t.x,this.CheckDirection(e,t,i.PadPos.Bot,o)),t.RightFree=!1):t.TopFree?(90==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o)),t.TopFree=!1):t.BotFree&&(-90==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o)),t.BotFree=!1))},e}();o.ChildTopParentMid=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],ChildTopParentTop:[function(e,t,o){"use strict";cc._RF.push(t,"13865LjImdCnISOei0dP/5V","ChildTopParentTop"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../DeskCheckModel"),n=e("../DominoTransform"),s=e("../../DominoModel"),a=function(){function e(){}return e.CheckDirection=function(e,t,o,a){void 0===a&&(a=[]);var r=i.DeskCheckModel.CheckChildTop(s.DominoPointPos.Top,t,s.DominoModel.getDominoByID(e.DominoID)),c=n.Direction.AnticlockWise,l=!1,d=!1;switch(r?(r.directions.length>0?1==r.directions.length&&(c=r.directions[0]):console.warn("[ChildTopParentTop] directions is null."),l=r.forceRotate,d=r.forceStatic):console.warn("[ChildTopParentTop] directionInfo is null."),o){case i.PadPos.Top:d?n.DominoTransform.Pos_Top(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Top(e,t,!0,c,!1,l);break;case i.PadPos.Bot:d?n.DominoTransform.Pos_Bot(e,t):n.DominoTransform.Vertical_To_Horizontal_Pos_Bottom(e,t,!1,c,!1,l);break;case i.PadPos.Left:d?n.DominoTransform.Pos_Left(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Left(e,t,!1,c,!1,l);break;case i.PadPos.Right:d?n.DominoTransform.Pos_Right(e,t):n.DominoTransform.Horizontal_To_Vertical_Pos_Right(e,t,!0,c,!1,l)}},e.Check=function(e,t,o){void 0===o&&(o=[]),t.TopFree=!1,0==t.Rotation?(e.Rotation=180,e.x=t.x,e.y=t.y+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Top,o)):180==t.Rotation?(e.Rotation=0,e.x=t.x,e.y=t.y-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Bot,o)):90==t.Rotation?(e.Rotation=-90,e.y=t.y,e.x=t.x+i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Right,o)):(e.Rotation=90,e.y=t.y,e.x=t.x-i.DeskCheckModel.DOMINO_SIZE.height,this.CheckDirection(e,t,i.PadPos.Left,o))},e}();o.ChildTopParentTop=a,cc._RF.pop()},{"../../DeskCheckModel":"DeskCheckModel","../../DominoModel":"DominoModel","../DominoTransform":"DominoTransform"}],Cocos:[function(e,t,o){"use strict";function i(e){return e&&e.getParent&&e.getParent()?e.getParent().convertToWorldSpaceAR(e.position):cc.v2(0,0)}cc._RF.push(t,"31c37gkdPVLCIrqcCKdauwi","Cocos"),Object.defineProperty(o,"__esModule",{value:!0}),o.GetWorldPosition=i,o.ConvertToNodeSpaceAR=function(e,t){if(!t)return cc.v2(0,0);var o=i(e);return t.convertToNodeSpaceAR(o)},o.Distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},cc._RF.pop()},{}],DeskCheckModel:[function(e,t,o){"use strict";cc._RF.push(t,"87d5fSBFhRG7rI1Y8XroIHd","DeskCheckModel"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./DeskNodeModel"),n=e("../Command/GamePlaySignal"),s=e("../Facade/PlayerModelProxy"),a=e("./DominoModel"),r=e("../../Global/Desk"),c=e("./DominoMatch/ChildBot/ChildBotParentBot"),l=e("./DominoMatch/ChildBot/ChildBotParentMId"),d=e("./DominoMatch/ChildBot/ChildBotParentTop"),h=e("./DominoMatch/ChildTop/ChildTopParentBot"),u=e("./DominoMatch/ChildTop/ChildTopParentMid"),p=e("./DominoMatch/ChildTop/ChildTopParentTop"),g=e("./DominoMatch/ChildMid/ChildMidParentBot"),f=e("./DominoMatch/ChildMid/ChildMidParentTop"),m=e("./DominoMatch/DominoTransform"),D=(e("../../Factory/GameFactory"),e("../../Utils/HashMap"));e("./GameRule");function y(e,t){e.contains(t)&&(e.width=Math.min(e.width,Math.max(t.x-e.x,0)))}function M(e,t){if(e.contains(t)){var o=Math.min(e.width,Math.max(e.width-Math.abs(e.x-t.x),0));e.x+=e.width-o,e.width=e.width}}function P(e,t){e.contains(t)&&(e.height=Math.min(e.height,Math.max(0,t.y-e.y)))}function k(e,t){if(e.contains(t)){var o=Math.min(e.height,Math.max(0,e.height-Math.abs(e.y-t.y)));e.y+=e.height-o,e.height=o}}(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bot=3]="Bot"})(o.PadPos||(o.PadPos={}));var C=function(){return function(){this.directions=[],this.forceRotate=!1,this.forceStatic=!1,this.isAllBlock=!1}}();o.DirectionInfo=C;var S=function(){function e(){}return Object.defineProperty(e,"Padding",{get:function(){return this.pading},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Top",{set:function(e){this.pading.top=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Bot",{set:function(e){this.pading.bot=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Left",{set:function(e){this.pading.left=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Right",{set:function(e){this.pading.right=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Position",{set:function(e){this.pading.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"x",{get:function(){return this.pading.position.x},set:function(e){this.pading.position.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"y",{get:function(){return this.pading.position.y},set:function(e){this.pading.position.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RootScale",{get:function(){return this.scale},set:function(e){this.scale!=e&&(this.scale=e,n.DeskRootScale.inst.dispatchOne(this.scale))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Width",{get:function(){return this.pading.left+this.pading.right},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Height",{get:function(){return this.pading.bot+this.pading.top},enumerable:!0,configurable:!0}),e.resetPading=function(){this.pading={top:0,bot:0,left:0,right:0,position:cc.v2(0,0)},this.dominoCount.bot=0,this.dominoCount.top=0,this.dominoCount.left=0,this.dominoCount.right=0,n.DeskRootPadingChanged.inst.dispatchOne(this.pading.position)},e.CheckCanPlace=function(e,t){var o=a.DominoModel.getDominoByID(e),n=a.DominoModel.getDominoByID(t),s=a.DominoModel.getConnectedVal(e,t),r=i.DeskNodeModel.getDeskNodeByDominoID(t),c=o.getValPos(s),l=n.getValPos(s);switch(c){case a.DominoPointPos.Bottom:var d=this.CheckChildBot(l,r,o);return d&&d.directions.length>0;case a.DominoPointPos.Mid:var h=this.CheckChildMid(l,r,o);return h&&h.directions.length>0;case a.DominoPointPos.Top:var u=this.CheckChildTop(l,r,o);return u&&u.directions.length>0}},e.CheckChildBot=function(e,t,o,i){switch(void 0===i&&(i=[]),e){case a.DominoPointPos.Bottom:return this.CheckChildBotParentBot(t,o,i);case a.DominoPointPos.Mid:return this.CheckChildBotParentMid(t,o,i);case a.DominoPointPos.Top:return this.CheckChildBotParentTop(t,o,i)}},e.SetCheckPoint=function(e){var t=e.Position,o=cc.v2(0,0),i=cc.v2(0,0),n=cc.v2(0,0),a=cc.v2(0,0);return 90==Math.abs(e.Rotation)?e.isMirror()&&e.DominoID==s.PlayerModelProxy.inst.ForkDomino?(o=t.add(cc.v2(-this.DOMINO_SIZE.height,-this.DOMINO_SIZE.width/2)),i=t.add(cc.v2(-this.DOMINO_SIZE.height,this.DOMINO_SIZE.width/2)),n=t.add(cc.v2(this.DOMINO_SIZE.height,-this.DOMINO_SIZE.width/2)),a=t.add(cc.v2(this.DOMINO_SIZE.height,this.DOMINO_SIZE.width/2))):(o=t.add(cc.v2(-this.DOMINO_SIZE.height/2,-this.DOMINO_SIZE.width/2)),i=t.add(cc.v2(-this.DOMINO_SIZE.height/2,this.DOMINO_SIZE.width/2)),n=t.add(cc.v2(this.DOMINO_SIZE.height/2,-this.DOMINO_SIZE.width/2)),a=t.add(cc.v2(this.DOMINO_SIZE.height/2,this.DOMINO_SIZE.width/2))):e.isMirror()&&e.DominoID==s.PlayerModelProxy.inst.ForkDomino?(o=t.add(cc.v2(-this.DOMINO_SIZE.width/2,-this.DOMINO_SIZE.height)),i=t.add(cc.v2(-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.height)),n=t.add(cc.v2(this.DOMINO_SIZE.width/2,-this.DOMINO_SIZE.height)),a=t.add(cc.v2(this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.height))):(o=t.add(cc.v2(-this.DOMINO_SIZE.width/2,-this.DOMINO_SIZE.height/2)),i=t.add(cc.v2(-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.height/2)),n=t.add(cc.v2(this.DOMINO_SIZE.width/2,-this.DOMINO_SIZE.height/2)),a=t.add(cc.v2(this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.height/2))),{leftBot:o,leftTop:i,rightBot:n,rightTop:a}},e.CheckPosRight=function(e,t,o,n){void 0===n&&(n=[]);var s=0,a=0;o.isMirror()&&(s=0,a=0),e.isMirror()&&90!=Math.abs(e.Rotation)&&(s=-this.DOMINO_SIZE.width/2);var c=e.Position.add(cc.v2(this.DOMINO_SIZE.height,0)),l=this.checkingNodes,d=cc.rect(c.x-this.DOMINO_SIZE.height/2+0+s,c.y+10-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20);o.isMirror()&&(d=cc.rect(c.x-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2+0+s,c.y+this.DOMINO_SIZE.width/2+5,this.DOMINO_SIZE.height,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width));var h=!0,u=this.DOMINO_SIZE.height-20,p=cc.rect(c.x-this.DOMINO_SIZE.height/2+0+s,c.y-.5*u,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+a,u),g=!0,f=cc.rect(c.x-this.DOMINO_SIZE.height/2+0+s,c.y-this.DOMINO_SIZE.height-10-this.DOMINO_SIZE.width/2- -20,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20);o.isMirror()&&(f=cc.rect(c.x-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2+0+s,c.y-5-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.height,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width));for(var D=!0,M=[],C=[],S=i.DeskNodeModel.getDeskNodeByDominoID(o.ID,!0),_=0,I=l;_<I.length;_++){var O=I[_];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(S&&S.Children.indexOf(O.ID)>=0))){var b=(L=this.SetCheckPoint(O)).leftBot,R=L.leftTop,v=L.rightBot,T=L.rightTop;if(p.contains(b)||p.contains(R)||p.contains(v)||p.contains(T)){g=!1,M.indexOf(O.DominoID)<0&&M.push(O.DominoID);var w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);C.indexOf(w)<0&&C.push(w)}if(d.contains(b)||d.contains(R)||d.contains(v)||d.contains(T)){h=!1,M.indexOf(O.DominoID)<0&&M.push(O.DominoID);var w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);C.indexOf(w)<0&&C.push(w)}if(f.contains(b)||f.contains(R)||f.contains(v)||f.contains(T)){D=!1,M.indexOf(O.DominoID)<0&&M.push(O.DominoID);w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);C.indexOf(w)<0&&C.push(w)}if(!D&&!h&&!g)break}}var x=0,N=0,F=0;p.width=Math.max(r.DeskMaxSize.width/2/this.RootScale-p.x-this.x,0),d.height=Math.max(r.DeskMaxSize.height/2/this.RootScale-d.y-this.y,0);var B=r.DeskMaxSize.height/2/this.RootScale+f.y+f.height+this.y;if(f.y-=B-f.height,f.height=B,this.RootScale<=r.DeskScaleRange.Mid){for(var E=0,A=l;E<A.length;E++){O=A[E];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(S&&S.Children.indexOf(O.ID)>=0))){var L;b=(L=this.SetCheckPoint(O)).leftBot,R=L.leftTop,v=L.rightBot,T=L.rightTop;y(p,b),y(p,R),y(p,v),y(p,T),P(d,b),P(d,R),P(d,v),P(d,T),k(f,b),k(f,R),k(f,v),k(f,T)}}F=p.width,x=f.height,N=d.height,(x>2*F||N>2*F)&&this.RootScale<=r.DeskScaleRange.Min&&this.Height>=r.DeskMaxSize.height&&F<=this.DOMINO_SIZE.width&&(g=!1)}var V=!1;g?h||D?D&&!h?t.directions.push(m.Direction.ClockWise):h&&!D?t.directions.push(m.Direction.AnticlockWise):x>N?t.directions.push(m.Direction.ClockWise):x<N?t.directions.push(m.Direction.AnticlockWise):this.dominoCount.top>this.dominoCount.bot?t.directions.push(m.Direction.ClockWise):this.dominoCount.bot>this.dominoCount.top?t.directions.push(m.Direction.AnticlockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)):(t.forceStatic=!0,t.directions.push(m.Direction.AnticlockWise)):(V=!0,D&&!h?t.directions.push(m.Direction.ClockWise):h&&!D?t.directions.push(m.Direction.AnticlockWise):(h||D||(t.isAllBlock=!0),x>N?t.directions.push(m.Direction.ClockWise):x<N?t.directions.push(m.Direction.AnticlockWise):this.dominoCount.top>this.dominoCount.bot?t.directions.push(m.Direction.ClockWise):this.dominoCount.bot>this.dominoCount.top?t.directions.push(m.Direction.AnticlockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)))),t.forceRotate=V},e.CheckPosLeft=function(e,t,o,n){void 0===n&&(n=[]);var s=0,a=0;o.isMirror()&&(s=0,a=0),e.isMirror()&&90!=Math.abs(e.Rotation)&&(s=this.DOMINO_SIZE.width/2);var c=e.Position.add(cc.v2(-this.DOMINO_SIZE.height,0)),l=this.checkingNodes,d=cc.rect(c.x-this.DOMINO_SIZE.width/2-0+s,c.y+10-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20),h=!0;o.isMirror()&&(d=cc.rect(c.x+this.DOMINO_SIZE.width/2-0+s,c.y+this.DOMINO_SIZE.width/2+5,this.DOMINO_SIZE.height,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width));var u=this.DOMINO_SIZE.height-20,p=cc.rect(c.x-a-this.DOMINO_SIZE.height-0+s,c.y-.5*u,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+a,u),g=!0,f=cc.rect(c.x-this.DOMINO_SIZE.width/2-0+s,c.y-10- -20-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20),D=!0;o.isMirror()&&(f=cc.rect(c.x+this.DOMINO_SIZE.width/2-0+s,c.y-5-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width-this.DOMINO_SIZE.width/2,this.DOMINO_SIZE.height,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width));for(var y=[],C=[],S=i.DeskNodeModel.getDeskNodeByDominoID(o.ID,!0),_=0,I=l;_<I.length;_++){var O=I[_];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(S&&S.Children.indexOf(O.ID)>=0))){var b=(V=this.SetCheckPoint(O)).leftBot,R=V.leftTop,v=V.rightBot,T=V.rightTop;if(p.contains(b)||p.contains(R)||p.contains(v)||p.contains(T)){g=!1,y.indexOf(O.DominoID)<0&&y.push(O.DominoID);var w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);C.indexOf(w)<0&&C.push(w)}if(d.contains(b)||d.contains(R)||d.contains(v)||d.contains(T)){h=!1,y.indexOf(O.DominoID)<0&&y.push(O.DominoID);var w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);C.indexOf(w)<0&&C.push(w)}if(f.contains(b)||f.contains(R)||f.contains(v)||f.contains(T)){D=!1,y.indexOf(O.DominoID)<0&&y.push(O.DominoID);w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);C.indexOf(w)<0&&C.push(w)}if(!D&&!h&&!g)break}}var x=0,N=0,F=0,B=r.DeskMaxSize.width/2/this.RootScale+p.x+p.width+this.x;p.x-=B-p.width,p.width=B,d.height=Math.max(r.DeskMaxSize.height/2/this.RootScale-d.y-this.y,0);var E=r.DeskMaxSize.height/2/this.RootScale+f.y+f.height+this.y;if(f.y-=E-f.height,f.height=E,this.RootScale<=r.DeskScaleRange.Mid){for(var A=0,L=l;A<L.length;A++){O=L[A];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(S&&S.Children.indexOf(O.ID)>=0))){var V;b=(V=this.SetCheckPoint(O)).leftBot,R=V.leftTop,v=V.rightBot,T=V.rightTop;M(p,b),M(p,R),M(p,v),M(p,T),P(d,b),P(d,R),P(d,v),P(d,T),k(f,b),k(f,R),k(f,v),k(f,T)}}F=p.width,x=f.height,N=d.height,(x>2*F||N>2*F)&&this.RootScale<=r.DeskScaleRange.Min&&this.Height>=r.DeskMaxSize.height&&F<=this.DOMINO_SIZE.width&&(g=!1)}var Z=!1;g?h||D?D&&!h?t.directions.push(m.Direction.AnticlockWise):h&&!D?t.directions.push(m.Direction.ClockWise):N>x?t.directions.push(m.Direction.ClockWise):x>N?t.directions.push(m.Direction.AnticlockWise):this.dominoCount.bot>this.dominoCount.top?t.directions.push(m.Direction.ClockWise):this.dominoCount.bot<this.dominoCount.top?t.directions.push(m.Direction.AnticlockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)):(t.forceStatic=!0,t.directions.push(m.Direction.AnticlockWise)):(Z=!0,D&&!h?t.directions.push(m.Direction.AnticlockWise):h&&!D?t.directions.push(m.Direction.ClockWise):(h||D||(t.isAllBlock=!0),N>x?t.directions.push(m.Direction.ClockWise):x>N?t.directions.push(m.Direction.AnticlockWise):this.dominoCount.bot>this.dominoCount.top?t.directions.push(m.Direction.ClockWise):this.dominoCount.bot<this.dominoCount.top?t.directions.push(m.Direction.AnticlockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)))),t.forceRotate=Z},e.CheckPosTop=function(e,t,o,n){void 0===n&&(n=[]);var s=0,a=0;o.isMirror()&&(s=0,a=0),e.isMirror()&&90==Math.abs(e.Rotation)&&(s=-this.DOMINO_SIZE.width/2);var c=e.Position.add(cc.v2(0,this.DOMINO_SIZE.height)),l=this.checkingNodes,d=cc.rect(c.x-this.DOMINO_SIZE.width/2+10,c.y-this.DOMINO_SIZE.height/2+0+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2),h=!0;o.isMirror()&&(d=cc.rect(c.x-this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.width+5,c.y-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2+0+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width,this.DOMINO_SIZE.height));var u=cc.rect(c.x-this.DOMINO_SIZE.height-10- -20-this.DOMINO_SIZE.width/2,c.y-this.DOMINO_SIZE.height/2+0+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2),p=!0;o.isMirror()&&(u=cc.rect(c.x-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.width-5,c.y-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2+0+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width,this.DOMINO_SIZE.height));for(var g=this.DOMINO_SIZE.height-20,f=cc.rect(c.x-g/2,c.y-this.DOMINO_SIZE.height/2+0+s,g,2*this.DOMINO_SIZE.height+a),D=!0,k=i.DeskNodeModel.getDeskNodeByDominoID(o.ID,!0),C=[],S=[],_=0,I=l;_<I.length;_++){var O=I[_];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(k&&k.Children.indexOf(O.ID)>=0))){var b=(L=this.SetCheckPoint(O)).leftBot,R=L.leftTop,v=L.rightBot,T=L.rightTop;if(d.contains(b)||d.contains(R)||d.contains(v)||d.contains(T)){h=!1,C.indexOf(O.DominoID)<0&&C.push(O.DominoID);var w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);S.indexOf(w)<0&&S.push(w)}if(u.contains(b)||u.contains(R)||u.contains(v)||u.contains(T)){p=!1,C.indexOf(O.DominoID)<0&&C.push(O.DominoID);w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);S.indexOf(w)<0&&S.push(w)}if(f.contains(b)||f.contains(R)||f.contains(v)||f.contains(T)){D=!1,C.indexOf(O.DominoID)<0&&C.push(O.DominoID);w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);S.indexOf(w)<0&&S.push(w)}if(!D&&!p&&!h)break}}var x=0,N=0,F=0;f.height=Math.max(r.DeskMaxSize.height/2/this.RootScale-f.y-this.y,0);var B=r.DeskMaxSize.width/2/this.RootScale+u.x+u.width+this.x;if(u.x-=B-u.width,u.width=B,d.width=Math.max(r.DeskMaxSize.width/2/this.RootScale-d.x-this.x,0),this.RootScale<=r.DeskScaleRange.Mid){for(var E=0,A=l;E<A.length;E++){O=A[E];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(k&&k.Children.indexOf(O.ID)>=0))){var L;b=(L=this.SetCheckPoint(O)).leftBot,R=L.leftTop,v=L.rightBot,T=L.rightTop;M(u,b),M(u,R),M(u,v),M(u,T),P(f,b),P(f,R),P(f,v),P(f,T),y(d,b),y(d,R),y(d,v),y(d,T)}}x=u.width,F=d.width,(x>2*(N=f.height)||F>2*N)&&this.RootScale<=r.DeskScaleRange.Min&&this.Height>=r.DeskMaxSize.height&&N<=this.DOMINO_SIZE.width&&(D=!1)}var V=!1;D?p||h?p&&!h?t.directions.push(m.Direction.AnticlockWise):h&&!p?t.directions.push(m.Direction.ClockWise):x>F?t.directions.push(m.Direction.AnticlockWise):x<F?t.directions.push(m.Direction.ClockWise):this.dominoCount.left>this.dominoCount.right?t.directions.push(m.Direction.ClockWise):this.dominoCount.left<this.dominoCount.right?t.directions.push(m.Direction.AnticlockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)):(t.forceStatic=!0,t.directions.push(m.Direction.AnticlockWise)):(V=!0,p&&!h?t.directions.push(m.Direction.AnticlockWise):h&&!p?t.directions.push(m.Direction.ClockWise):(p||h||(t.isAllBlock=!0),x>F?t.directions.push(m.Direction.AnticlockWise):x<F?t.directions.push(m.Direction.ClockWise):this.dominoCount.left>this.dominoCount.right?t.directions.push(m.Direction.ClockWise):this.dominoCount.left<this.dominoCount.right?t.directions.push(m.Direction.AnticlockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)))),t.forceRotate=V},e.CheckPosBot=function(e,t,o,n){void 0===n&&(n=[]);var s=0,a=0;o.isMirror()&&(s=0,a=0),e.isMirror()&&90==Math.abs(e.Rotation)&&(s=this.DOMINO_SIZE.width/2);var c=e.Position.add(cc.v2(0,-this.DOMINO_SIZE.height)),l=this.checkingNodes,d=cc.rect(c.x+10-this.DOMINO_SIZE.width/2,c.y-0-this.DOMINO_SIZE.width/2+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2),h=!0;o.isMirror()&&(d=cc.rect(c.x-this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.width+5,c.y-0+this.DOMINO_SIZE.width/2+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width,this.DOMINO_SIZE.height));var u=cc.rect(c.x-10- -20-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2,c.y-0-this.DOMINO_SIZE.width/2+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width+-20,this.DOMINO_SIZE.width+(this.DOMINO_SIZE.height-this.DOMINO_SIZE.width)/2),p=!0;o.isMirror()&&(u=cc.rect(c.x-this.DOMINO_SIZE.height-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.width-5,c.y-0+this.DOMINO_SIZE.width/2+s,this.DOMINO_SIZE.height+this.DOMINO_SIZE.width,this.DOMINO_SIZE.height));for(var g=this.DOMINO_SIZE.height-20,f=cc.rect(c.x-g/2,c.y+this.DOMINO_SIZE.height/2-2*this.DOMINO_SIZE.height-a-0+s,g,2*this.DOMINO_SIZE.height+a),D=!0,P=i.DeskNodeModel.getDeskNodeByDominoID(o.ID,!0),C=[],S=[],_=0,I=l;_<I.length;_++){var O=I[_];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(P&&P.Children.indexOf(O.ID)>=0))){var b=(V=this.SetCheckPoint(O)).leftBot,R=V.leftTop,v=V.rightBot,T=V.rightTop;if(d.contains(b)||d.contains(R)||d.contains(v)||d.contains(T)){h=!1,C.indexOf(O.DominoID)<0&&C.push(O.DominoID);var w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);S.indexOf(w)<0&&S.push(w)}if(u.contains(b)||u.contains(R)||u.contains(v)||u.contains(T)){p=!1,C.indexOf(O.DominoID)<0&&C.push(O.DominoID);w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);S.indexOf(w)<0&&S.push(w)}if(f.contains(b)||f.contains(R)||f.contains(v)||f.contains(T)){D=!1,C.indexOf(O.DominoID)<0&&C.push(O.DominoID);w=cc.rect(b.x,b.y,v.x-b.x,R.y-b.y);S.indexOf(w)<0&&S.push(w)}if(!D&&!p&&!h)break}}var x=0,N=0,F=0,B=r.DeskMaxSize.width/2/this.RootScale+u.x+u.width+this.x;u.x-=B-u.width,u.width=B,d.width=Math.max(r.DeskMaxSize.width/2/this.RootScale-d.x-this.x,0);var E=r.DeskMaxSize.height/2/this.RootScale+f.y+f.height+this.y;if(f.y-=E-f.height,f.height=E,this.RootScale<=r.DeskScaleRange.Mid){for(var A=0,L=l;A<L.length;A++){O=L[A];if(!(n.indexOf(O.DominoID)>=0)&&(O.DominoID!=o.ID&&e.DominoID!=O.DominoID&&!(P&&P.Children.indexOf(O.ID)>=0))){var V;b=(V=this.SetCheckPoint(O)).leftBot,R=V.leftTop,v=V.rightBot,T=V.rightTop;M(u,b),M(u,R),M(u,v),M(u,T),k(f,b),k(f,R),k(f,v),k(f,T),y(d,b),y(d,R),y(d,v),y(d,T)}}N=u.width,F=d.width,(N>2*(x=f.height)||F>2*x)&&this.RootScale<=r.DeskScaleRange.Min&&this.Height>=r.DeskMaxSize.height&&x<=this.DOMINO_SIZE.width&&(D=!1)}var Z=!1;D?p||h?p&&!h?t.directions.push(m.Direction.ClockWise):h&&!p?t.directions.push(m.Direction.AnticlockWise):F>N?t.directions.push(m.Direction.AnticlockWise):N>F?t.directions.push(m.Direction.ClockWise):this.dominoCount.left>this.dominoCount.right?t.directions.push(m.Direction.AnticlockWise):this.dominoCount.left<this.dominoCount.right?t.directions.push(m.Direction.ClockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)):(t.forceStatic=!0,t.directions.push(m.Direction.AnticlockWise)):(Z=!0,p&&!h?t.directions.push(m.Direction.ClockWise):h&&!p?t.directions.push(m.Direction.AnticlockWise):(p||h||(t.isAllBlock=!0),F>N?t.directions.push(m.Direction.AnticlockWise):N>F?t.directions.push(m.Direction.ClockWise):this.dominoCount.left>this.dominoCount.right?t.directions.push(m.Direction.AnticlockWise):this.dominoCount.left<this.dominoCount.right?t.directions.push(m.Direction.ClockWise):(t.directions.push(m.Direction.AnticlockWise),t.directions.push(m.Direction.ClockWise)))),t.forceRotate=Z},e.CheckChildBotParentBot=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:this.CheckPosBot(e,i,t,o);break;case 180:this.CheckPosTop(e,i,t,o);break;case 90:this.CheckPosLeft(e,i,t,o);break;case-90:this.CheckPosRight(e,i,t,o)}return i},e.CheckChildBotParentMid=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:e.RightFree?this.CheckPosRight(e,i,t,o):e.LeftFree?this.CheckPosLeft(e,i,t,o):e.BotFree?this.CheckPosBot(e,i,t,o):e.TopFree&&this.CheckPosTop(e,i,t,o);break;case 180:e.LeftFree?this.CheckPosRight(e,i,t,o):e.RightFree?this.CheckPosLeft(e,i,t,o):e.TopFree?this.CheckPosBot(e,i,t,o):e.BotFree&&this.CheckPosTop(e,i,t,o);break;case 90:e.LeftFree?this.CheckPosTop(e,i,t,o):e.RightFree?this.CheckPosBot(e,i,t,o):e.TopFree?this.CheckPosRight(e,i,t,o):e.BotFree&&this.CheckPosLeft(e,i,t,o);break;case-90:e.LeftFree?this.CheckPosBot(e,i,t,o):e.RightFree?this.CheckPosTop(e,i,t,o):e.TopFree?this.CheckPosLeft(e,i,t,o):e.BotFree&&this.CheckPosRight(e,i,t,o)}return i},e.CheckChildBotParentTop=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:this.CheckPosTop(e,i,t,o);break;case 180:this.CheckPosBot(e,i,t,o);break;case 90:this.CheckPosRight(e,i,t,o);break;case-90:this.CheckPosLeft(e,i,t,o)}return i},e.CheckChildMid=function(e,t,o,i){switch(void 0===i&&(i=[]),e){case a.DominoPointPos.Bottom:return this.CheckChildMidParentBot(t,o,i);case a.DominoPointPos.Mid:return console.error(" \u4e0d\u5b58\u5728\u5b50\u7236\u8282\u70b9\u540c\u65f6\u5bf9\u79f0\u7684\u60c5\u51b5"),null;case a.DominoPointPos.Top:return this.CheckChildMidParentTop(t,o,i)}},e.CheckChildMidParentBot=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:this.CheckPosBot(e,i,t,o);break;case 180:this.CheckPosTop(e,i,t,o);break;case 90:this.CheckPosLeft(e,i,t,o);break;case-90:this.CheckPosRight(e,i,t,o)}return i},e.CheckChildMidParentTop=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:this.CheckPosTop(e,i,t,o);break;case 180:this.CheckPosBot(e,i,t,o);break;case 90:this.CheckPosRight(e,i,t,o);break;case-90:this.CheckPosLeft(e,i,t,o)}return i},e.CheckChildTop=function(e,t,o,i){switch(void 0===i&&(i=[]),e){case a.DominoPointPos.Bottom:return this.CheckChildTopParentBot(t,o,i);case a.DominoPointPos.Mid:return this.CheckChildTopParentMid(t,o,i);case a.DominoPointPos.Top:return this.CheckChildTopParentTop(t,o,i)}},e.CheckChildTopParentBot=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:this.CheckPosBot(e,i,t,o);break;case 180:this.CheckPosTop(e,i,t,o);break;case 90:this.CheckPosLeft(e,i,t,o);break;case-90:this.CheckPosRight(e,i,t,o)}return i},e.CheckChildTopParentMid=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:e.TopFree,e.BotFree,e.LeftFree,e.RightFree;e.RightFree?this.CheckPosRight(e,i,t,o):e.LeftFree?this.CheckPosLeft(e,i,t,o):e.BotFree?this.CheckPosBot(e,i,t,o):e.TopFree&&this.CheckPosTop(e,i,t,o);break;case 180:e.LeftFree?this.CheckPosRight(e,i,t,o):e.RightFree?this.CheckPosLeft(e,i,t,o):e.BotFree?this.CheckPosTop(e,i,t,o):e.TopFree&&this.CheckPosBot(e,i,t,o);break;case 90:e.LeftFree?this.CheckPosTop(e,i,t,o):e.RightFree?this.CheckPosBot(e,i,t,o):e.TopFree?this.CheckPosRight(e,i,t,o):e.BotFree&&this.CheckPosLeft(e,i,t,o);break;case-90:e.LeftFree?this.CheckPosBot(e,i,t,o):e.RightFree?this.CheckPosTop(e,i,t,o):e.TopFree?this.CheckPosLeft(e,i,t,o):e.BotFree&&this.CheckPosRight(e,i,t,o)}return i},e.CheckChildTopParentTop=function(e,t,o){void 0===o&&(o=[]);var i=new C;switch(e.Rotation){case 0:this.CheckPosTop(e,i,t,o);break;case 180:this.CheckPosBot(e,i,t,o);break;case 90:this.CheckPosRight(e,i,t,o);break;case-90:this.CheckPosLeft(e,i,t,o)}return i},e.UpdateIndex=function(e,t){e.y<t.y?e.ZIndex=t.ZIndex+1:e.y>t.y?e.ZIndex=t.ZIndex-1:e.ZIndex=t.ZIndex+100},e.addDeskNodeByLayer=function(e,t){this.deskNodeLayerMap.has(e)?this.deskNodeLayerMap.get(e).indexOf(t)<0&&this.deskNodeLayerMap.get(e).push(t):this.deskNodeLayerMap.add(e,[t])},e.clearLayerData=function(){this.deskNodeLayerMap.clear()},e.UpdateTransforms=function(){var e=this;Date.now();this.resetPading(),this.checkingNodes=[];for(var t=0,o=s.PlayerModelProxy.inst.getDeskDominos();t<o.length;t++){var n=o[t];i.DeskNodeModel.getDeskNodeByDominoID(n.ID).setAllFree()}var r=i.DeskNodeModel.getDeskNode(i.DeskNodeModel.Root.Children[0]),c=a.DominoModel.getDominoByID(r.DominoID);r.isFirst=!0,r.ZIndex=Math.floor(cc.macro.MAX_ZINDEX/2),c.isMirror()?(r.Position=cc.v2(0,0),r.Rotation=0,r.Rotation%180==0?(this.pading.top=this.DOMINO_SIZE.height/2,this.pading.bot=this.DOMINO_SIZE.height/2,this.pading.left=this.DOMINO_SIZE.width/2,this.pading.right=this.DOMINO_SIZE.width/2):(this.pading.top=this.DOMINO_SIZE.width/2,this.pading.bot=this.DOMINO_SIZE.width/2,this.pading.left=this.DOMINO_SIZE.height/2,this.pading.right=this.DOMINO_SIZE.height/2),this.checkPadding()):(r.Position=cc.v2(0,0),r.Rotation=90,r.Rotation%180==0?(this.pading.top=this.DOMINO_SIZE.height/2,this.pading.bot=this.DOMINO_SIZE.height/2,this.pading.left=this.DOMINO_SIZE.width/2,this.pading.right=this.DOMINO_SIZE.width/2):(this.pading.top=this.DOMINO_SIZE.width/2,this.pading.bot=this.DOMINO_SIZE.width/2,this.pading.left=this.DOMINO_SIZE.height/2,this.pading.right=this.DOMINO_SIZE.height/2),this.checkPadding()),this.checkingNodes.push(r),this.deskNodeLayerMap.forEach(function(t,o){for(var i=0,n=o;i<n.length;i++){var s=n[i];s.Parent&&(e.UpdateTransformRecursily(s.ID,s.Parent,!1),s.x>0?e.dominoCount.right++:s.x<0&&e.dominoCount.left++,s.y>0?e.dominoCount.top++:s.y<0&&e.dominoCount.bot++)}}),console.log(this.dominoCount),this.CheckHungryDomino()},e.resetToFree=function(e,t){switch(t.Rotation){case 0:e.x-t.x>=this.DOMINO_SIZE.width?t.RightFree=!0:t.x-e.x>=this.DOMINO_SIZE.width?t.LeftFree=!0:e.y-t.y>=this.DOMINO_SIZE.width?t.TopFree=!0:t.y-e.y>=this.DOMINO_SIZE.width?t.BotFree=!0:console.warn("\u627e\u4e0d\u5230\u65b9\u4f4d, child\uff1a",e.DominoID,",parent:",t.DominoID);break;case 180:e.x-t.x>=this.DOMINO_SIZE.width?t.LeftFree=!0:t.x-e.x>=this.DOMINO_SIZE.width?t.RightFree=!0:e.y-t.y>=this.DOMINO_SIZE.width?t.BotFree=!0:t.y-e.y>=this.DOMINO_SIZE.width?t.TopFree=!0:console.warn("\u627e\u4e0d\u5230\u65b9\u4f4d, child\uff1a",e.DominoID,",parent:",t.DominoID);break;case 90:e.x-t.x>=this.DOMINO_SIZE.width?t.TopFree=!0:t.x-e.x>=this.DOMINO_SIZE.width?t.BotFree=!0:e.y-t.y>=this.DOMINO_SIZE.width?t.LeftFree=!0:t.y-e.y>=this.DOMINO_SIZE.width?t.RightFree=!0:console.warn("\u627e\u4e0d\u5230\u65b9\u4f4d, child\uff1a",e.DominoID,",parent:",t.DominoID);break;case-90:e.x-t.x>=this.DOMINO_SIZE.width?t.BotFree=!0:t.x-e.x>=this.DOMINO_SIZE.width?t.TopFree=!0:e.y-t.y>=this.DOMINO_SIZE.width?t.RightFree=!0:t.y-e.y>=this.DOMINO_SIZE.width?t.LeftFree=!0:console.warn("\u627e\u4e0d\u5230\u65b9\u4f4d, child\uff1a",e.DominoID,",parent:",t.DominoID)}},e.CheckHungryDomino=function(){var e=s.PlayerModelProxy.inst.getFreeDominos(),t=[];t=(t=t.concat(s.PlayerModelProxy.inst.getPlayerDominos())).concat(s.PlayerModelProxy.inst.getAIDominos()),console.log("domino rest count:",t.length);for(var o=[],n=0,a=e;n<a.length;n++){var r=a[n],c=i.DeskNodeModel.getDeskNodeByDominoID(r.ID,!0);if(c){for(var l=!1,d=0,h=t;d<h.length;d++){var u=h[d];if(this.CheckIsBlock(u,c)){l=!0;break}}l&&o.indexOf(r.ID)<0&&o.push(r.ID)}}console.log(" block free dominos:",o);var p=0,g=this;function f(o,n){if(n.Parent&&n&&(g.resetToFree(n,n.Parent),g.UpdateTransformRecursily(n.ID,n.Parent,!0,o),!n.Parent.isRoot())){for(var s=!1,a=0,r=e;a<r.length;a++){var c=r[a],l=i.DeskNodeModel.getDeskNodeByDominoID(c.ID,!0);if(l){for(var d=0,h=t;d<h.length;d++){var u=h[d];if(g.CheckIsBlock(u,l)){s=!0;break}}if(s)break}}s&&(o.push(n.ID),f(o,n.Parent))}}(function o(n){if(!(n.length<=0))if(p>=2)console.warn("\u9012\u5f52\u8d85\u8fc72\u6b21\uff0c\u8fd8\u5b58\u5728\u88ab\u906e\u6321\u7684domino:",n);else{p++;for(var s=0,a=n;s<a.length;s++){var r=a[s],c=i.DeskNodeModel.getDeskNodeByDominoID(r),l=[];l.push(r),f(l,c.Parent)}for(var d=[],h=0,u=e;h<u.length;h++){var m=u[h],D=i.DeskNodeModel.getDeskNodeByDominoID(m.ID,!0);if(D){for(var y=!1,M=0,P=t;M<P.length;M++){var k=P[M];if(g.CheckIsBlock(k,D)){y=!0;break}}y&&d.indexOf(m.ID)<0&&d.push(m.ID)}}o(d)}})(o)},e.CheckIsBlock=function(e,t){if(0==a.DominoModel.checkCanConnect(e.ID,t.DominoID))return!1;var o=i.DeskNodeModel.createDeskNode(e.ID);if(!t||t.isRoot()||o.isRoot()||o.isFirst)return!1;var n=a.DominoModel.getDominoByID(t.DominoID),r=n.FreePoints[0],c=3==n.TopPoint&&3==n.BotPoint&&!1,l=n.getValPos(r);c&&console.log("parent connect point:",r,",pos:",a.DominoPointPos[l]);var d=new C;switch(l){case a.DominoPointPos.Top:switch(t.Rotation){case 0:this.CheckPosTop(t,d,e);break;case 180:this.CheckPosBot(t,d,e);break;case 90:this.CheckPosRight(t,d,e);break;case-90:this.CheckPosLeft(t,d,e)}break;case a.DominoPointPos.Mid:if(s.PlayerModelProxy.inst.ForkDomino==t.DominoID)switch(t.Rotation){case 0:t.LeftFree?this.CheckPosLeft(t,d,e):t.RightFree?this.CheckPosRight(t,d,e):t.TopFree?this.CheckPosTop(t,d,e):t.BotFree&&this.CheckPosBot(t,d,e);break;case 180:t.LeftFree?this.CheckPosRight(t,d,e):t.RightFree?this.CheckPosLeft(t,d,e):t.TopFree?this.CheckPosBot(t,d,e):t.BotFree&&this.CheckPosTop(t,d,e);break;case 90:t.LeftFree?this.CheckPosTop(t,d,e):t.RightFree?this.CheckPosBot(t,d,e):t.TopFree?this.CheckPosRight(t,d,e):t.BotFree&&this.CheckPosLeft(t,d,e);break;case-90:t.LeftFree?this.CheckPosBot(t,d,e):t.RightFree?this.CheckPosTop(t,d,e):t.TopFree?this.CheckPosLeft(t,d,e):t.BotFree&&this.CheckPosRight(t,d,e)}else switch(t.Rotation){case 0:t.LeftFree?this.CheckPosLeft(t,d,e):t.RightFree&&this.CheckPosRight(t,d,e);break;case 180:t.LeftFree?this.CheckPosRight(t,d,e):t.RightFree&&this.CheckPosLeft(t,d,e);break;case 90:t.LeftFree?this.CheckPosTop(t,d,e):t.RightFree&&this.CheckPosBot(t,d,e);break;case-90:t.LeftFree?this.CheckPosBot(t,d,e):t.RightFree&&this.CheckPosTop(t,d,e)}break;case a.DominoPointPos.Bottom:switch(t.Rotation){case 0:this.CheckPosBot(t,d,e);break;case 180:this.CheckPosTop(t,d,e);break;case 90:this.CheckPosLeft(t,d,e);break;case-90:this.CheckPosRight(t,d,e)}}return d.isAllBlock},e.UpdateTransformRecursily=function(e,t,o,n){void 0===o&&(o=!0),void 0===n&&(n=[]);var s=i.DeskNodeModel.getDeskNode(e),r=a.DominoModel.getDominoByID(s.DominoID),c=a.DominoModel.getDominoByID(t.DominoID);if(null!=r&&null!=c){var l=r.getValPos(s.ConnectedVal),d=c.getValPos(s.ConnectedValue);switch(console.log(" child pos:",a.DominoPointPos[l],", parent:",a.DominoPointPos[d]),l){case a.DominoPointPos.Bottom:this.childBottom(d,e,t,n);break;case a.DominoPointPos.Mid:this.childMid(d,e,t,n);break;case a.DominoPointPos.Top:this.childTop(d,e,t,n)}if(this.UpdateIndex(s,t),this.checkPadding(),this.checkingNodes.indexOf(s)<0&&this.checkingNodes.push(s),o){var h=n.indexOf(t.ID);h>=0&&n.splice(h,1);for(var u=0,p=s.Children;u<p.length;u++){var g=p[u];this.UpdateTransformRecursily(g,s,!0,n)}}}},e.checkPadding=function(){this.pading.left!=this.pading.right&&(this.pading.position.x+=(this.pading.left-this.pading.right)/2,this.pading.left=this.pading.right=(this.pading.left+this.pading.right)/2),this.pading.bot!=this.pading.top&&(this.pading.position.y+=(this.pading.bot-this.pading.top)/2,this.pading.top=this.pading.bot=(this.pading.top+this.pading.bot)/2),this.UpdateScaleMin(),n.DeskRootPadingChanged.inst.dispatchOne(this.pading.position.mul(this.RootScale))},e.UpdateScaleMin=function(){var e=this.pading.bot+this.pading.top,t=this.pading.left+this.pading.right,o=Math.min(r.DeskMaxSize.height/e,r.DeskMaxSize.width/t),i=Math.max(r.DeskScaleRange.Min,Math.min(o,this.RootScale));this.RootScale=i},e.childBottom=function(e,t,o,n){void 0===n&&(n=[]);var s=i.DeskNodeModel.getDeskNode(t);switch(e){case a.DominoPointPos.Bottom:c.ChildBotParentBot.Check(s,o,n);break;case a.DominoPointPos.Mid:l.ChildBotParentMid.Check(s,o,n);break;case a.DominoPointPos.Top:d.ChildBotParentTop.Check(s,o,n)}},e.childTop=function(e,t,o,n){void 0===n&&(n=[]);var s=i.DeskNodeModel.getDeskNode(t);switch(e){case a.DominoPointPos.Bottom:h.ChildTopParentBot.Check(s,o,n);break;case a.DominoPointPos.Mid:u.ChildTopParentMid.Check(s,o,n);break;case a.DominoPointPos.Top:p.ChildTopParentTop.Check(s,o,n)}},e.childMid=function(e,t,o,n){void 0===n&&(n=[]);var s=i.DeskNodeModel.getDeskNode(t);switch(e){case a.DominoPointPos.Bottom:g.ChildMidParentBot.Check(s,o,n);break;case a.DominoPointPos.Mid:console.error(" \u7236\u8282\u70b9 mid match \u5b50\u8282\u70b9 mid");break;case a.DominoPointPos.Top:f.ChildMidParentTop.Check(s,o,n)}},e.DOMINO_SIZE=cc.size(94,180),e.checkingNodes=[],e.scale=1,e.pading={top:0,bot:0,left:0,right:0,position:cc.v2(0,0)},e.dominoCount={left:0,right:0,bot:0,top:0},e.deskNodeLayerMap=new D.HashMap,e}();o.DeskCheckModel=S,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../../Global/Desk":"Desk","../../Utils/HashMap":"HashMap","../Command/GamePlaySignal":"GamePlaySignal","../Facade/PlayerModelProxy":"PlayerModelProxy","./DeskNodeModel":"DeskNodeModel","./DominoMatch/ChildBot/ChildBotParentBot":"ChildBotParentBot","./DominoMatch/ChildBot/ChildBotParentMId":"ChildBotParentMid","./DominoMatch/ChildBot/ChildBotParentTop":"ChildBotParentTop","./DominoMatch/ChildMid/ChildMidParentBot":"ChildMidParentBot","./DominoMatch/ChildMid/ChildMidParentTop":"ChildMidParentTop","./DominoMatch/ChildTop/ChildTopParentBot":"ChildTopParentBot","./DominoMatch/ChildTop/ChildTopParentMid":"ChildTopParentMid","./DominoMatch/ChildTop/ChildTopParentTop":"ChildTopParentTop","./DominoMatch/DominoTransform":"DominoTransform","./DominoModel":"DominoModel","./GameRule":"GameRule"}],DeskNodeModel:[function(e,t,o){"use strict";cc._RF.push(t,"61a5efXiGdK9IQmU0SeqVCq","DeskNodeModel"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/HashMap"),n=e("../Facade/PlayerModelProxy"),s=e("./DeskCheckModel"),a=e("./DominoModel"),r=function(){function e(t,o,i){void 0===o&&(o=0),void 0===i&&(i=!1),this.root=!1,this.nodeId="",this.dominoId="",this.childrenIds=[],this.parentId="",this.connectedVal=-1,this.layer=0,this.leftFree=!0,this.rightFree=!0,this.topFree=!0,this.botFree=!0,this.posistion=cc.v2(0,0),this.rotation=0,this.zIndex=0,this.first=!1,this.dominoId=t,i&&(this.root=!0,e.rootNodeMap.add(o,this)),this.nodeId="deskNode:"+e.deskNodeID++,e.deskNodeMap.add(this.nodeId,this)}return e.getDeskNode=function(e,t){void 0===t&&(t=!1);var o=this.deskNodeMap.get(e);return!t&&console.assert(null!=o," desk node is null:",e),o},e.getDeskNodeByDominoID=function(e,t){void 0===t&&(t=!1);var o=null;return this.deskNodeMap.forEach(function(t,i){i.DominoID==e&&(o=i)}),!t&&console.assert(null!=o," desk node is null:",e),o},e.checkHasDeskNode=function(e){var t=null;return this.deskNodeMap.forEach(function(o,i){i.DominoID==e&&(t=i)}),null!=t},e.createDeskNode=function(t,o,i){void 0===o&&(o=0),void 0===i&&(i=!1);var n=this.getDeskNodeByDominoID(t,!0);return n||new e(t,o,i)},Object.defineProperty(e,"Root",{get:function(){var e=this.rootNodeMap.get(n.PlayerModelProxy.inst.Round);return console.assert(null!=e,"  round: ",n.PlayerModelProxy.inst.Round," , root is null!"),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConnectedValue",{get:function(){return this.connectedVal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Layer",{get:function(){return this.layer},enumerable:!0,configurable:!0}),e.prototype.isMirror=function(){return a.DominoModel.getDominoByID(this.DominoID).isMirror()},e.prototype.isRoot=function(){return this.root},e.prototype.hasChild=function(){return this.childrenIds.length>0},Object.defineProperty(e.prototype,"ID",{get:function(){return this.nodeId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DominoID",{get:function(){return this.dominoId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Parent",{get:function(){return""==this.parentId?null:e.getDeskNode(this.parentId)},enumerable:!0,configurable:!0}),e.prototype.setParent=function(t){""==this.parentId||this.parentId==t?null!=e.deskNodeMap.get(t)?this.parentId!=t&&(this.parentId=t):console.error(t," is a invaild deskNode, onSetParent"):console.error(this.nodeId," already has a parent:",this.parentId)},e.prototype.setConnectedVal=function(e){this.connectedVal=e},Object.defineProperty(e.prototype,"ConnectedVal",{get:function(){return this.connectedVal},enumerable:!0,configurable:!0}),e.prototype.addChild=function(t,o){if(null!=e.deskNodeMap.get(t)){var i=e.deskNodeMap.get(t);this.childrenIds.indexOf(t)<0&&(this.childrenIds.push(t),i.setParent(this.nodeId),i.setConnectedVal(o),i.layer=this.layer+1,s.DeskCheckModel.addDeskNodeByLayer(i.layer,i))}else console.error(t," is a invaild deskNode, on AddChild")},Object.defineProperty(e.prototype,"Children",{get:function(){return this.childrenIds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ChildrenCount",{get:function(){return this.childrenIds.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFirst",{get:function(){return this.first},set:function(e){this.first=e},enumerable:!0,configurable:!0}),e.prototype.setAllFree=function(){this.LeftFree=!0,this.BotFree=!0,this.TopFree=!0,this.RightFree=!0},Object.defineProperty(e.prototype,"LeftFree",{get:function(){return this.leftFree},set:function(e){this.leftFree=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RightFree",{get:function(){return this.rightFree},set:function(e){this.rightFree=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopFree",{get:function(){return this.topFree},set:function(e){this.topFree=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BotFree",{get:function(){return this.botFree},set:function(e){this.botFree=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Position",{get:function(){return this.posistion},set:function(e){this.posistion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.posistion.x},set:function(e){this.posistion.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.posistion.y},set:function(e){this.posistion.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rotation",{get:function(){return this.rotation},set:function(e){this.rotation=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ZIndex",{get:function(){return this.zIndex},set:function(e){this.zIndex=e},enumerable:!0,configurable:!0}),e.deskNodeMap=new i.HashMap,e.deskNodeID=0,e.rootNodeMap=new i.HashMap,e}();o.DeskNodeModel=r,cc._RF.pop()},{"../../Utils/HashMap":"HashMap","../Facade/PlayerModelProxy":"PlayerModelProxy","./DeskCheckModel":"DeskCheckModel","./DominoModel":"DominoModel"}],DeskRootMediator:[function(e,t,o){"use strict";cc._RF.push(t,"7e0e7gNH7tHhqch8phMFMEj","DeskRootMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.PlaceDomino.inst.addListenerOne(this.onDominoPlaced,this),n.DeskRootScale.inst.addListenerOne(this.onScaleChanged,this),n.DeskRootPadingChanged.inst.addListenerOne(this.onPaddingChanged,this)},t.prototype.onDominoPlaced=function(e){this.View.addDomino(e)},t.prototype.onScaleChanged=function(e){this.View.onScaleChanged(e)},t.prototype.onPaddingChanged=function(e){this.View.onPositionChanged(e)},t.prototype.onUnregister=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal"}],DeskRootView:[function(e,t,o){"use strict";cc._RF.push(t,"e0718e9H/JNtYw+cLGf7tH9","DeskRootView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./DeskRootMediator"),s=e("../../../Utils/Cocos"),a=e("../../Command/GamePlaySignal"),r=e("../../Model/DominoModel"),c=e("../DominoControl/DominoNodePool"),l=e("../../../Global/Desk"),d=e("../../Model/DeskCheckModel"),h=e("../../Model/GameRule"),u=cc._decorator,p=u.ccclass,g=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scaleStep=.02,t.posStep=cc.v2(0,0),t.targetPosition=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=l.DeskScaleRange.Origin,this.BindMedaitor(n.default),this.node.getParent().getComponent(cc.Sprite).enabled=h.DrawDebug},t.prototype.onScaleChanged=function(e){this.scaleStep=(e-this.node.scale)/2},t.prototype.onPositionChanged=function(e){this.targetPosition=e,this.posStep.x=(this.targetPosition.x-this.node.x)/20,this.posStep.y=(this.targetPosition.y-this.node.y)/20},t.prototype.start=function(){window.DeskRoot=this.node},t.prototype.addDomino=function(e){var t=c.default.getDomino(e);t.getParent()&&t.setPosition(s.ConvertToNodeSpaceAR(t,this.node)),t.zIndex=cc.macro.MAX_ZINDEX,t.scale=t.scale*(t.parent.scale/this.node.scale),t.setParent(this.node),t.runAction(cc.scaleTo(.1,1)),t.group="default",a.DispatchDoneSignal.inst.dispatchTwo(e,r.DominoOwner.Desk),a.PlaceDominoDone.inst.dispatchOne(e)},t.prototype.update=function(e){this.node.scale!=d.DeskCheckModel.RootScale&&(this.node.scale+=this.scaleStep),(this.node.scale>d.DeskCheckModel.RootScale&&this.scaleStep>0||this.node.scale<d.DeskCheckModel.RootScale&&this.scaleStep<0)&&(this.scaleStep=0,this.node.scale=d.DeskCheckModel.RootScale),this.targetPosition&&(this.node.x!=this.targetPosition.x&&(this.node.x+=this.posStep.x),this.node.y!=this.targetPosition.y&&(this.node.y+=this.posStep.y),(this.node.x>this.targetPosition.x&&this.posStep.x>0||this.node.x<this.targetPosition.x&&this.posStep.x<0)&&(this.node.x=this.targetPosition.x,this.posStep.x=0),(this.node.y>this.targetPosition.y&&this.posStep.y>0||this.node.y<this.targetPosition.y&&this.posStep.y<0)&&(this.node.y=this.targetPosition.y,this.posStep.y=0))},t=__decorate([p],t)}(i.default));o.default=g,cc._RF.pop()},{"../../../Global/Desk":"Desk","../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DeskCheckModel":"DeskCheckModel","../../Model/DominoModel":"DominoModel","../../Model/GameRule":"GameRule","../DominoControl/DominoNodePool":"DominoNodePool","./DeskRootMediator":"DeskRootMediator"}],Desk:[function(e,t,o){"use strict";cc._RF.push(t,"74537474HZIIryEAbzQ7oeC","Desk"),Object.defineProperty(o,"__esModule",{value:!0}),o.DeskMaxSize=cc.size(850,850),o.DominoRange={x:{Min:-540,Max:540},y:{Min:-540,Max:540}},o.DeskScaleRange={Max:1.5,Origin:1.2,Mid:.8,Min:.7},cc._RF.pop()},{}],DominoDeskTransformMediator:[function(e,t,o){"use strict";cc._RF.push(t,"d56d5RiU8dLBqckrUexjznT","DominoDeskTransformMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Model/DeskNodeModel"),a=e("../../Model/DominoModel"),r=cc._decorator,c=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.PlaceDominoDone.inst.addListenerOne(this.onDominoPlaceDone,this)},t.prototype.onDominoPlaceDone=function(e){if(this.View.Owner==a.DominoOwner.Desk&&0!=s.DeskNodeModel.checkHasDeskNode(this.View.ID)){var t=s.DeskNodeModel.getDeskNodeByDominoID(this.View.ID);null!=t&&(t.Rotation%180==0?this.View.turnVertical(t.Rotation):t.Rotation>0?this.View.turnHorizontalRight(t.Rotation):this.View.turnHorizontalLeft(t.Rotation),this.View.setTargetZIndex(t.ZIndex),this.View.setTargetPos(t.Position))}},t.prototype.onUnregister=function(){},t=__decorate([c],t)}(i.default));o.default=l,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DeskNodeModel":"DeskNodeModel","../../Model/DominoModel":"DominoModel"}],DominoDeskTransform:[function(e,t,o){"use strict";cc._RF.push(t,"4d1ffQJVWVBG7JrRGkstzZN","DominoDeskTransform"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../../View/BaseView"),s=e("./DominoDeskTransformMediator"),a=e("../../Model/DominoModel"),r=e("../../Controller/ResourceController"),c=e("../../Facade/PlayerModelProxy"),l=e("../../Model/DeskNodeModel"),d=e("../../Controller/GameStateController"),h=cc._decorator,u=h.ccclass;h.property;(function(e){e[e.VerticalNormal=0]="VerticalNormal",e[e.VerticalReverse=1]="VerticalReverse",e[e.HorizontalRight=2]="HorizontalRight",e[e.HorizontalLeft=3]="HorizontalLeft"})(i=o.RotateState||(o.RotateState={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.backNode=null,t.frontNode=null,t.frontSprite=null,t.pointRoot=null,t.topPointSp=null,t.bottomPointSp=null,t.rotateState=i.VerticalNormal,t.model=null,t.offsetStep=cc.v2(0,0),t.targetPosition=null,t.targetZIndex=cc.macro.MAX_ZINDEX,t.speedScale=.3,t}return __extends(t,e),Object.defineProperty(t.prototype,"Back",{get:function(){return this.backNode?this.backNode:this.backNode=this.node.getChildByName("Back")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Front",{get:function(){return this.frontNode?this.frontNode:this.frontNode=this.node.getChildByName("Front")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FrontSprite",{get:function(){return this.frontSprite?this.frontSprite:this.frontSprite=this.Front.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointRoot",{get:function(){return this.pointRoot?this.pointRoot:this.pointRoot=this.node.getChildByName("Point")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TopPointSprite",{get:function(){return this.topPointSp?this.topPointSp:this.PointRoot.getChildByName("Top").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BottomPointSprite",{get:function(){return this.bottomPointSp?this.bottomPointSp:this.PointRoot.getChildByName("Bottom").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Child",{get:function(){return this.PointRoot.getChildByName("Child")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.BindMedaitor(s.default)},Object.defineProperty(t.prototype,"ID",{get:function(){return this.model.ID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Owner",{get:function(){return this.model.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Tag",{get:function(){return this.node.getChildByName("Tag")},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){this.model=e,this.rotateState=i.VerticalNormal,this.FrontSprite.spriteFrame=r.ResourceController.inst.getFrontSprite(c.PlayerModelProxy.inst.Theme,this.rotateState),this.node.rotation=0,this.PointRoot.x=0,this.PointRoot.y=-8.5,this.Front.scaleX=1,this.Front.scaleY=1,this.Child&&this.Child.active&&(this.Child.getChildByName("Top").active=!0,this.Child.getChildByName("Bot").active=!0,this.Child.getChildByName("Left").active=!0,this.Child.getChildByName("Right").active=!0)},t.prototype.unuse=function(){this.node.zIndex=0,this.model=null,this.targetPosition=null},t.prototype.turnVertical=function(e){this.rotateState=e%360==180?i.VerticalReverse:i.VerticalNormal,this.node.runAction(cc.sequence(cc.rotateTo(.1/this.speedScale,e),cc.callFunc(function(){})))},t.prototype.turnHorizontalRight=function(e){this.rotateState=i.HorizontalRight,this.node.runAction(cc.sequence(cc.rotateTo(.1/this.speedScale,e),cc.callFunc(function(){})))},t.prototype.turnHorizontalLeft=function(e){this.rotateState=i.HorizontalLeft,this.node.runAction(cc.sequence(cc.rotateTo(.1/this.speedScale,e),cc.callFunc(function(){})))},t.prototype.setZIndex=function(e){this.node.zIndex!=e&&(this.node.zIndex=e,console.log("ID:",this.ID," update zIndex:",this.node.zIndex),this.onComplete())},t.prototype.setTargetPos=function(e){this.targetPosition=e,this.offsetStep=cc.Vec2.ZERO.clone(),this.offsetStep.x=(this.targetPosition.x-this.node.x)/2,this.offsetStep.y=(this.targetPosition.y-this.node.y)/2},t.prototype.setTargetZIndex=function(e){this.targetZIndex=e},t.prototype.onComplete=function(){0==d.GameStateController.inst.isRoundStart()&&(this.targetPosition=null)},t.prototype.update=function(e){this.model&&this.model.Owner==a.DominoOwner.Desk&&(this.rotateState==i.VerticalNormal?(this.PointRoot.x=0,this.PointRoot.y=-7.8,this.Front.scaleX=1,this.Front.scaleY=1,this.Tag.x=2.4):this.rotateState==i.VerticalReverse?(this.PointRoot.x=0,this.PointRoot.y=-7.8,this.Front.scaleX=1,this.Front.scaleY=-1,this.Tag.x=2.4):this.rotateState==i.HorizontalRight?(this.PointRoot.x=0,this.PointRoot.y=-8.5,this.Front.scaleX=1,this.Front.scaleY=1,this.Tag.x=8):(this.PointRoot.x=0,this.PointRoot.y=-8.5,this.Front.scaleX=-1,this.Front.scaleY=1,this.Tag.x=2.4),this.FrontSprite.spriteFrame=r.ResourceController.inst.getFrontSprite(c.PlayerModelProxy.inst.Theme,this.rotateState),this.targetPosition&&(this.node.x+=this.offsetStep.x*this.speedScale,(this.node.x>this.targetPosition.x&&this.offsetStep.x>0||this.node.x<this.targetPosition.x&&this.offsetStep.x<0)&&(this.node.x=this.targetPosition.x,this.offsetStep.x=0),this.node.y+=this.offsetStep.y*this.speedScale,(this.node.y>this.targetPosition.y&&this.offsetStep.y>0||this.node.y<this.targetPosition.y&&this.offsetStep.y<0)&&(this.node.y=this.targetPosition.y,this.offsetStep.y=0)),(this.targetPosition&&Math.abs(this.node.x-this.targetPosition.x)<=.2&&Math.abs(this.node.y-this.targetPosition.y)<=.2||0==this.offsetStep.x&&0==this.offsetStep.y)&&this.setZIndex(this.targetZIndex)),this.Child&&this.Child.active&&this.model&&this.model.Owner==a.DominoOwner.Desk&&(this.Child.getChildByName("Top").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).TopFree,this.Child.getChildByName("Bot").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).BotFree,this.Child.getChildByName("Left").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).LeftFree,this.Child.getChildByName("Right").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).RightFree,this.Child.getChildByName("First").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).isFirst)},t=__decorate([u],t)}(n.default);o.default=p,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Controller/GameStateController":"GameStateController","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DeskNodeModel":"DeskNodeModel","../../Model/DominoModel":"DominoModel","./DominoDeskTransformMediator":"DominoDeskTransformMediator"}],DominoHighLightMediator:[function(e,t,o){"use strict";cc._RF.push(t,"82971cH0ixPToEOitCszksn","DominoHighLightMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.PlaceDominoDone.inst.addListener(this.onPlaceDominoDone,this),n.UpdateHighLightDomino.inst.addListenerTwo(this.onUpdateHighLightDominos,this),n.PlayerReleasedDomino.inst.addListenerTwo(this.onReleaseDomino,this),n.GameOverSignal.inst.addListener(this.onGameOver,this)},t.prototype.onGameOver=function(){this.View.normal()},t.prototype.onPlaceDominoDone=function(){this.View.normal()},t.prototype.onReleaseDomino=function(e,t){t&&this.View.normal()},t.prototype.onUpdateHighLightDominos=function(e,t){this.View.ID==t?this.View.highLightTarget():e.indexOf(this.View.ID)>=0?this.View.highLight():this.View.normal()},t.prototype.onUnregister=function(){n.PlaceDominoDone.inst.removeTarget(this)},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal"}],DominoHighLightView:[function(e,t,o){"use strict";cc._RF.push(t,"e3f29nHXjFEL7GDdim4pI4P","DominoHighLightView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./DominoHighLightMediator"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"HighLightRoot",{get:function(){return this.node.getChildByName("HighLight")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ConnectionLight",{get:function(){return this.HighLightRoot.getChildByName("Connection")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TargetAnimation",{get:function(){return this.HighLightRoot.getChildByName("Target")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(n.default)},t.prototype.start=function(){},Object.defineProperty(t.prototype,"ID",{get:function(){return this.model?this.model.ID:null},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){this.model=e},t.prototype.unuse=function(){this.model=null},t.prototype.highLight=function(){this.HighLightRoot.active=!0,this.ConnectionLight.active=!0,this.TargetAnimation.active=!1},t.prototype.normal=function(){this.HighLightRoot.active=!1},t.prototype.highLightTarget=function(){this.HighLightRoot.active=!0,this.ConnectionLight.active=!1,this.TargetAnimation.active=!0},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","./DominoHighLightMediator":"DominoHighLightMediator"}],DominoMatchAniMediator:[function(e,t,o){"use strict";cc._RF.push(t,"9624bdvGldD4aaxXfQwC2jz","DominoMatchAniMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Model/DominoModel"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.PlayMatchAnimation.inst.addListenerTwo(this.onMatched,this),n.PlayBothAnimationSignal.inst.addListenerOne(this.onBothPlay,this)},t.prototype.onBothPlay=function(e){e.indexOf(this.View.ID)<0||(this.View.playBot(),this.View.playTop())},t.prototype.onMatched=function(e,t){if(this.View.Model.Owner==s.DominoOwner.Desk&&!(t.indexOf(this.View.ID)<0))switch(this.View.Model.getValPos(e)){case s.DominoPointPos.Bottom:this.View.playBot(!0);break;case s.DominoPointPos.Top:this.View.playTop(!0);break;case s.DominoPointPos.Mid:this.View.playBot(!0),this.View.playTop(!0)}},t.prototype.onUnregister=function(){},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel"}],DominoMatchAniView:[function(e,t,o){"use strict";cc._RF.push(t,"526e05P8PpA7r9HPHT27zsI","DominoMatchAniView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("../../Animation/MatchAnimation"),s=e("../../Controller/ResourceController"),a=e("./DominoMatchAniMediator"),r=e("../../Facade/PlayerModelProxy"),c=e("../../Command/GamePlaySignal"),l=cc._decorator,d=l.ccclass,h=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"AnimationRoot",{get:function(){return this.node.getChildByName("MatchAnimation")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.AnimationRoot.getChildByName("Top")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bot",{get:function(){return this.AnimationRoot.getChildByName("Bot")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TopAni",{get:function(){return this.Top.getComponent(n.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BotAni",{get:function(){return this.Bot.getComponent(n.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.BindMedaitor(a.default)},t.prototype.start=function(){},Object.defineProperty(t.prototype,"ID",{get:function(){return this.model?this.model.ID:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){this.model=e,this.Top.active=!1,this.Bot.active=!1},t.prototype.unuse=function(){this.model=null},t.prototype.playTop=function(e){void 0===e&&(e=!1),this.AnimationRoot.active=!0,this.TopAni.Frames=s.ResourceController.inst.getMatchAtlas(this.model.TopPoint),this.TopAni.play(),e&&r.PlayerModelProxy.inst.isPlayerTurn()&&c.OnPlayMatchAnimation.inst.dispatchTwo(this.Top,this.model.TopPoint)},t.prototype.playBot=function(e){void 0===e&&(e=!1),this.AnimationRoot.active=!0,this.BotAni.Frames=s.ResourceController.inst.getMatchAtlas(this.model.BotPoint),this.BotAni.play(),e&&r.PlayerModelProxy.inst.isPlayerTurn()&&c.OnPlayMatchAnimation.inst.dispatchTwo(this.Bot,this.model.BotPoint)},t=__decorate([d],t)}(i.default));o.default=h,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Animation/MatchAnimation":"MatchAnimation","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","./DominoMatchAniMediator":"DominoMatchAniMediator"}],DominoModel:[function(e,t,o){"use strict";cc._RF.push(t,"d3e67EqEe5AErIO2Y9YhnVa","DominoModel"),Object.defineProperty(o,"__esModule",{value:!0});var i,n,s,a=e("../../Utils/HashMap"),r=e("../Command/GamePlaySignal");(function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"})(i=o.DominoState||(o.DominoState={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Mid=2]="Mid"}(n=o.DominoPointPos||(o.DominoPointPos={})),function(e){e[e.Desk=0]="Desk",e[e.Dispatcher=1]="Dispatcher",e[e.Stack=2]="Stack",e[e.AI=3]="AI",e[e.Player=4]="Player"}(s=o.DominoOwner||(o.DominoOwner={}));var c=function(){function e(t,o,n,a){this.points=[],this.currentPoints=[],this.state=null,this.id="",this.times=1,this.owner=null,this.points=[t,o],this.currentPoints=[t,o],this.id="objectID:"+ ++e.DominoID+" - round:"+n+" - topPoint:"+t+" - botPoint:"+o,this.setState(i.Back),this.setOwner(s.Dispatcher),this.times=a,e.DominoMap.add(this.id,this)}return e.getDominoByID=function(e){return this.DominoMap.get(e)},e.checkCanConnect=function(e,t){return this.getConnectedVal(e,t)>=0},e.getConnectedVal=function(e,t){for(var o=this.getDominoByID(e),i=this.getDominoByID(t),n=o.getCurrentPoints(),s=i.getCurrentPoints(),a=0,r=n;a<r.length;a++){var c=r[a];if(s.indexOf(c)>=0)return c}return-1},Object.defineProperty(e.prototype,"Times",{get:function(){return this.times},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FreePoints",{get:function(){return this.currentPoints},enumerable:!0,configurable:!0}),e.prototype.removePoint=function(e,t){if(void 0===t&&(t=-1),0!=t)for(var o=0,i=0;i<this.currentPoints.length;i++)if(this.currentPoints[i]==e&&(this.currentPoints.splice(i,1),i--,o++),-1!=t&&o>=t)return},e.prototype.getCurrentPoints=function(){return this.currentPoints},Object.defineProperty(e.prototype,"TopPoint",{get:function(){return this.points[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BotPoint",{get:function(){return this.points[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"State",{get:function(){return this.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Owner",{get:function(){return this.owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanConnect",{get:function(){return this.currentPoints.length>0},enumerable:!0,configurable:!0}),e.prototype.isMirror=function(){return this.TopPoint==this.BotPoint},e.prototype.getValPos=function(e){return this.isMirror()?n.Mid:e==this.TopPoint?n.Top:n.Bottom},e.prototype.setState=function(e){this.state!=e&&(this.state=e,r.DominoStateChanged.inst.dispatchTwo(this.state,this.id))},e.prototype.setOwner=function(e){this.owner!=e&&(this.owner=e,r.DominoOwnerChanged.inst.dispatchTwo(this.owner,this.id))},Object.defineProperty(e.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),e.DominoID=0,e.DominoMap=new a.HashMap,e}();o.DominoModel=c,cc._RF.pop()},{"../../Utils/HashMap":"HashMap","../Command/GamePlaySignal":"GamePlaySignal"}],DominoNodePool:[function(e,t,o){"use strict";cc._RF.push(t,"a3d52zjpv9FI4Th92WrFIJg","DominoNodePool"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../Utils/HashMap"),n=e("../../../Utils/Cocos"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}var o;return __extends(t,e),o=t,t.addDomino=function(e,t){0==this.dominoPool.has(e)&&this.dominoPool.add(e,t)},t.removeDomino=function(e){this.dominoPool.has(e)&&this.dominoPool.remove(e)},t.getDomino=function(e){var t=this.dominoPool.get(e);return console.assert(null!=t&&cc.isValid(t,!0)," domino has destory:",e),t},t.getDistance=function(e,t){var o=this.getDomino(e),i=this.getDomino(t),s=i.position;return o.getParent()!==i.getParent()&&(s=n.ConvertToNodeSpaceAR(i,o.parent)),n.Distance(o.position,s)},t.prototype.reuse=function(e){this.model=e,o.addDomino(this.model.ID,this.node)},t.prototype.unuse=function(){this.model&&(o.removeDomino(this.model.ID),this.model=null)},t.dominoPool=new i.HashMap,t=o=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../Utils/HashMap":"HashMap"}],DominoRootMediator:[function(e,t,o){"use strict";cc._RF.push(t,"77577mHRqJLJqmARaKDq06g","DominoRootMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Facade/PlayerModelProxy"),a=e("../../Controller/ResourceController"),r=e("../../Model/DominoModel"),c=(e("../../../Utils/Random"),cc._decorator),l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.ReadyDispatchDominoSignal.inst.addListener(this.onReadyDispatch,this)},t.prototype.onReadyDispatch=function(){var e=s.PlayerModelProxy.inst.getOriginDominoOnNewRound(),t=s.PlayerModelProxy.inst.Round;console.log(" onReady :",t);for(var o=0,i=e;o<i.length;o++){var c=i[o];(M=a.ResourceController.inst.getDomino(c)).name=c.ID,this.View.addDomino(M)}for(var l=s.PlayerModelProxy.inst.getPlayerDominos(),d=s.PlayerModelProxy.inst.getAIDominos(),h=s.PlayerModelProxy.inst.getStackDominos(),u=0,p=l;u<p.length;u++){c=p[u];(M=this.View.getDominoNodeByID(c.ID))&&(n.DispatchPlayerDomino.inst.dispatchTwo(M,c.ID),c.setState(r.DominoState.Front))}for(var g=0,f=0,m=d;f<m.length;f++){c=m[f];(M=this.View.getDominoNodeByID(c.ID))&&(n.DispatchAIDomino.inst.dispatchFour(M,c.ID,++g,.1*g),c.setState(r.DominoState.Back))}g=0;for(var D=0,y=h;D<y.length;D++){c=y[D];var M=this.View.getDominoNodeByID(c.ID);c.setState(r.DominoState.Back),M&&n.DispatchStackDomino.inst.dispatchFour(M,c.ID,++g,.05*g)}},t.prototype.onUnregister=function(){n.ReadyDispatchDominoSignal.inst.removeTarget(this)},t=__decorate([l],t)}(i.default));o.default=d,cc._RF.pop()},{"../../../Utils/Random":"Random","../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DominoModel":"DominoModel"}],DominoRootView:[function(e,t,o){"use strict";cc._RF.push(t,"e23b8FPPtNLrodbpiII6hKL","DominoRootView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./DominoRootMediator"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dispatchRoot=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"DispatchRoot",{get:function(){return this.dispatchRoot?this.dispatchRoot:this.dispatchRoot=this.node.getChildByName("DispatchCardRoot")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},t.prototype.start=function(){},t.prototype.addDomino=function(e){e.setPosition(0,0),e.scale=1,e.rotation=0,this.DispatchRoot.addChild(e)},t.prototype.getDominoNodeByID=function(e){for(var t=0,o=this.DispatchRoot.children;t<o.length;t++){var i=o[t];if(i.name==e)return i}return console.error(" dispatch root has no this domino:",e),null},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","./DominoRootMediator":"DominoRootMediator"}],DominoSelector:[function(e,t,o){"use strict";cc._RF.push(t,"c3aa2s4+CpByqNHaDUTY+q/","DominoSelector"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/ToSingleton"),n=e("../Command/GamePlaySignal"),s=e("../Facade/PlayerModelProxy"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dominoID=null,t}return __extends(t,e),t.prototype.isSelected=function(){return null!==this.dominoID},t.prototype.getCurrentDominoID=function(){return this.dominoID},t.prototype.select=function(e){null!==this.dominoID&&console.warn("already selected ",this.dominoID),console.log("selected domino :",e),this.dominoID=e,n.PlayerSelectedDomino.inst.dispatchOne(e)},t.prototype.free=function(e){if(null!=this.dominoID){var t=s.PlayerModelProxy.inst.checkCanConnect(this.dominoID);console.log("free domino :",this.dominoID,",isCancel:",e,"canConnect:",t),e=e||!t,n.PlayerReleasedDomino.inst.dispatchTwo(this.dominoID,e),this.dominoID=null}else console.warn(" domino already release")},t}(i.SingleTon());o.DominoSelector=a,cc._RF.pop()},{"../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal","../Facade/PlayerModelProxy":"PlayerModelProxy"}],DominoStateMediator:[function(e,t,o){"use strict";cc._RF.push(t,"2328d0bmRxO/Lx2flEDW3B5","DominoStateMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Model/DominoModel"),s=e("../../Command/GamePlaySignal"),a=e("../../Controller/ResourceController"),r=e("../../Controller/GameStateController"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){s.DominoStateChanged.inst.addListenerTwo(this.onStateChanged,this),s.BeforeNextRoundSignal.inst.addListener(this.onNextRound,this),s.RoundEndSignal.inst.addListenerOne(this.onRoundEnd,this)},t.prototype.onRoundEnd=function(e){r.GameOverType.indexOf(e)>=0||this.View.Model.Owner==n.DominoOwner.Desk&&this.node.runAction(cc.sequence(cc.delayTime(1),cc.moveTo(this.View.Model.BotPoint/5.5,3e3,1500),cc.callFunc(function(){})))},t.prototype.onUnregister=function(){},t.prototype.onNextRound=function(){a.ResourceController.inst.putDomino(this.node)},t.prototype.onStateChanged=function(e,t){this.View.ID==t&&this.View.updateState(e)},t=__decorate([l],t)}(i.default));o.default=d,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/GameStateController":"GameStateController","../../Controller/ResourceController":"ResourceController","../../Model/DominoModel":"DominoModel"}],DominoStateView:[function(e,t,o){"use strict";cc._RF.push(t,"87114OMoWlLsoDhH6WqkdyW","DominoStateView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./DominoStateMediator"),s=e("../../Model/DominoModel"),a=e("../../Controller/ResourceController"),r=e("../../Facade/PlayerModelProxy"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.backNode=null,t.frontNode=null,t.pointRoot=null,t.topPointSp=null,t.bottomPointSp=null,t.dominoId="",t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Back",{get:function(){return this.backNode?this.backNode:this.backNode=this.node.getChildByName("Back")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Front",{get:function(){return this.frontNode?this.frontNode:this.frontNode=this.node.getChildByName("Front")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointRoot",{get:function(){return this.pointRoot?this.pointRoot:this.pointRoot=this.node.getChildByName("Point")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TopPointSprite",{get:function(){return this.topPointSp?this.topPointSp:this.PointRoot.getChildByName("Top").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BottomPointSprite",{get:function(){return this.bottomPointSp?this.bottomPointSp:this.PointRoot.getChildByName("Bottom").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Tag",{get:function(){return this.node.getChildByName("Tag")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this.dominoId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},t.prototype.start=function(){},t.prototype.reuse=function(e){for(var t=0,o=this.Tag.children;t<o.length;t++){var i=o[t];i.active=i.name==e.Times.toString()}this.dominoId=e.ID,this.model=e,this.TopPointSprite.spriteFrame=a.ResourceController.inst.getPointSprite(r.PlayerModelProxy.inst.Theme,e.TopPoint),this.BottomPointSprite.spriteFrame=a.ResourceController.inst.getPointSprite(r.PlayerModelProxy.inst.Theme,e.BotPoint),this.updateState(e.State)},t.prototype.unuse=function(){this.node.scale=1,this.dominoId="",this.model=null},t.prototype.updateState=function(e){e==s.DominoState.Back?this.turnBack():this.turnFront()},t.prototype.turnBack=function(){this.Back.active=!0,this.Front.active=!1,this.PointRoot.active=!1,this.Tag.active=!1},t.prototype.turnFront=function(){this.Back.active=!1,this.Front.active=!0,this.PointRoot.active=!0,this.Tag.active=!0},t.prototype.update=function(e){},t=__decorate([l],t)}(i.default));o.default=d,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DominoModel":"DominoModel","./DominoStateMediator":"DominoStateMediator"}],DominoTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"3fb25pDlgRALqJT87WTHhz1","DominoTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/SingleTouchMediator"),n=e("../../Controller/GameStateController"),s=e("../../Controller/DominoSelector"),a=e("../../Model/DominoModel"),r=e("../../Command/GamePlaySignal"),c=e("../../Facade/PlayerModelProxy"),l=e("./DominoNodePool"),d=e("../../../Utils/Cocos"),h=e("../../Model/DeskNodeModel"),u=cc._decorator,p=u.ccclass,g=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),r.PlayerSelectedDomino.inst.addListenerOne(this.onSelected,this),r.PlayerReleasedDomino.inst.addListenerTwo(this.onReleased,this),r.AISelectedDomino.inst.addListenerTwo(this.onAiSeleced,this),r.GameOverSignal.inst.addListener(this.onGameOver,this)},t.prototype.onUnregister=function(){e.prototype.onUnregister.call(this)},t.prototype.onGameOver=function(){this.View.onRelease()},t.prototype.onAiSeleced=function(e,t){if(this.View.ID==e){var o;"root"!=t&&(o=l.default.getDomino(t));var i="root"==t?h.DeskNodeModel.Root:h.DeskNodeModel.getDeskNodeByDominoID(t);if(i&&(o||"root"===t)){var n=this.node.getParent().getParent(),s=d.ConvertToNodeSpaceAR(this.node,n);console.log(n.name,s),this.node.setParent(n),this.node.setPosition(s);var a=cc.v2(0,0);if("root"!=t){var c=o.position;o.setPosition(i.Position),a=d.ConvertToNodeSpaceAR(o,n),o.setPosition(c)}this.View.onAiSelected(a,function(){console.log("ai moved done"),r.AIReleaseDomino.inst.dispatchTwo(e,t)})}}},t.prototype.onSelected=function(e){this.View.ID!=e?this.View.onRelease():this.View.onSelected()},t.prototype.onReleased=function(e,t){this.View.ID==e?t&&this.View.onRelease():this.View.onRelease()},t.prototype.onTouchStart=function(e){0!=n.GameStateController.inst.isRoundStart()?0!=c.PlayerModelProxy.inst.isPlayerTurn()?[a.DominoOwner.Player,a.DominoOwner.Stack].indexOf(this.View.Owner)<0?console.log("touch start , domino owner is not Player or Stack:",this.View.ID,", current owner:",a.DominoOwner[this.View.Owner]):s.DominoSelector.inst.isSelected()?console.log("touch start  has selected a domino:",s.DominoSelector.inst.getCurrentDominoID()):0!=this.View.isDispatchDone()?this.View.Owner==a.DominoOwner.Player?s.DominoSelector.inst.select(this.View.ID):this.drawDomino():console.log(" touch start , not readr:",this.View.ID):console.log(" AI turn"):console.log("touch start round not start now:",this.View.ID)},t.prototype.drawDomino=function(){c.PlayerModelProxy.inst.checkCanPlace()?r.CloseDominoBagSignal.inst.dispatch():(c.PlayerModelProxy.inst.drawDomino(this.View.ID,a.DominoOwner.Player),r.DispatchPlayerDomino.inst.dispatchThree(this.node,this.View.ID,!0))},t.prototype.onTouchMove=function(e){0!=n.GameStateController.inst.isRoundStart()&&0!=c.PlayerModelProxy.inst.isPlayerTurn()&&([a.DominoOwner.Player,a.DominoOwner.Stack].indexOf(this.View.Owner)<0||0!=s.DominoSelector.inst.isSelected()&&s.DominoSelector.inst.getCurrentDominoID()===this.View.ID&&(0!=this.View.isDispatchDone()?this.View.Owner==a.DominoOwner.Player&&(this.View.onDrag(e.getDelta()),r.MoveDomino.inst.dispatchOne(this.View.ID)):console.log(" touch move , not readr:",this.View.ID)))},t.prototype.onTouchEnd=function(e){0!=n.GameStateController.inst.isRoundStart()&&0!=c.PlayerModelProxy.inst.isPlayerTurn()&&([a.DominoOwner.Player,a.DominoOwner.Stack].indexOf(this.View.Owner)<0||s.DominoSelector.inst.isSelected()&&s.DominoSelector.inst.getCurrentDominoID()!==this.View.ID||(0!=this.View.isDispatchDone()?this.View.Owner==a.DominoOwner.Player&&s.DominoSelector.inst.free(this.checkIsCancel()):console.log(" touch emd , not readr:",this.View.ID)))},t.prototype.onTouchCancel=function(e){0!=n.GameStateController.inst.isRoundStart()&&0!=c.PlayerModelProxy.inst.isPlayerTurn()&&([a.DominoOwner.Player,a.DominoOwner.Stack].indexOf(this.View.Owner)<0||s.DominoSelector.inst.isSelected()&&s.DominoSelector.inst.getCurrentDominoID()!==this.View.ID||(0!=this.View.isDispatchDone()?this.View.Owner==a.DominoOwner.Player&&s.DominoSelector.inst.free(this.checkIsCancel()):console.log(" touch emd , not readr:",this.View.ID)))},t.prototype.checkIsCancel=function(){return this.View.MoveDistance<=300||this.View.Pos.y<=200},t=__decorate([p],t)}(i.default));o.default=g,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/SingleTouchMediator":"SingleTouchMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/DominoSelector":"DominoSelector","../../Controller/GameStateController":"GameStateController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DeskNodeModel":"DeskNodeModel","../../Model/DominoModel":"DominoModel","./DominoNodePool":"DominoNodePool"}],DominoTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"f755dkIaNJJOqsleXgF2v47","DominoTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../Model/DominoModel"),s=e("../../../View/BaseView"),a=e("./DominoTouchMediator"),r=e("../../Command/GamePlaySignal"),c=e("../../../Utils/Cocos"),l=cc._decorator,d=l.ccclass;l.property;(function(e){e[e.None=0]="None",e[e.Selected=1]="Selected",e[e.Drag=2]="Drag",e[e.Release=3]="Release"})(i||(i={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultPosition=cc.v2(0,0),t.targetPosition=null,t.targetScale=0,t.touchState=null,t.dispatchDone=!0,t.zIndex=0,t.selectOffset=200,t.aiMovedDoneCallback=null,t.scaleStep=0,t.offsetStep=cc.v2(0,0),t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.BindMedaitor(a.default),r.DispatchDoneSignal.inst.addListenerOne(this.onDispatchDone,this),r.UpdateDominoArrayPos.inst.addListenerTwo(this.onUpdatePos,this),r.DispatchPlayerDomino.inst.addListenerTwo(this.startDispatch,this),r.DispatchAIDomino.inst.addListenerTwo(this.startDispatch,this)},t.prototype.startDispatch=function(e,t){this.ID==t&&(this.dispatchDone=!1)},t.prototype.onUpdatePos=function(e,t){this.ID==e&&(this.defaultPosition=t,this.Owner==n.DominoOwner.Player&&this.State==i.Release&&(this.targetPosition=this.defaultPosition.clone()))},t.prototype.onDispatchDone=function(e){this.ID==e&&(this.defaultPosition=this.node.position.clone(),this.targetScale=this.node.scale,this.dispatchDone=!0,this.zIndex=this.node.zIndex)},t.prototype.isDispatchDone=function(){return this.dispatchDone},t.prototype.start=function(){},t.prototype.unuse=function(){this.zIndex=this.node.zIndex=0,this.model=null,this.dispatchDone=!1,this.aiMovedDoneCallback=null},Object.defineProperty(t.prototype,"Pos",{get:function(){return this.node.position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MoveDistance",{get:function(){return c.Distance(this.node.position,this.defaultPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this.model.ID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Owner",{get:function(){return this.model.Owner},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e){this.model=e,this.node.zIndex=this.zIndex,this.State=i.Release,this.targetPosition=null,this.targetScale=1},Object.defineProperty(t.prototype,"State",{get:function(){return this.touchState},set:function(e){this.touchState!=e&&(this.touchState=e)},enumerable:!0,configurable:!0}),t.prototype.onAiSelected=function(e,t){this.targetPosition=e,this.targetScale=1/this.node.parent.scale*1.5,this.node.group="Effect",this.aiMovedDoneCallback=t,this.updateStep()},t.prototype.onSelected=function(){this.Owner==n.DominoOwner.Player&&this.State==i.Release&&(this.node.zIndex=cc.macro.MAX_ZINDEX,this.State=i.Selected,this.targetPosition=this.defaultPosition.add(cc.v2(0,this.selectOffset)),this.targetScale=1/this.node.parent.scale*1.5,console.log("on Selected :",this.targetScale),this.node.group="Effect",this.updateStep())},t.prototype.onDrag=function(e){e.mulSelf(1/this.node.parent.scale),this.Owner==n.DominoOwner.Player&&(this.State=i.Drag,this.targetScale=1/this.node.parent.scale*1.5,this.node.zIndex=cc.macro.MAX_ZINDEX,this.targetPosition.addSelf(e),this.node.group="Effect",this.updateStep(!0))},t.prototype.onRelease=function(){this.Owner==n.DominoOwner.Player&&(this.node.zIndex=this.zIndex,this.State=i.Release,this.targetPosition=this.defaultPosition.clone(),this.targetScale=1,this.node.group="default",this.updateStep())},t.prototype.updateStep=function(e){void 0===e&&(e=!1),e?(this.offsetStep.x=this.targetPosition.x-this.node.x,this.offsetStep.y=this.targetPosition.y-this.node.y):(this.offsetStep.x=(this.targetPosition.x-this.node.x)/10,this.offsetStep.y=(this.targetPosition.y-this.node.y)/10),this.scaleStep=(this.targetScale-this.node.scale)/5},t.prototype.update=function(e){if(this.model&&this.dispatchDone&&(this.model.Owner==n.DominoOwner.AI||this.model.Owner==n.DominoOwner.Player)){this.node.scale+=this.scaleStep,(this.node.scale>this.targetScale&&this.scaleStep>0||this.node.scale<this.targetScale&&this.scaleStep<0)&&(this.node.scale=this.targetScale,this.scaleStep=0);var t=Math.abs(Math.floor(10*this.node.scale)-Math.floor(10*this.targetScale))<=.01||0==this.scaleStep;this.targetPosition&&(this.node.x+=this.offsetStep.x,(this.node.x>this.targetPosition.x&&this.offsetStep.x>0||this.node.x<this.targetPosition.x&&this.offsetStep.x<0)&&(this.node.x=this.targetPosition.x,this.offsetStep.x=0),this.node.y+=this.offsetStep.y,(this.node.y>this.targetPosition.y&&this.offsetStep.y>0||this.node.y<this.targetPosition.y&&this.offsetStep.y<0)&&(this.node.y=this.targetPosition.y,this.offsetStep.y=0)),this.targetPosition&&(Math.abs(Math.ceil(this.node.y)-Math.ceil(this.targetPosition.y))<=.2&&Math.abs(Math.ceil(this.node.x)-Math.ceil(this.targetPosition.x))<=.2||0==this.offsetStep.y&&0==this.offsetStep.x)&&t&&this.model.Owner==n.DominoOwner.AI&&this.aiMovedDoneCallback&&(this.aiMovedDoneCallback(),this.aiMovedDoneCallback=null)}},t=__decorate([d],t)}(s.default);o.default=h,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./DominoTouchMediator":"DominoTouchMediator"}],DominoTransform:[function(e,t,o){"use strict";cc._RF.push(t,"d666dq6FoJK04sE4uMdROa1","DominoTransform"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../DeskCheckModel"),s=e("../../../Global/Desk");(function(e){e[e.AnticlockWise=0]="AnticlockWise",e[e.ClockWise=1]="ClockWise"})(i=o.Direction||(o.Direction={}));var a=function(){function e(){}return e.Vertical_To_Horizontal_Pos_Bottom=function(e,t,o,a,r,c){e.setAllFree(),o?e.BotFree=!1:e.TopFree=!1;var l={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},d=!1,h=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,u=e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y;if(u||c){l.bot=n.DeskCheckModel.Padding.bot+h;var p=(l.top+l.bot)*n.DeskCheckModel.RootScale;(p>=s.DeskMaxSize.height&&s.DeskMaxSize.height*n.DeskCheckModel.RootScale/p<s.DeskScaleRange.Mid||c)&&(d=!0,a==i.AnticlockWise?(e.Rotation=o?90:-90,e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.width/2):(e.Rotation=o?-90:90,e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.width/2),r&&t.Rotation%180!=0?e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.width:e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.height/2-n.DeskCheckModel.DOMINO_SIZE.width/2,h=n.DeskCheckModel.DOMINO_SIZE.width/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,u=e.y-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,l.bot=n.DeskCheckModel.Padding.bot+h,p=(l.top+l.bot)*n.DeskCheckModel.RootScale)}u&&(n.DeskCheckModel.Padding.bot+=h),d&&(a==i.AnticlockWise?e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)):e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x))},e.Vertical_To_Horizontal_Pos_Top=function(e,t,o,a,r,c){e.setAllFree(),o?e.TopFree=!1:e.BotFree=!1;var l={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},d=!1,h=e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y,u=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y);if(h||c){l.top=n.DeskCheckModel.Padding.top+u;var p=(l.top+l.bot)*n.DeskCheckModel.RootScale;(p>=s.DeskMaxSize.height&&s.DeskMaxSize.height*n.DeskCheckModel.RootScale/p<s.DeskScaleRange.Mid||c)&&(d=!0,a==i.AnticlockWise?(e.Rotation=o?90:-90,e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.width/2):(e.Rotation=o?-90:90,e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.width/2),r&&t.Rotation%180!=0?e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.width:e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.height/2+n.DeskCheckModel.DOMINO_SIZE.width/2,u=n.DeskCheckModel.DOMINO_SIZE.width/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y),h=e.y+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y,l.top=n.DeskCheckModel.Padding.top+u,p=(l.top+l.bot)*n.DeskCheckModel.RootScale)}h&&(n.DeskCheckModel.Padding.top+=u),d&&(a==i.AnticlockWise?e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x):e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)))},e.Horizontal_To_Vertical_Pos_Left=function(e,t,o,a,r,c){e.setAllFree(),o?e.BotFree=!1:e.TopFree=!1;var l={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},d=!1,h=e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,u=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x;if(h||c){l.left=n.DeskCheckModel.Padding.left+u;var p=(l.left+l.right)*n.DeskCheckModel.RootScale;(p>=s.DeskMaxSize.width&&s.DeskMaxSize.width*n.DeskCheckModel.RootScale/p<s.DeskScaleRange.Mid||c)&&(d=!0,a==i.AnticlockWise?(e.Rotation=o?180:0,e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.width/2):(e.Rotation=o?0:180,e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.width/2),r&&t.Rotation%180==0?e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.width:e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.height/2-n.DeskCheckModel.DOMINO_SIZE.width/2,u=n.DeskCheckModel.DOMINO_SIZE.width/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,h=e.x-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,l.left=n.DeskCheckModel.Padding.left+u,p=(l.left+l.right)*n.DeskCheckModel.RootScale)}h&&(n.DeskCheckModel.Padding.left+=u),d&&(a==i.ClockWise?e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)):e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y))},e.Horizontal_To_Vertical_Pos_Right=function(e,t,o,a,r,c){e.setAllFree(),o?e.TopFree=!1:e.BotFree=!1;var l={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},d=!1,h=e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x,u=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x);if(h||c){l.right=n.DeskCheckModel.Padding.right+u;var p=(l.left+l.right)*n.DeskCheckModel.RootScale;(p>=s.DeskMaxSize.width&&s.DeskMaxSize.width*n.DeskCheckModel.RootScale/p<s.DeskScaleRange.Mid||c)&&(d=!0,a==i.AnticlockWise?(e.Rotation=o?180:0,e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.width/2):(e.Rotation=o?0:180,e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.width/2),r&&t.Rotation%180==0?e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.width:e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.height/2+n.DeskCheckModel.DOMINO_SIZE.width/2,u=n.DeskCheckModel.DOMINO_SIZE.width/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x),h=e.x+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x,l.right=n.DeskCheckModel.Padding.right+u,p=(l.left+l.right)*n.DeskCheckModel.RootScale)}h&&(n.DeskCheckModel.Padding.right+=u),d&&(a==i.ClockWise?e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y):e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)))},e.Mirror_Horizontal_To_Vertical_Pos_Top=function(e,t,o,a){e.setAllFree();var r={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},c=!1,l=e.y+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y,d=n.DeskCheckModel.DOMINO_SIZE.width/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y);if(l||a){r.top=n.DeskCheckModel.Padding.top+d;var h=(r.top+r.bot)*n.DeskCheckModel.RootScale;(h>=s.DeskMaxSize.height&&s.DeskMaxSize.height*n.DeskCheckModel.RootScale/h<s.DeskScaleRange.Mid||a)&&(c=!0,o==i.AnticlockWise?(e.Rotation=0,e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.width):(e.Rotation=180,e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.width),e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.height/4,d=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y),l=e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y,r.top=n.DeskCheckModel.Padding.top+d,h=(r.top+r.bot)*n.DeskCheckModel.RootScale)}l&&(n.DeskCheckModel.Padding.top+=d),c?o==i.AnticlockWise?(e.x-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.width/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x),e.RightFree=!1):(e.x+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.width/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)),e.RightFree=!1):(e.x>=0&&e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)),e.x<=0&&e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x),90==e.Rotation?e.RightFree=!1:e.LeftFree=!1)},e.Mirror_Horizontal_To_Vertical_Pos_Bottom=function(e,t,o,a){e.setAllFree();var r={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},c=!1,l=e.y-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,d=n.DeskCheckModel.DOMINO_SIZE.width/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y;if(l||a){r.bot=n.DeskCheckModel.Padding.bot+d;var h=(r.top+r.bot)*n.DeskCheckModel.RootScale;(h>=s.DeskMaxSize.height&&s.DeskMaxSize.height*n.DeskCheckModel.RootScale/h<s.DeskScaleRange.Mid||a)&&(c=!0,o==i.AnticlockWise?(e.Rotation=180,e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.width):(e.Rotation=0,e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.width),e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.height/4,d=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,l=e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,r.bot=n.DeskCheckModel.Padding.bot+d,h=(r.top+r.bot)*n.DeskCheckModel.RootScale)}l&&(n.DeskCheckModel.Padding.bot+=d),c?o==i.AnticlockWise?(e.x+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.width/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)),e.RightFree=!1):(e.x-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.width/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x),e.RightFree=!1):(e.x>=0&&e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)),e.x<=0&&e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x),90==e.Rotation?e.LeftFree=!1:e.RightFree=!1)},e.Mirror_Vertical_To_Horizontal_Pos_Right=function(e,t,o,a){e.setAllFree();var r={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},c=!1,l=e.x+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x,d=n.DeskCheckModel.DOMINO_SIZE.width/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x);if(l||a){r.right=n.DeskCheckModel.Padding.right+d;var h=(r.left+r.right)*n.DeskCheckModel.RootScale;(h>=s.DeskMaxSize.width&&s.DeskMaxSize.width*n.DeskCheckModel.RootScale/h<s.DeskScaleRange.Mid||a)&&(c=!0,o==i.AnticlockWise?(e.Rotation=-90,e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.width):(e.Rotation=90,e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.width),e.x=t.x+n.DeskCheckModel.DOMINO_SIZE.height/4,d=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x),l=e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x,r.right=n.DeskCheckModel.Padding.right+d,h=(r.left+r.right)*n.DeskCheckModel.RootScale)}l&&(n.DeskCheckModel.Padding.right+=d),c?o==i.ClockWise?(e.y-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.width/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y),e.LeftFree=!1):(e.y>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.width/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)),e.LeftFree=!1):(e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)),e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y),0==e.Rotation?e.LeftFree=!1:e.RightFree=!1)},e.Mirror_Vertical_To_Horizontal_Pos_Left=function(e,t,o,a){e.setAllFree();var r={top:n.DeskCheckModel.Padding.top,bot:n.DeskCheckModel.Padding.bot,left:n.DeskCheckModel.Padding.left,right:n.DeskCheckModel.Padding.right},c=!1,l=e.x-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,d=n.DeskCheckModel.DOMINO_SIZE.width/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x;if(l||a){r.left=n.DeskCheckModel.Padding.left+d;var h=(r.left+r.right)*n.DeskCheckModel.RootScale;(h>=s.DeskMaxSize.width&&s.DeskMaxSize.width*n.DeskCheckModel.RootScale/h<s.DeskScaleRange.Mid||a)&&(c=!0,o==i.AnticlockWise?(e.y=t.y-n.DeskCheckModel.DOMINO_SIZE.width,e.Rotation=-90):(e.Rotation=90,e.y=t.y+n.DeskCheckModel.DOMINO_SIZE.width),e.x=t.x-n.DeskCheckModel.DOMINO_SIZE.height/4,d=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,l=e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,r.left=n.DeskCheckModel.Padding.left+d,h=(r.left+r.right)*n.DeskCheckModel.RootScale)}l&&(n.DeskCheckModel.Padding.left+=d),c?o==i.ClockWise?(e.y+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.width/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)),e.RightFree=!1):(e.y-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.width/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y),e.RightFree=!1):(e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)),e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y),0==e.Rotation?e.RightFree=!1:e.LeftFree=!1)},e.Pos_Top=function(e,t){e.setAllFree();var o=e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y,i=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y);if(e.isMirror())switch(e.Rotation){case 0:e.BotFree=!1;break;case 180:e.TopFree=!1;break;case 90:case-90:90==e.Rotation?e.RightFree=!1:e.LeftFree=!1,o=e.y+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y,i=n.DeskCheckModel.DOMINO_SIZE.width/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y),e.x>=0&&e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)),e.x<=0&&e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x)}else 180==e.Rotation?e.TopFree=!1:e.BotFree=!1;o&&(n.DeskCheckModel.Padding.top+=i)},e.Pos_Bot=function(e,t){var o=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,i=e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y;if(e.setAllFree(),e.isMirror())switch(e.Rotation){case 0:e.TopFree=!1;break;case 180:e.BotFree=!1;break;case 90:case-90:90==e.Rotation?e.LeftFree=!1:e.RightFree=!1,i=e.y-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,o=n.DeskCheckModel.DOMINO_SIZE.width/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y,e.x>=0&&e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.right+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x)),e.x<=0&&e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x&&(n.DeskCheckModel.Padding.left+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x)}else 0==e.Rotation?e.TopFree=!1:e.BotFree=!1;i&&(n.DeskCheckModel.Padding.bot+=o)},e.Pos_Left=function(e,t){var o=e.x-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,i=n.DeskCheckModel.DOMINO_SIZE.height/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x;if(e.setAllFree(),e.isMirror())switch(e.Rotation){case 0:case 180:o=e.x-n.DeskCheckModel.DOMINO_SIZE.width/2<=-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,i=n.DeskCheckModel.DOMINO_SIZE.width/2-e.x-n.DeskCheckModel.Padding.left-n.DeskCheckModel.Padding.position.x,e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)),e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y),0==e.Rotation?e.RightFree=!1:e.LeftFree=!1;break;case 90:e.TopFree=!1;break;case-90:e.BotFree=!1}else 90==e.Rotation?e.TopFree=!1:e.BotFree=!1;o&&(n.DeskCheckModel.Padding.left+=i)},e.Pos_Right=function(e,t){var o=e.x+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x,i=n.DeskCheckModel.DOMINO_SIZE.height/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x);if(e.setAllFree(),e.isMirror())switch(e.Rotation){case 0:case 180:o=e.x+n.DeskCheckModel.DOMINO_SIZE.width/2>=n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x,i=n.DeskCheckModel.DOMINO_SIZE.width/2+e.x-(n.DeskCheckModel.Padding.right-n.DeskCheckModel.Padding.position.x),e.y+n.DeskCheckModel.DOMINO_SIZE.height/2>=n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.top+=n.DeskCheckModel.DOMINO_SIZE.height/2+e.y-(n.DeskCheckModel.Padding.top-n.DeskCheckModel.Padding.position.y)),e.y-n.DeskCheckModel.DOMINO_SIZE.height/2<=-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y&&(n.DeskCheckModel.Padding.bot+=n.DeskCheckModel.DOMINO_SIZE.height/2-e.y-n.DeskCheckModel.Padding.bot-n.DeskCheckModel.Padding.position.y),0==e.Rotation?e.LeftFree=!1:e.RightFree=!1;break;case 90:e.BotFree=!1;break;case-90:e.TopFree=!1}else-90==e.Rotation?e.TopFree=!1:e.BotFree=!1;o&&(n.DeskCheckModel.Padding.right+=i)},e}();o.DominoTransform=a,cc._RF.pop()},{"../../../Global/Desk":"Desk","../DeskCheckModel":"DeskCheckModel"}],FacadeGlobal:[function(e,t,o){"use strict";cc._RF.push(t,"c46cfDkM7pInYAeGAk610m1","FacadeGlobal"),cc._RF.pop()},{}],FrameAniBase:[function(e,t,o){"use strict";cc._RF.push(t,"6298cJI+OZK9J9ZyfrpqPP2","FrameAniBase"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,s=i.property,a=i.executeInEditMode,r=i.requireComponent,c=i.playOnFocus,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Frames=null,t.Interval=.1,t.Priority=0,t.Loop=!1,t.PlayOnLoad=!1,t.currentIndex=0,t.time=0,t.isPlay=!1,t.listener=[],t.complateEvent=[],t}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{set:function(e){this.Frames=e},enumerable:!0,configurable:!0}),t.prototype.onFocusInEditor=function(){},t.prototype.onLostFocusInEditor=function(){clearInterval(o.intervalID)},t.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},t.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,0==this.isPlaying&&this.callEventComplete()},t.prototype.playOnLoop=function(){this.Loop=!0,this.play()},t.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},t.prototype.pause=function(){this.isPlay=!1},t.prototype.resume=function(){this.isPlay=!0},t.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex],this.Loop=!1},t.prototype.onKeyFrame=function(e){},t.prototype.addKeyEventListener=function(e,t){this.listener.push({callback:e,target:t})},Object.defineProperty(t.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),t.prototype.clearAllListener=function(){return this.listener.length=0,this},t.prototype.onComplete=function(){},t.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var e=0,t=this.listener;e<t.length;e++){var o=t[e];o.callback.apply(o.target,[this.currentIndex,this.__classname__])}},t.prototype.callEventComplete=function(){this.onComplete();for(var e=0,t=this.complateEvent;e<t.length;e++){var o=t[e];o.f.apply(o.target,[this.__classname__])}},t.prototype.addCompleteEvent=function(e,t){this.complateEvent.push({f:e,target:t})},Object.defineProperty(t.prototype,"TotalFrameCount",{get:function(){return this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),t.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},t.prototype.start=function(){},Object.defineProperty(t.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var e=0,t=this.getComponents(o);e<t.length;e++){var i=t[e];if(i.Priority>this.Priority&&i.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex],this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.Frames.getSpriteFrames().length,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},t.prototype.update=function(e){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=e},t.aniName="FrameAniBase",t.intervalID=-1,__decorate([s(cc.SpriteAtlas)],t.prototype,"Frames",void 0),__decorate([s],t.prototype,"Interval",void 0),__decorate([s],t.prototype,"Priority",void 0),__decorate([s],t.prototype,"Loop",void 0),__decorate([s],t.prototype,"PlayOnLoad",void 0),t=o=__decorate([n,a,c,r(cc.Sprite)],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],GameFactory:[function(e,t,o){"use strict";cc._RF.push(t,"93d23kfnY1A76OtZSkIyJ5r","GameFactory"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Utils/HashMap"),n=function(){function e(e,t,o){this._pool=[],this.totalSize=0,this.initTime=[],this.completeHandler=o,this.template=e,this.totalSize=t,this.hashKey="ObjPool:"+this.template.name+" - "+this.totalSize,this.initPool(t)}return e.prototype.initPool=function(e,t){var o=this;if(void 0===t&&(t=!1),t)for(var i=0;i<e;++i){this.initTime.push(Date.now());var n=cc.instantiate(this.template);this.put(n)}else for(i=0;i<e;++i)this.initTime.push(Date.now()),setTimeout(function(){var e=cc.instantiate(o.template);o.put(e)},i)},e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy&&this._pool[t].destroy();this._pool.length=0},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){e.removeFromParent(!1);for(var t=0,o=e.getComponents(cc.Component);t<o.length;t++){var i=o[t];i&&i.unuse&&i.unuse.apply(i)}this._pool.push(e),this.completeHandler&&this.totalSize<=this._pool.length&&(this.completeHandler(),this.completeHandler=null)}},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this._pool.length-1;o<0&&(console.warn(" last < 0 "),this.initPool(1,!0)),o=this._pool.length-1;var i=this._pool[o];this._pool.length=o;for(var n=0,s=i.getComponents(cc.Component);n<s.length;n++){var a=s[n];a&&a.reuse&&a.reuse.apply(a,arguments)}return i},e}(),s=function(){function e(){this.count=0,this.totalCount=0,this.objPool=new i.HashMap,this.startTime=0}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;this.doneCallback=e,this.startTime=Date.now(),cc.loader.loadResDir("prefabs/",cc.Prefab,function(e,o,i){if(e)console.error(" Game Factory init failed:",e);else{t.totalCount=o.length;for(var s=function(e){var i=o[e],s=i.name.split("."),a=s[0],r=s[1]?parseInt(s[1]):30;console.log(" init pool:",a,", count:",r),setTimeout(function(){var e=new n(i,r,t.addCount.bind(t));t.objPool.add(a,e)},10*e)},a=0;a<o.length;a++)s(a)}})},e.prototype.addCount=function(){this.count++,this.count>=this.totalCount&&(console.log(" factory cost time:",(Date.now()-this.startTime).toFixed(2)+"ms"),this.doneCallback&&(this.doneCallback(),this.doneCallback=null))},e.prototype.getObj=function(e){for(var t,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return this.objPool.has(e)?(t=this.objPool.get(e)).get.apply(t,o):(console.error(" objPool dosen't exists this obj:",e),null)},e.prototype.putObj=function(e,t){if(this.objPool.has(e))return this.objPool.get(e).put(t);console.error(" objPool dosen't exists this obj:",e)},e}();o.gFactory=s.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],GamePlayModel:[function(e,t,o){"use strict";cc._RF.push(t,"44c14BLbudFBKuHzjUsVsV9","GamePlayModel"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Global/Theme"),n=e("../../Global/Level"),s=e("../../Utils/Random"),a=e("../../Initialization/Command/InitSignal"),r=e("./GameRule"),c=e("../../Utils/HashMap"),l=e("./RoundModel"),d=e("./DominoModel"),h=e("../Command/GamePlaySignal"),u=e("../../Global/Desk"),p=e("./DeskCheckModel"),g=function(){function e(){this.matchCount=new c.HashMap,this.totalMatchCount={AI:0,Player:0},this.round=0,this.roundCreated=0,this.level=0,this.playerScore=0,this.noviceScore=0,this.gameTime=r.TotalTime,this.forkDominoID=null,this.pauseCount=0,this.pauseScore=0,this.roundCache=new c.HashMap,this.currentRound=null,this.dominoPlacedCache=new c.HashMap,this.init()}return e.prototype.addDominoPlacedCache=function(e){0==this.dominoPlacedCache.has(this.round)&&this.dominoPlacedCache.add(this.round,[]);var t=e.split("-"),o=t[2].split(":")[1]+": "+t[3].split(":")[1];this.dominoPlacedCache.get(this.round).push(o);for(var i=[],n=0,s=this.dominoPlacedCache.get(this.round);n<s.length;n++){var a=s[n];i.push(a)}console.log("\u51fa\u724c\u987a\u5e8f\uff1a",i)},e.prototype.init=function(){},Object.defineProperty(e.prototype,"Time",{get:function(){return this.gameTime},set:function(e){this.gameTime=e,this.gameTime=Math.max(0,this.gameTime)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return this.theme},set:function(e){console.log("set game theme:",i.Theme[e]),this.theme=e,a.GameThemeInit.inst.dispatchOne(this.theme)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this.level},set:function(e){console.log("set game Level:",e),this.level=e},enumerable:!0,configurable:!0}),e.prototype.addMatchCount=function(){null==this.matchCount.get(this.round)&&this.matchCount.add(this.round,{AI:0,Player:0}),this.turn==r.Turn.AI?(this.matchCount.get(this.round).AI++,this.totalMatchCount.AI++):(this.matchCount.get(this.round).Player++,this.totalMatchCount.Player++)},e.prototype.getTotalMatchCount=function(){return this.totalMatchCount},e.prototype.getCurrentMatchCount=function(){return this.matchCount.get(this.round)},Object.defineProperty(e.prototype,"Round",{get:function(){return this.round},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RoundData",{get:function(){return this.currentRound},enumerable:!0,configurable:!0}),e.prototype.initGametheme=function(){var e=n.Level.getThemeRandomPool(this.Level);this.Theme=e[Math.floor(s.Random.getRandom()*e.length)]},e.prototype.createRoundData=function(e){var t;void 0===e&&(e=6),console.log(" -- initRoundData : ",e);n.Level.getDominoCountInRound(this.level);for(var o=n.Level.getDominoCountInHand(this.level),i=n.Level.getPointRandomPool(this.level),a=0;a<e;++a){this.roundCreated++;for(var c=[],h=[],u=[],p=[],g=[],f=0;f<r.TotalCount;f++)g.push(f);for(var m=[],D=[],y=Math.round(r.TotalCount*r.DoubleRate),M=Math.round(r.TotalCount*r.ThribleRate);y-- >0;){var P=Math.floor(s.Random.getRandom()*g.length);m.push(g[P]),g.splice(P,1)}for(;M-- >0;){P=Math.floor(s.Random.getRandom()*g.length);D.push(g[P]),g.splice(P,1)}for(var k=0,C=0;C<i.length;C++)for(var S=C;S<i.length;S++){var _=1;m.indexOf(k)>=0?_=2:D.indexOf(k)>=0&&(_=3),p.push(new d.DominoModel(i[C],i[S],this.roundCreated,_)),k++}for(P=0;P<p.length;P++){var I=Math.floor(s.Random.getRandom()*p.length);t=[p[I],p[P]],p[P]=t[0],p[I]=t[1]}for(;h.length<o;)h.push(p.pop());for(;c.length<o;)c.push(p.pop());for(;p.length>0;)u.push(p.pop());this.roundCache.add(this.roundCreated,new l.RoundModel(h,c,u,this.roundCreated))}console.log(this.roundCache.values),console.log(" -- has create ",this.roundCreated," data.")},Object.defineProperty(e.prototype,"ForkDominoID",{get:function(){return this.forkDominoID},set:function(e){null===this.forkDominoID||this.forkDominoID==e?this.forkDominoID=e:console.error("forkDominoID != dominoID",this.forkDominoID,e)},enumerable:!0,configurable:!0}),e.prototype.nextRound=function(){this.round++,this.roundCache.has(this.round)||this.createRoundData(),this.currentRound=this.roundCache.get(this.round),console.assert(null!=this.currentRound," round data is null"),this.turn=this.round%2?r.Turn.Player:r.Turn.AI,h.PlayTurnChanged.inst.dispatchOne(this.turn),console.log(" \u7b2c",this.round+" \u56de\u5408, \u8d77\u624b:",r.Turn[this.turn]),this.forkDominoID=null,p.DeskCheckModel.resetPading(),p.DeskCheckModel.clearLayerData(),p.DeskCheckModel.RootScale=u.DeskScaleRange.Origin,h.RoundNumberChanged.inst.dispatchOne(this.round)},Object.defineProperty(e.prototype,"currentTurn",{get:function(){return this.turn},enumerable:!0,configurable:!0}),e.prototype.changeTurn=function(){this.turn=this.turn==r.Turn.AI?r.Turn.Player:r.Turn.AI,h.PlayTurnChanged.inst.dispatchOne(this.turn)},e.prototype.getTotalDominosInRound=function(){return this.currentRound.getTotalDominos()},e.prototype.getPlayerDominosInRound=function(){return this.currentRound?this.currentRound.getPlayerDominos():[]},e.prototype.getAIDominosInRound=function(){return this.currentRound?this.currentRound.getAIDominos():[]},e.prototype.getDeskDominosInRound=function(){return this.currentRound.getDeskDominos()},e.prototype.getStackDominosInRound=function(){return this.currentRound.getStackDominos()},e.prototype.setPlayerDominos=function(e){this.currentRound.setPlayerDominos(e)},e.prototype.setAIDominos=function(e){this.currentRound.setAIDominos(e)},e.prototype.setStackDominos=function(e){this.currentRound.setStackDominos(e)},e.prototype.addPlayerScore=function(e,t){void 0===t&&(t=1),this.playerScore+=e,this.playerScore=Math.max(this.playerScore,0),h.PlayerScoreChanged.inst.dispatchTwo(this.playerScore,e),h.AddScoreSignal.inst.dispatchTwo(r.Turn.Player,t)},e.prototype.addNoviceScore=function(e,t){void 0===t&&(t=1),this.noviceScore+=e,this.noviceScore=Math.max(this.noviceScore,0),h.NoviceScoreChanged.inst.dispatchTwo(this.noviceScore,e),h.AddScoreSignal.inst.dispatchTwo(r.Turn.AI,t)},Object.defineProperty(e.prototype,"TotalScore",{get:function(){return this.Timebonus+this.ScoreSpread+this.playerScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Timebonus",{get:function(){return Math.floor(this.gameTime)<1||this.totalMatchCount.Player<=0?0:Math.floor(.8*this.gameTime+1.2*this.totalMatchCount.Player)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScoreSpread",{get:function(){return this.playerScore-this.noviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerScore",{get:function(){return this.playerScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseScore",{get:function(){return this.pauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NoviceScore",{get:function(){return this.noviceScore},enumerable:!0,configurable:!0}),e.prototype.addPauseCount=function(){this.pauseCount++,console.log("pause count:",this.pauseCount),this.pauseCount>r.FreePauseLimit&&this.addPlayerScore(-r.PauseScoreCost)},Object.defineProperty(e.prototype,"PauseCount",{get:function(){return this.pauseCount},enumerable:!0,configurable:!0}),e}();o.GamePlayModel=g,cc._RF.pop()},{"../../Global/Desk":"Desk","../../Global/Level":"Level","../../Global/Theme":"Theme","../../Initialization/Command/InitSignal":"InitSignal","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../Command/GamePlaySignal":"GamePlaySignal","./DeskCheckModel":"DeskCheckModel","./DominoModel":"DominoModel","./GameRule":"GameRule","./RoundModel":"RoundModel"}],GamePlaySignal:[function(e,t,o){"use strict";cc._RF.push(t,"f546cQa6nNAALT4Y03Ql6vU","GamePlaySignal"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/Signal"),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.BeforeNextRoundSignal=n;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.NextRoundSignal=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.RoundStartSignal=a;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.RoundEndSignal=r;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.GameOverSignal=c;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.RevertSignal=l;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.LastRoundStartSignal=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.FirstRoundStartSignal=h;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.GamePauseSignal=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ReadyDispatchDominoSignal=p;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DispatchPlayerDomino=g;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DispatchAIDomino=f;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DispatchStackDomino=m;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DispatchDoneSignal=D;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayerSelectedDomino=y;var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayerReleasedDomino=M;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.AIReleaseDomino=P;var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.AISelectedDomino=k;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlaceDomino=C;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.MoveDomino=S;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.UpdateHighLightDomino=_;var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlaceDominoDone=I;var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayMatchAnimation=O;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.OnPlayMatchAnimation=b;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayBothAnimationSignal=R;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ActionDoneThisTurn=v;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.SkipActionThisTurn=T;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.UpdateDominoArrayPos=w;var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayTurnChanged=x;var N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.RoundNumberChanged=N;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.NoviceScoreChanged=F;var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlayerScoreChanged=B;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.BoneyardCountChanged=E;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DominoStateChanged=A;var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DominoOwnerChanged=L;var V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DeskRootScale=V;var Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DeskRootPadingChanged=Z;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.OpenDominoBagSignal=G;var j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.CloseDominoBagSignal=j;var H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.TimeAnimationStateChanged=H;var U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.UpdateTimeNumber=U;var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ShowAllAIRestSignal=z;var W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ShowAllPlayerRestSignal=W;var q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.OpenResultLayerSignal=q;var K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ShowSubmitSignal=K;var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ScoreCountingSignal=X;var J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.AddScoreSignal=J;var Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.PlaySpineSignal=Y;var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.DrawCardSignal=Q;var $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.OpenDominoBagEffectSignal=$;var ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ShowPauseLayerSignal=ee;var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.HidePauseLayerSignal=te;var oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ShowHelpLayerSignal=oe;var ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.HideHelpLayerSignal=ie;var ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.CountDownSignal=ne;var se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.ButtonClickSignal=se,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],GameRule:[function(e,t,o){"use strict";cc._RF.push(t,"e188bsLeINMX7IBIdB98Lvl","GameRule"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven"}(o.DominoPoint||(o.DominoPoint={})),function(e){e[e.AI=0]="AI",e[e.Player=1]="Player"}(o.Turn||(o.Turn={})),o.ScoreLimit=99999999,o.MaxRound=6,o.TotalCount=28,o.DoubleRate=.2,o.ThribleRate=.1,o.MatchLimit=2,o.TotalTime=180,o.DrawDebug=!1,o.FreePauseLimit=3,o.PauseScoreCost=100,cc._RF.pop()},{}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"8e9767SqtRH2bxBloI/ZSqE","GameStateController"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../Utils/ToSingleton"),s=e("../Command/GamePlaySignal"),a=e("../Facade/PlayerModelProxy"),r=e("../Model/GameRule");(function(e){e[e.Init=0]="Init",e[e.OutOfMove=1]="OutOfMove",e[e.TimeUp=2]="TimeUp",e[e.DominoOut=3]="DominoOut",e[e.ScoreReach=4]="ScoreReach",e[e.RoundOut=5]="RoundOut"})(i=o.RoundEndType||(o.RoundEndType={})),o.GameOverType=[i.ScoreReach,i.TimeUp,i.RoundOut];var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pauseCount=0,t.roundstart=!1,t.currentRound=0,t.onResumeCallbacks=[],t}return __extends(t,e),t.prototype.start=function(){this.pauseCount=0},t.prototype.canStart=function(){return this.currentRound<a.PlayerModelProxy.inst.Round},t.prototype.roundStart=function(){console.log(" round start:",++this.currentRound),this.roundstart=!0,a.PlayerModelProxy.inst.Round==r.MaxRound&&s.LastRoundStartSignal.inst.dispatch(),s.RoundStartSignal.inst.dispatch()},t.prototype.roundEnd=function(e){console.log("round end :",i[e]),this.roundstart=!1,s.CloseDominoBagSignal.inst.dispatch(),a.PlayerModelProxy.inst.Round>=r.MaxRound&&e!=i.TimeUp&&(e=i.RoundOut),o.GameOverType.indexOf(e)>=0?s.GameOverSignal.inst.dispatchOne(e):e!=i.Init&&s.RoundEndSignal.inst.dispatchOne(e)},t.prototype.isRoundStart=function(){return this.roundstart},t.prototype.pause=function(e){void 0===e&&(e=!1),0==this.isPause()&&(this.onResumeCallbacks.length=0,s.GamePauseSignal.inst.dispatch(),e||this.onResumeCallbacks.push(function(){a.PlayerModelProxy.inst.addPauseCount()})),this.pauseCount++},t.prototype.clearResumeCallback=function(){this.onResumeCallbacks.length=0},t.prototype.resume=function(){if(this.pauseCount--,console.assert(this.pauseCount>=0," pause count smaller than 0!!!"),this.pauseCount=Math.max(this.pauseCount,0),this.pauseCount<=0){for(var e=0,t=this.onResumeCallbacks;e<t.length;e++){(0,t[e])()}this.onResumeCallbacks.length=0}},t.prototype.isPause=function(){return this.pauseCount>0},t.prototype.addResumeCallback=function(e){this.onResumeCallbacks||(this.onResumeCallbacks=[]),this.onResumeCallbacks.push(e)},t}(n.SingleTon());o.GameStateController=c,cc._RF.pop()},{"../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal","../Facade/PlayerModelProxy":"PlayerModelProxy","../Model/GameRule":"GameRule"}],GuideLayerMediator:[function(e,t,o){"use strict";cc._RF.push(t,"62089SPl75HV7H0u4CduKq+","GuideLayerMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../../View/BaseMediator"),n=e("../../../Controller/GameStateController"),s=e("../../../Command/GamePlaySignal"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeCallback=null,t}return __extends(t,e),t.prototype.onRegister=function(){s.ShowHelpLayerSignal.inst.addListenerOne(this.showGuide,this),s.HideHelpLayerSignal.inst.addListenerOne(this.hideGuide,this)},t.prototype.showGuide=function(e){this.View.isShowed()||(n.GameStateController.inst.pause(!0),this.closeCallback=e,this.View.Show())},t.prototype.hideGuide=function(){0!=this.View.isShowed()&&(n.GameStateController.inst.resume(),this.View.Hide(this.closeCallback),this.closeCallback=null)},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../../View/BaseMediator":"BaseMediator","../../../Command/GamePlaySignal":"GamePlaySignal","../../../Controller/GameStateController":"GameStateController"}],GuideLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"c0680yliqtH4JG8sE62LErp","GuideLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../../../View/BaseView"),s=e("./GuideLayerMediator"),a=e("../../../Command/GamePlaySignal"),r=e("./Page4GuideView"),c=e("./Page3GuideView"),l=cc._decorator,d=l.ccclass;l.property;(function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"})(i||(i={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=i.Hide,t}return __extends(t,e),Object.defineProperty(t.prototype,"Next",{get:function(){return this.node.getChildByName("Next")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Close",{get:function(){return this.node.getChildByName("Close")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GuidePage",{get:function(){return this.node.getChildByName("GuidePage").getComponent(cc.PageView)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalPage",{get:function(){return this.node.getChildByName("TotalPage").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Page",{get:function(){return this.node.getChildByName("Page").getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(s.default),this.state=i.Hide,this.node.scale=1,this.node.active=!1,this.GuidePage.node.on("page-turning",this.onPageChanged,this),this.Close.on(cc.Node.EventType.TOUCH_END,this.close,this),this.Next.on(cc.Node.EventType.TOUCH_END,this.next,this)},t.prototype.start=function(){},t.prototype.close=function(){a.ButtonClickSignal.inst.dispatch(),a.HideHelpLayerSignal.inst.dispatch()},t.prototype.next=function(){a.ButtonClickSignal.inst.dispatch(),this.GuidePage.scrollToPage((this.GuidePage.getCurrentPageIndex()+1)%this.GuidePage.content.childrenCount,0),this.onPageChanged()},t.prototype.onPageChanged=function(){this.TotalPage.string=this.GuidePage.content.childrenCount.toString(),this.Page.string=(this.GuidePage.getCurrentPageIndex()+1).toString(),this.GuidePage.getCurrentPageIndex()>=this.GuidePage.content.childrenCount-1?(this.Next.active=!1,this.Close.active=!0):(this.Next.active=!0,this.Close.active=!1),3==this.GuidePage.getCurrentPageIndex()?this.GuidePage.getPages()[3].getComponent(r.default).play():this.GuidePage.getPages()[3].getComponent(r.default).stop(),2==this.GuidePage.getCurrentPageIndex()?this.GuidePage.getPages()[2].getComponent(c.default).play():this.GuidePage.getPages()[2].getComponent(c.default).stop()},t.prototype.isShowed=function(){return this.state==i.Show},t.prototype.Show=function(e){this.isShowed()||(this.state=i.Show,this.node.active=!0,this.node.stopAllActions(),this.node.scale=0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()}))),this.Next.active=!0,this.Close.active=!1,this.GuidePage.scrollToPage(0,0),this.onPageChanged())},t.prototype.Hide=function(e){var t=this;0!=this.isShowed()&&(this.state=i.Hide,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.scale=1,e&&e(),t.node.active=!1}))))},t=__decorate([d],t)}(n.default);o.default=h,cc._RF.pop()},{"../../../../View/BaseView":"BaseView","../../../Command/GamePlaySignal":"GamePlaySignal","./GuideLayerMediator":"GuideLayerMediator","./Page3GuideView":"Page3GuideView","./Page4GuideView":"Page4GuideView"}],HandAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"47d0fmMHbxNhbvgNe+Ljdtp","HandAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../Animation/MatchAnimation"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onFinish=function(){},t.prototype.onComplete=function(){e.prototype.onComplete.call(this),this.onFinish()},t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../../Animation/MatchAnimation":"MatchAnimation"}],HashMap:[function(e,t,o){"use strict";cc._RF.push(t,"4b0e7DzcRNJnZXTYCWgDaDU","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){this._list=new Array,this.clear()}return e.prototype.getIndexByKey=function(e){for(var t=this._list.length,o=0;o<t;o++){if(this._list[o].key==e)return o}return-1},e.prototype.keyOf=function(e){for(var t=this._list.length,o=0;o<t;o++){var i=this._list[o];if(i.value.hashKey&&e.hashKey&&i.value.hashKey===e.hashKey||i.value==e)return i.key}return null},Object.defineProperty(e.prototype,"keys",{get:function(){for(var e=new Array,t=0,o=this._list;t<o.length;t++){var i=o[t];i&&e.push(i.key)}return e},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var o={key:e,value:t},i=this.getIndexByKey(e);-1!=i?this._list[i]=o:this._list.push(o)},Object.defineProperty(e.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.getIndexByKey(e);if(-1!=t){var o=this._list[t];return this._list.splice(t,1),o}return null},e.prototype.has=function(e){return-1!=this.getIndexByKey(e)},e.prototype.get=function(e){var t=this.getIndexByKey(e);return-1!=t?this._list[t].value:null},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.sort=function(e){this._list.sort(e)},e.prototype.forEachKeyValue=function(e){for(var t=this._list.length,o=0;o<t;o++){e(this._list[o])}},e.prototype.forEach=function(e){for(var t=this._list.length,o=0;o<t;o++){var i=this._list[o];e(i.key,i.value)}},e.prototype.clear=function(){this._list=[]},e}();o.HashMap=i,cc._RF.pop()},{}],InitSceneView:[function(e,t,o){"use strict";cc._RF.push(t,"bcc37nuyBhJzL2qRh1HJa3o","InitSceneView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../View/BaseView"),n=e("./LoadingPageMediator"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],InitSignal:[function(e,t,o){"use strict";cc._RF.push(t,"646a9Tm+5pCK5Z4d5Nzebhw","InitSignal"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/Signal"),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.GameThemeInit=n;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.GameReadySignal=s,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],InitialFacade:[function(e,t,o){"use strict";cc._RF.push(t,"cbbbcO7od5PrqaPNOs8dFh3","InitialFacade"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Command/InititalCommond"),n=e("../Command/StartGameCommond"),s=e("../Command/LoadAudioCommond"),a=e("../Command/LoadPrefabCommond"),r=e("../../Utils/Celer/CelerSDK"),c=function(){function e(e){this.loadTime={},this.steps=[],this.facade=puremvc.Facade.getInstance(e)}return Object.defineProperty(e,"inst",{get:function(){return this.instance?this.instance:this.instance=new e(e.MULTITON_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Facade",{get:function(){return console.assert(null!==this.facade," facade is null"),this.facade},enumerable:!0,configurable:!0}),e.prototype.register=function(){var t=this;this.facade.registerCommand(e.INITIALIZATION,i.InitialCommond),this.facade.registerCommand(e.START_UP,n.StartGameCommond),r.CelerSDK.inst.init(function(){t.facade.sendNotification(e.START_UP,t)})},e.prototype.unregister=function(){this.facade.removeCommand(e.INITIALIZATION),this.facade.removeCommand(e.START_UP)},e.prototype.start=function(){this.register();for(var t=0,o=e.TOTAL_STEPS;t<o.length;t++){var i=o[t];this.loadTime[i]=Date.now()}this.facade.sendNotification(e.INITIALIZATION,this)},e.prototype.step=function(t){if(console.log(" initialization step:",t),this.steps.indexOf(t)<0){this.steps.push(t),this.steps.sort(),e.TOTAL_STEPS.sort();var o=this.steps.join("-"),i=e.TOTAL_STEPS.join("-");console.log(" cur-steps\uff1a",o,", total:",i,", ",t," cost:",(Date.now()-this.loadTime[t]).toFixed(2),"ms"),i===o&&r.CelerSDK.inst.celerXReady()}},e.MULTITON_KEY="INITIAL_FCADE",e.INITIALIZATION="initialization",e.START_UP="startup",e.TOTAL_STEPS=[s.LoadAudioCommond.STEP,a.LoadPrefabCommond.STEP],e}();o.InitialFacade=c,cc._RF.pop()},{"../../Utils/Celer/CelerSDK":"CelerSDK","../Command/InititalCommond":"InititalCommond","../Command/LoadAudioCommond":"LoadAudioCommond","../Command/LoadPrefabCommond":"LoadPrefabCommond","../Command/StartGameCommond":"StartGameCommond"}],InititalCommond:[function(e,t,o){"use strict";cc._RF.push(t,"a28caT/H41F74cWxJYqN9pz","InititalCommond"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./LoadPrefabCommond"),n=e("./LoadAudioCommond"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initializeMacroCommand=function(){this.addSubCommand(i.LoadPrefabCommond),this.addSubCommand(n.LoadAudioCommond)},t}(puremvc.MacroCommand);o.InitialCommond=s,cc._RF.pop()},{"./LoadAudioCommond":"LoadAudioCommond","./LoadPrefabCommond":"LoadPrefabCommond"}],Level:[function(e,t,o){"use strict";cc._RF.push(t,"3ebc53AC99D9oQzOQ3jCSgn","Level"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Theme"),n=e("../GamePlay/Model/GameRule"),s=function(){function e(){}return e.getThemeRandomPool=function(e){return[i.Theme.Number,i.Theme.Sweet]},e.getDominoCountInRound=function(e){return 28},e.getDominoCountInHand=function(e){return 7},e.getTopPointRandomPool=function(e){return[n.DominoPoint.One,n.DominoPoint.Two,n.DominoPoint.Three,n.DominoPoint.Four,n.DominoPoint.Five,n.DominoPoint.Six,n.DominoPoint.Seven]},e.getBottomPointRandomPool=function(e){return[n.DominoPoint.One,n.DominoPoint.Two,n.DominoPoint.Three,n.DominoPoint.Four,n.DominoPoint.Five,n.DominoPoint.Six,n.DominoPoint.Seven]},e.getPointRandomPool=function(e){return[n.DominoPoint.One,n.DominoPoint.Two,n.DominoPoint.Three,n.DominoPoint.Four,n.DominoPoint.Five,n.DominoPoint.Six,n.DominoPoint.Seven]},e}();o.Level=s,cc._RF.pop()},{"../GamePlay/Model/GameRule":"GameRule","./Theme":"Theme"}],LoadAudioCommond:[function(e,t,o){"use strict";cc._RF.push(t,"d4f3eGYUlBES5d8aEvuPQna","LoadAudioCommond"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Manager/AudioManager"),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){if(e){var o=e.getBody();o&&o.step&&i.gAudio.init(function(){o.step(t.STEP)})}},t.STEP="LoadAudio",t}(puremvc.SimpleCommand);o.LoadAudioCommond=n,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager"}],LoadPrefabCommond:[function(e,t,o){"use strict";cc._RF.push(t,"8b33fPnvCZEJ7bc/zCVv9My","LoadPrefabCommond"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Factory/GameFactory"),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){i.gFactory.init(function(){if(e){var o=e.getBody();o&&o.step&&o.step(t.STEP)}})},t.STEP="LoadPrefab",t}(puremvc.SimpleCommand);o.LoadPrefabCommond=n,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory"}],LoadingPageMediator:[function(e,t,o){"use strict";cc._RF.push(t,"890a7spQqhPvr2Up1cp0iGl","LoadingPageMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../View/BaseMediator"),n=e("../Command/InitSignal"),s=e("../../GamePlay/Command/GamePlaySignal"),a=e("../../Utils/Celer/CelerSDK"),r=cc._decorator,c=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=3e3,t.startTime=0,t}return __extends(t,e),t.prototype.onRegister=function(){this.startTime=Date.now(),n.GameReadySignal.inst.addListener(this.onGameReady,this)},t.prototype.onGameReady=function(){var e=this,t=Date.now()-this.startTime;console.log(" -- game init done, hide loading page: ",t),t<=this.time?setTimeout(function(){e.View.Hide(function(){e.startGame()})},this.time-t):this.View.Hide(function(){e.startGame()})},t.prototype.startGame=function(){CELER_X&&a.CelerSDK.inst.isNew()?s.ShowHelpLayerSignal.inst.dispatchOne(function(){s.FirstRoundStartSignal.inst.dispatch()}):s.FirstRoundStartSignal.inst.dispatch()},t.prototype.onDestroy=function(){},t=__decorate([c],t)}(i.default));o.default=l,cc._RF.pop()},{"../../GamePlay/Command/GamePlaySignal":"GamePlaySignal","../../Utils/Celer/CelerSDK":"CelerSDK","../../View/BaseMediator":"BaseMediator","../Command/InitSignal":"InitSignal"}],LoadingView:[function(e,t,o){"use strict";cc._RF.push(t,"5bb03yEifFAc6rRMybrkHat","LoadingView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../View/BaseView"),n=e("./LoadingPageMediator"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=1,this.node.opacity=255,this.BindMedaitor(n.default)},t.prototype.start=function(){},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.node.active=!1,e()})))},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],LogHandler:[function(e,t,o){"use strict";cc._RF.push(t,"a4747QIvUBIo6Ktpx/xQwuB","LogHandler"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var o=e.call(this)||this;if(o.logFunc=console.log,o.logMsg=null,o.frameTimes=0,o.now=0,o.Frame=20,o.totalFrames=0,o.startTime=0,window.addEventListener)for(var i=0,n=t.LISTENNING_EVENTS;i<n.length;i++){var s=n[i],a="trigger"+s.charAt(0).toLocaleUpperCase()+s.substring(1);o[a]&&"function"==typeof o[a]&&window.addEventListener(s,o[a].bind(o))}return o}return __extends(t,e),t.prototype.dumpFrameInfo=function(){var e=(Date.now()-this.startTime)/1e3,t=e/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",e+"s"," , per frame cost time ave:"+t+"s")},t.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLog.apply(this,e),this.sendLog()},t.prototype.ready=function(){console.log(t.VERSION)},t.prototype.initLog=function(e){var o=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){o.frameTimes=0,o.now=Date.now(),o.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){o.frameTimes++,o.totalFrames++,o.frameTimes>=o.Frame&&(o.frameTimes=0,o.now=Date.now())},this),this.logFunc=e,window.consoleError=console.error,window.consoleWarn=console.warn,window.consoleLog=console.log,window.consoleAssert=console.assert,console.error=function(){for(var e,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];(e=t.inst).log.apply(e,["[ERROR]"].concat(o))},console.warn=function(){for(var e,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];(e=t.inst).log.apply(e,["[WARN]"].concat(o))},console.log=function(){for(var e,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];(e=t.inst).log.apply(e,["[INFO]"].concat(o))},console.assert=function(e){for(var o,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];e||(o=t.inst).log.apply(o,["[ASSERT ERROR]"].concat(i))}},t.prototype.formatLogArguments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o="",i=0;i<arguments.length;i++){var n=typeof arguments[i];"string"==n||"number"==n?o+=" "+arguments[i]:"object"==n?o+=" "+JSON.stringify(arguments[i]):"boolean"==n&&arguments[i].toString&&(o+=arguments[i].toString())}return o},t.prototype.addLog=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==this.logMsg&&(this.logMsg={});var i=this.formatLogArguments.apply(this,e),n=this.getFullTime(new Date);this.logMsg[n]=t.VERSION+i},t.prototype.getFullTime=function(e){var t="";t+=e.getFullYear();var o=e.getMonth()+1;t+="-"+(o>=10?o:"0"+o);var i=e.getDate();t+="-"+(i>=10?i:"0"+i);var n=e.getHours();t+="  "+(n>=10?n:"0"+n);var s=e.getMinutes();t+=":"+(s>=10?s:"0"+s);var a=e.getSeconds();return t+=":"+(a>=10?a:"0"+a)},t.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},t.prototype.triggerClose=function(e){this.addLog("triggerClose"),this.sendLog()},t.prototype.triggerLoad=function(e){this.addLog("triggerLoad"),this.sendLog()},t.prototype.triggerUnload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerOnunload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerError=function(e){this.addLog("triggerError"),this.addLog(e.message),this.sendLog()},t.prototype.triggerFocus=function(e){this.addLog("triggerFocus"),this.sendLog()},t.prototype.triggerBlur=function(e){this.addLog("triggerBlur"),this.sendLog()},t.prototype.triggerAbort=function(e){this.addLog("triggerAbort"),this.sendLog()},t.prototype.triggerSuspend=function(e){this.addLog("triggerSuspend"),this.sendLog()},t.prototype.beforeunload=function(e){this.addLog("beforeunload"),this.sendLog()},t.VERSION="DominoCash version 14 : ",t.LISTENNING_EVENTS=["error"],t}(e("./ToSingleton").SingleTon());o.LogHandler=i,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],MatchAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"61d950QFp1OBY7SHwGT/rda","MatchAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/FrameAniBase"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.play=function(){this.node.active=!0,this.node.opacity=255,e.prototype.play.call(this)},t.prototype.onComplete=function(){var e=this;this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.node.active=!1})))},t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../Utils/FrameAniBase":"FrameAniBase"}],MinuteNumberView:[function(e,t,o){"use strict";cc._RF.push(t,"fe1bccYBpNGhrWsN6lUzGrK","MinuteNumberView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Command/GamePlaySignal"),n=e("../../../Utils/Time"),s=e("../../Model/GameRule"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){i.UpdateTimeNumber.inst.addListenerOne(this.onTimeChanged,this),this.onTimeChanged(s.TotalTime)},t.prototype.onTimeChanged=function(e){var t=n.Time.timeFormat(e);this.Label.string=t.split("/")[0]},t=__decorate([r],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../Utils/Time":"Time","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GameRule":"GameRule"}],NextRoundButton:[function(e,t,o){"use strict";cc._RF.push(t,"c93e1YMIp5Of5Y9rEVQQgnY","NextRoundButton"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/Test"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.on(cc.Node.EventType.TOUCH_END,function(){n.NextRoundSignal.inst.dispatch()},this)},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/Test":"Test","../../Command/GamePlaySignal":"GamePlaySignal"}],NoviceScoreView:[function(e,t,o){"use strict";cc._RF.push(t,"4f218LIe2pG+4ykKpmPlGiu","NoviceScoreView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./NumberChangedView"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.NoviceScoreChanged.inst.addListenerOne(this.onNumberChanged,this)},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal","./NumberChangedView":"NumberChangedView"}],NumberChangedView:[function(e,t,o){"use strict";cc._RF.push(t,"2b373cJGixKrYQE7awOvUKY","NumberChangedView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.num=0,t.showNum=0,t.step=0,t.label=null,t.action=!0,t.STEP=120,t.callback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.label?this.label:this.label=this.node.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onStep=function(e){},t.prototype.onNumberChanged=function(e,t){if(this.num=e,this.callback=t,this.num!=this.showNum){var o=this.num-this.showNum;this.step=o>0?Math.ceil(o/this.STEP):Math.floor(o/this.STEP),this.action&&this.node.runAction(cc.sequence(cc.scaleTo(.1,1.4),cc.delayTime(.2),cc.scaleTo(.1,1)))}else this.step=0},t.prototype.update=function(e){this.num!=this.showNum&&(this.showNum+=this.step,this.onStep(this.step),(this.showNum>this.num&&this.step>0||this.showNum<this.num&&this.step<0)&&(this.showNum=this.num,this.step=0)),Math.abs(this.num-this.showNum)<=Math.abs(this.step)&&this.callback&&"function"==typeof this.callback&&(this.callback(),this.callback=null),this.Label.string=this.showNum>=0?this.showNum.toString():"/"+Math.abs(this.showNum).toString()},t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../../View/BaseView":"BaseView"}],Page3GuideView:[function(e,t,o){"use strict";cc._RF.push(t,"4d8e695x1BGDpCRTFTkYqw7","Page3GuideView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./HandAnimation"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isStop=!0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Card1",{get:function(){return this.node.getChildByName("card1")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Card1Front",{get:function(){return this.node.getChildByName("card1Front")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Card2",{get:function(){return this.node.getChildByName("card2")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Card2Front",{get:function(){return this.node.getChildByName("card2Front")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Hand1",{get:function(){return this.node.getChildByName("Hand1").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Hand2",{get:function(){return this.node.getChildByName("Hand2").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"No",{get:function(){return this.node.getChildByName("No")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.reset=function(){this.No.opacity=0,this.No.stopAllActions(),this.Card1.active=!0,this.Card2.active=!0,this.Card1Front.active=!1,this.Card1Front.setPosition(143,214.5),this.Card1Front.stopAllActions(),this.Card2Front.active=!1,this.Card2Front.setPosition(-69,215),this.Card2Front.stopAllActions(),this.Hand1.stop(),this.Hand1.node.active=!1,this.Hand2.stop(),this.Hand2.node.active=!1},t.prototype.play=function(){var e=this;this.isStop=!1,this.reset(),this.Hand1.onFinish=function(){e.Card1.active=!1,e.Card1Front.active=!0,e.Card1Front.runAction(cc.sequence(cc.delayTime(.3),cc.moveTo(.1,-107.4,-623.4),cc.callFunc(function(){e.No.runAction(cc.sequence(cc.fadeIn(.1),cc.callFunc(function(){e.Hand2.play()})))})))},this.Hand2.onFinish=function(){e.Card2.active=!1,e.Card2Front.active=!0,e.Card2Front.runAction(cc.sequence(cc.delayTime(.3),cc.moveTo(.1,-20.1,-623.4),cc.delayTime(.5),cc.callFunc(function(){0==e.isStop&&e.play()})))},this.Hand1.play()},t.prototype.stop=function(){this.isStop=!0,this.reset()},t=__decorate([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{"./HandAnimation":"HandAnimation"}],Page4GuideView:[function(e,t,o){"use strict";cc._RF.push(t,"42950rZI9BN9L6HF4d2hB9q","Page4GuideView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../../Utils/FrameAniBase"),n=e("../Animations/BlingAnimation"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isStop=!0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Rest",{get:function(){return this.node.getChildByName("Rest")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Flip",{get:function(){return this.node.getChildByName("Flip").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Light",{get:function(){return this.node.getChildByName("Light").getComponent(n.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Points",{get:function(){return this.node.getChildByName("Point")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.reset=function(){this.Rest.opacity=255,this.Rest.stopAllActions(),this.Flip.stop(),this.Flip.node.setPosition(-247,337),this.Flip.node.stopAllActions(),this.Light.node.active=!1,this.Light.stop(),this.Points.scale=0,this.Points.stopAllActions()},t.prototype.play=function(){var e=this;this.isStop=!1,this.reset(),this.Rest.runAction(cc.sequence(cc.delayTime(.5),cc.fadeOut(.2))),this.Flip.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){e.Flip.play()}),cc.moveTo(.2,0,0))),this.Points.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.Light.play()}),cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))),0==this.isStop&&(this.Light.onComplete=function(){e.play()})},t.prototype.stop=function(){this.isStop=!0,this.reset()},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../../../Utils/FrameAniBase":"FrameAniBase","../Animations/BlingAnimation":"BlingAnimation"}],PauseButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"a9d77641DxI471b+BzO/HOY","PauseButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Command/GamePlaySignal"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,function(){i.ShowPauseLayerSignal.inst.dispatch()},this)},t.prototype.start=function(){},t=__decorate([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal"}],PauseLayerMediator:[function(e,t,o){"use strict";cc._RF.push(t,"fb7adjOScBAXKcKAFT6lvsN","PauseLayerMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Controller/GameStateController"),s=e("../../Command/GamePlaySignal"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){s.ShowPauseLayerSignal.inst.addListener(this.showPause,this),s.HidePauseLayerSignal.inst.addListener(this.hidePause,this),s.GameOverSignal.inst.addListener(this.onGameOver,this)},t.prototype.onGameOver=function(){s.ShowPauseLayerSignal.inst.removeTarget(this),s.HidePauseLayerSignal.inst.removeTarget(this)},t.prototype.showPause=function(){this.View.isShowed()||(console.log(" show pause "),n.GameStateController.inst.pause(),this.View.Show())},t.prototype.hidePause=function(){0!=this.View.isShowed()&&(n.GameStateController.inst.resume(),this.View.Hide(function(){}))},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/GameStateController":"GameStateController"}],PauseLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"8b3e1b6eiZBIbYUOD9jTwLM","PauseLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../../View/BaseView"),s=e("./PauseLayerMediator"),a=e("../../../View/SliderView"),r=e("../../../Manager/AudioManager"),c=e("../../Command/GamePlaySignal"),l=e("../../Controller/GameStateController"),d=e("../../Facade/PlayerModelProxy"),h=e("../../Controller/ResourceController"),u=e("../../Model/GameRule"),p=cc._decorator,g=p.ccclass;p.property;(function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"})(i||(i={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=i.Hide,t}return __extends(t,e),Object.defineProperty(t.prototype,"MusicSlider",{get:function(){return this.node.getChildByName("MusicSlider").getComponent(a.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EffectSlider",{get:function(){return this.node.getChildByName("EffectSlider").getComponent(a.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("Resume")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"End",{get:function(){return this.node.getChildByName("End")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Help",{get:function(){return this.node.getChildByName("Help")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseTip",{get:function(){return this.node.getChildByName("PauseTip")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return this.PauseTip.getChildByName("FreeCount").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseScore",{get:function(){return this.PauseTip.getChildByName("Score").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content",{get:function(){return this.PauseTip.getChildByName("Content").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(s.default),this.state=i.Hide,this.node.scale=1,this.node.active=!1},t.prototype.start=function(){this.MusicSlider.onProgress=function(e){r.gAudio.setMusicVolume(e)},this.EffectSlider.onProgress=function(e){r.gAudio.setEffectVolume(e)},this.Help.on(cc.Node.EventType.TOUCH_END,function(){c.ButtonClickSignal.inst.dispatch(),c.ShowHelpLayerSignal.inst.dispatch()},this),this.Resume.on(cc.Node.EventType.TOUCH_END,function(){c.HidePauseLayerSignal.inst.dispatch(),c.ButtonClickSignal.inst.dispatch()},this),this.End.on(cc.Node.EventType.TOUCH_END,function(){l.GameStateController.inst.clearResumeCallback(),c.ButtonClickSignal.inst.dispatch(),c.HidePauseLayerSignal.inst.dispatch(),c.GameOverSignal.inst.dispatchOne(l.RoundEndType.RoundOut)},this)},t.prototype.isShowed=function(){return this.state==i.Show},t.prototype.showPauseTip=function(){var e=d.PlayerModelProxy.inst.FreePauseCount;this.FreePauseCount.node.active=e>0,this.FreePauseCount.string=e.toString(),this.Content.spriteFrame=e>0?h.ResourceController.inst.getAltas(h.PauseTip.Free):h.ResourceController.inst.getAltas(h.PauseTip.noFree),this.PauseScore.string="/"+u.PauseScoreCost.toString()},t.prototype.Show=function(e){this.isShowed()||(this.MusicSlider.Percent=r.gAudio.MusicVolume,this.EffectSlider.Percent=r.gAudio.EffectVolume,this.showPauseTip(),this.state=i.Show,this.node.active=!0,this.node.stopAllActions(),this.node.scale=0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()}))))},t.prototype.Hide=function(e){var t=this;0!=this.isShowed()&&(this.state=i.Hide,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.scale=1,e&&e(),t.node.active=!1}))))},t=__decorate([g],t)}(n.default);o.default=f,cc._RF.pop()},{"../../../Manager/AudioManager":"AudioManager","../../../View/BaseView":"BaseView","../../../View/SliderView":"SliderView","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/GameStateController":"GameStateController","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/GameRule":"GameRule","./PauseLayerMediator":"PauseLayerMediator"}],PlayerCardRootMediator:[function(e,t,o){"use strict";cc._RF.push(t,"4eb14w4LJlCa7KntGVst6EG","PlayerCardRootMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Model/DominoModel"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.DispatchPlayerDomino.inst.addListenerThree(this.onAddDomino,this),n.PlaceDominoDone.inst.addListener(this.onPlacedDone,this)},t.prototype.onAddDomino=function(e,t,o){void 0===o&&(o=!1),s.DominoModel.getDominoByID(t).setState(s.DominoState.Front),this.View.addDomino(e,t,o)},t.prototype.onPlacedDone=function(){this.View.updateDominoPos()},t.prototype.onUnregister=function(){},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel"}],PlayerCardRootView:[function(e,t,o){"use strict";cc._RF.push(t,"73787HzHthJ1LZA7f0ObcSf","PlayerCardRootView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./PlayerCardRootMediator"),s=e("../../../Utils/Cocos"),a=e("../../Command/GamePlaySignal"),r=e("../../Model/DominoModel"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.childOffset=cc.v2(14,0),t}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=.6,this.BindMedaitor(n.default)},t.prototype.start=function(){},t.prototype.updateScale=function(){this.node.scale=Math.min(.85,11/this.node.childrenCount*.85)},t.prototype.updateDominoPos=function(){if(!(this.node.childrenCount<=0)){for(var e=[],t=0,o=this.node.children;t<o.length;t++){var i=o[t];e.push(i)}e.sort(function(e,t){return e.x-t.x});var n=!1,s=!1,r=0;do{i=e[r];var c=e[r+1];i.x>i.width&&0==r&&(n=!0,a.UpdateDominoArrayPos.inst.dispatchTwo(i.name,i.position.add(cc.v2(-i.width-this.childOffset.x,0)))),n&&c?a.UpdateDominoArrayPos.inst.dispatchTwo(c.name,c.position.add(cc.v2(-c.width-this.childOffset.x,0))):(c&&c.x-i.x>2*i.width||s)&&(s=!0,a.UpdateDominoArrayPos.inst.dispatchTwo(c.name,c.position.add(cc.v2(-c.width-this.childOffset.x,0)))),r++}while(r<e.length-1);this.updateScale()}},t.prototype.addDomino=function(e,t,o){void 0===o&&(o=!1),e.getParent()&&e.setPosition(s.ConvertToNodeSpaceAR(e,this.node));var i=cc.v2(0,0);i.addSelf(this.childOffset.mul(this.node.childrenCount+1)),i.addSelf(cc.v2(e.width,0).mul(this.node.childrenCount).add(cc.v2(.75*e.width,0))),e.setParent(this.node),this.node.zIndex=0,this.updateScale(),e.scale=1/this.node.scale;var n=.1*this.node.childrenCount;o&&(n=.1),e.runAction(cc.sequence(cc.delayTime(n),cc.spawn(cc.moveTo(.2,i),cc.scaleTo(.2,1)),cc.callFunc(function(){a.DispatchDoneSignal.inst.dispatchTwo(t,r.DominoOwner.Player)})))},t=__decorate([l],t)}(i.default));o.default=d,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./PlayerCardRootMediator":"PlayerCardRootMediator"}],PlayerModelProxy:[function(e,t,o){"use strict";cc._RF.push(t,"05371njh5dFV5jUHKKdb8d5","PlayerModelProxy"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("../../Utils/ToSingleton"),s=e("../Model/GamePlayModel"),a=e("../Command/GamePlaySignal"),r=e("../Controller/GameStateController"),c=e("../Model/DominoModel"),l=e("../Model/GameRule"),d=e("../Controller/DominoSelector"),h=e("../View/DominoControl/DominoNodePool"),u=e("../Model/DeskNodeModel"),p=e("../Model/DeskCheckModel"),g=e("../Controller/AIController"),f=e("../../Utils/Random");(function(e){e[e.Need=0]="Need",e[e.Skip=1]="Skip",e[e.noNeed=2]="noNeed",e[e.End=3]="End"})(i=o.DrawType||(o.DrawType={}));var m=function(e){function t(){var t=e.call(this)||this;return t.testPlayerDominos={},t.testAIDominos={},t.testStackDominos={},t.isGameOver=!1,t.changeTurnOpen=!0,t.playerModel=null,t.roundDispatchCount=0,t.roundDispatchCountLimit=28,t.bindSignal(),t}return __extends(t,e),Object.defineProperty(t.prototype,"connectJudgeDistance",{get:function(){return 1e3*p.DeskCheckModel.RootScale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.playerModel?this.playerModel:this.playerModel=new s.GamePlayModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Theme",{get:function(){return this.Model.Theme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this.Model.Level},set:function(e){this.Model.Level=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Round",{get:function(){return this.Model.Round},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Turn",{get:function(){return this.Model.currentTurn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeLeft",{get:function(){return this.Model.Time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlayerScore",{get:function(){return this.Model.PlayerScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NoviceScore",{get:function(){return this.Model.NoviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointSpread",{get:function(){return this.Model.ScoreSpread},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Model.Timebonus},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){var e=this;a.NextRoundSignal.inst.addListener(this.nextRound,this),a.DispatchDoneSignal.inst.addListenerTwo(this.onDispatchDominoDone,this),a.PlayerReleasedDomino.inst.addListenerTwo(this.onPlayerReleaseDomino,this),a.AIReleaseDomino.inst.addListenerTwo(this.onAIReleaseDomino,this),a.PlayTurnChanged.inst.addListenerOne(this.onPlayTurnChanged,this),a.MoveDomino.inst.addListenerOne(this.onDominoMoved,this),a.PlaceDomino.inst.addListenerOne(this.Model.addDominoPlacedCache,this.Model),a.PlaceDominoDone.inst.addListenerOne(this.onPlaceDominoDone,this),a.ActionDoneThisTurn.inst.addListenerOne(this.onActionDone,this),a.GameOverSignal.inst.addListener(function(){e.isGameOver=!0},this)},t.prototype.drawDomino=function(e,t){this.Model.RoundData.removeStackDomino(e),t==c.DominoOwner.AI?this.Model.RoundData.addAIDomino(c.DominoModel.getDominoByID(e)):this.Model.RoundData.addPlayerDomino(c.DominoModel.getDominoByID(e)),a.DrawCardSignal.inst.dispatch(),a.BoneyardCountChanged.inst.dispatchOne(this.Model.RoundData.getStackDominos().length),console.log(" stack count:",this.Model.RoundData.getStackDominos().length),this.checkDrawCard(this.Model.currentTurn)},t.prototype.addGameTime=function(e){r.GameStateController.inst.isPause()||0==r.GameStateController.inst.isRoundStart()||this.isGameOver||(this.Model.Time+=e,a.UpdateTimeNumber.inst.dispatchOne(this.Model.Time),a.TimeAnimationStateChanged.inst.dispatchOne(this.Model.Time<=30),this.Model.Time<=0&&r.GameStateController.inst.roundEnd(r.RoundEndType.TimeUp))},t.prototype.playAllMatchAnimation=function(){this.isPlayerWin()?this.playAIMatchAnimation():this.playPlayerMatchAnimation()},t.prototype.playAIMatchAnimation=function(){for(var e=[],t=0,o=this.getAIDominos();t<o.length;t++){var i=o[t];e.push(i.ID)}a.PlayBothAnimationSignal.inst.dispatchOne(e)},t.prototype.playPlayerMatchAnimation=function(){for(var e=[],t=0,o=this.getPlayerDominos();t<o.length;t++){var i=o[t];e.push(i.ID)}a.PlayBothAnimationSignal.inst.dispatchOne(e)},t.prototype.onActionDone=function(e){a.CloseDominoBagSignal.inst.dispatch(),this.checkMatch(e),this.checkIsEnd()||(this.changeTurnOpen,this.Model.changeTurn())},t.prototype.gameOver=function(){return this.isGameOver},t.prototype.checkIsEnd=function(){return null!=this.Model.RoundData&&((this.Model.getPlayerDominosInRound().length<=0||this.Model.getAIDominosInRound().length<=0)&&(r.GameStateController.inst.roundEnd(r.RoundEndType.DominoOut),!0))},t.prototype.onPlaceDominoDone=function(e){var t=c.DominoModel.getDominoByID(e);a.ActionDoneThisTurn.inst.dispatchOne(t.FreePoints[0])},t.prototype.onPlayerReleaseDomino=function(e,t){this.onReleaseDomino(e,null,t,c.DominoOwner.Player)},t.prototype.onAIReleaseDomino=function(e,t){console.log("onAIReleaseDomino:",e," to ",t),this.onReleaseDomino(e,t,!1,c.DominoOwner.AI)},t.prototype.hasScoreBonus=function(){return this.Model.getAIDominosInRound().length>0||this.Model.getPlayerDominosInRound().length>0},t.prototype.checkDrawCard=function(e){if(0!=r.GameStateController.inst.isRoundStart())switch(this.checkNeed2Draw()){case i.End:console.log("\u672c\u8f6e\u7ed3\u675f\uff0c\u65e0\u9700\u62bd\u5361");break;case i.Need:console.log("\u9700\u8981\u62bd\u5361"),a.OpenDominoBagSignal.inst.dispatchOne(function(){e==l.Turn.AI?(console.log("\u7535\u8111\u62bd\u724c"),setTimeout(function(){g.AIController.inst.drawDomino()},500)):console.log("\u73a9\u5bb6\u62bd\u724c")});break;case i.Skip:a.SkipActionThisTurn.inst.dispatchOne(t.inst.Turn),a.ActionDoneThisTurn.inst.dispatchOne(-1);break;case i.noNeed:if(console.log("\u4e0d\u9700\u8981\u62bd\u5361"),a.CloseDominoBagSignal.inst.dispatch(),0==r.GameStateController.inst.isRoundStart())return;e==l.Turn.AI&&setTimeout(function(){g.AIController.inst.placeDomino()},500+f.Random.getRandom(0,1e3))}},Object.defineProperty(t.prototype,"PauseScore",{get:function(){return this.Model.PauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return Math.max(0,l.FreePauseLimit-this.Model.PauseCount)},enumerable:!0,configurable:!0}),t.prototype.addPauseCount=function(){this.Model.addPauseCount()},Object.defineProperty(t.prototype,"PauseCount",{get:function(){return this.Model.PauseCount},enumerable:!0,configurable:!0}),t.prototype.onPlayTurnChanged=function(e){this.checkDrawCard(e)},t.prototype.checkCanConnect=function(e){return this.Model.RoundData.isDeskEmpty()?(console.log(" is empty:",this.Model.Round),!0):null!=this.getTargetInfo(e)},t.prototype.onReleaseDomino=function(e,t,o,i){if(!o){if(this.Model.RoundData.isDeskEmpty())return this.Model.RoundData.addDomino(null,e,i,-1),void a.PlaceDomino.inst.dispatchTwo(e,-1);var n=null;i==c.DominoOwner.Player?n=this.getTargetInfo(e):(n={targetID:t,targetVal:c.DominoModel.getConnectedVal(e,t)},console.log("ai target:",n)),null!=n&&(console.log("place target :",n.targetID,", connected point :",l.DominoPoint[n.targetVal]),this.Model.RoundData.addDomino(n.targetID,e,i,n.targetVal),a.PlaceDomino.inst.dispatchTwo(e,n.targetVal))}},t.prototype.setForkDomino=function(e){this.Model.ForkDominoID=e},Object.defineProperty(t.prototype,"ForkDomino",{get:function(){return this.Model.ForkDominoID},enumerable:!0,configurable:!0}),t.prototype.getPointRemoveCount=function(e){if(0==c.DominoModel.getDominoByID(e).isMirror())return 1;if(null==this.Model.ForkDominoID)this.Model.ForkDominoID=e;else if(this.Model.ForkDominoID!=e)return 1;var t=u.DeskNodeModel.getDeskNodeByDominoID(e),o=0;return t.LeftFree||o++,t.RightFree||o++,t.BotFree||o++,t.TopFree||o++,o>=3?-1:0},t.prototype.getFreeDominos=function(){for(var e=[],t=0,o=this.Model.getDeskDominosInRound();t<o.length;t++){var i=o[t];i.CanConnect&&e.push(i)}return e},t.prototype.getTargetInfo=function(e){var t=this.getCanConnectedDominos(e);if(t.length<=0)return null;for(var o=this.connectJudgeDistance,i="",n=-1,s=0,a=t;s<a.length;s++){var r=a[s];h.default.getDistance(e,r)<o&&(o=h.default.getDistance(e,r),i=r,n=c.DominoModel.getConnectedVal(e,i))}return""==i||-1==n?null:{targetVal:n,targetID:i}},t.prototype.checkCanPlace=function(){for(var e=0,t=this.Model.currentTurn==l.Turn.AI?this.Model.getAIDominosInRound():this.Model.getPlayerDominosInRound();e<t.length;e++){var o=t[e];if(this.getCanConnectedDominos(o.ID).length>0)return!0}return!1},t.prototype.checkNeed2Draw=function(){if(this.Model.RoundData.isDeskEmpty())return i.noNeed;if(this.checkCanPlace())return i.noNeed;if(this.Model.getStackDominosInRound().length>0)return i.Need;for(var e=0,t=this.Model.currentTurn==l.Turn.AI?this.Model.getPlayerDominosInRound():this.Model.getAIDominosInRound();e<t.length;e++){var o=t[e];if(this.getCanConnectedDominos(o.ID).length>0)return i.Skip}return r.GameStateController.inst.roundEnd(r.RoundEndType.OutOfMove),i.End},t.prototype.onDispatchDominoDone=function(e,t){this.changeDominoOwner(t,e),r.GameStateController.inst.isRoundStart()||r.GameStateController.inst.canStart()&&(this.roundDispatchCount++,this.roundDispatchCount>=this.roundDispatchCountLimit&&(r.GameStateController.inst.roundStart(),this.checkDrawCard(this.Model.currentTurn),this.roundDispatchCount=0))},t.prototype.getTotalScore=function(){return this.Model.TotalScore},t.prototype.checkScore=function(e){if(e<=0)return e;var t=e;return console.log("origin Score:",e,", new Score:",t),t},t.prototype.addScore=function(e,t){0!=e&&(this.Model.currentTurn==l.Turn.AI?this.Model.addNoviceScore(e):this.Model.addPlayerScore(e))},t.prototype.getPlayerRestPoints=function(){for(var e=0,t=0,o=this.Model.getPlayerDominosInRound();t<o.length;t++)for(var i=o[t],n=0,s=i.FreePoints;n<s.length;n++){e+=s[n]*i.Times}return e},t.prototype.getAiRestPoints=function(){for(var e=0,t=0,o=this.Model.getAIDominosInRound();t<o.length;t++)for(var i=o[t],n=0,s=i.FreePoints;n<s.length;n++){e+=s[n]*i.Times}return e},t.prototype.isPlayerWin=function(){return this.getPlayerRestPoints()<this.getAiRestPoints()},t.prototype.isPlayerOut=function(){return this.getPlayerDominos().length<=0},t.prototype.checkoutThisRound=function(){console.log(" \u6839\u636e\u5269\u4f59\u70b9\u6570\u7ed3\u7b97\u672c\u8f6e");var e=this.getAiRestPoints(),t=this.getPlayerRestPoints();t<e?this.Model.addPlayerScore(e):this.Model.addNoviceScore(t)},t.prototype.checkMatch=function(e){var t=this.getFreeDominos(),o=[],i=1;if(t.length<=0)console.warn(" \u6ca1\u6709\u7aef\u5934");else{console.log("\u68c0\u6d4b\u662f\u5426\u8fde\u8fde\u770b:",e);var n=0;if(1==t.length){if(!t[0].isMirror()||t[0].ID!=this.ForkDomino)return;o.push(t[0].ID),i=t[0].Times,n=this.checkScore(2*e)*t[0].Times}else{for(var s=0,r=0;r<t.length;r++){var c=t[r];c.FreePoints[0]==e&&(o.push(c.ID),i=Math.max(i,c.Times),c.isMirror()?s+=2:s+=1)}s>=l.MatchLimit&&(n=this.checkScore(e*s)*i),console.log("matchCount:",s,",times:",i,",addScore:",n)}n>0&&(a.PlayMatchAnimation.inst.dispatchTwo(e,o),this.Model.addMatchCount()),this.addScore(n,i)}},t.prototype.createRoundData=function(){this.Model.createRoundData()},t.prototype.initGametheme=function(){this.Model.initGametheme()},t.prototype.isPlayerTurn=function(){return this.Model.currentTurn==l.Turn.Player},t.prototype.nextRound=function(){d.DominoSelector.inst.free(!0),this.roundDispatchCount=0,r.GameStateController.inst.roundEnd(r.RoundEndType.Init),a.BeforeNextRoundSignal.inst.dispatch(),this.Model.nextRound(),a.ReadyDispatchDominoSignal.inst.dispatch()},t.prototype.getOriginDominoOnNewRound=function(){return this.Model.getTotalDominosInRound()},t.prototype.getPlayerDominos=function(){return this.Model.getPlayerDominosInRound()},t.prototype.getAIDominos=function(){return this.Model.getAIDominosInRound()},t.prototype.setPlayerDominos=function(e){this.Model.setPlayerDominos(e)},t.prototype.setAIDominos=function(e){this.Model.setAIDominos(e)},t.prototype.setStackDominos=function(e){this.Model.setStackDominos(e)},t.prototype.getDeskDominos=function(){return this.Model.getDeskDominosInRound()},t.prototype.showAllRest=function(){for(var e=this.getPlayerDominos(),t=0,o=e;t<o.length;t++){(r=o[t]).setOwner(c.DominoOwner.Dispatcher)}a.ShowAllPlayerRestSignal.inst.dispatchOne(e);for(var i=this.getAIDominos(),n=0,s=i;n<s.length;n++){var r;(r=s[n]).setOwner(c.DominoOwner.Dispatcher),r.setState(c.DominoState.Front)}a.ShowAllAIRestSignal.inst.dispatchOne(i)},t.prototype.getStackDominos=function(){return this.Model.getStackDominosInRound()},t.prototype.changeDominoOwner=function(e,t){c.DominoModel.getDominoByID(t).setOwner(e)},t.prototype.getHungryDominos=function(e){for(var t=[],o=0,i=this.Model.getDeskDominosInRound();o<i.length;o++){var n=i[o];c.DominoModel.checkCanConnect(e,n.ID)&&t.push(n)}return t},t.prototype.getCanConnectedDominos=function(e){var t=[],o=this.getHungryDominos(e);if(o.length<=0)return[];for(var i=0,n=o;i<n.length;i++){var s=n[i];p.DeskCheckModel.CheckCanPlace(e,s.ID)&&t.push(s.ID)}return t},t.prototype.getDominosInRange=function(e){var t=[],o=this.getCanConnectedDominos(e);if(o.length<=0)return[];for(var i=0,n=o;i<n.length;i++){var s=n[i];h.default.getDistance(e,s)<this.connectJudgeDistance&&t.push(s)}return t},t.prototype.getHighLightDominos=function(e){var t={highLights:[],target:null},o=this.getDominosInRange(e),i=this.getTargetInfo(e);if(null==i)return o.length>0&&console.warn("target is null, dominos(In range) is not null, id:",e),t;var n=o.indexOf(i.targetID);return n>=0&&o.splice(n,1),t.highLights=o,t.target=i.targetID,t},t.prototype.onDominoMoved=function(e){var t=this.getHighLightDominos(e);a.UpdateHighLightDomino.inst.dispatchTwo(t.highLights,t.target)},t}(n.SingleTon());o.PlayerModelProxy=m,cc._RF.pop()},{"../../Utils/Random":"Random","../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal","../Controller/AIController":"AIController","../Controller/DominoSelector":"DominoSelector","../Controller/GameStateController":"GameStateController","../Model/DeskCheckModel":"DeskCheckModel","../Model/DeskNodeModel":"DeskNodeModel","../Model/DominoModel":"DominoModel","../Model/GamePlayModel":"GamePlayModel","../Model/GameRule":"GameRule","../View/DominoControl/DominoNodePool":"DominoNodePool"}],PlayerScoreView:[function(e,t,o){"use strict";cc._RF.push(t,"e8edbOBuLtMSqa2yMYDJxJP","PlayerScoreView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./NumberChangedView"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.PlayerScoreChanged.inst.addListenerOne(this.onNumberChanged,this)},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal","./NumberChangedView":"NumberChangedView"}],Random:[function(e,t,o){"use strict";cc._RF.push(t,"114f9Vox8JGQbohBr4HFlkf","Random"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){}return e.seededRandom=function(e,t,o){return t+1e6*((1711*e+88888)%302654/302654+(1722*e+55555)%302665/302665+(1755*e+23333)%302766/302766)%1e6/1e6*(o-t)},e.getRandom=function(e,t){void 0===e&&(e=0),void 0===t&&(t=1);var o=this.randomSeed,i=this.seededRandom(o,e,t),n=Math.floor(this.seededRandom(o,1,302766));return this.randomSeed+=n,i},e.setRandomSeed=function(e){console.log(" set random seed:",e),this.randomSeed=e,this.sharedSeed=e},e.randomRoundToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.round(this.getRandom(e,t))},e.clamp=function(e,t,o){return Math.max(t,Math.min(e,o))},e.randomSeed=Math.random(),e.sharedSeed=Math.random(),e}();o.Random=i,cc._RF.pop()},{}],ResourceController:[function(e,t,o){"use strict";cc._RF.push(t,"101438Z+apHT6Ap+WQKfVd2","ResourceController"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/ToSingleton"),n=e("../../Global/Theme"),s=e("../../Factory/GameFactory"),a=e("../View/DominoControl/DominoDeskTransform"),r=e("../../Utils/HashMap"),c=e("../Facade/PlayerModelProxy"),l={Number:{VerticalNormal:"bg_vertical",VerticalReverse:"bg_vertical",HorizontalLeft:"bg_across",HorizontalRight:"bg_across"},Sweet:{VerticalNormal:"bg_vertical",VerticalReverse:"bg_vertical",HorizontalLeft:"bg_across",HorizontalRight:"bg_across"}};o.MatchAtlas={Number:{0:"",1:"number",2:"number",3:"number",4:"number",5:"number",6:"number",7:"number"},Sweet:{0:"",1:"point1",2:"point2",3:"point3",4:"point4",5:"point5",6:"point6",7:"point7"}},o.Title={Complete:"bg_font_complete",TimeUp:"bg_font_timeup"};var d={Number:{0:"",1:"bg_point1",2:"bg_point2",3:"bg_point3",4:"bg_point4",5:"bg_point5",6:"bg_point6",7:"bg_point7"},Sweet:{0:"",1:"bg_point1circle",2:"bg_point2circletriangle",3:"bg_point3circlesquare",4:"bg_point4circleheart",5:"bg_point5circlestar",6:"bg_point6circlerainbow",7:"bg_point7circledonut"}};o.FontAtlas={FirstRound:"bg_font_start",Points:"bg_font_points",PlayerDominoLink:"bg_font_link1",AIDominoLink:"bg_font_link2",Locked:"bg_font_locked",NoviceScore:"bg_font_nscore",PlayerScore:"bg_font_youscore",Pass:"bg_font_pass",FinalRound:"bg_font_Final round",Three:"font_3",Two:"font_2",One:"font_1",LetsGo:"font_let'sgo"},o.PauseTip={noFree:"bg_font_nofree",Free:"bg_font_free"},o.ScoreFont={Red:"Red",Gold:"Gold"};var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matchAtlas=new r.HashMap,t.UIAtlas=null,t.FontAtlas=null,t.fonts=new r.HashMap,t}return __extends(t,e),t.prototype.setAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.UIAtlas=e},t.prototype.setFont=function(e,t){this.fonts.add(e,t)},t.prototype.getFont=function(e){return this.fonts.get(e)},t.prototype.getTitleSprite=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.setFontAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.FontAtlas=e},t.prototype.getFontAltas=function(e){return this.FontAtlas.getSpriteFrame(e)},t.prototype.getAltas=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.addMatchAtlas=function(e,t){this.matchAtlas.add(e,t)},t.prototype.getMatchAtlas=function(e){var t=c.PlayerModelProxy.inst.Theme;return this.matchAtlas.get(o.MatchAtlas[n.Theme[t]][e])},t.prototype.getPointSprite=function(e,t){var o=d[n.Theme[e]][t];return o&&""!=o?this.UIAtlas.getSpriteFrame(o):null},t.prototype.getFrontSprite=function(e,t){var o=l[n.Theme[e]][a.RotateState[t]];return o&&""!=o?this.UIAtlas.getSpriteFrame(o):null},t.prototype.getDomino=function(e){return s.gFactory.getObj("Domino",e)},t.prototype.putDomino=function(e){e.stopAllActions(),s.gFactory.putObj("Domino",e)},t}(i.SingleTon());o.ResourceController=h,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../../Global/Theme":"Theme","../../Utils/HashMap":"HashMap","../../Utils/ToSingleton":"ToSingleton","../Facade/PlayerModelProxy":"PlayerModelProxy","../View/DominoControl/DominoDeskTransform":"DominoDeskTransform"}],ResultLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"1d316b2LEdDqYFjzncb2WIs","ResultLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("../../Command/GamePlaySignal"),s=e("../../Controller/GameStateController"),a=e("./NumberChangedView"),r=e("./Animations/BlingAnimation"),c=e("../../../Global/Theme"),l=e("../../Facade/PlayerModelProxy"),d=e("../../../Utils/Time"),h=e("../../../Utils/Celer/CelerSDK"),u=e("../../Controller/ResourceController"),p=cc._decorator,g=p.ccclass,f=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CountTotal=4,t.count=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Root",{get:function(){return this.node.getChildByName("Root")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Light",{get:function(){return this.Root.getChildByName("Light")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.Root.getChildByName("Title").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalScore",{get:function(){return this.Root.getChildByName("TotalScore").getComponent(a.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Points",{get:function(){return this.Root.getChildByName("Points").getComponent(a.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointSpread",{get:function(){return this.Root.getChildByName("PointSpread").getComponent(a.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Root.getChildByName("TimeBonus").getComponent(a.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScoreSub",{get:function(){return this.Root.getChildByName("ScoreSub").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeSec",{get:function(){return this.Root.getChildByName("TimeSec").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeMin",{get:function(){return this.Root.getChildByName("TimeMin").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SpineRoot",{get:function(){return this.Root.getChildByName("Spine")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bling",{get:function(){return this.Root.getChildByName("Bling").getComponent(r.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Submit",{get:function(){return this.Root.getChildByName("Submit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseScore",{get:function(){return this.Root.getChildByName("PauseScore").getComponent(a.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.active=!1,this.node.scale=1,n.OpenResultLayerSignal.inst.addListenerOne(this.onGameOver,this)},t.prototype.onGameOver=function(e){this.Submit.scale=0,this.Bling.node.active=!1,this.Light.scale=0,this.PauseScore.node.active=!1,this.PauseScore.node.active?this.CountTotal=5:this.CountTotal=4,e==s.RoundEndType.TimeUp?this.Title.spriteFrame=u.ResourceController.inst.getTitleSprite(u.Title.TimeUp):this.Title.spriteFrame=u.ResourceController.inst.getTitleSprite(u.Title.Complete);for(var t=0,o=this.SpineRoot.children;t<o.length;t++){var i=o[t];i.active=i.name==c.Theme[l.PlayerModelProxy.inst.Theme],i.active&&(this.spine=i.getComponent(sp.Skeleton))}var n=d.Time.timeFormat(l.PlayerModelProxy.inst.TimeLeft);this.TimeMin.string=n.split("/")[0],this.TimeSec.string=n.split("/")[1],this.ScoreSub.string=l.PlayerModelProxy.inst.PlayerScore+"/"+l.PlayerModelProxy.inst.NoviceScore,this.Root.scale=0,this.node.active=!0,this.Root.runAction(cc.sequence(cc.scaleTo(.1,.9,1.3),cc.scaleTo(.1,1.2,.9),cc.scaleTo(.1,1,1),cc.callFunc(this.showInfo.bind(this))))},Object.defineProperty(t.prototype,"Count",{get:function(){return this.count},set:function(e){var t=this;this.count!=e&&(this.count=e,console.log("count:",this.Count),this.Count>=this.CountTotal&&(n.ShowSubmitSignal.inst.dispatch(),this.Submit.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){t.Submit.once(cc.Node.EventType.TOUCH_END,function(){h.CelerSDK.inst.submitScore(l.PlayerModelProxy.inst.getTotalScore())},t),CELER_X&&setTimeout(function(){h.CelerSDK.inst.submitScore(l.PlayerModelProxy.inst.getTotalScore())},5e3)})))))},enumerable:!0,configurable:!0}),t.prototype.showInfo=function(){var e=this;this.Count=0,this.spine&&(this.spine.animation="animation",n.PlaySpineSignal.inst.dispatch(),this.spine.setEventListener(function(t,o){switch(o.stringValue){case"light":e.Bling.play(),e.Light.runAction(cc.sequence(cc.scaleTo(.1,3),cc.callFunc(function(){e.Light.runAction(cc.repeatForever(cc.rotateBy(.1,1)))})))}})),this.TotalScore.STEP=150,this.Points.STEP=150,this.PointSpread.STEP=150,this.TimeBonus.STEP=150,this.PauseScore.STEP=150;var t=function(){n.ScoreCountingSignal.inst.dispatch()};this.TimeBonus.onStep=t,this.TotalScore.onStep=t,this.Points.onStep=t,this.PointSpread.onStep=t,this.PauseScore.onStep=t,this.PauseScore.node.active&&this.PauseScore.onNumberChanged(l.PlayerModelProxy.inst.PauseScore,function(){e.Count++,console.log(" pauseScore Done")}),this.TimeBonus.onNumberChanged(l.PlayerModelProxy.inst.TimeBonus,function(){e.Count++,console.log("TimeBonus Done")}),this.TotalScore.onNumberChanged(l.PlayerModelProxy.inst.getTotalScore(),function(){e.Count++,console.log("TotalScore Done")}),this.Points.onNumberChanged(l.PlayerModelProxy.inst.PlayerScore+l.PlayerModelProxy.inst.PauseScore,function(){e.Count++,console.log("Points Done")}),this.PointSpread.onNumberChanged(l.PlayerModelProxy.inst.PointSpread,function(){e.Count++,console.log("PointSpread Done")})},t=__decorate([g],t)}(i.default));o.default=f,cc._RF.pop()},{"../../../Global/Theme":"Theme","../../../Utils/Celer/CelerSDK":"CelerSDK","../../../Utils/Time":"Time","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/GameStateController":"GameStateController","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","./Animations/BlingAnimation":"BlingAnimation","./NumberChangedView":"NumberChangedView"}],RevertButton:[function(e,t,o){"use strict";cc._RF.push(t,"3cd7e1GQclO6b3cd+ADDY2O","RevertButton"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/Test"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.on(cc.Node.EventType.TOUCH_END,function(){n.RevertSignal.inst.dispatch()},this)},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/Test":"Test","../../Command/GamePlaySignal":"GamePlaySignal"}],RoundInfoMediator:[function(e,t,o){"use strict";cc._RF.push(t,"fc81ebQhvNGn5DghI/pHhJR","RoundInfoMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../../Controller/GameStateController"),a=e("../../Controller/ResourceController"),r=e("../../Facade/PlayerModelProxy"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isShowingCountdown=!1,t}return __extends(t,e),t.prototype.onRegister=function(){n.RoundEndSignal.inst.addListenerOne(this.onRoundEnd,this),n.PlayerScoreChanged.inst.addListenerTwo(this.onPlayerScoreChanged,this),n.NoviceScoreChanged.inst.addListenerTwo(this.onNoviceScoreChanged,this),n.SkipActionThisTurn.inst.addListener(this.onPass,this),n.GameOverSignal.inst.addListenerOne(this.onGameOver,this),n.FirstRoundStartSignal.inst.addListener(this.onGameStart,this),n.GamePauseSignal.inst.addListener(this.onGamePause,this),n.LastRoundStartSignal.inst.addListener(this.onLastRound,this),n.OnPlayMatchAnimation.inst.addListenerTwo(this.onMatchAnimationPlayed,this)},t.prototype.onMatchAnimationPlayed=function(e,t){},t.prototype.onLastRound=function(){this.View.showFont(function(){},a.FontAtlas.FinalRound,!1)},t.prototype.onGamePause=function(){this.isShowingCountdown&&(this.View.stopFont(),s.GameStateController.inst.addResumeCallback(this.startCountDown.bind(this)))},t.prototype.startCountDown=function(){var e=this;this.View.stopFont(),this.isShowingCountdown=!0,n.CountDownSignal.inst.dispatch(),this.View.showCountDown(function(){n.CountDownSignal.inst.dispatch(),e.View.showCountDown(function(){n.CountDownSignal.inst.dispatch(),e.View.showCountDown(function(){e.View.showCountDown(function(){e.isShowingCountdown=!1,n.NextRoundSignal.inst.dispatch()},a.FontAtlas.LetsGo)},a.FontAtlas.One)},a.FontAtlas.Two)},a.FontAtlas.Three)},t.prototype.onGameStart=function(){var e=this;this.View.showFont(function(){e.startCountDown()},a.FontAtlas.FirstRound,!1)},t.prototype.onGameOver=function(e){var t=null;t=e==s.RoundEndType.TimeUp?a.ResourceController.inst.getTitleSprite(a.Title.TimeUp):a.ResourceController.inst.getTitleSprite(a.Title.Complete),this.View.showFont(function(){},t,!1,1.6),setTimeout(function(){n.OpenResultLayerSignal.inst.dispatchOne(e)},2e3)},t.prototype.onPass=function(){this.View.showPass()},t.prototype.onNoviceScoreChanged=function(e,t){console.log(" Novice add Score:",t),t<=0||s.GameStateController.inst.isRoundStart()||this.View.showGetScore(t,!1,function(){n.NextRoundSignal.inst.dispatch()})},t.prototype.onPlayerScoreChanged=function(e,t){console.log(" player add Score:",t,s.GameStateController.inst.isRoundStart()),s.GameStateController.inst.isRoundStart()?t>0?this.View.showGetScore(t,!0,null):this.View.showSubScore(t,null):t>0&&this.View.showGetScore(t,!0,function(){n.NextRoundSignal.inst.dispatch()})},t.prototype.onRoundEnd=function(e){var t=this;console.log(" round info:",s.RoundEndType[e]);var o=r.PlayerModelProxy.inst.hasScoreBonus();if(e==s.RoundEndType.DominoOut){var i=r.PlayerModelProxy.inst.isPlayerOut();this.View.showFont(function(){o?(r.PlayerModelProxy.inst.showAllRest(),t.View.showFont(function(){r.PlayerModelProxy.inst.playAllMatchAnimation(),r.PlayerModelProxy.inst.checkoutThisRound()},i?a.FontAtlas.PlayerScore:a.FontAtlas.NoviceScore,i)):r.PlayerModelProxy.inst.checkoutThisRound()},i?a.FontAtlas.PlayerDominoLink:a.FontAtlas.AIDominoLink,i)}else e==s.RoundEndType.OutOfMove&&this.View.showFont(function(){r.PlayerModelProxy.inst.showAllRest();var e=r.PlayerModelProxy.inst.isPlayerWin();t.View.showFont(function(){r.PlayerModelProxy.inst.playAllMatchAnimation(),r.PlayerModelProxy.inst.checkoutThisRound()},e?a.FontAtlas.PlayerScore:a.FontAtlas.NoviceScore,e)},a.FontAtlas.Locked,!1)},t=__decorate([l],t)}(i.default));o.default=d,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/GameStateController":"GameStateController","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy"}],RoundInfoView:[function(e,t,o){"use strict";cc._RF.push(t,"d2f47HoXG9I142ufIU0vAHm","RoundInfoView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./RoundInfoMediator"),s=e("./Animations/ScoreEffectAnimation"),a=e("../../Controller/ResourceController"),r=cc._decorator,c=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Win",{get:function(){return this.node.getChildByName("Win")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScoreEffect",{get:function(){return this.node.getChildByName("ScoreEffect").getComponent(s.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Font",{get:function(){return this.node.getChildByName("Font").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScoreLabel",{get:function(){return this.node.getChildByName("Score").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Pass",{get:function(){return this.node.getChildByName("Pass")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScoreFloatRoot",{get:function(){return this.node.getChildByName("ScoreFloat")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SubScore",{get:function(){return this.node.getChildByName("SubScore").getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(n.default),this.Font.node.active=!1,this.ScoreEffect.node.active=!1,this.Win.active=!1,this.ScoreLabel.node.active=!1,this.SubScore.node.active=!1,this.Pass.active=!1,this.ScoreFloatRoot.active=!1;for(var e=0,t=this.ScoreFloatRoot.children;e<t.length;e++){t[e].active=!1}},t.prototype.start=function(){},t.prototype.showPass=function(){var e=this;this.Pass.stopAllActions(),this.Pass.scale=0,this.Pass.active=!0,this.Pass.opacity=255,this.Pass.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.delayTime(.5),cc.fadeOut(.2),cc.callFunc(function(){e.Pass.active=!1})))},t.prototype.showSubScore=function(e,t){var o=this;this.SubScore.node.scale=1,this.SubScore.string="/"+Math.abs(e).toString(),this.SubScore.node.anchorX=.5,this.SubScore.node.x=0,this.SubScore.node.active=!1,this.SubScore.node.scale=0,this.SubScore.node.opacity=255;var i=cc.sequence(cc.scaleTo(.1,1.3),cc.delayTime(.4),cc.scaleTo(.1,1),cc.delayTime(.8),cc.fadeOut(.4),cc.callFunc(function(){o.SubScore.node.active=!1,o.SubScore.node.anchorX=.5,t&&t()}));this.SubScore.node.stopAllActions(),this.SubScore.node.active=!0,this.SubScore.node.runAction(i)},t.prototype.showGetScore=function(e,t,o,i,n){var s=this;void 0===i&&(i=1),void 0===n&&(n=0),this.ScoreLabel.node.scale=1,this.Font.node.scale=1,this.ScoreLabel.node.x=-300,this.Font.node.x=0,this.ScoreLabel.string=e.toString(),this.Font.spriteFrame=a.ResourceController.inst.getFontAltas(a.FontAtlas.Points);var r=cc.sequence(cc.delayTime(n),cc.scaleTo(.1*i,1.3),cc.delayTime(.4*i),cc.scaleTo(.1*i,1),cc.delayTime(.8*i),cc.fadeOut(.4*i),cc.callFunc(function(){s.ScoreLabel.node.active=!1,s.ScoreLabel.node.anchorX=.5,o&&o()})),c=cc.sequence(cc.delayTime(n),cc.scaleTo(.1*i,1.3),cc.delayTime(.4*i),cc.scaleTo(.1*i,1),cc.delayTime(.8*i),cc.fadeOut(.4*i),cc.callFunc(function(){s.Font.node.active=!1,s.Font.node.anchorX=.5})),l=this.ScoreLabel.node.width,d=this.Font.node.width;this.Font.node.anchorX=0,this.ScoreLabel.node.anchorX=1,this.ScoreLabel.node.x+=l/2,this.Font.node.x-=d/2;var h=this.ScoreLabel.node.x-l+(l+d)/2;this.ScoreLabel.node.x-=h,this.ScoreLabel.node.x-=10,this.Font.node.x-=h,this.Font.node.x+=10,this.ScoreLabel.node.scale=0,this.Font.node.scale=0,this.ScoreLabel.node.opacity=255,this.Font.node.opacity=255,this.ScoreLabel.node.active=!0,this.Font.node.active=!0,this.ScoreLabel.node.stopAllActions(),this.Font.node.stopAllActions(),this.ScoreLabel.node.runAction(r),this.Font.node.runAction(c),t&&this.ScoreEffect.play()},t.prototype.stopFont=function(){this.Font.node.stopAllActions(),this.Font.node.anchorX=.5,this.Font.node.x=0,this.Font.node.scale=0,this.Font.node.active=!0,this.Font.node.opacity=255},t.prototype.getScoreNode=function(){for(var e=0,t=this.ScoreFloatRoot.children;e<t.length;e++){var o=t[e];if(0==o.active)return o}var i=cc.instantiate(this.ScoreFloatRoot.children[0]);return this.ScoreFloatRoot.addChild(i),console.log("add new score float node"),i},t.prototype.showMatchScore=function(e,t,o,i,n){var s=this;void 0===n&&(n=1),this.ScoreFloatRoot.active=!0;var a=this.getScoreNode();a.getComponent(cc.Label).string=e.toString(),a.setPosition(i),a.active=!0;var r=a.scale;a.scale=0,a.opacity=255,a.runAction(cc.sequence(cc.scaleTo(.1*n,1.2*r),cc.scaleTo(.1*n,r),cc.delayTime(.5*n),cc.spawn(cc.moveTo(.1*n,0,0),cc.fadeOut(.1*n)),cc.callFunc(function(){o&&o(),a.active=!1,s.checkScoreFloat()})))},t.prototype.checkScoreFloat=function(){for(var e=0,t=this.ScoreFloatRoot.children;e<t.length;e++){if(t[e].active)return}this.ScoreFloatRoot.active=!1},t.prototype.showCountDown=function(e,t){this.Font.node.stopAllActions(),this.Font.spriteFrame="string"==typeof t?a.ResourceController.inst.getFontAltas(t):t,this.ScoreLabel.node.active=!1,this.Font.node.anchorX=.5,this.Font.node.x=0,this.Font.node.scale=0,this.Font.node.active=!0,this.Font.node.opacity=255,this.Font.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.delayTime(.7),cc.scaleTo(.1,1),cc.fadeOut(.1),cc.callFunc(function(){e&&e()})))},t.prototype.showFont=function(e,t,o,i){var n=this;void 0===i&&(i=1),this.ScoreLabel.node.stopAllActions(),this.Font.node.stopAllActions(),this.Font.spriteFrame="string"==typeof t?a.ResourceController.inst.getFontAltas(t):t,this.ScoreLabel.node.active=!1,this.Font.node.anchorX=.5,this.Font.node.x=0,this.Font.node.scale=0,this.Font.node.active=!0,this.Font.node.opacity=255,this.Font.node.runAction(cc.sequence(cc.scaleTo(.1,1.2*i),cc.delayTime(1.5),cc.scaleTo(.1,1*i),cc.fadeOut(.2),cc.callFunc(function(){e&&e()}))),o&&(this.Win.active=!0,this.Win.opacity=150,this.Win.runAction(cc.sequence(cc.repeat(cc.rotateBy(.1,3),30),cc.fadeOut(.2),cc.callFunc(function(){n.Win.active=!1}))))},t=__decorate([c],t)}(i.default));o.default=l,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Controller/ResourceController":"ResourceController","./Animations/ScoreEffectAnimation":"ScoreEffectAnimation","./RoundInfoMediator":"RoundInfoMediator"}],RoundModel:[function(e,t,o){"use strict";cc._RF.push(t,"bf5bdkSPH5MipC9sR1nqP0P","RoundModel"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=e("./DominoModel"),s=e("./DeskNodeModel"),a=e("../Facade/PlayerModelProxy"),r=e("./DeskCheckModel");(function(e){e[e.AI=0]="AI",e[e.Player=1]="Player"})(i=o.DrawTarget||(o.DrawTarget={}));var c=function(){function e(e,t,o,i){this.playerDominos=[],this.AIDominos=[],this.DominoStack=[],this.DeskDominos=[],this.deskHeadDomino=null,this.round=0,this.playerDominos=e,this.AIDominos=t,this.DominoStack=o,this.deskHeadDomino=s.DeskNodeModel.createDeskNode("head-"+i,i,!0),this.round=i}return Object.defineProperty(e.prototype,"Round",{get:function(){return this.round},enumerable:!0,configurable:!0}),e.prototype.getDeskHeadDomino=function(){return this.deskHeadDomino},e.prototype.getTotalDominos=function(){return[].concat(this.AIDominos).concat(this.playerDominos).concat(this.DeskDominos).concat(this.DominoStack)},e.prototype.addPlayerDomino=function(e){this.playerDominos.push(e)},e.prototype.addDeskDomino=function(e){this.DeskDominos.push(e)},e.prototype.addAIDomino=function(e){this.AIDominos.push(e)},e.prototype.removeAIDomino=function(e){for(var t=0;t<this.AIDominos.length;t++)if(this.AIDominos[t].ID==e){this.AIDominos.splice(t,1);break}},e.prototype.removePlayerDomino=function(e){for(var t=0;t<this.playerDominos.length;t++)if(this.playerDominos[t].ID==e){this.playerDominos.splice(t,1);break}},e.prototype.removeDeskDomino=function(e){for(var t=0;t<this.DeskDominos.length;t++)if(this.DeskDominos[t].ID==e){this.DeskDominos.splice(t,1);break}},e.prototype.removeStackDomino=function(e){for(var t=0;t<this.DominoStack.length;t++)if(this.DominoStack[t].ID==e){this.DominoStack.splice(t,1);break}},e.prototype.getPlayerDominos=function(){return this.playerDominos},e.prototype.getAIDominos=function(){return this.AIDominos},e.prototype.getStackDominos=function(){return this.DominoStack},e.prototype.getDeskDominos=function(){return this.DeskDominos},e.prototype.setPlayerDominos=function(e){this.playerDominos=e},e.prototype.setAIDominos=function(e){this.AIDominos=e},e.prototype.setStackDominos=function(e){this.DominoStack=e},e.prototype.drawDomino=function(e,t){for(var o=0;o<this.DominoStack.length;++o)if(this.DominoStack[o].ID==e){console.log(i[t]," \u62bd\u724c:",e);var n=this.DominoStack.splice(o,1)[0];t==i.AI?this.addAIDomino(n):this.addPlayerDomino(n);break}console.warn(" Domino Stack has no this domino card:",e,", target:",i[t])},e.prototype.isDeskEmpty=function(){return 0==this.deskHeadDomino.hasChild()},e.prototype.isStackEmpty=function(){return this.DominoStack.length<=0},e.prototype.addDomino=function(e,t,o,i){var c=s.DeskNodeModel.createDeskNode(t),l=n.DominoModel.getDominoByID(t);if(this.isDeskEmpty())this.deskHeadDomino.addChild(c.ID,i),l.isMirror()&&a.PlayerModelProxy.inst.setForkDomino(t);else if(s.DeskNodeModel.getDeskNodeByDominoID(e).addChild(c.ID,i),i>=0){var d=n.DominoModel.getDominoByID(e),h=a.PlayerModelProxy.inst.getPointRemoveCount(e);d.removePoint(i,h);var u=a.PlayerModelProxy.inst.getPointRemoveCount(t);l.removePoint(i,u)}o==n.DominoOwner.AI?this.removeAIDomino(t):o==n.DominoOwner.Player&&this.removePlayerDomino(t),this.addDeskDomino(n.DominoModel.getDominoByID(t)),r.DeskCheckModel.UpdateTransforms()},e}();o.RoundModel=c,cc._RF.pop()},{"../Facade/PlayerModelProxy":"PlayerModelProxy","./DeskCheckModel":"DeskCheckModel","./DeskNodeModel":"DeskNodeModel","./DominoModel":"DominoModel"}],RoundNumberView:[function(e,t,o){"use strict";cc._RF.push(t,"f1e3cYK7O5CubEBkE1PRV8Q","RoundNumberView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.RoundNumberChanged.inst.addListenerOne(this.onRoundChanged,this)},t.prototype.onRoundChanged=function(e){this.node.getComponent(cc.Label).string=e.toString()},t.prototype.start=function(){},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal"}],ScoreEffectAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"9f54a+qOyRMB6B6d6INMqzW","ScoreEffectAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../Animation/MatchAnimation"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../../Animation/MatchAnimation":"MatchAnimation"}],SecondNumberView:[function(e,t,o){"use strict";cc._RF.push(t,"01490yk9XFIi4RGSkR2UXcR","SecondNumberView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Command/GamePlaySignal"),n=e("../../../Utils/Time"),s=e("../../Model/GameRule"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){i.UpdateTimeNumber.inst.addListenerOne(this.onTimeChanged,this),this.onTimeChanged(s.TotalTime)},t.prototype.onTimeChanged=function(e){var t=n.Time.timeFormat(e).split("/")[1];this.Label.string=t},t=__decorate([r],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../Utils/Time":"Time","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GameRule":"GameRule"}],ShowRestMediator:[function(e,t,o){"use strict";cc._RF.push(t,"6c4b9YLxENJsoWbT30N/Lsz","ShowRestMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseMediator"),n=e("../../Command/GamePlaySignal"),s=e("../DominoControl/DominoNodePool"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){n.ShowAllAIRestSignal.inst.addListenerOne(this.onShowAllAI,this),n.ShowAllPlayerRestSignal.inst.addListenerOne(this.onShowAllPlayer,this)},t.prototype.onShowAllAI=function(e){for(var t=[],o=0,i=e;o<i.length;o++){var n=i[o],a=s.default.getDomino(n.ID);a&&t.push(a)}this.View.showAllAI(t)},t.prototype.onShowAllPlayer=function(e){for(var t=[],o=0,i=e;o<i.length;o++){var n=i[o],a=s.default.getDomino(n.ID);a&&t.push(a)}this.View.showAllPlayer(t)},t.prototype.start=function(){},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../DominoControl/DominoNodePool":"DominoNodePool"}],ShowRestView:[function(e,t,o){"use strict";cc._RF.push(t,"c62a1huAClAK6NAmjMkYNER","ShowRestView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../View/BaseView"),n=e("./ShowRestMediator"),s=e("../../../Utils/Cocos"),a=e("../../Model/DeskCheckModel"),r=cc._decorator,c=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.space=20,t}return __extends(t,e),Object.defineProperty(t.prototype,"Ai",{get:function(){return this.node.getChildByName("AI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Player",{get:function(){return this.node.getChildByName("Player")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.BindMedaitor(n.default)},t.prototype.start=function(){},t.prototype.showAllPlayer=function(e){this.moveNodes(this.Player,e)},t.prototype.getDominoOffset=function(e){if(e<=1)return 0;var t=0,o=Math.floor(e/2);return e%2==1?(t=-o*(a.DeskCheckModel.DOMINO_SIZE.width+this.space),e>1&&(t-=(a.DeskCheckModel.DOMINO_SIZE.width+this.space)/2)):t=-o*(a.DeskCheckModel.DOMINO_SIZE.width+this.space),t+=a.DeskCheckModel.DOMINO_SIZE.width/2,t+=this.space/2},t.prototype.moveNodes=function(e,t){for(var o=this.getDominoOffset(t.length),i=0,n=0,a=t;n<a.length;n++){var r=a[n],c=s.ConvertToNodeSpaceAR(r,e);r.setParent(e),r.setPosition(c),r.runAction(cc.moveTo(.2,o+(r.width+this.space)*i++,0))}},t.prototype.showAllAI=function(e){this.moveNodes(this.Ai,e)},t=__decorate([c],t)}(i.default));o.default=l,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Model/DeskCheckModel":"DeskCheckModel","./ShowRestMediator":"ShowRestMediator"}],Signal:[function(e,t,o){"use strict";cc._RF.push(t,"5e03fyVNOZPs7lLvT6ttunM","Signal"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listenerMap=[],t.onceListenerMap=[],t}return __extends(t,e),t.prototype.doDispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.excuteListener.apply(this,e),this.excuteOnce.apply(this,e)},t.prototype.excuteListener=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.listenerMap&&this.listenerMap.length>0)for(var o=0,i=this.listenerMap;o<i.length;o++){var n=i[o];n.callback.apply(n.target,e)}},t.prototype.excuteOnce=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var o=0,i=this.onceListenerMap;o<i.length;o++){var n=i[o];n.callback.apply(n.target,e)}this.onceListenerMap.length=0}},t.prototype.listen=function(e,t){this.listenerMap.push({callback:e,target:t})},t.prototype.listenOnce=function(e,t){this.onceListenerMap.push({callback:e,target:t})},t.prototype.removeListener=function(e,t){if(this.listenerMap&&this.listenerMap.length>0)for(var o=0;o<this.listenerMap.length;++o){var i=this.listenerMap[o];i.callback==e&&i.target==t&&(this.listenerMap.splice(o,1),--o)}},t.prototype.removeTarget=function(e){if(this.listenerMap&&this.listenerMap.length>0)for(var t=0;t<this.listenerMap.length;++t){this.listenerMap[t].target==e&&(this.listenerMap.splice(t,1),--t)}},t.prototype.dispatch=function(){this.doDispatch(null)},t.prototype.dispatchOne=function(e){this.doDispatch(e)},t.prototype.dispatchTwo=function(e,t){this.doDispatch(e,t)},t.prototype.dispatchThree=function(e,t,o){this.doDispatch(e,t,o)},t.prototype.dispatchFour=function(e,t,o,i){this.doDispatch(e,t,o,i)},t.prototype.dispatchFive=function(e,t,o,i,n){this.doDispatch(e,t,o,i,n)},t.prototype.addListener=function(e,t){this.listen(e,t)},t.prototype.addOnce=function(e,t){this.listenOnce(e,t)},t.prototype.addListenerOne=function(e,t){this.listen(e,t)},t.prototype.addListenerTwo=function(e,t){this.listen(e,t)},t.prototype.addListenerThree=function(e,t){this.listen(e,t)},t.prototype.addListenerFour=function(e,t){this.listen(e,t)},t.prototype.addListenerFive=function(e,t){this.listen(e,t)},t.prototype.addOnceOne=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceTwo=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceThree=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFour=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFive=function(e,t){this.listenOnce(e,t)},t}(e("./ToSingleton").SingleTon());o.BaseSignal=i,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],SingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"a548b2LkW5CxJKelhmtRBC7","SingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.touchid=null,t}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){this.node.targetOff(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.onUnregister=function(){this.node.targetOff(this)},t.prototype.touchStart=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchStart(e)):console.log(this.node.name," touch start  touchid is different: ",this.touchid,e.getID())},t.prototype.touchMove=function(e){null!==this.touchid&&this.touchid!==e.getID()||(this.touchid=e.getID(),this.onTouchMove(e))},t.prototype.touchEnd=function(e){null===this.touchid||this.touchid===e.getID()?null!=this.touchid&&(this.touchid=null,this.onTouchEnd(e),this.OnClick()):console.log(this.node.name," touch end  touchid is different: ",this.touchid,e.getID())},t.prototype.touchCancel=function(e){null===this.touchid||this.touchid===e.getID()?null!=this.touchid&&(this.touchid=null,this.onTouchCancel(e)):console.log(this.node.name," touch cancel  touchid is different: ",this.touchid,e.getID())},t.prototype.OnClick=function(){},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t=__decorate([n],t)}(cc.Component));o.default=s,cc._RF.pop()},{}],SliderView:[function(e,t,o){"use strict";cc._RF.push(t,"394a62dXudN17IlVFpX69Lf","SliderView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Utils/Random"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.totalLength=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Progress",{get:function(){return this.node.getChildByName("Mask")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Slider",{get:function(){return this.getComponent(cc.Slider)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Percent",{get:function(){return this.Slider.progress},set:function(e){this.Slider.progress=i.Random.clamp(e,0,1),this.Progress.width=this.node.width*this.Slider.progress},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.Slider.node.on("slide",this.onSlided,this),this.totalLength=this.Progress.width},t.prototype.onSlided=function(){this.Progress.width=this.totalLength*this.Slider.progress,this.onProgress&&this.onProgress(this.Slider.progress)},t.prototype.start=function(){},t.prototype.onProgress=function(e){},t=__decorate([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../Utils/Random":"Random"}],StartGameCommond:[function(e,t,o){"use strict";cc._RF.push(t,"1db594KvoJIVbc+cwfogrGn","StartGameCommond"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./InitSignal"),n=e("../../GamePlay/Facade/PlayerModelProxy"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){console.log("--------- excute StartGameCommond ---------"),n.PlayerModelProxy.inst.createRoundData(),n.PlayerModelProxy.inst.initGametheme(),i.GameReadySignal.inst.dispatch()},t}(puremvc.SimpleCommand);o.StartGameCommond=s,cc._RF.pop()},{"../../GamePlay/Facade/PlayerModelProxy":"PlayerModelProxy","./InitSignal":"InitSignal"}],StepManager:[function(e,t,o){"use strict";cc._RF.push(t,"83709TvPtJOVayPDGaPh6Ov","StepManager");(function(){function e(){this.totalStep=[],this.curStep=[]}e.prototype.register=function(e,t){this.completeCallback=e,this.totalStep=t},e.prototype.nextStep=function(e){this.totalStep.indexOf(e)<0?console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",e):this.curStep.indexOf(e)>=0?console.warn(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",e):(this.curStep.push(e),this.curStep.sort(function(e,t){return e>t?-1:1}),this.totalStep.sort(function(e,t){return e>t?-1:1}),console.log(" cur step:",this.curStep.join(",")),console.log(" total step:",this.totalStep.join(",")),this.curStep.join(",")==this.totalStep.join(",")&&(console.log(" step done"),this.totalStep.length=0,this.completeCallback(),this.completeCallback=null))}})();cc._RF.pop()},{}],TargetAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"960bbJvbKFANaln3iMkq8bb","TargetAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../Utils/FrameAniBase"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../Utils/FrameAniBase":"FrameAniBase"}],Test:[function(e,t,o){"use strict";cc._RF.push(t,"5a43fKhvPtCNa/XTygKKeUt","Test"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../GamePlay/Model/GameRule"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.active=i.DrawDebug},t.prototype.start=function(){},t=__decorate([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../GamePlay/Model/GameRule":"GameRule"}],ThemeView:[function(e,t,o){"use strict";cc._RF.push(t,"aefb6btN6dDsLbrbCsSRBfb","ThemeView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../View/BaseView"),n=e("../Command/InitSignal"),s=e("../../Global/Theme"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},t.prototype.start=function(){},t.prototype.onThemeInit=function(e){for(var t=0,o=this.node.children;t<o.length;t++){var i=o[t];i.active=i.name==s.Theme[e]}},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../Global/Theme":"Theme","../../View/BaseView":"BaseView","../Command/InitSignal":"InitSignal"}],Theme:[function(e,t,o){"use strict";cc._RF.push(t,"1eeb2LaYMZEfb4+fEga+UZy","Theme"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Number=0]="Number",e[e.Sweet=1]="Sweet"}(o.Theme||(o.Theme={})),cc._RF.pop()},{}],TimeEffectAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"5b207NhZo1JnYmGTCnSF/9k","TimeEffectAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../../Utils/FrameAniBase"),n=e("../../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,r=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.opacity=0,n.TimeAnimationStateChanged.inst.addListenerOne(this.onPlayStateChanged,this)},t.prototype.onPlayStateChanged=function(e){e?0==this.isPlaying&&this.play():this.stop()},t.prototype.start=function(){},t.prototype.play=function(){this.node.opacity=255,e.prototype.play.call(this)},t.prototype.stop=function(){this.node.opacity=0,e.prototype.stop.call(this)},t=__decorate([a],t)}(i.default));o.default=r,cc._RF.pop()},{"../../../../Utils/FrameAniBase":"FrameAniBase","../../../Command/GamePlaySignal":"GamePlaySignal"}],Time:[function(e,t,o){"use strict";cc._RF.push(t,"87a24xcV95AoII6L5W1ABoI","Time"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){}return e.timeFormat=function(e){var t=Math.floor(e/60),o=Math.floor(e%60),i=o.toString();return o<10&&(i="0"+o),t+"/"+i},e}();o.Time=i,cc._RF.pop()},{}],ToSingleton:[function(e,t,o){"use strict";cc._RF.push(t,"b07299nlSpOIIxOkIMBhUY9","ToSingleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleTon=function(){return function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),e}()},cc._RF.pop()},{}],UpThemeView:[function(e,t,o){"use strict";cc._RF.push(t,"be1349NGflO6aWLqhbWgiHy","UpThemeView"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../View/BaseView"),n=e("../Command/InitSignal"),s=e("../../Global/Theme"),a=cc._decorator,r=a.ccclass,c=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){n.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},t.prototype.start=function(){},t.prototype.onThemeInit=function(e){for(var t=0,o=this.node.children;t<o.length;t++){var i=o[t];i.active=i.name==s.Theme[e]}},t=__decorate([r],t)}(i.default));o.default=c,cc._RF.pop()},{"../../Global/Theme":"Theme","../../View/BaseView":"BaseView","../Command/InitSignal":"InitSignal"}],UpdateController:[function(e,t,o){"use strict";cc._RF.push(t,"b3cadc9oLxMlaTWSqS0DgLW","UpdateController"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Utils/ToSingleton"),n=cc._decorator,s=n.ccclass,a=(n.property,function(e){function t(){var t=e.call(this)||this;return t.assetsManager=null,t.STORAGE_PATH=(window.jsb&&jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hot-update",t.MANIFEST_PAth="",t.isUpdating=!1,t.manifest=null,t.completeCallback=[],t.startCallback=[],t.errorCallback=[],t.progressCallback=[],t.init(),t}return __extends(t,e),t.prototype.init=function(){window.jsb&&(this.assetsManager=new jsb.AssetsManager(this.MANIFEST_PAth,this.STORAGE_PATH,this.versionCompareHandle),this.assetsManager.setVerifyCallback(this.verifyCallback.bind(this)),cc.sys.os===cc.sys.OS_ANDROID&&this.assetsManager.setMaxConcurrentTask(2))},t.prototype.setManifest=function(e){this.manifest=e},t.prototype.getVersion=function(){return null==this.assetsManager?"":null==this.assetsManager.getLocalManifest()?"":this.assetsManager.getLocalManifest().getVersion()},t.prototype.addCompleteCallback=function(e,t){this.completeCallback.push({target:t,callback:e})},t.prototype.addErrorCallback=function(e,t){this.errorCallback.push({target:e,callback:t})},t.prototype.addStartCallback=function(e,t){this.startCallback.push({target:e,callback:t})},t.prototype.addProgressCallback=function(e,t){this.progressCallback.push({target:e,callback:t})},t.prototype.triggeError=function(e,t){void 0===t&&(t=!1),this.onError(e,t)},t.prototype.onError=function(e,t){void 0===t&&(t=!1),console.log(" this.errorCallback:",this.errorCallback.length,"error:",e);for(var o=0,i=this.errorCallback;o<i.length;o++){var n=i[o];n.callback.apply(n.target,[e,t])}},t.prototype.onComplete=function(e,t){void 0===t&&(t=!1),console.log(" on update complete:",this.getVersion()),console.log("storagePath:",this.getStoragePath()),console.log("search path:",this.getSearchPaths());for(var o=function(o){setTimeout(function(){o.callback.apply(o.target,[e,t])},0)},i=0,n=this.completeCallback;i<n.length;i++){o(n[i])}},t.prototype.getStoragePath=function(){return this.assetsManager?this.assetsManager.getStoragePath():""},t.prototype.getSearchPaths=function(){return window.jsb?jsb.fileUtils.getSearchPaths():""},t.prototype.onStart=function(e,t){void 0===t&&(t=!1),console.log(" this.startCallback:",this.startCallback.length);for(var o=0,i=this.startCallback;o<i.length;o++){var n=i[o];n.callback.apply(n.target,[e,t])}},t.prototype.onProgress=function(e,t){for(var o=0,i=this.progressCallback;o<i.length;o++){var n=i[o];n.callback.apply(n.target,[e,t])}},t.prototype.loadCustomManifest=function(e){if(null!=this.assetsManager&&this.assetsManager.getState()==jsb.AssetsManager.State.UNINITED){var t=new jsb.Manifest(e,this.STORAGE_PATH);this.assetsManager.loadLocalManifest(t,this.STORAGE_PATH)}},t.prototype.checkForUpdate=function(){if(null!=this.assetsManager){if(this.isUpdating)return"Version update is on process...";if(console.log(" start check for update ..."),this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifest.nativeUrl;console.log(" native url:",e),cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this.assetsManager.loadLocalManifest(e)}if(!this.assetsManager.getLocalManifest()||!this.assetsManager.getLocalManifest().isLoaded())return this.onError("Failed to load local manifest ..."),"Failed to load local manifest ...";this.assetsManager.setEventCallback(this.checkUpdateCallback.bind(this)),this.assetsManager.checkUpdate(),this.isUpdating=!0}else this.onComplete("no need to update.")},t.prototype.checkUpdateCallback=function(e){switch(console.log("checkUpdateCallback Code: "+e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:var t=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():" null",o=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null";this.onComplete("Already up to date with the latest remote version :"+t+", local version :"+o);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.isUpdating=!1;var i=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null",n=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():"null";if(console.log("New version found, old:",i,", new: ",n),"null"==i||"null"==n);else{console.log("storage path:",this.assetsManager.getStoragePath());var s=i.split(".")[0];n.split(".")[0]>s?this.onStart("new version found, go to store to download new app.",!0):(this.onStart("new version found, update process start.",!1),this.updateVersion())}break;default:return}},t.prototype.getUpdateDescription=function(){return""},t.prototype.updateVersion=function(){if(null!=this.assetsManager&&!this.isUpdating)if([jsb.AssetsManager.State.UPDATING,jsb.AssetsManager.State.UNZIPPING,jsb.AssetsManager.State.UP_TO_DATE].indexOf(this.assetsManager.getState())>=0)this.onComplete("no need to update: "+this.assetsManager.getState(),!1);else{if(this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifest.nativeUrl;cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this.assetsManager.loadLocalManifest(e)}this.assetsManager.setEventCallback(this.updateCallback.bind(this)),console.log(" start update ...:",this.assetsManager.getState()),this.assetsManager.update(),this.isUpdating=!0}},t.prototype.versionToInt=function(e){return parseInt(e.toString().split(".").join(""))},t.prototype.versionToString=function(e){return Math.floor(e/100)+"."+Math.floor(e/10)%10+"."+Math.floor(e)%10},t.prototype.updateCallback=function(e){var t=this,o=!1,i=!1,n=null;switch(console.log("update event code:",e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped."),i=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var s=e.getPercent();NaN!=s&&"number"==typeof s||(s=0),this.onProgress(e.getMessage()?"Updated file:"+e.getMessage():"Updating:"+(100*s).toFixed(0)+"%",s);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped."),i=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:n=function(){var e=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Already up to date with the latest remote version :"+e)},i=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:n=function(){var o=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Update finished. new : "+o+e.getMessage(),!0)},o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.onError("Update failed. "+e.getMessage(),!0);break;case jsb.EventAssetsManager.ERROR_UPDATING:this.onError("Asset update error: "+e.getAssetId()+", "+e.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.onError(e.getMessage())}if(i&&(this.assetsManager.setEventCallback(null),this.isUpdating=!1),o){this.assetsManager.setEventCallback(null);var a=jsb.fileUtils.getSearchPaths();console.log("old searchPaths:",a);var r=this.assetsManager.getLocalManifest().getSearchPaths();console.log("new path:",JSON.stringify(r));for(var c=0,l=r;c<l.length;c++){var d=l[c];a.indexOf(d)<0&&Array.prototype.unshift.apply(a,d)}cc.sys.localStorage.setItem("select-game",JSON.stringify(a)),jsb.fileUtils.setSearchPaths(a),console.log("new searchPaths:",JSON.stringify(a)),console.log(" paths storage:",cc.sys.localStorage.getItem("select-game"))}n&&n()},t.prototype.restart=function(){cc.audioEngine.stopAll(),cc.game.restart()},t.prototype.retry=function(){null!=this.assetsManager&&0==this.isUpdating&&this.assetsManager.downloadFailedAssets()},t.prototype.versionCompareHandle=function(e,t){cc.log("JS Custom Version Compare: version A is "+e+", version B is "+t);for(var o=e.split("."),i=t.split("."),n=0;n<o.length;++n){var s=parseInt(o[n]),a=parseInt(i[n]||"0");if(s!==a)return s-a}return i.length>o.length?-1:0},t.prototype.verifyCallback=function(e,t){var o=t.compressed,i=t.md5,n=t.path;t.size;return o?("Verification passed : "+n,!0):("Verification passed : "+n+" ("+i+")",!0)},t.prototype.destory=function(){this.assetsManager&&this.assetsManager.setEventCallback(null),this.startCallback=[],this.completeCallback=[],this.errorCallback=[],this.progressCallback=[]},t=__decorate([s],t)}(i.SingleTon()));o.default=a,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}]},{},["App","GameFactory","MatchAnimation","TargetAnimation","GamePlaySignal","AIController","DominoSelector","GameStateController","ResourceController","PlayerModelProxy","DeskCheckModel","DeskNodeModel","ChildBotParentBot","ChildBotParentMid","ChildBotParentTop","ChildMidParentBot","ChildMidParentTop","ChildTopParentBot","ChildTopParentMid","ChildTopParentTop","DominoTransform","DominoModel","GamePlayModel","GameRule","RoundModel","DeskRootMediator","DeskRootView","ShowRestMediator","ShowRestView","DominoDeskTransform","DominoDeskTransformMediator","DominoNodePool","DominoTouchMediator","DominoTouchView","AICardRootMediator","AICardRootView","CardDrawRootMediator","CardDrawRootView","DominoHighLightMediator","DominoHighLightView","DominoMatchAniMediator","DominoMatchAniView","DominoRootMediator","DominoRootView","DominoStateMediator","DominoStateView","PlayerCardRootMediator","PlayerCardRootView","NextRoundButton","RevertButton","BagOpenAnimation","BlingAnimation","ScoreEffectAnimation","TimeEffectAnimation","BoneyardView","BottomLightView","CardBagView","MinuteNumberView","NoviceScoreView","NumberChangedView","PauseButtonView","PauseLayerMediator","PauseLayerView","PlayerScoreView","ResultLayerView","RoundInfoMediator","RoundInfoView","RoundNumberView","SecondNumberView","GuideLayerMediator","GuideLayerView","HandAnimation","Page3GuideView","Page4GuideView","Desk","FacadeGlobal","Level","Theme","InitSignal","InititalCommond","LoadAudioCommond","LoadPrefabCommond","StartGameCommond","InitialFacade","InitSceneView","LoadingPageMediator","LoadingView","ThemeView","UpThemeView","AudioManager","StepManager","UpdateController","CelerSDK","Cocos","FrameAniBase","HashMap","LogHandler","Random","Signal","Time","ToSingleton","BaseMediator","BaseView","SingleTouchMediator","SliderView","Test"]);