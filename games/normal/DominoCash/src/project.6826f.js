window.__require=function t(e,i,o){function n(s,r){if(!i[s]){if(!e[s]){var h=s.split("/");if(h=h[h.length-1],!e[h]){var l="function"==typeof __require&&__require;if(!r&&l)return l(h,!0);if(a)return a(h,!0);throw new Error("Cannot find module '"+s+"'")}}var d=i[s]={exports:{}};e[s][0].call(d.exports,function(t){return n(e[s][1][t]||t)},d,d.exports,t,e,i,o)}return i[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<o.length;s++)n(o[s]);return n}({AICardRootMediator:[function(t,e,i){"use strict";cc._RF.push(e,"c4ada55MoZOXLMlauB7AaZA","AICardRootMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.DispatchAIDomino.inst.addListenerThree(this.onDispatchDomino,this)},e.prototype.onDispatchDomino=function(t,e,i){this.View.addDomino(t,e,i)},e.prototype.onUnregister=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal"}],AICardRootView:[function(t,e,i){"use strict";cc._RF.push(e,"2cb3dA6rJhNvJZr2QVIvF+K","AICardRootView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("../../../Utils/Cocos"),a=t("./AICardRootMediator"),s=t("../../Command/GamePlaySignal"),r=t("../../Model/DominoModel"),h=cc._decorator,l=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childOffset=cc.v2(17,0),e}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=.7,this.BindMedaitor(a.default)},e.prototype.start=function(){},e.prototype.addDomino=function(t,e,i){var o=this,a=cc.v2(0,0);t.getParent()&&(a=n.ConvertToNodeSpaceAR(this.node,t.getParent()),i<=7?(a.addSelf(this.childOffset.mul(i)),a.addSelf(cc.v2(t.width,0).mul(i).add(cc.v2(.75*t.width,0)))):(a.addSelf(this.childOffset.mul(i-6).add(cc.v2(15,t.height/3))),a.addSelf(cc.v2(t.width,0).mul(i%7).add(cc.v2(.75*t.width,0))))),t.runAction(cc.sequence(cc.delayTime(.1*i),cc.spawn(cc.moveTo(.2,a),cc.scaleTo(.2,.7)),cc.callFunc(function(){t.scale=1;var i=cc.v2(0,0);o.node.childrenCount<7?(i.addSelf(o.childOffset.mul(o.node.childrenCount+1)),i.addSelf(cc.v2(t.width,0).mul(o.node.childrenCount).add(cc.v2(.75*t.width,0)))):(i.addSelf(o.childOffset.mul(o.node.childrenCount-6).add(cc.v2(15,t.height/3))),i.addSelf(cc.v2(t.width,0).mul(o.node.childrenCount%7).add(cc.v2(.75*t.width,0)))),t.setParent(o.node),t.zIndex=100-o.node.childrenCount,t.setPosition(i),s.DispatchDoneSignal.inst.dispatchTwo(e,r.DominoOwner.AI)})))},e=__decorate([l],e)}(o.default));i.default=d,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./AICardRootMediator":"AICardRootMediator"}],App:[function(t,e,i){"use strict";cc._RF.push(e,"eaeeaWDD5pJfqkUameEwNsk","App"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Initialization/Facade/InitialFacade"),n=t("../GamePlay/Controller/ResourceController"),a=cc._decorator,s=a.ccclass,r=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GameUIAtlas=null,e}return __extends(e,t),e.prototype.onLoad=function(){console.log(" app onload "),n.ResourceController.inst.setAtlas(this.GameUIAtlas)},e.prototype.start=function(){o.InitialFacade.inst.start()},__decorate([r(cc.SpriteAtlas)],e.prototype,"GameUIAtlas",void 0),e=__decorate([s],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../GamePlay/Controller/ResourceController":"ResourceController","../Initialization/Facade/InitialFacade":"InitialFacade"}],AudioManager:[function(t,e,i){"use strict";cc._RF.push(e,"88c70Ktw0pBKKUTDtyQ2NkZ","AudioManager"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Utils/HashMap");window.oncanplay&&(window.oncanplay=function(){a.canPlay=!0});var n="sounds/",a=function(){function t(){this.audioID={},this.clips=new o.HashMap}return Object.defineProperty(t,"inst",{get:function(){return this.ins?this.ins:this.ins=new t},enumerable:!0,configurable:!0}),t.prototype.init=function(t){var e=this;console.warn(" start load AudioClip ");var i=this;cc.loader.loadRes(n+"bgm",cc.AudioClip,function(e,o){e?console.error(e):(i.clips.add(o.name,o),t&&t())}),cc.loader.loadRes(n+"mouse_bgm",function(t,e){t?console.error(t):i.clips.add(e.name,e)}),cc.loader.loadRes(n+"bgm_30",function(t,e){t?console.error(t):i.clips.add(e.name,e)}),cc.loader.loadResDir(n,function(t,i,o){if(t)console.error(t);else for(var n=0,a=i;n<a.length;n++){var s=a[n];e.clips.has(s.name)||e.clips.add(s.name,s)}})},t.prototype.playEffect=function(e,i,o){var a=this;if(void 0===i&&(i=!1),t.canPlay){if(!(cc.audioEngine.getEffectsVolume()<=.05)){var s=this.clips.get(e);s?(this.audioID[e]=cc.audioEngine.playEffect(s,i),cc.audioEngine.setFinishCallback(this.audioID[e],function(){o&&o()})):cc.loader.loadRes(n+e,cc.AudioClip,function(t,n){t?console.error(t):(a.clips.add(n.name,n),a.audioID[e]=cc.audioEngine.playEffect(n,i),cc.audioEngine.setFinishCallback(a.audioID[e],function(){o&&o()}))})}}else this.bindTouch()},t.prototype.playMusic=function(e,i){var o=this;if(void 0===i&&(i=!0),!t.canPlay)return this.bindTouch(),void t.PlayedList.push({loop:!0,volume:1,clipName:e,supTime:Date.now(),skip:!1,isBgm:!0});var a=this.clips.get(e);a?cc.audioEngine.playMusic(a,i):cc.loader.loadRes(n+e,cc.AudioClip,function(t,e){t?console.error(t):("string"==typeof e._audio&&cc.loader._cache&&cc.loader._cache[e._audio]&&cc.loader._cache[e._audio].buffer&&(e._audio=cc.loader._cache[e._audio].buffer),o.clips.add(e.name,e),cc.audioEngine.playMusic(e,i))})},t.prototype.bindTouch=function(){if(!t.hasBindTouch){var e=this,i=function(){var o;for(cc.game.canvas.removeEventListener("touchstart",i),t.canPlay=!0;(o=t.PlayedList.pop())&&e.clips.get(o.clipName)&&!o.skip;)cc.audioEngine.playMusic(e.clips.get(o.clipName),o.loop)};t.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",i)}},t.PlayedList=[],t.canPlay=!1,t.hasBindTouch=!1,t}();i.gAudio=a.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],BaseMediator:[function(t,e,i){"use strict";cc._RF.push(e,"a76c1ySm3tAQId4zbAsdr/d","BaseMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.bind=function(t){this.view=t},Object.defineProperty(e.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),e.prototype.onRegister=function(){console.error(" should override onRegister ")},e.prototype.onUnregister=function(){console.error(" should override onUnregister ")},e=__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],BaseView:[function(t,e,i){"use strict";cc._RF.push(e,"6daedF7tVNJ3qN565kuohVZ","BaseView"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=0},e.prototype.Show=function(t){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){t&&t()})))},e.prototype.Hide=function(t){var e=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){e.node.active=!1,t&&t()})))},e.prototype.OnClick=function(){},e.prototype.BindMedaitor=function(t){if(!this.node.getComponent(t)){var e=this.node.addComponent(t);return e.bind&&e.bind(this),e.onRegister&&e.onRegister(),e}console.warn(" this node already has the same component..")},e.prototype.UnbindMedaitor=function(t){var e=this.node.getComponent(t);if(e)return e.onUnregister&&e.onUnregister(),e.bind&&e.bind(null),this.node.removeComponent(t),e;console.warn(" component already removed..")},e=__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],BoneyardView:[function(t,e,i){"use strict";cc._RF.push(e,"b154euTdL5OGYwXKvvOY1je","BoneyardView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./NumberChangedView"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.BoneyardCountChanged.inst.addListenerOne(this.onNumberChanged,this)},e.prototype.start=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal","./NumberChangedView":"NumberChangedView"}],CardBagView:[function(t,e,i){"use strict";cc._RF.push(e,"88a63Q6wgZO+oBZDp1W3w5V","CardBagView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.node.scale=1,n.BoneyardCountChanged.inst.addListenerOne(function(){t.node.stopAllActions(),t.node.runAction(cc.sequence(cc.scaleTo(.05,1.2),cc.scaleTo(.05,1)))},this)},e.prototype.start=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal"}],CardDrawRootMediator:[function(t,e,i){"use strict";cc._RF.push(e,"fad0fFFWGBMpYnfZ9Ni9q3J","CardDrawRootMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.DispatchStackDomino.inst.addListenerThree(this.onAddDomino,this)},e.prototype.onAddDomino=function(t,e,i){this.View.addDomino(t,e,i)},e.prototype.onUnregister=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal"}],CardDrawRootView:[function(t,e,i){"use strict";cc._RF.push(e,"03d56Urg/VFFrfQp6Xd0sWN","CardDrawRootView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("./CardDrawRootMediator"),a=t("../../../Utils/Cocos"),s=t("../../Command/GamePlaySignal"),r=t("../../Model/DominoModel"),h=cc._decorator,l=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childOffset=cc.v2(-20,0),e.bagClosePos=cc.v2(177,535),e.bagOpenPos=cc.v2(0,286),e}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=0,this.BindMedaitor(n.default),this.node.active=!1,this.node.setPosition(this.bagClosePos)},e.prototype.start=function(){},e.prototype.cloaseBag=function(){},e.prototype.openBag=function(){},e.prototype.addDomino=function(t,e,i){var o=this,n=cc.v2(0,0);t.getParent()&&(n=a.ConvertToNodeSpaceAR(this.node,t.getParent()));var h=cc.v2(-this.node.width/2,0);h.addSelf(this.childOffset.mul((i-1)%7+1)),h.addSelf(cc.v2(t.width,0).mul((i-1)%7).add(cc.v2(.75*t.width,0))),i-1>=7&&h.addSelf(cc.v2(0,.6*t.height+20)),h.addSelf(cc.v2(15,-55)),t.runAction(cc.sequence(cc.delayTime(.1*i),cc.spawn(cc.moveTo(.2,n),cc.scaleTo(.2,.6)),cc.callFunc(function(){t.setParent(o.node),t.setPosition(h),s.BoneyardCountChanged.inst.dispatchOne(i),s.DispatchDoneSignal.inst.dispatchTwo(e,r.DominoOwner.Stack)})))},e=__decorate([l],e)}(o.default));i.default=d,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./CardDrawRootMediator":"CardDrawRootMediator"}],CelerSDK:[function(t,e,i){"use strict";cc._RF.push(e,"34a72Ol/DRKJb0NyonTxi8g","CelerSDK"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ToSingleton"),n=t("../LogHandler"),a=t("../Random"),s=t("../../GamePlay/Facade/PlayerModelProxy"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alreadySubmit=!1,e.isNewPlayer=!0,e.celerStartCallback=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"MatchID",{get:function(){return this.match.matchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MatchRandomSeed",{get:function(){return this.match.sharedRandomSeed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DifficultyLevel",{get:function(){return this.match.difficultyLevel},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.alreadySubmit=!1,CELER_X&&celerSDK.onStart(this.onCelerStart.bind(this)),CELER_X&&celerSDK.provideScore(function(){return 0}),this.celerStartCallback=t,CELER_X&&n.LogHandler.inst.initLog(celerSDK.log)},e.prototype.celerXReady=function(){console.log(" invoke celerx.ready() "),CELER_X?celerSDK.ready():this.onCelerStart()},e.prototype.isNew=function(){return this.isNewPlayer},e.prototype.isOnCelerPlatform=function(){return CELER_X},e.prototype.onCelerStart=function(){console.log(" celerx onStart call"),this.match=CELER_X?celerSDK.getMatch():{matchId:"error : can not get id",shouldLaunchTutorial:Math.random()>.5,sharedRandomSeed:Math.random(),difficultyLevel:0},console.log("match id:",this.match.matchId,", seed:",this.match.sharedRandomSeed),a.Random.setRandomSeed(this.match.sharedRandomSeed),s.PlayerModelProxy.inst.Level=this.match.difficultyLevel,this.match&&this.match.shouldLaunchTutorial?this.isNewPlayer=!0:this.isNewPlayer=!1,this.celerStartCallback&&(this.celerStartCallback(),this.celerStartCallback=null)},e.prototype.submitScore=function(t){this.alreadySubmit||(this.alreadySubmit=!0,console.log(" submit score:",t,", match id:",this.match.matchId),CELER_X&&celerSDK.submitScore(t))},e}(o.SingleTon());i.CelerSDK=r,cc._RF.pop()},{"../../GamePlay/Facade/PlayerModelProxy":"PlayerModelProxy","../LogHandler":"LogHandler","../Random":"Random","../ToSingleton":"ToSingleton"}],Cocos:[function(t,e,i){"use strict";function o(t){return t&&t.getParent&&t.getParent()?t.getParent().convertToWorldSpaceAR(t.position):cc.v2(0,0)}cc._RF.push(e,"31c37gkdPVLCIrqcCKdauwi","Cocos"),Object.defineProperty(i,"__esModule",{value:!0}),i.GetWorldPosition=o,i.ConvertToNodeSpaceAR=function(t,e){if(!e)return cc.v2(0,0);var i=o(t);return e.convertToNodeSpaceAR(i)},i.Distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},cc._RF.pop()},{}],DeskNodeModel:[function(t,e,i){"use strict";cc._RF.push(e,"61a5efXiGdK9IQmU0SeqVCq","DeskNodeModel"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../../Utils/HashMap"),a=t("./DominoModel"),s=t("../Facade/PlayerModelProxy"),r=t("../Command/GamePlaySignal"),h=t("../../Global/Desk");(function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Top=2]="Top",t[t.Bot=3]="Bot"})(o=i.PadPos||(i.PadPos={}));var l=function(){function t(e,i){void 0===e&&(e=""),void 0===i&&(i=0),this.root=!1,this.nodeId="",this.dominoId="",this.childrenIds=[],this.parentId="",this.connectedVal=-1,this.leftFree=!0,this.rightFree=!0,this.topFree=!0,this.botFree=!0,this.first=!1,this.posistion=cc.v2(0,0),this.rotation=0,this.zIndex=0,this.dominoId=e,""!=e&&null!=e||(this.root=!0,t.rootNodeMap.add(i,this)),this.nodeId="deskNode:"+t.deskNodeID++,t.deskNodeMap.add(this.nodeId,this)}return t.getDeskNode=function(t){var e=this.deskNodeMap.get(t);return console.assert(null!=e," desk node is null:",t),e},t.getDeskNodeByDominoID=function(t){var e=null;return this.deskNodeMap.forEach(function(i,o){o.DominoID==t&&(e=o)}),console.assert(null!=e," desk node is null:",t),e},t.checkHasDeskNode=function(t){var e=null;return this.deskNodeMap.forEach(function(i,o){o.DominoID==t&&(e=o)}),null!=e},Object.defineProperty(t,"Root",{get:function(){var t=this.rootNodeMap.get(s.PlayerModelProxy.inst.Round);return console.assert(null!=t,"  round: ",s.PlayerModelProxy.inst.Round," , root is null!"),t},enumerable:!0,configurable:!0}),t.prototype.isRoot=function(){return this.root},t.prototype.hasChild=function(){return this.childrenIds.length>0},Object.defineProperty(t.prototype,"ID",{get:function(){return this.nodeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DominoID",{get:function(){return this.dominoId},enumerable:!0,configurable:!0}),t.prototype.setParent=function(e){""==this.parentId||this.parentId==e?null!=t.deskNodeMap.get(e)?this.parentId!=e&&(this.parentId=e):console.error(e," is a invaild deskNode, onSetParent"):console.error(this.nodeId," already has a parent:",this.parentId)},t.prototype.setConnectedVal=function(t){this.connectedVal=t},Object.defineProperty(t.prototype,"ConnectedVal",{get:function(){return this.connectedVal},enumerable:!0,configurable:!0}),t.prototype.addChild=function(e,i){if(null!=t.deskNodeMap.get(e)){var o=t.deskNodeMap.get(e);this.childrenIds.indexOf(e)<0&&(this.childrenIds.push(e),o.setParent(this.nodeId),o.setConnectedVal(i)),t.UpdateTransforms()}else console.error(e," is a invaild deskNode, on AddChild")},Object.defineProperty(t.prototype,"Children",{get:function(){return this.childrenIds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ChildrenCount",{get:function(){return this.childrenIds.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFirst",{get:function(){return this.first},set:function(t){this.first=t},enumerable:!0,configurable:!0}),t.prototype.setAllFree=function(){this.LeftFree=!0,this.BotFree=!0,this.TopFree=!0,this.RightFree=!0},Object.defineProperty(t.prototype,"LeftFree",{get:function(){return this.leftFree},set:function(t){this.leftFree=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RightFree",{get:function(){return this.rightFree},set:function(t){this.rightFree=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TopFree",{get:function(){return this.topFree},set:function(t){this.topFree=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BotFree",{get:function(){return this.botFree},set:function(t){this.botFree=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Position",{get:function(){return this.posistion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.posistion.x},set:function(t){this.posistion.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.posistion.y},set:function(t){this.posistion.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rotation",{get:function(){return this.rotation},set:function(t){this.rotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ZIndex",{get:function(){return this.zIndex},set:function(t){this.zIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RootScale",{get:function(){return this.scale},set:function(t){this.scale!=t&&(this.scale=t,r.DeskRootScale.inst.dispatchOne(this.scale))},enumerable:!0,configurable:!0}),t.resetPading=function(){this.pading={top:0,bot:0,left:0,right:0,position:cc.v2(0,0)},r.DeskRootPadingChanged.inst.dispatchOne(this.pading.position)},t.UpdateTransforms=function(){this.resetPading();for(var t=0,e=s.PlayerModelProxy.inst.getDeskDominos();t<e.length;t++){var i=e[t];this.getDeskNodeByDominoID(i.ID).setAllFree()}var o=this.getDeskNode(this.Root.childrenIds[0]),n=a.DominoModel.getDominoByID(o.DominoID);o.isFirst=!0,o.zIndex=Math.floor(cc.macro.MAX_ZINDEX/2),n.isMirror()?(o.posistion=cc.v2(0,0),o.rotation=0,o.rotation%180==0?(this.pading.top=this.DOMINO_SIZE.height/2,this.pading.bot=this.DOMINO_SIZE.height/2,this.pading.left=this.DOMINO_SIZE.width/2,this.pading.right=this.DOMINO_SIZE.width/2):(this.pading.top=this.DOMINO_SIZE.width/2,this.pading.bot=this.DOMINO_SIZE.width/2,this.pading.left=this.DOMINO_SIZE.height/2,this.pading.right=this.DOMINO_SIZE.height/2),this.checkPadding()):(o.posistion=cc.v2(0,0),o.rotation=90,o.rotation%180==0?(this.pading.top=this.DOMINO_SIZE.height/2,this.pading.bot=this.DOMINO_SIZE.height/2,this.pading.left=this.DOMINO_SIZE.width/2,this.pading.right=this.DOMINO_SIZE.width/2):(this.pading.top=this.DOMINO_SIZE.width/2,this.pading.bot=this.DOMINO_SIZE.width/2,this.pading.left=this.DOMINO_SIZE.height/2,this.pading.right=this.DOMINO_SIZE.height/2),this.checkPadding()),this.topID=this.botID=this.rightID=this.leftID=o.ID;for(var r=0,h=o.Children;r<h.length;r++){var l=h[r];this.UpdateTransformRecursily(l,o)}},t.UpdateTransformRecursily=function(t,e){var i=this.getDeskNode(t),o=a.DominoModel.getDominoByID(i.DominoID),n=a.DominoModel.getDominoByID(e.DominoID),s=o.getValPos(i.ConnectedVal),r=n.getValPos(i.connectedVal);switch(console.log(" child pos:",a.DominoPointPos[s],", parent:",a.DominoPointPos[r]),s){case a.DominoPointPos.Bottom:this.childBottom(r,t,e);break;case a.DominoPointPos.Mid:this.childMid(r,t,e);break;case a.DominoPointPos.Top:this.childTop(r,t,e)}this.UpdateZIndex(i,e);for(var h=0,l=i.Children;h<l.length;h++){var d=l[h];this.UpdateTransformRecursily(d,i)}},t.checkPadding=function(){console.log("top:",this.pading.top,", bot:",this.pading.bot,", left:",this.pading.left,", right:",this.pading.right,",x:",this.pading.position.x,",y:",this.pading.position.y,",scale:",this.RootScale);var t=!1;this.pading.left!=this.pading.right&&(this.pading.position.x+=(this.pading.left-this.pading.right)/2,this.pading.left=this.pading.right=(this.pading.left+this.pading.right)/2,t=!0),this.pading.bot!=this.pading.top&&(this.pading.position.y+=(this.pading.bot-this.pading.top)/2,this.pading.top=this.pading.bot=(this.pading.top+this.pading.bot)/2,t=!0),t&&console.log(" new !! top:",this.pading.top,", bot:",this.pading.bot,", left:",this.pading.left,", right:",this.pading.right,",x:",this.pading.position.x,",y:",this.pading.position.y,",scale:",this.RootScale),r.DeskRootPadingChanged.inst.dispatchOne(this.pading.position.mul(this.RootScale))},t.childVertical_2_Horizontal_Right=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y>=this.pading.top-this.pading.position.y){var o=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y);i.top=this.pading.top+o;var n=(i.top+i.bot)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=90,t.x=e.x+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,t.y=e.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y),i.top=this.pading.top+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.top+=o,90==t.rotation&&t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x),h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.childVerticalReverse_2_Horizontal_Right=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y>=this.pading.top-this.pading.position.y){var o=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y);i.top=this.pading.top+o;var n=(i.top+i.bot)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=-90,t.x=e.x+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,t.y=e.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y),i.top=this.pading.top+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.top+=o,-90==t.rotation&&t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x),h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.childVertical_2_Horizontal_Left=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y<=-this.pading.bot-this.pading.position.y){var o=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y;i.bot=this.pading.bot+o;var n=(i.bot+i.top)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=-90,t.x=e.x-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,t.y=e.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y,i.bot=this.pading.bot+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.bot+=o,-90==t.rotation&&t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.childVerticalReverse_2_Horizontal_Left=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y<=-this.pading.bot-this.pading.position.y){var o=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y;i.bot=this.pading.bot+o;var n=(i.bot+i.top)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=90,t.x=e.x-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,t.y=e.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y,i.bot=this.pading.bot+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.bot+=o,90==t.rotation&&t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.childHorizontal_2_Bot=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x>=this.pading.right-this.pading.position.x){var o=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x);i.right=this.pading.right+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=180,t.x=e.x+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,t.y=e.y-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x),i.right=this.pading.right+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.right+=o,180==t.rotation&&t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y,h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.childHorizontalReverse_2_Bot=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x>=this.pading.right-this.pading.position.x){var o=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x);i.right=this.pading.right+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=0,t.x=e.x+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,t.y=e.y-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x),i.right=this.pading.right+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.right+=o,0==t.rotation&&t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y,h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.childHorizontal_2_Top=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x<=-this.pading.left-this.pading.position.x){var o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x;i.left=this.pading.left+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=0,t.x=e.x-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,t.y=e.y+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,i.left=this.pading.left+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.left+=o,0==t.rotation&&t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y),h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.childHorizontalReverse_2_Top=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x<=-this.pading.left-this.pading.position.x){var o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x;i.left=this.pading.left+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=180,t.x=e.x-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,t.y=e.y+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,i.left=this.pading.left+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.left+=o,180==t.rotation&&t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y),h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.parentMid_childHorizontal_2_Bot=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x>=this.pading.right-this.pading.position.x){var o=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x);i.right=this.pading.right+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=180,t.x=e.x+this.DOMINO_SIZE.width,t.y=e.y-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x),i.right=this.pading.right+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.right+=o,180==t.rotation&&t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y,h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.parentMid_childHorizontalReverse_2_Bot=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x>=this.pading.right-this.pading.position.x){var o=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x);i.right=this.pading.right+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=0,t.x=e.x+this.DOMINO_SIZE.width,t.y=e.y-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x),i.right=this.pading.right+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.right+=o,0==t.rotation&&t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y,h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.parentMid_childHorizontal_2_Top=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x<=-this.pading.left-this.pading.position.x){var o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x;i.left=this.pading.left+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=0,t.x=e.x-this.DOMINO_SIZE.width,t.y=e.y+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,i.left=this.pading.left+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.left+=o,0==t.rotation&&t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y),h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.parentMid_childHorizontalReverse_2_Top=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.x<=-this.pading.left-this.pading.position.x){var o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x;i.left=this.pading.left+o;var n=(i.left+i.right)*this.RootScale;n>=h.DeskMaxSize.width&&h.DeskMaxSize.width*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=180,t.x=e.x-this.DOMINO_SIZE.width,t.y=e.y+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,o=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,i.left=this.pading.left+o,n=(i.left+i.right)*this.RootScale),n>=h.DeskMaxSize.width&&this.ScaleMin(Math.max(h.DeskMaxSize.width/n,h.DeskScaleRange.Min)),this.pading.left+=o,180==t.rotation&&t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y),h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min)))}},t.parentMid_childVertical_2_Horizontal_Right=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y>=this.pading.top-this.pading.position.y){var o=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y);i.top=this.pading.top+o;var n=(i.top+i.bot)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=90,t.x=e.x+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,t.y=e.y+this.DOMINO_SIZE.width,o=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y),i.top=this.pading.top+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.top+=o,90==t.rotation&&t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x),h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.parentMid_childVerticalReverse_2_Horizontal_Right=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y>=this.pading.top-this.pading.position.y){var o=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y);i.top=this.pading.top+o;var n=(i.top+i.bot)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=-90,t.x=e.x+this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,t.y=e.y+this.DOMINO_SIZE.width,o=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y),i.top=this.pading.top+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.top+=o,-90==t.rotation&&t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x),h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.parentMid_childVertical_2_Horizontal_Left=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y<=-this.pading.bot-this.pading.position.y){var o=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y;i.bot=this.pading.bot+o;var n=(i.bot+i.top)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=-90,t.x=e.x-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,t.y=e.y-this.DOMINO_SIZE.width,o=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y,i.bot=this.pading.bot+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.bot+=o,-90==t.rotation&&t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.parentMid_childVerticalReverse_2_Horizontal_Left=function(t,e){var i={top:this.pading.top,bot:this.pading.bot,left:this.pading.left,right:this.pading.right};if(t.y<=-this.pading.bot-this.pading.position.y){var o=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y;i.bot=this.pading.bot+o;var n=(i.bot+i.top)*this.RootScale;n>=h.DeskMaxSize.height&&h.DeskMaxSize.height*this.RootScale/n<h.DeskScaleRange.Mid&&(t.rotation=90,t.x=e.x-this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,t.y=e.y-this.DOMINO_SIZE.width,o=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y,i.bot=this.pading.bot+o,n=(i.top+i.bot)*this.RootScale),n>=h.DeskMaxSize.height&&this.ScaleMin(Math.max(h.DeskMaxSize.height/n,h.DeskScaleRange.Min)),this.pading.bot+=o,90==t.rotation&&t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x,h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min)))}},t.childBot_ParentBot=function(t,e,i){switch(i){case o.Top:this.childVertical_2_Horizontal_Right(t,e);break;case o.Bot:this.childVertical_2_Horizontal_Left(t,e);break;case o.Left:this.childHorizontal_2_Top(t,e);break;case o.Right:this.childHorizontal_2_Bot(t,e)}this.checkPadding()},t.childBot_ParentMid=function(t,e,i,n){switch(i){case o.Top:switch(n){case 180:case 0:this.childVertical_2_Horizontal_Right(t,e);break;case-90:case 90:this.parentMid_childVertical_2_Horizontal_Right(t,e)}break;case o.Bot:switch(n){case 0:case 180:this.childVertical_2_Horizontal_Left(t,e);break;case 90:case-90:this.parentMid_childVertical_2_Horizontal_Left(t,e)}break;case o.Left:switch(n){case 0:case 180:this.parentMid_childHorizontal_2_Top(t,e);break;case 90:case-90:this.childHorizontal_2_Top(t,e)}break;case o.Right:switch(n){case 0:case 180:this.parentMid_childHorizontal_2_Bot(t,e);break;case 90:case-90:this.childHorizontal_2_Bot(t,e)}}this.checkPadding()},t.childBot_ParentTop=function(t,e,i){switch(i){case o.Top:this.childVertical_2_Horizontal_Right(t,e);break;case o.Bot:this.childVertical_2_Horizontal_Left(t,e);break;case o.Left:this.childHorizontal_2_Top(t,e);break;case o.Right:this.childHorizontal_2_Bot(t,e)}this.checkPadding()},t.childTop_ParentBot=function(t,e,i){switch(i){case o.Top:this.childVerticalReverse_2_Horizontal_Right(t,e);break;case o.Bot:this.childVerticalReverse_2_Horizontal_Left(t,e);break;case o.Left:this.childHorizontalReverse_2_Top(t,e);break;case o.Right:this.childHorizontalReverse_2_Bot(t,e)}this.checkPadding()},t.childTop_ParentMid=function(t,e,i,n){switch(i){case o.Top:switch(n){case 180:case 0:this.childVerticalReverse_2_Horizontal_Right(t,e);break;case-90:case 90:this.parentMid_childVerticalReverse_2_Horizontal_Right(t,e)}break;case o.Bot:switch(n){case 0:case 180:this.childVerticalReverse_2_Horizontal_Left(t,e);break;case 90:case-90:this.parentMid_childVerticalReverse_2_Horizontal_Left(t,e)}break;case o.Left:switch(n){case 0:case 180:this.parentMid_childHorizontalReverse_2_Top(t,e);break;case 90:case-90:this.childHorizontalReverse_2_Top(t,e)}break;case o.Right:switch(n){case 0:case 180:this.parentMid_childHorizontalReverse_2_Bot(t,e);break;case 90:case-90:this.childHorizontalReverse_2_Bot(t,e)}}this.checkPadding()},t.childTop_ParentTop=function(t,e,i){switch(i){case o.Top:this.childVerticalReverse_2_Horizontal_Right(t,e);break;case o.Bot:this.childVerticalReverse_2_Horizontal_Left(t,e);break;case o.Left:this.childHorizontalReverse_2_Top(t,e);break;case o.Right:this.childHorizontalReverse_2_Bot(t,e)}this.checkPadding()},t.childMid_ParentBot=function(t,e,i,n){switch(i){case o.Top:switch(n){case 0:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y));break;case 90:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y));break;case 180:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y));break;case-90:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y))}h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min));break;case o.Bot:switch(n){case 0:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y);break;case 90:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y);break;case 180:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y);break;case-90:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y)}h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min));break;case o.Left:switch(n){case 0:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.width/2-t.x-this.pading.left-this.pading.position.x);break;case 90:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x);break;case 180:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.width/2-t.x-this.pading.left-this.pading.position.x);break;case-90:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x)}h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min));break;case o.Right:switch(n){case 0:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x));break;case 90:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x));break;case 180:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x));break;case-90:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x))}h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min))}this.checkPadding()},t.childMid_ParentTop=function(t,e,i,n){switch(i){case o.Top:switch(n){case 0:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y));break;case 90:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y));break;case 180:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.height/2+t.y-(this.pading.top-this.pading.position.y));break;case-90:t.y>=this.pading.top-this.pading.position.y&&(this.pading.top+=this.DOMINO_SIZE.width/2+t.y-(this.pading.top-this.pading.position.y))}h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min));break;case o.Bot:switch(n){case 0:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y);break;case 90:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y);break;case 180:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.height/2-t.y-this.pading.bot-this.pading.position.y);break;case-90:t.y<=-this.pading.bot-this.pading.position.y&&(this.pading.bot+=this.DOMINO_SIZE.width/2-t.y-this.pading.bot-this.pading.position.y)}h.DeskMaxSize.height<this.pading.top+this.pading.bot&&this.ScaleMin(Math.max(h.DeskMaxSize.height/(this.pading.top+this.pading.bot),h.DeskScaleRange.Min));break;case o.Left:switch(n){case 0:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.width/2-t.x-this.pading.left-this.pading.position.x);break;case 90:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x);break;case 180:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.width/2-t.x-this.pading.left-this.pading.position.x);break;case-90:t.x<=-this.pading.left-this.pading.position.x&&(this.pading.left+=this.DOMINO_SIZE.height/2-t.x-this.pading.left-this.pading.position.x)}h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min));break;case o.Right:switch(n){case 0:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x));break;case 90:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x));break;case 180:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.width/2+t.x-(this.pading.right-this.pading.position.x));break;case-90:t.x>=this.pading.right-this.pading.position.x&&(this.pading.right+=this.DOMINO_SIZE.height/2+t.x-(this.pading.right-this.pading.position.x))}h.DeskMaxSize.width<this.pading.left+this.pading.right&&this.ScaleMin(Math.max(h.DeskMaxSize.width/(this.pading.left+this.pading.right),h.DeskScaleRange.Min))}this.checkPadding()},t.childMid_ParentMid=function(t,e,i,o,n){},t.ScaleMin=function(t){t>=this.RootScale||(this.RootScale=t)},t.UpdateZIndex=function(t,e){t.y<e.y?t.zIndex=e.zIndex+1:t.y>e.y?t.zIndex=e.zIndex-1:t.zIndex=e.zIndex+1},t.childBottom=function(t,e,i){var n=this.getDeskNode(e);a.DominoModel.getDominoByID(n.DominoID),a.DominoModel.getDominoByID(i.DominoID);switch(t){case a.DominoPointPos.Bottom:0==i.Rotation?(n.rotation=180,n.x=i.x,n.y=i.y-this.DOMINO_SIZE.height,i.BotFree=!1,n.BotFree=!1,this.childBot_ParentBot(n,i,o.Bot)):180==i.Rotation?(n.rotation=0,n.x=i.x,n.y=i.y+this.DOMINO_SIZE.height,i.BotFree=!1,n.BotFree=!1,this.childBot_ParentBot(n,i,o.Top)):90==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height,i.BotFree=!1,n.BotFree=!1,this.childBot_ParentBot(n,i,o.Left)):(n.rotation=90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height,i.BotFree=!1,n.BotFree=!1,this.childBot_ParentBot(n,i,o.Right));break;case a.DominoPointPos.Mid:0==i.Rotation||180==i.Rotation?i.RightFree?(0==i.Rotation?(n.rotation=90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Right,i.Rotation)):(n.rotation=-90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Left,i.Rotation)),i.RightFree=!1,n.BotFree=!1):i.LeftFree?(180==i.Rotation?(n.rotation=90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Right,i.Rotation)):(n.rotation=-90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Left,i.Rotation)),i.LeftFree=!1,n.BotFree=!1):i.BotFree?(0==i.Rotation?(n.rotation=180,n.y=i.y-this.DOMINO_SIZE.height,n.x=i.x,this.childBot_ParentMid(n,i,o.Bot,i.Rotation)):(n.rotation=0,n.y=i.y+this.DOMINO_SIZE.height,n.x=i.x,this.childBot_ParentMid(n,i,o.Top,i.Rotation)),i.BotFree=!1,n.BotFree=!1):i.TopFree&&(180==i.Rotation?(n.rotation=180,n.y=i.y-this.DOMINO_SIZE.height,n.x=i.x,this.childBot_ParentMid(n,i,o.Bot,i.Rotation)):(n.rotation=0,n.y=i.y+this.DOMINO_SIZE.height,n.x=i.x,this.childBot_ParentMid(n,i,o.Top,i.Rotation)),i.TopFree=!1,n.BotFree=!1):90!=i.Rotation&&-90!=i.Rotation||(i.LeftFree?(90==i.Rotation?(n.rotation=0,n.y=i.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,n.x=i.x,this.childBot_ParentMid(n,i,o.Top,i.Rotation)):(n.rotation=180,n.y=i.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,n.x=i.x,this.childBot_ParentMid(n,i,o.Bot,i.Rotation)),i.LeftFree=!1,n.BotFree=!1):i.RightFree?(-90==i.Rotation?(n.rotation=0,n.y=i.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,n.x=i.x,this.childBot_ParentMid(n,i,o.Top,i.Rotation)):(n.rotation=180,n.y=i.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,n.x=i.x,this.childBot_ParentMid(n,i,o.Bot,i.Rotation)),i.RightFree=!1,n.BotFree=!1):i.TopFree?(-90==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Left,i.Rotation)):(n.rotation=90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Right,i.Rotation)),i.TopFree=!1,n.BotFree=!1):i.BotFree&&(90==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Left,i.Rotation)):(n.rotation=90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.height/2,this.childBot_ParentMid(n,i,o.Right,i.Rotation)),i.BotFree=!1,n.BotFree=!1));break;case a.DominoPointPos.Top:0==i.Rotation?(n.rotation=0,n.x=i.x,n.y=i.y+this.DOMINO_SIZE.height,i.TopFree=!1,n.BotFree=!1,this.childBot_ParentTop(n,i,o.Top)):180==i.Rotation?(n.rotation=180,n.x=i.x,n.y=i.y-this.DOMINO_SIZE.height,i.TopFree=!1,n.BotFree=!1,this.childBot_ParentTop(n,i,o.Bot)):90==i.Rotation?(n.rotation=90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height,i.TopFree=!1,n.BotFree=!1,this.childBot_ParentTop(n,i,o.Right)):(n.rotation=-90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height,this.childBot_ParentTop(n,i,o.Left),i.TopFree=!1,n.BotFree=!1)}},t.childTop=function(t,e,i){var n=this.getDeskNode(e);a.DominoModel.getDominoByID(n.DominoID),a.DominoModel.getDominoByID(i.DominoID);switch(t){case a.DominoPointPos.Bottom:0==i.Rotation?(n.rotation=0,n.x=i.x,n.y=i.y-this.DOMINO_SIZE.height,this.childTop_ParentBot(n,i,o.Bot),i.BotFree=!1,n.TopFree=!1):180==i.Rotation?(n.rotation=180,n.x=i.x,n.y=i.y+this.DOMINO_SIZE.height,this.childTop_ParentBot(n,i,o.Top),i.BotFree=!1,n.TopFree=!1):90==i.Rotation?(n.rotation=90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height,this.childTop_ParentBot(n,i,o.Left),i.BotFree=!1,n.TopFree=!1):(n.rotation=-90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height,this.childTop_ParentBot(n,i,o.Right),i.BotFree=!1,n.TopFree=!1);break;case a.DominoPointPos.Mid:0==i.Rotation||180==i.Rotation?i.RightFree?(0==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.height/2,this.childTop_ParentMid(n,i,o.Right,i.Rotation)):(n.rotation=90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.height/2,this.childTop_ParentMid(n,i,o.Left,i.Rotation)),i.RightFree=!1,n.TopFree=!1):i.LeftFree?(180==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.width/2+this.DOMINO_SIZE.height/2,this.childTop_ParentMid(n,i,o.Right,i.Rotation)):(n.rotation=90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.width/2-this.DOMINO_SIZE.height/2,this.childTop_ParentMid(n,i,o.Left,i.Rotation)),i.LeftFree=!1,n.TopFree=!1):i.BotFree?(0==i.Rotation?(n.rotation=0,n.y=i.y-this.DOMINO_SIZE.height,n.x=i.x,this.childTop_ParentMid(n,i,o.Bot,i.Rotation)):(n.rotation=180,n.y=i.y+this.DOMINO_SIZE.height,n.x=i.x,this.childTop_ParentMid(n,i,o.Top,i.Rotation)),i.BotFree=!1,n.TopFree=!1):i.TopFree&&(180==i.Rotation?(n.rotation=0,n.y=i.y-this.DOMINO_SIZE.height,n.x=i.x,this.childTop_ParentMid(n,i,o.Bot,i.Rotation)):(n.rotation=180,n.y=i.y+this.DOMINO_SIZE.height,n.x=i.x,this.childTop_ParentMid(n,i,o.Top,i.Rotation)),i.TopFree=!1,n.TopFree=!1):90!=i.Rotation&&-90!=i.Rotation||(i.LeftFree?(90==i.Rotation?(n.rotation=180,n.y=i.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,n.x=i.x,this.childTop_ParentMid(n,i,o.Top,i.Rotation)):(n.rotation=0,n.y=i.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,n.x=i.x,this.childTop_ParentMid(n,i,o.Bot,i.Rotation)),i.LeftFree=!1,n.TopFree=!1):i.RightFree?(-90==i.Rotation?(n.rotation=180,n.y=i.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,n.x=i.x,this.childTop_ParentMid(n,i,o.Top,i.Rotation)):(n.rotation=0,n.y=i.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,n.x=i.x,this.childTop_ParentMid(n,i,o.Bot,i.Rotation)),i.RightFree=!1,n.TopFree=!1):i.TopFree?(90==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height,this.childTop_ParentMid(n,i,o.Right,i.Rotation)):(n.rotation=90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height,this.childTop_ParentMid(n,i,o.Left,i.Rotation)),i.TopFree=!1,n.TopFree=!1):i.BotFree&&(-90==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height,this.childTop_ParentMid(n,i,o.Right,i.Rotation)):(n.rotation=90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height,this.childTop_ParentMid(n,i,o.Left,i.Rotation)),i.BotFree=!1,n.TopFree=!1));break;case a.DominoPointPos.Top:0==i.Rotation?(n.rotation=180,n.x=i.x,n.y=i.y+this.DOMINO_SIZE.height,this.childTop_ParentTop(n,i,o.Top),i.TopFree=!1,n.TopFree=!1):180==i.Rotation?(n.rotation=0,n.x=i.x,n.y=i.y-this.DOMINO_SIZE.height,this.childTop_ParentTop(n,i,o.Bot),i.TopFree=!1,n.TopFree=!1):90==i.Rotation?(n.rotation=-90,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height,this.childTop_ParentTop(n,i,o.Right),i.TopFree=!1,n.TopFree=!1):(n.rotation=90,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height,this.childTop_ParentTop(n,i,o.Left),i.TopFree=!1,n.TopFree=!1)}},t.childMid=function(t,e,i){var n=this.getDeskNode(e);a.DominoModel.getDominoByID(n.DominoID),a.DominoModel.getDominoByID(i.DominoID);switch(t){case a.DominoPointPos.Bottom:0==i.Rotation?(n.rotation=90,n.x=i.x,n.y=i.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,this.childMid_ParentBot(n,i,o.Bot,n.rotation),i.BotFree=!1,n.LeftFree=!1):180==i.Rotation?(n.rotation=-90,n.x=i.x,n.y=i.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,this.childMid_ParentBot(n,i,o.Top,n.rotation),i.BotFree=!1,n.LeftFree=!1):90==i.Rotation?(n.rotation=0,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,this.childMid_ParentBot(n,i,o.Left,n.rotation),i.BotFree=!1,n.RightFree=!1):(n.rotation=0,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,this.childMid_ParentBot(n,i,o.Right,n.rotation),i.BotFree=!1,n.LeftFree=!1);break;case a.DominoPointPos.Mid:console.error(" \u7236\u8282\u70b9 mid match \u5b50\u8282\u70b9 mid");break;case a.DominoPointPos.Top:0==i.Rotation?(n.rotation=90,n.x=i.x,n.y=i.y+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,this.childMid_ParentTop(n,i,o.Top,n.rotation),i.TopFree=!1,n.RightFree=!1):180==i.Rotation?(n.rotation=-90,n.x=i.x,n.y=i.y-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,this.childMid_ParentTop(n,i,o.Bot,n.rotation),i.TopFree=!1,n.RightFree=!1):90==i.Rotation?(n.rotation=0,n.y=i.y,n.x=i.x+this.DOMINO_SIZE.height/2+this.DOMINO_SIZE.width/2,this.childMid_ParentTop(n,i,o.Right,n.rotation),i.TopFree=!1,n.LeftFree=!1):(n.rotation=0,n.y=i.y,n.x=i.x-this.DOMINO_SIZE.height/2-this.DOMINO_SIZE.width/2,this.childMid_ParentTop(n,i,o.Left,n.rotation),i.TopFree=!1,n.RightFree=!1)}},t.deskNodeMap=new n.HashMap,t.deskNodeID=0,t.rootNodeMap=new n.HashMap,t.leftID="",t.rightID="",t.topID="",t.botID="",t.DOMINO_SIZE=cc.size(93,179),t.DOMINO_Z_INDEX=cc.macro.MAX_ZINDEX,t.scale=1,t.pading={top:0,bot:0,left:0,right:0,position:cc.v2(0,0)},t.SizeOffset=cc.size(0,0),t}();i.DeskNodeModel=l,cc._RF.pop()},{"../../Global/Desk":"Desk","../../Utils/HashMap":"HashMap","../Command/GamePlaySignal":"GamePlaySignal","../Facade/PlayerModelProxy":"PlayerModelProxy","./DominoModel":"DominoModel"}],DeskRootMediator:[function(t,e,i){"use strict";cc._RF.push(e,"7e0e7gNH7tHhqch8phMFMEj","DeskRootMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.PlaceDomino.inst.addListenerFour(this.onDominoPlaced,this),n.DeskRootScale.inst.addListenerOne(this.onScaleChanged,this),n.DeskRootPadingChanged.inst.addListenerOne(this.onPaddingChanged,this)},e.prototype.onDominoPlaced=function(t,e,i,o){this.View.addDomino(t)},e.prototype.onScaleChanged=function(t){this.View.onScaleChanged(t)},e.prototype.onPaddingChanged=function(t){this.View.onPositionChanged(t)},e.prototype.onUnregister=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal"}],DeskRootView:[function(t,e,i){"use strict";cc._RF.push(e,"e0718e9H/JNtYw+cLGf7tH9","DeskRootView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("./DeskRootMediator"),a=t("../../../Utils/Cocos"),s=t("../../Command/GamePlaySignal"),r=t("../../Model/DominoModel"),h=t("../DominoControl/DominoNodePool"),l=t("../../Model/DeskNodeModel"),d=t("../../../Global/Desk"),c=cc._decorator,p=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scaleStep=.02,e.posStep=cc.v2(0,0),e.targetPosition=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=d.DeskScaleRange.Origin,this.BindMedaitor(n.default)},e.prototype.onScaleChanged=function(t){this.scaleStep=(t-this.node.scale)/2},e.prototype.onPositionChanged=function(t){this.targetPosition=t,this.posStep.x=(this.targetPosition.x-this.node.x)/20,this.posStep.y=(this.targetPosition.y-this.node.y)/20},e.prototype.start=function(){},e.prototype.addDomino=function(t){var e=h.default.getDomino(t);e.getParent()&&e.setPosition(a.ConvertToNodeSpaceAR(e,this.node)),e.zIndex=cc.macro.MAX_ZINDEX,e.scale=e.scale*(e.parent.scale/this.node.scale),e.setParent(this.node),e.runAction(cc.scaleTo(.1,1)),s.DispatchDoneSignal.inst.dispatchTwo(t,r.DominoOwner.Desk),s.PlaceDominoDone.inst.dispatchOne(t)},e.prototype.update=function(t){this.node.scale!=l.DeskNodeModel.RootScale&&(this.node.scale+=this.scaleStep),(this.node.scale>l.DeskNodeModel.RootScale&&this.scaleStep>0||this.node.scale<l.DeskNodeModel.RootScale&&this.scaleStep<0)&&(this.scaleStep=0,this.node.scale=l.DeskNodeModel.RootScale),this.targetPosition&&(this.node.x!=this.targetPosition.x&&(this.node.x+=this.posStep.x),this.node.y!=this.targetPosition.y&&(this.node.y+=this.posStep.y),(this.node.x>this.targetPosition.x&&this.posStep.x>0||this.node.x<this.targetPosition.x&&this.posStep.x<0)&&(this.node.x=this.targetPosition.x,this.posStep.x=0),(this.node.y>this.targetPosition.y&&this.posStep.y>0||this.node.y<this.targetPosition.y&&this.posStep.y<0)&&(this.node.y=this.targetPosition.y,this.posStep.y=0))},e=__decorate([p],e)}(o.default));i.default=u,cc._RF.pop()},{"../../../Global/Desk":"Desk","../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DeskNodeModel":"DeskNodeModel","../../Model/DominoModel":"DominoModel","../DominoControl/DominoNodePool":"DominoNodePool","./DeskRootMediator":"DeskRootMediator"}],Desk:[function(t,e,i){"use strict";cc._RF.push(e,"74537474HZIIryEAbzQ7oeC","Desk"),Object.defineProperty(i,"__esModule",{value:!0}),i.DeskMaxSize=cc.size(800,800),i.DominoRange={x:{Min:-540,Max:540},y:{Min:-540,Max:540}},i.DeskScaleRange={Max:1.5,Origin:1.2,Mid:.9,Min:.7},cc._RF.pop()},{}],DominoDeskTransformMediator:[function(t,e,i){"use strict";cc._RF.push(e,"d56d5RiU8dLBqckrUexjznT","DominoDeskTransformMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Command/GamePlaySignal"),a=t("../../Model/DeskNodeModel"),s=cc._decorator,r=s.ccclass,h=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.PlaceDominoDone.inst.addListenerOne(this.onDominoPlaceDone,this)},e.prototype.onDominoPlaceDone=function(t){if(0!=a.DeskNodeModel.checkHasDeskNode(this.View.ID)){var e=a.DeskNodeModel.getDeskNodeByDominoID(this.View.ID);null!=e&&(e.Rotation%180==0?this.View.turnVertical(e.Rotation):e.Rotation>0?this.View.turnHorizontalRight(e.Rotation):this.View.turnHorizontalLeft(e.Rotation),this.View.setTargetZIndex(e.ZIndex),this.View.setTargetPos(e.Position))}},e.prototype.onUnregister=function(){},e=__decorate([r],e)}(o.default));i.default=h,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DeskNodeModel":"DeskNodeModel"}],DominoDeskTransform:[function(t,e,i){"use strict";cc._RF.push(e,"4d1ffQJVWVBG7JrRGkstzZN","DominoDeskTransform"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../../../View/BaseView"),a=t("./DominoDeskTransformMediator"),s=t("../../Model/DominoModel"),r=t("../../Controller/ResourceController"),h=t("../../Facade/PlayerModelProxy"),l=t("../../Model/DeskNodeModel"),d=cc._decorator,c=d.ccclass;d.property;(function(t){t[t.VerticalNormal=0]="VerticalNormal",t[t.VerticalReverse=1]="VerticalReverse",t[t.HorizontalRight=2]="HorizontalRight",t[t.HorizontalLeft=3]="HorizontalLeft"})(o=i.RotateState||(i.RotateState={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.backNode=null,e.frontNode=null,e.frontSprite=null,e.pointRoot=null,e.topPointSp=null,e.bottomPointSp=null,e.rotateState=o.VerticalNormal,e.model=null,e.offsetStep=cc.v2(0,0),e.targetPosition=null,e.targetZIndex=cc.macro.MAX_ZINDEX,e}return __extends(e,t),Object.defineProperty(e.prototype,"Back",{get:function(){return this.backNode?this.backNode:this.backNode=this.node.getChildByName("Back")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Front",{get:function(){return this.frontNode?this.frontNode:this.frontNode=this.node.getChildByName("Front")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FrontSprite",{get:function(){return this.frontSprite?this.frontSprite:this.frontSprite=this.Front.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PointRoot",{get:function(){return this.pointRoot?this.pointRoot:this.pointRoot=this.node.getChildByName("Point")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopPointSprite",{get:function(){return this.topPointSp?this.topPointSp:this.PointRoot.getChildByName("Top").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BottomPointSprite",{get:function(){return this.bottomPointSp?this.bottomPointSp:this.PointRoot.getChildByName("Bottom").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Child",{get:function(){return this.PointRoot.getChildByName("Child")},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.BindMedaitor(a.default)},Object.defineProperty(e.prototype,"ID",{get:function(){return this.model.ID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Owner",{get:function(){return this.model.Owner},enumerable:!0,configurable:!0}),e.prototype.reuse=function(t){this.model=t,this.rotateState=o.VerticalNormal,this.FrontSprite.spriteFrame=r.ResourceController.inst.getFrontSprite(h.PlayerModelProxy.inst.Theme,this.rotateState),this.node.rotation=0,this.PointRoot.x=0,this.PointRoot.y=-8.5,this.Front.scaleX=1,this.Front.scaleY=1,this.Child&&this.Child.active&&(this.Child.getChildByName("Top").active=!0,this.Child.getChildByName("Bot").active=!0,this.Child.getChildByName("Left").active=!0,this.Child.getChildByName("Right").active=!0)},e.prototype.unuse=function(){this.node.zIndex=0,this.model=null,this.targetPosition=null},e.prototype.turnVertical=function(t){this.rotateState=t%360==180?o.VerticalReverse:o.VerticalNormal,this.node.runAction(cc.sequence(cc.rotateTo(.1,t),cc.callFunc(function(){})))},e.prototype.turnHorizontalRight=function(t){this.rotateState=o.HorizontalRight,this.node.runAction(cc.sequence(cc.rotateTo(.1,t),cc.callFunc(function(){})))},e.prototype.turnHorizontalLeft=function(t){this.rotateState=o.HorizontalLeft,this.node.runAction(cc.sequence(cc.rotateTo(.1,t),cc.callFunc(function(){})))},e.prototype.setZIndex=function(t){this.node.zIndex=t},e.prototype.setTargetPos=function(t){this.targetPosition=t,this.offsetStep=cc.Vec2.ZERO.clone(),this.offsetStep.x=(this.targetPosition.x-this.node.x)/2,this.offsetStep.y=(this.targetPosition.y-this.node.y)/2},e.prototype.setTargetZIndex=function(t){this.targetZIndex=t},e.prototype.update=function(t){this.model&&this.model.Owner==s.DominoOwner.Desk&&(this.rotateState==o.VerticalNormal?(this.PointRoot.x=0,this.PointRoot.y=-8.5,this.Front.scaleX=1,this.Front.scaleY=1):this.rotateState==o.VerticalReverse?(this.PointRoot.x=0,this.PointRoot.y=0,this.Front.scaleX=1,this.Front.scaleY=-1):this.rotateState==o.HorizontalRight?(this.PointRoot.x=0,this.PointRoot.y=0,this.Front.scaleX=1,this.Front.scaleY=1):(this.PointRoot.x=0,this.PointRoot.y=0,this.Front.scaleX=-1,this.Front.scaleY=1),this.FrontSprite.spriteFrame=r.ResourceController.inst.getFrontSprite(h.PlayerModelProxy.inst.Theme,this.rotateState),this.targetPosition&&(this.node.x+=this.offsetStep.x,(this.node.x>this.targetPosition.x&&this.offsetStep.x>0||this.node.x<this.targetPosition.x&&this.offsetStep.x<0)&&(this.node.x=this.targetPosition.x),this.node.y+=this.offsetStep.y,(this.node.y>this.targetPosition.y&&this.offsetStep.y>0||this.node.y<this.targetPosition.y&&this.offsetStep.y<0)&&(this.node.y=this.targetPosition.y)),this.targetPosition&&this.node.x==this.targetPosition.x&&this.node.y==this.targetPosition.y&&this.setZIndex(this.targetZIndex)),this.Child&&this.Child.active&&this.model&&this.model.Owner==s.DominoOwner.Desk&&(this.Child.getChildByName("Top").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).TopFree,this.Child.getChildByName("Bot").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).BotFree,this.Child.getChildByName("Left").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).LeftFree,this.Child.getChildByName("Right").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).RightFree,this.Child.getChildByName("First").active=l.DeskNodeModel.getDeskNodeByDominoID(this.model.ID).isFirst)},e=__decorate([c],e)}(n.default);i.default=p,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DeskNodeModel":"DeskNodeModel","../../Model/DominoModel":"DominoModel","./DominoDeskTransformMediator":"DominoDeskTransformMediator"}],DominoModel:[function(t,e,i){"use strict";cc._RF.push(e,"d3e67EqEe5AErIO2Y9YhnVa","DominoModel"),Object.defineProperty(i,"__esModule",{value:!0});var o,n,a,s=t("../../Utils/HashMap"),r=t("../Command/GamePlaySignal");(function(t){t[t.Back=0]="Back",t[t.Front=1]="Front"})(o=i.DominoState||(i.DominoState={})),function(t){t[t.Top=0]="Top",t[t.Bottom=1]="Bottom",t[t.Mid=2]="Mid"}(n=i.DominoPointPos||(i.DominoPointPos={})),function(t){t[t.Desk=0]="Desk",t[t.Dispatcher=1]="Dispatcher",t[t.Stack=2]="Stack",t[t.AI=3]="AI",t[t.Player=4]="Player"}(a=i.DominoOwner||(i.DominoOwner={}));var h=function(){function t(e,i,n){this.points=[],this.currentPoints=[],this.state=null,this.id="",this.owner=null,this.points=[e,i],this.currentPoints=[e,i],this.id="objectID:"+ ++t.DominoID+" - round:"+n+" - topPoint:"+e+" - botPoint:"+i,this.setState(o.Back),this.setOwner(a.Dispatcher),t.DominoMap.add(this.id,this)}return t.getDominoByID=function(t){return this.DominoMap.get(t)},t.checkCanConnect=function(t,e){return this.getConnectedVal(t,e)>=0},t.getConnectedVal=function(t,e){for(var i=this.getDominoByID(t),o=this.getDominoByID(e),n=i.getCurrentPoints(),a=o.getCurrentPoints(),s=0,r=n;s<r.length;s++){var h=r[s];if(a.indexOf(h)>=0)return h}return-1},t.prototype.removePoint=function(t,e){void 0===e&&(e=-1);for(var i=0,o=0;o<this.currentPoints.length;o++)if(this.currentPoints[o]==t&&(this.currentPoints.splice(o,1),o--,i++),-1!=e&&i>=e)return},t.prototype.getCurrentPoints=function(){return this.currentPoints},Object.defineProperty(t.prototype,"TopPoint",{get:function(){return this.points[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BotPoint",{get:function(){return this.points[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"State",{get:function(){return this.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Owner",{get:function(){return this.owner},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CanConnect",{get:function(){return this.currentPoints.length>0},enumerable:!0,configurable:!0}),t.prototype.isMirror=function(){return this.TopPoint==this.BotPoint},t.prototype.getValPos=function(t){return this.isMirror()?n.Mid:t==this.TopPoint?n.Top:n.Bottom},t.prototype.setState=function(t){this.state!=t&&(this.state=t,r.DominoStateChanged.inst.dispatchTwo(this.state,this.id))},t.prototype.setOwner=function(t){this.owner!=t&&(this.owner=t,r.DominoOwnerChanged.inst.dispatchTwo(this.owner,this.id))},Object.defineProperty(t.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),t.DominoID=0,t.DominoMap=new s.HashMap,t}();i.DominoModel=h,cc._RF.pop()},{"../../Utils/HashMap":"HashMap","../Command/GamePlaySignal":"GamePlaySignal"}],DominoNodePool:[function(t,e,i){"use strict";cc._RF.push(e,"a3d52zjpv9FI4Th92WrFIJg","DominoNodePool"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../Utils/HashMap"),n=t("../../../Utils/Cocos"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=null,e}var i;return __extends(e,t),i=e,e.addDomino=function(t,e){0==this.dominoPool.has(t)&&this.dominoPool.add(t,e)},e.removeDomino=function(t){this.dominoPool.has(t)&&this.dominoPool.remove(t)},e.getDomino=function(t){var e=this.dominoPool.get(t);return console.assert(null!=e&&cc.isValid(e,!0)," domino has destory:",t),e},e.getDistance=function(t,e){var i=this.getDomino(t),o=this.getDomino(e),a=o.position;return i.getParent()!==o.getParent()&&(a=n.ConvertToNodeSpaceAR(o,i.parent)),n.Distance(i.position,a)},e.prototype.reuse=function(t){this.model=t,i.addDomino(this.model.ID,this.node)},e.prototype.unuse=function(){this.model&&(i.removeDomino(this.model.ID),this.model=null)},e.dominoPool=new o.HashMap,e=i=__decorate([s],e)}(cc.Component));i.default=r,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../Utils/HashMap":"HashMap"}],DominoRootMediator:[function(t,e,i){"use strict";cc._RF.push(e,"77577mHRqJLJqmARaKDq06g","DominoRootMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Command/GamePlaySignal"),a=t("../../Facade/PlayerModelProxy"),s=t("../../Controller/ResourceController"),r=t("../../Model/DominoModel"),h=cc._decorator,l=h.ccclass,d=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.ReadyDispatchDominoSignal.inst.addListener(this.onReadyDispatch,this)},e.prototype.onReadyDispatch=function(){for(var t=a.PlayerModelProxy.inst.getOriginDominoOnNewRound(),e=0,i=t;e<i.length;e++){var o=i[e];(d=s.ResourceController.inst.getDomino(o)).name=o.ID,this.View.addDomino(d)}a.PlayerModelProxy.inst.getPlayerDominos(),a.PlayerModelProxy.inst.getAIDominos(),a.PlayerModelProxy.inst.getStackDominos();for(var h=0,l=t;h<l.length;h++){var d,o=l[h];(d=this.View.getDominoNodeByID(o.ID))&&(n.DispatchPlayerDomino.inst.dispatchTwo(d,o.ID),o.setState(r.DominoState.Front))}},e.prototype.onUnregister=function(){n.ReadyDispatchDominoSignal.inst.removeTarget(this)},e=__decorate([l],e)}(o.default));i.default=d,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DominoModel":"DominoModel"}],DominoRootView:[function(t,e,i){"use strict";cc._RF.push(e,"e23b8FPPtNLrodbpiII6hKL","DominoRootView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("./DominoRootMediator"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dispatchRoot=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"DispatchRoot",{get:function(){return this.dispatchRoot?this.dispatchRoot:this.dispatchRoot=this.node.getChildByName("DispatchCardRoot")},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},e.prototype.start=function(){},e.prototype.addDomino=function(t){t.setPosition(0,0),t.scale=1,t.rotation=0,this.DispatchRoot.addChild(t)},e.prototype.getDominoNodeByID=function(t){for(var e=0,i=this.DispatchRoot.children;e<i.length;e++){var o=i[e];if(o.name==t)return o}return console.error(" dispatch root has no this domino:",t),null},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","./DominoRootMediator":"DominoRootMediator"}],DominoSelector:[function(t,e,i){"use strict";cc._RF.push(e,"c3aa2s4+CpByqNHaDUTY+q/","DominoSelector"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Utils/ToSingleton"),n=t("../Command/GamePlaySignal"),a=t("../Facade/PlayerModelProxy"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dominoID=null,e}return __extends(e,t),e.prototype.isSelected=function(){return null!==this.dominoID},e.prototype.getCurrentDominoID=function(){return this.dominoID},e.prototype.select=function(t){null!==this.dominoID&&console.error("already selected ",this.dominoID),console.log("selected domino :",t),this.dominoID=t,n.PlayerSelectedDomino.inst.dispatchOne(t)},e.prototype.free=function(t){null!=this.dominoID?(console.log("free domino :",this.dominoID),t=t||!a.PlayerModelProxy.inst.checkCanConnect(this.dominoID),n.PlayerReleasedDomino.inst.dispatchTwo(this.dominoID,t),this.dominoID=null):console.warn(" domino already release")},e}(o.SingleTon());i.DominoSelector=s,cc._RF.pop()},{"../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal","../Facade/PlayerModelProxy":"PlayerModelProxy"}],DominoStateMediator:[function(t,e,i){"use strict";cc._RF.push(e,"2328d0bmRxO/Lx2flEDW3B5","DominoStateMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Model/DominoModel"),a=t("../../Command/GamePlaySignal"),s=t("../../Controller/ResourceController"),r=cc._decorator,h=r.ccclass,l=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){a.DominoStateChanged.inst.addListenerTwo(this.onStateChanged,this),a.BeforeNextRoundSignal.inst.addListener(this.onNextRound,this)},e.prototype.onUnregister=function(){a.DominoStateChanged.inst.removeTarget(this),a.BeforeNextRoundSignal.inst.removeTarget(this)},e.prototype.onNextRound=function(){console.log(" on next round"),s.ResourceController.inst.putDomino(this.node)},e.prototype.onStateChanged=function(t,e){this.View.ID==e&&(console.log(" domino:",e," state changed:",n.DominoState[t]),this.View.updateState(t))},e=__decorate([h],e)}(o.default));i.default=l,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/ResourceController":"ResourceController","../../Model/DominoModel":"DominoModel"}],DominoStateView:[function(t,e,i){"use strict";cc._RF.push(e,"87114OMoWlLsoDhH6WqkdyW","DominoStateView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("./DominoStateMediator"),a=t("../../Model/DominoModel"),s=t("../../Controller/ResourceController"),r=t("../../Facade/PlayerModelProxy"),h=cc._decorator,l=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.backNode=null,e.frontNode=null,e.pointRoot=null,e.topPointSp=null,e.bottomPointSp=null,e.dominoId="",e}return __extends(e,t),Object.defineProperty(e.prototype,"Back",{get:function(){return this.backNode?this.backNode:this.backNode=this.node.getChildByName("Back")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Front",{get:function(){return this.frontNode?this.frontNode:this.frontNode=this.node.getChildByName("Front")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PointRoot",{get:function(){return this.pointRoot?this.pointRoot:this.pointRoot=this.node.getChildByName("Point")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopPointSprite",{get:function(){return this.topPointSp?this.topPointSp:this.PointRoot.getChildByName("Top").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BottomPointSprite",{get:function(){return this.bottomPointSp?this.bottomPointSp:this.PointRoot.getChildByName("Bottom").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ID",{get:function(){return this.dominoId},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},e.prototype.start=function(){},e.prototype.reuse=function(t){this.dominoId=t.ID,this.TopPointSprite.spriteFrame=s.ResourceController.inst.getPointSprite(r.PlayerModelProxy.inst.Theme,t.TopPoint),this.BottomPointSprite.spriteFrame=s.ResourceController.inst.getPointSprite(r.PlayerModelProxy.inst.Theme,t.BotPoint),this.updateState(t.State)},e.prototype.unuse=function(){this.node.scale=1,this.dominoId=""},e.prototype.updateState=function(t){t==a.DominoState.Back?this.turnBack():this.turnFront()},e.prototype.turnBack=function(){this.Back.active=!0,this.Front.active=!1,this.PointRoot.active=!1},e.prototype.turnFront=function(){this.Back.active=!1,this.Front.active=!0,this.PointRoot.active=!0},e=__decorate([l],e)}(o.default));i.default=d,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Controller/ResourceController":"ResourceController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DominoModel":"DominoModel","./DominoStateMediator":"DominoStateMediator"}],DominoTouchMediator:[function(t,e,i){"use strict";cc._RF.push(e,"3fb25pDlgRALqJT87WTHhz1","DominoTouchMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/SingleTouchMediator"),n=t("../../Controller/GameStateController"),a=t("../../Controller/DominoSelector"),s=t("../../Model/DominoModel"),r=t("../../Command/GamePlaySignal"),h=t("../../Facade/PlayerModelProxy"),l=cc._decorator,d=l.ccclass,c=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){t.prototype.onRegister.call(this),r.PlayerSelectedDomino.inst.addListenerOne(this.onSelected,this),r.PlayerReleasedDomino.inst.addListenerTwo(this.onReleased,this)},e.prototype.onUnregister=function(){t.prototype.onUnregister.call(this)},e.prototype.onSelected=function(t){this.View.ID!=t?this.View.onRelease():this.View.onSelected()},e.prototype.onReleased=function(t,e){this.View.ID==t?e&&this.View.onRelease():this.View.onRelease()},e.prototype.onTouchStart=function(t){0!=n.GameStateController.inst.isRoundStart()?0!=h.PlayerModelProxy.inst.isPlayerTurn()?[s.DominoOwner.Player,s.DominoOwner.Stack].indexOf(this.View.Owner)<0?console.log("touch start , domino owner is not Player or Stack:",this.View.ID,", current owner:",s.DominoOwner[this.View.Owner]):a.DominoSelector.inst.isSelected()?console.log("touch start  has selected a domino:",a.DominoSelector.inst.getCurrentDominoID()):a.DominoSelector.inst.select(this.View.ID):console.log(" AI turn"):console.log("touch start round not start now:",this.View.ID)},e.prototype.onTouchMove=function(t){0!=n.GameStateController.inst.isRoundStart()&&0!=h.PlayerModelProxy.inst.isPlayerTurn()&&([s.DominoOwner.Player,s.DominoOwner.Stack].indexOf(this.View.Owner)<0||0!=a.DominoSelector.inst.isSelected()&&a.DominoSelector.inst.getCurrentDominoID()===this.View.ID&&this.View.onDrag(t.getDelta()))},e.prototype.onTouchEnd=function(t){0!=n.GameStateController.inst.isRoundStart()&&0!=h.PlayerModelProxy.inst.isPlayerTurn()&&([s.DominoOwner.Player,s.DominoOwner.Stack].indexOf(this.View.Owner)<0||a.DominoSelector.inst.isSelected()&&a.DominoSelector.inst.getCurrentDominoID()!==this.View.ID||a.DominoSelector.inst.free(this.View.MoveDistance<=300||this.View.Pos.y<=200))},e.prototype.onTouchCancel=function(t){0!=n.GameStateController.inst.isRoundStart()&&0!=h.PlayerModelProxy.inst.isPlayerTurn()&&([s.DominoOwner.Player,s.DominoOwner.Stack].indexOf(this.View.Owner)<0||a.DominoSelector.inst.isSelected()&&a.DominoSelector.inst.getCurrentDominoID()!==this.View.ID||a.DominoSelector.inst.free(this.View.MoveDistance<=300||this.View.Pos.y<=200))},e=__decorate([d],e)}(o.default));i.default=c,cc._RF.pop()},{"../../../View/SingleTouchMediator":"SingleTouchMediator","../../Command/GamePlaySignal":"GamePlaySignal","../../Controller/DominoSelector":"DominoSelector","../../Controller/GameStateController":"GameStateController","../../Facade/PlayerModelProxy":"PlayerModelProxy","../../Model/DominoModel":"DominoModel"}],DominoTouchView:[function(t,e,i){"use strict";cc._RF.push(e,"f755dkIaNJJOqsleXgF2v47","DominoTouchView"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../../Model/DominoModel"),a=t("../../../View/BaseView"),s=t("./DominoTouchMediator"),r=t("../../Command/GamePlaySignal"),h=t("../../../Utils/Cocos"),l=cc._decorator,d=l.ccclass;l.property;(function(t){t[t.None=0]="None",t[t.Selected=1]="Selected",t[t.Drag=2]="Drag",t[t.Release=3]="Release"})(o||(o={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultPosition=cc.v2(0,0),e.targetPosition=null,e.targetScale=0,e.touchState=null,e.dispatchDone=!0,e.zIndex=0,e.selectOffset=200,e.scaleStep=0,e.offsetStep=cc.v2(0,0),e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.BindMedaitor(s.default),r.DispatchDoneSignal.inst.addListenerOne(this.onDispatchDone,this),r.UpdateDominoArrayPos.inst.addListenerTwo(this.onUpdatePos,this)},e.prototype.onUpdatePos=function(t,e){this.ID==t&&(this.defaultPosition=e,this.Owner==n.DominoOwner.Player&&this.State==o.Release&&(this.targetPosition=this.defaultPosition.clone()))},e.prototype.onDispatchDone=function(t){this.ID==t&&(this.defaultPosition=this.node.position.clone(),this.targetScale=this.node.scale,this.dispatchDone=!0,this.zIndex=this.node.zIndex)},e.prototype.start=function(){},e.prototype.unuse=function(){this.zIndex=this.node.zIndex=0,this.model=null,this.dispatchDone=!1},Object.defineProperty(e.prototype,"Pos",{get:function(){return this.node.position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MoveDistance",{get:function(){return h.Distance(this.node.position,this.defaultPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ID",{get:function(){return this.model.ID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Owner",{get:function(){return this.model.Owner},enumerable:!0,configurable:!0}),e.prototype.reuse=function(t){this.model=t,this.node.zIndex=this.zIndex,this.State=o.Release,this.targetPosition=null,this.targetScale=1},Object.defineProperty(e.prototype,"State",{get:function(){return this.touchState},set:function(t){this.touchState!=t&&(this.touchState=t)},enumerable:!0,configurable:!0}),e.prototype.onSelected=function(){this.Owner==n.DominoOwner.Player&&this.State==o.Release&&(this.node.zIndex=cc.macro.MAX_ZINDEX,this.State=o.Selected,this.targetPosition=this.defaultPosition.add(cc.v2(0,this.selectOffset)),this.targetScale=1/this.node.parent.scale*1.5,console.log("on Selected :",this.targetScale))},e.prototype.onDrag=function(t){t.mulSelf(1/this.node.parent.scale),this.Owner==n.DominoOwner.Player&&(this.State=o.Drag,this.targetScale=1/this.node.parent.scale*1.5,this.node.zIndex=cc.macro.MAX_ZINDEX,this.targetPosition.addSelf(t))},e.prototype.onRelease=function(){this.Owner==n.DominoOwner.Player&&(this.node.zIndex=this.zIndex,this.State=o.Release,this.targetPosition=this.defaultPosition.clone(),this.targetScale=1)},e.prototype.update=function(t){this.model&&this.Owner==n.DominoOwner.Player&&this.dispatchDone&&(this.scaleStep=(this.targetScale-this.node.scale)/2,this.node.scale+=this.scaleStep,(this.node.scale>this.targetScale&&this.scaleStep>0||this.node.scale<this.targetScale&&this.scaleStep<0)&&(this.node.scale=this.targetScale),this.targetPosition&&(this.offsetStep.x=(this.targetPosition.x-this.node.x)/2,this.node.x+=this.offsetStep.x,(this.node.x>this.targetPosition.x&&this.offsetStep.x>0||this.node.x<this.targetPosition.x&&this.offsetStep.x<0)&&(this.node.x=this.targetPosition.x),this.offsetStep.y=(this.targetPosition.y-this.node.y)/2,this.node.y+=this.offsetStep.y,(this.node.y>this.targetPosition.y&&this.offsetStep.y>0||this.node.y<this.targetPosition.y&&this.offsetStep.y<0)&&(this.node.y=this.targetPosition.y)))},e=__decorate([d],e)}(a.default);i.default=c,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./DominoTouchMediator":"DominoTouchMediator"}],FacadeGlobal:[function(t,e,i){"use strict";cc._RF.push(e,"c46cfDkM7pInYAeGAk610m1","FacadeGlobal"),cc._RF.pop()},{}],FrameAniBase:[function(t,e,i){"use strict";cc._RF.push(e,"6298cJI+OZK9J9ZyfrpqPP2","FrameAniBase"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,s=o.executeInEditMode,r=o.requireComponent,h=o.playOnFocus,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Frames=null,e.Interval=.1,e.Priority=0,e.Loop=!1,e.PlayOnLoad=!1,e.currentIndex=0,e.time=0,e.isPlay=!1,e.listener=[],e.complateEvent=[],e}var i;return __extends(e,t),i=e,Object.defineProperty(e.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Animation",{set:function(t){this.Frames=t},enumerable:!0,configurable:!0}),e.prototype.onFocusInEditor=function(){this.time=this.Interval,i.intervalID=setInterval(this.update.bind(this),.016,.016)},e.prototype.onLostFocusInEditor=function(){clearInterval(i.intervalID)},e.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},e.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,0==this.isPlaying&&this.callEventComplete()},e.prototype.playOnLoop=function(){this.Loop=!0,this.play()},e.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},e.prototype.pause=function(){this.isPlay=!1},e.prototype.resume=function(){this.isPlay=!0},e.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.Loop=!1},e.prototype.onKeyFrame=function(t){},e.prototype.addKeyEventListener=function(t,e){this.listener.push({callback:t,target:e})},Object.defineProperty(e.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),e.prototype.clearAllListener=function(){return this.listener.length=0,this},e.prototype.onComplete=function(){},e.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var t=0,e=this.listener;t<e.length;t++){var i=e[t];i.callback.apply(i.target,[this.currentIndex,this.__classname__])}},e.prototype.callEventComplete=function(){this.onComplete();for(var t=0,e=this.complateEvent;t<e.length;t++){var i=e[t];i.f.apply(i.target,[this.__classname__])}},e.prototype.addCompleteEvent=function(t,e){this.complateEvent.push({f:t,target:e})},Object.defineProperty(e.prototype,"TotalFrameCount",{get:function(){return this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),e.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},e.prototype.start=function(){},Object.defineProperty(e.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var t=0,e=this.getComponents(i);t<e.length;t++){var o=e[t];if(o.Priority>this.Priority&&o.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex],this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.Frames.getSpriteFrames().length,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},e.prototype.update=function(t){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=t},e.aniName="FrameAniBase",e.intervalID=-1,__decorate([a(cc.SpriteAtlas)],e.prototype,"Frames",void 0),__decorate([a],e.prototype,"Interval",void 0),__decorate([a],e.prototype,"Priority",void 0),__decorate([a],e.prototype,"Loop",void 0),__decorate([a],e.prototype,"PlayOnLoad",void 0),e=i=__decorate([n,s,h,r(cc.Sprite)],e)}(cc.Component);i.default=l,cc._RF.pop()},{}],GameFactory:[function(t,e,i){"use strict";cc._RF.push(e,"93d23kfnY1A76OtZSkIyJ5r","GameFactory"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Utils/HashMap"),n=function(){function t(t,e,i){this._pool=[],this.totalSize=0,this.initTime=[],this.completeHandler=i,this.template=t,this.totalSize=e,this.hashKey="ObjPool:"+this.template.name+" - "+this.totalSize,this.initPool(e)}return t.prototype.initPool=function(t,e){var i=this;if(void 0===e&&(e=!1),e)for(var o=0;o<t;++o){this.initTime.push(Date.now());var n=cc.instantiate(this.template);this.put(n)}else for(o=0;o<t;++o)this.initTime.push(Date.now()),setTimeout(function(){var t=cc.instantiate(i.template);i.put(t)},o)},t.prototype.size=function(){return this._pool.length},t.prototype.clear=function(){for(var t=this._pool.length,e=0;e<t;++e)this._pool[e].destroy&&this._pool[e].destroy();this._pool.length=0},t.prototype.put=function(t){if(t&&-1===this._pool.indexOf(t)){t.removeFromParent(!1);for(var e=0,i=t.getComponents(cc.Component);e<i.length;e++){var o=i[e];o&&o.unuse&&o.unuse.apply(o)}this._pool.push(t),this.completeHandler&&this.totalSize<=this._pool.length&&(this.completeHandler(),this.completeHandler=null)}},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this._pool.length-1;i<0&&(console.warn(" last < 0 "),this.initPool(1,!0)),i=this._pool.length-1;var o=this._pool[i];this._pool.length=i;for(var n=0,a=o.getComponents(cc.Component);n<a.length;n++){var s=a[n];s&&s.reuse&&s.reuse.apply(s,arguments)}return o},t}(),a=function(){function t(){this.count=0,this.totalCount=0,this.objPool=new o.HashMap,this.startTime=0}return Object.defineProperty(t,"inst",{get:function(){return this.ins?this.ins:this.ins=new t},enumerable:!0,configurable:!0}),t.prototype.init=function(t){var e=this;this.doneCallback=t,this.startTime=Date.now(),cc.loader.loadResDir("prefabs/",cc.Prefab,function(t,i,o){if(t)console.error(" Game Factory init failed:",t);else{e.totalCount=i.length;for(var a=function(t){var o=i[t],a=o.name.split("."),s=a[0],r=a[1]?parseInt(a[1]):30;console.log(" init pool:",s,", count:",r),setTimeout(function(){var t=new n(o,r,e.addCount.bind(e));e.objPool.add(s,t)},10*t)},s=0;s<i.length;s++)a(s)}})},t.prototype.addCount=function(){this.count++,this.count>=this.totalCount&&(console.log(" factory cost time:",(Date.now()-this.startTime).toFixed(2)+"ms"),this.doneCallback&&(this.doneCallback(),this.doneCallback=null))},t.prototype.getObj=function(t){for(var e,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return this.objPool.has(t)?(e=this.objPool.get(t)).get.apply(e,i):(console.error(" objPool dosen't exists this obj:",t),null)},t.prototype.putObj=function(t,e){if(this.objPool.has(t))return this.objPool.get(t).put(e);console.error(" objPool dosen't exists this obj:",t)},t}();i.gFactory=a.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],GamePlayModel:[function(t,e,i){"use strict";cc._RF.push(e,"44c14BLbudFBKuHzjUsVsV9","GamePlayModel"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Global/Theme"),n=t("../../Global/Level"),a=t("../../Utils/Random"),s=t("../../Initialization/Command/InitSignal"),r=t("./GameRule"),h=t("../../Utils/HashMap"),l=t("./RoundModel"),d=t("./DominoModel"),c=t("../Command/GamePlaySignal"),p=t("./DeskNodeModel"),u=t("../../Global/Desk"),g=function(){function t(){this.round=0,this.roundCreated=0,this.level=0,this.playerScore=0,this.noviceScore=0,this.gameTime=0,this.roundCache=new h.HashMap,this.currentRound=null,this.init()}return t.prototype.init=function(){},Object.defineProperty(t.prototype,"Theme",{get:function(){return this.theme},set:function(t){console.log("set game theme:",o.Theme[t]),this.theme=t,s.GameThemeInit.inst.dispatchOne(this.theme)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this.level},set:function(t){console.log("set game Level:",t),this.level=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Round",{get:function(){return this.round},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RoundData",{get:function(){return this.currentRound},enumerable:!0,configurable:!0}),t.prototype.initGametheme=function(){var t=n.Level.getThemeRandomPool(this.Level);this.Theme=t[Math.floor(a.Random.getRandom()*t.length)]},t.prototype.createRoundData=function(t){var e;void 0===t&&(t=6),console.log(" -- initRoundData : ",t);n.Level.getDominoCountInRound(this.level);for(var i=n.Level.getDominoCountInHand(this.level),o=n.Level.getPointRandomPool(this.level),s=0;s<t;++s){this.roundCreated++;for(var r=[],h=[],c=[],p=[],u=0;u<o.length;u++)for(var g=u;g<o.length;g++)p.push(new d.DominoModel(o[u],o[g],this.roundCreated));for(var f=0;f<p.length;f++){var m=Math.floor(a.Random.getRandom()*p.length);e=[p[m],p[f]],p[f]=e[0],p[m]=e[1]}for(;h.length<i;)h.push(p.pop());for(;r.length<i;)r.push(p.pop());for(;p.length>0;)c.push(p.pop());this.roundCache.add(this.roundCreated,new l.RoundModel(h,r,c,this.roundCreated))}console.log(this.roundCache.values),console.log(" -- has create ",this.roundCreated," data.")},t.prototype.nextRound=function(){this.round++,this.roundCache.has(this.round)||this.createRoundData(),this.currentRound=this.roundCache.get(this.round),console.assert(null!=this.currentRound," round data is null"),this.turn=this.round%2?r.Turn.Player:r.Turn.AI,this.turn=r.Turn.Player,console.log(" \u7b2c",this.round+" \u56de\u5408, \u8d77\u624b:",r.Turn[this.turn]),p.DeskNodeModel.resetPading(),p.DeskNodeModel.RootScale=u.DeskScaleRange.Origin,c.RoundNumberChanged.inst.dispatchOne(this.round)},Object.defineProperty(t.prototype,"currentTurn",{get:function(){return this.turn},enumerable:!0,configurable:!0}),t.prototype.changeTurn=function(){this.turn=this.turn==r.Turn.AI?r.Turn.Player:r.Turn.AI,this.turn=r.Turn.Player,c.PlayTurnChanged.inst.dispatchOne(this.turn)},t.prototype.getTotalDominosInRound=function(){return this.currentRound.getTotalDominos()},t.prototype.getPlayerDominosInRound=function(){return this.currentRound.getPlayerDominos()},t.prototype.getAIDominosInRound=function(){return this.currentRound.getAIDominos()},t.prototype.getDeskDominosInRound=function(){return this.currentRound.getDeskDominos()},t.prototype.getStackDominosInRound=function(){return this.currentRound.getStackDominos()},t.prototype.addPlayerScore=function(t){this.playerScore+=t,this.playerScore=Math.max(this.playerScore,0),c.PlayerScoreChanged.inst.dispatchOne(this.playerScore)},t.prototype.addNoviceScore=function(t){this.noviceScore+=t,this.noviceScore=Math.max(this.noviceScore,0),c.NoviceScoreChanged.inst.dispatchOne(this.noviceScore)},t}();i.GamePlayModel=g,cc._RF.pop()},{"../../Global/Desk":"Desk","../../Global/Level":"Level","../../Global/Theme":"Theme","../../Initialization/Command/InitSignal":"InitSignal","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../Command/GamePlaySignal":"GamePlaySignal","./DeskNodeModel":"DeskNodeModel","./DominoModel":"DominoModel","./GameRule":"GameRule","./RoundModel":"RoundModel"}],GamePlaySignal:[function(t,e,i){"use strict";cc._RF.push(e,"f546cQa6nNAALT4Y03Ql6vU","GamePlaySignal"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Utils/Signal"),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.BeforeNextRoundSignal=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.NextRoundSignal=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.RoundStartSignal=s;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.RoundEndSignal=r;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.ReadyDispatchDominoSignal=h;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DispatchPlayerDomino=l;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DispatchAIDomino=d;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DispatchStackDomino=c;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DispatchDoneSignal=p;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.PlayerSelectedDomino=u;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.PlayerReleasedDomino=g;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.PlaceDomino=f;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.PlaceDominoDone=m;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.ActionDoneThisTurn=y;var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.SkipActionThisTurn=D;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.UpdateDominoArrayPos=S;var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.PlayTurnChanged=M;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.RoundNumberChanged=_;var I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.NoviceScoreChanged=I;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.PlayerScoreChanged=P;var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.BoneyardCountChanged=O;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DominoStateChanged=b;var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DominoOwnerChanged=R;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DeskRootScale=v;var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.DeskRootPadingChanged=x,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],GameRule:[function(t,e,i){"use strict";cc._RF.push(e,"e188bsLeINMX7IBIdB98Lvl","GameRule"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Three=3]="Three",t[t.Four=4]="Four",t[t.Five=5]="Five",t[t.Six=6]="Six",t[t.Seven=7]="Seven"}(i.DominoPoint||(i.DominoPoint={})),function(t){t[t.AI=0]="AI",t[t.Player=1]="Player"}(i.Turn||(i.Turn={})),cc._RF.pop()},{}],GameStateController:[function(t,e,i){"use strict";cc._RF.push(e,"8e9767SqtRH2bxBloI/ZSqE","GameStateController"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../../Utils/ToSingleton"),a=t("../Command/GamePlaySignal");(function(t){t[t.Init=0]="Init",t[t.OutOfMove=1]="OutOfMove",t[t.TimeUp=2]="TimeUp",t[t.DominoOut=3]="DominoOut",t[t.ScoreReach=4]="ScoreReach"})(o=i.RoundEndType||(i.RoundEndType={}));var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pauseCount=0,e.roundstart=!1,e}return __extends(e,t),e.prototype.start=function(){this.pauseCount=0},e.prototype.roundStart=function(){console.log(" round start"),this.roundstart=!0,a.RoundStartSignal.inst.dispatch()},e.prototype.roundEnd=function(t){console.log("round end "),this.roundstart=!1,t!=o.Init&&a.RoundEndSignal.inst.dispatchOne(t)},e.prototype.isRoundStart=function(){return this.roundstart},e.prototype.pause=function(){this.pauseCount++},e.prototype.resume=function(){this.pauseCount--,console.assert(this.pauseCount>=0," pause count smaller than 0!!!"),this.pauseCount=Math.max(this.pauseCount,0)},e.prototype.isPause=function(){return this.pauseCount>0},e}(n.SingleTon());i.GameStateController=s,cc._RF.pop()},{"../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal"}],HashMap:[function(t,e,i){"use strict";cc._RF.push(e,"4b0e7DzcRNJnZXTYCWgDaDU","HashMap"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this._list=new Array,this.clear()}return t.prototype.getIndexByKey=function(t){for(var e=this._list.length,i=0;i<e;i++){if(this._list[i].key==t)return i}return-1},t.prototype.keyOf=function(t){for(var e=this._list.length,i=0;i<e;i++){var o=this._list[i];if(o.value.hashKey&&t.hashKey&&o.value.hashKey===t.hashKey||o.value==t)return o.key}return null},Object.defineProperty(t.prototype,"keys",{get:function(){for(var t=new Array,e=0,i=this._list;e<i.length;e++){var o=i[e];o&&t.push(o.key)}return t},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){var i={key:t,value:e},o=this.getIndexByKey(t);-1!=o?this._list[o]=i:this._list.push(i)},Object.defineProperty(t.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){var e=this.getIndexByKey(t);if(-1!=e){var i=this._list[e];return this._list.splice(e,1),i}return null},t.prototype.has=function(t){return-1!=this.getIndexByKey(t)},t.prototype.get=function(t){var e=this.getIndexByKey(t);return-1!=e?this._list[e].value:null},Object.defineProperty(t.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),t.prototype.sort=function(t){this._list.sort(t)},t.prototype.forEachKeyValue=function(t){for(var e=this._list.length,i=0;i<e;i++){t(this._list[i])}},t.prototype.forEach=function(t){for(var e=this._list.length,i=0;i<e;i++){var o=this._list[i];t(o.key,o.value)}},t.prototype.clear=function(){this._list=[]},t}();i.HashMap=o,cc._RF.pop()},{}],InitSceneView:[function(t,e,i){"use strict";cc._RF.push(e,"bcc37nuyBhJzL2qRh1HJa3o","InitSceneView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../View/BaseView"),n=t("./LoadingPageMediator"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},e.prototype.start=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],InitSignal:[function(t,e,i){"use strict";cc._RF.push(e,"646a9Tm+5pCK5Z4d5Nzebhw","InitSignal"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Utils/Signal"),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.GameThemeInit=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.BaseSignal);i.GameReadySignal=a,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],InitialFacade:[function(t,e,i){"use strict";cc._RF.push(e,"cbbbcO7od5PrqaPNOs8dFh3","InitialFacade"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Command/InititalCommond"),n=t("../Command/StartGameCommond"),a=t("../Command/LoadAudioCommond"),s=t("../Command/LoadPrefabCommond"),r=t("../../Utils/Celer/CelerSDK"),h=function(){function t(t){this.loadTime={},this.steps=[],this.facade=puremvc.Facade.getInstance(t)}return Object.defineProperty(t,"inst",{get:function(){return this.instance?this.instance:this.instance=new t(t.MULTITON_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Facade",{get:function(){return console.assert(null!==this.facade," facade is null"),this.facade},enumerable:!0,configurable:!0}),t.prototype.register=function(){var e=this;this.facade.registerCommand(t.INITIALIZATION,o.InitialCommond),this.facade.registerCommand(t.START_UP,n.StartGameCommond),r.CelerSDK.inst.init(function(){e.facade.sendNotification(t.START_UP,e)})},t.prototype.unregister=function(){this.facade.removeCommand(t.INITIALIZATION),this.facade.removeCommand(t.START_UP)},t.prototype.start=function(){this.register();for(var e=0,i=t.TOTAL_STEPS;e<i.length;e++){var o=i[e];this.loadTime[o]=Date.now()}this.facade.sendNotification(t.INITIALIZATION,this)},t.prototype.step=function(e){if(console.log(" initialization step:",e),this.steps.indexOf(e)<0){this.steps.push(e),this.steps.sort(),t.TOTAL_STEPS.sort();var i=this.steps.join("-"),o=t.TOTAL_STEPS.join("-");console.log(" cur-steps\uff1a",i,", total:",o,", ",e," cost:",(Date.now()-this.loadTime[e]).toFixed(2),"ms"),o===i&&(r.CelerSDK.inst.isOnCelerPlatform()?r.CelerSDK.inst.celerXReady():this.facade.sendNotification(t.START_UP,this))}},t.MULTITON_KEY="INITIAL_FCADE",t.INITIALIZATION="initialization",t.START_UP="startup",t.TOTAL_STEPS=[a.LoadAudioCommond.STEP,s.LoadPrefabCommond.STEP],t}();i.InitialFacade=h,cc._RF.pop()},{"../../Utils/Celer/CelerSDK":"CelerSDK","../Command/InititalCommond":"InititalCommond","../Command/LoadAudioCommond":"LoadAudioCommond","../Command/LoadPrefabCommond":"LoadPrefabCommond","../Command/StartGameCommond":"StartGameCommond"}],InititalCommond:[function(t,e,i){"use strict";cc._RF.push(e,"a28caT/H41F74cWxJYqN9pz","InititalCommond"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./LoadPrefabCommond"),n=t("./LoadAudioCommond"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initializeMacroCommand=function(){this.addSubCommand(o.LoadPrefabCommond),this.addSubCommand(n.LoadAudioCommond)},e}(puremvc.MacroCommand);i.InitialCommond=a,cc._RF.pop()},{"./LoadAudioCommond":"LoadAudioCommond","./LoadPrefabCommond":"LoadPrefabCommond"}],Level:[function(t,e,i){"use strict";cc._RF.push(e,"3ebc53AC99D9oQzOQ3jCSgn","Level"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Theme"),n=t("../GamePlay/Model/GameRule"),a=function(){function t(){}return t.getThemeRandomPool=function(t){return[o.Theme.Number]},t.getDominoCountInRound=function(t){return 28},t.getDominoCountInHand=function(t){return 7},t.getTopPointRandomPool=function(t){return[n.DominoPoint.One,n.DominoPoint.Two,n.DominoPoint.Three,n.DominoPoint.Four,n.DominoPoint.Five,n.DominoPoint.Six,n.DominoPoint.Seven]},t.getBottomPointRandomPool=function(t){return[n.DominoPoint.One,n.DominoPoint.Two,n.DominoPoint.Three,n.DominoPoint.Four,n.DominoPoint.Five,n.DominoPoint.Six,n.DominoPoint.Seven]},t.getPointRandomPool=function(t){return[n.DominoPoint.One,n.DominoPoint.Two,n.DominoPoint.Three,n.DominoPoint.Four,n.DominoPoint.Five,n.DominoPoint.Six,n.DominoPoint.Seven]},t}();i.Level=a,cc._RF.pop()},{"../GamePlay/Model/GameRule":"GameRule","./Theme":"Theme"}],LoadAudioCommond:[function(t,e,i){"use strict";cc._RF.push(e,"d4f3eGYUlBES5d8aEvuPQna","LoadAudioCommond"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){if(t){var i=t.getBody();i&&i.step&&i.step(e.STEP)}},e.STEP="LoadAudio",e}(puremvc.SimpleCommand);i.LoadAudioCommond=o,cc._RF.pop()},{}],LoadPrefabCommond:[function(t,e,i){"use strict";cc._RF.push(e,"8b33fPnvCZEJ7bc/zCVv9My","LoadPrefabCommond"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Factory/GameFactory"),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){o.gFactory.init(function(){if(t){var i=t.getBody();i&&i.step&&i.step(e.STEP)}})},e.STEP="LoadPrefab",e}(puremvc.SimpleCommand);i.LoadPrefabCommond=n,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory"}],LoadingPageMediator:[function(t,e,i){"use strict";cc._RF.push(e,"890a7spQqhPvr2Up1cp0iGl","LoadingPageMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../View/BaseMediator"),n=t("../Command/InitSignal"),a=t("../../GamePlay/Command/GamePlaySignal"),s=cc._decorator,r=s.ccclass,h=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.GameReadySignal.inst.addListener(this.onGameReady,this)},e.prototype.onGameReady=function(){console.log(" -- game init done, hide loading page "),this.View.Hide(function(){a.NextRoundSignal.inst.dispatch()})},e.prototype.onDestroy=function(){},e=__decorate([r],e)}(o.default));i.default=h,cc._RF.pop()},{"../../GamePlay/Command/GamePlaySignal":"GamePlaySignal","../../View/BaseMediator":"BaseMediator","../Command/InitSignal":"InitSignal"}],LoadingView:[function(t,e,i){"use strict";cc._RF.push(e,"5bb03yEifFAc6rRMybrkHat","LoadingView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../View/BaseView"),n=t("./LoadingPageMediator"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=1,this.node.opacity=255,this.BindMedaitor(n.default)},e.prototype.start=function(){},e.prototype.Hide=function(t){var e=this;this.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){e.node.active=!1,t()})))},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],LogHandler:[function(t,e,i){"use strict";cc._RF.push(e,"a4747QIvUBIo6Ktpx/xQwuB","LogHandler"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var i=t.call(this)||this;if(i.logFunc=console.log,i.logMsg=null,i.frameTimes=0,i.now=0,i.Frame=20,i.totalFrames=0,i.startTime=0,window.addEventListener)for(var o=0,n=e.LISTENNING_EVENTS;o<n.length;o++){var a=n[o],s="trigger"+a.charAt(0).toLocaleUpperCase()+a.substring(1);i[s]&&"function"==typeof i[s]&&window.addEventListener(a,i[s].bind(i))}return i}return __extends(e,t),e.prototype.dumpFrameInfo=function(){var t=(Date.now()-this.startTime)/1e3,e=t/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",t+"s"," , per frame cost time ave:"+e+"s")},e.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addLog.apply(this,t),this.sendLog()},e.prototype.initLog=function(t){var i=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){i.frameTimes=0,i.now=Date.now(),i.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){i.frameTimes++,i.totalFrames++,i.frameTimes>=i.Frame&&(i.frameTimes=0,i.now=Date.now())},this),this.logFunc=t,console.error=function(){for(var t,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];(t=e.inst).log.apply(t,["[ERROR]"].concat(i))},console.warn=function(){for(var t,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];(t=e.inst).log.apply(t,["[WARN]"].concat(i))},console.log=function(){for(var t,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];(t=e.inst).log.apply(t,["[INFO]"].concat(i))},console.assert=function(t){for(var i,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];t&&(i=e.inst).log.apply(i,["[ERROR]"].concat(o))}},e.prototype.formatLogArguments=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i="",o=0;o<arguments.length;o++){var n=typeof arguments[o];"string"==n||"number"==n?i+=" "+arguments[o]:"object"==n?i+=" "+JSON.stringify(arguments[o]):"boolean"==n&&arguments[o].toString&&(i+=arguments[o].toString())}return i},e.prototype.addLog=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];null==this.logMsg&&(this.logMsg={});var o=this.formatLogArguments.apply(this,t),n=this.getFullTime(new Date);this.logMsg[n]=e.VERSION+o},e.prototype.getFullTime=function(t){var e="";e+=t.getFullYear();var i=t.getMonth()+1;e+="-"+(i>=10?i:"0"+i);var o=t.getDate();e+="-"+(o>=10?o:"0"+o);var n=t.getHours();e+="  "+(n>=10?n:"0"+n);var a=t.getMinutes();e+=":"+(a>=10?a:"0"+a);var s=t.getSeconds();return e+=":"+(s>=10?s:"0"+s)},e.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},e.prototype.triggerClose=function(t){this.addLog("triggerClose"),this.sendLog()},e.prototype.triggerLoad=function(t){this.addLog("triggerLoad"),this.sendLog()},e.prototype.triggerUnload=function(t){this.addLog("triggerUnload"),this.sendLog()},e.prototype.triggerOnunload=function(t){this.addLog("triggerUnload"),this.sendLog()},e.prototype.triggerError=function(t){this.addLog("triggerError"),this.addLog(t.message),this.sendLog()},e.prototype.triggerFocus=function(t){this.addLog("triggerFocus"),this.sendLog()},e.prototype.triggerBlur=function(t){this.addLog("triggerBlur"),this.sendLog()},e.prototype.triggerAbort=function(t){this.addLog("triggerAbort"),this.sendLog()},e.prototype.triggerSuspend=function(t){this.addLog("triggerSuspend"),this.sendLog()},e.prototype.beforeunload=function(t){this.addLog("beforeunload"),this.sendLog()},e.VERSION="DominoCash version 1 : ",e.LISTENNING_EVENTS=["error"],e}(t("./ToSingleton").SingleTon());i.LogHandler=o,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],NoviceScoreView:[function(t,e,i){"use strict";cc._RF.push(e,"4f218LIe2pG+4ykKpmPlGiu","NoviceScoreView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./NumberChangedView"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.NoviceScoreChanged.inst.addListenerOne(this.onNumberChanged,this)},e.prototype.start=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal","./NumberChangedView":"NumberChangedView"}],NumberChangedView:[function(t,e,i){"use strict";cc._RF.push(e,"2b373cJGixKrYQE7awOvUKY","NumberChangedView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=cc._decorator,a=n.ccclass,s=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=0,e.showNum=0,e.step=0,e.label=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"Label",{get:function(){return this.label?this.label:this.label=this.node.getComponent(cc.Label)},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.onNumberChanged=function(t){this.num=t,this.num!=this.showNum?this.step=Math.ceil((this.num-this.showNum)/120):this.step=0},e.prototype.update=function(t){this.num!=this.showNum&&(this.showNum+=this.step,(this.showNum>this.num&&this.step>0||this.showNum<this.num&&this.step<0)&&(this.showNum=this.num,this.step=0)),this.Label.string=this.showNum.toString()},e=__decorate([a],e)}(o.default));i.default=s,cc._RF.pop()},{"../../../View/BaseView":"BaseView"}],PlayerCardRootMediator:[function(t,e,i){"use strict";cc._RF.push(e,"4eb14w4LJlCa7KntGVst6EG","PlayerCardRootMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseMediator"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRegister=function(){n.DispatchPlayerDomino.inst.addListenerTwo(this.onAddDomino,this),n.PlaceDominoDone.inst.addListener(this.onPlacedDone,this)},e.prototype.onAddDomino=function(t,e){this.View.addDomino(t,e)},e.prototype.onPlacedDone=function(){this.View.updateDominoPos()},e.prototype.onUnregister=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseMediator":"BaseMediator","../../Command/GamePlaySignal":"GamePlaySignal"}],PlayerCardRootView:[function(t,e,i){"use strict";cc._RF.push(e,"73787HzHthJ1LZA7f0ObcSf","PlayerCardRootView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("./PlayerCardRootMediator"),a=t("../../../Utils/Cocos"),s=t("../../Command/GamePlaySignal"),r=t("../../Model/DominoModel"),h=cc._decorator,l=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childOffset=cc.v2(14,0),e}return __extends(e,t),e.prototype.onLoad=function(){this.node.scale=1,this.BindMedaitor(n.default)},e.prototype.start=function(){},e.prototype.updateDominoPos=function(){if(!(this.node.childrenCount<=0)){var t=this.node.children;t.sort(function(t,e){return t.x-e.x});for(var e=!1,i=!1,o=0;o<t.length-1;o++){var n=t[o],a=t[o+1];n.x>n.width&&0==o&&(e=!0,s.UpdateDominoArrayPos.inst.dispatchTwo(n.name,n.position.add(cc.v2(-n.width-this.childOffset.x,0)))),e&&a?s.UpdateDominoArrayPos.inst.dispatchTwo(a.name,a.position.add(cc.v2(-a.width-this.childOffset.x,0))):(a&&a.x-n.x>2*n.width||i)&&(i=!0,s.UpdateDominoArrayPos.inst.dispatchTwo(a.name,a.position.add(cc.v2(-a.width-this.childOffset.x,0))))}this.node.scale=1-this.node.childrenCount/14*.3}},e.prototype.addDomino=function(t,e){t.getParent()&&t.setPosition(a.ConvertToNodeSpaceAR(t,this.node));var i=cc.v2(0,0);i.addSelf(this.childOffset.mul(this.node.childrenCount+1)),i.addSelf(cc.v2(t.width,0).mul(this.node.childrenCount).add(cc.v2(.75*t.width,0))),t.setParent(this.node),this.node.zIndex=0,this.node.scale=1-this.node.childrenCount/14*.3,t.scale=1/this.node.scale,t.runAction(cc.sequence(cc.delayTime(.1*this.node.childrenCount),cc.spawn(cc.moveTo(.2,i),cc.scaleTo(.2,1)),cc.callFunc(function(){s.DispatchDoneSignal.inst.dispatchTwo(e,r.DominoOwner.Player)})))},e=__decorate([l],e)}(o.default));i.default=d,cc._RF.pop()},{"../../../Utils/Cocos":"Cocos","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/DominoModel":"DominoModel","./PlayerCardRootMediator":"PlayerCardRootMediator"}],PlayerModelProxy:[function(t,e,i){"use strict";cc._RF.push(e,"05371njh5dFV5jUHKKdb8d5","PlayerModelProxy"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Utils/ToSingleton"),n=t("../Model/GamePlayModel"),a=t("../Command/GamePlaySignal"),s=t("../../Global/Level"),r=t("../Controller/GameStateController"),h=t("../Model/DominoModel"),l=t("../Model/GameRule"),d=t("../Controller/DominoSelector"),c=t("../View/DominoControl/DominoNodePool"),p=t("../Model/DeskNodeModel"),u=function(t){function e(){var e=t.call(this)||this;return e.playerModel=null,e.roundDispatchCount=0,e.bindSignal(),e}return __extends(e,t),Object.defineProperty(e.prototype,"connectJudgeDistance",{get:function(){return 1e3*p.DeskNodeModel.RootScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Model",{get:function(){return this.playerModel?this.playerModel:this.playerModel=new n.GamePlayModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return this.Model.Theme},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this.Model.Level},set:function(t){this.Model.Level=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Round",{get:function(){return this.Model.Round},enumerable:!0,configurable:!0}),e.prototype.bindSignal=function(){a.NextRoundSignal.inst.addListener(this.nextRound,this),a.DispatchDoneSignal.inst.addListenerTwo(this.onDispatchDominoDone,this),a.PlayerReleasedDomino.inst.addListenerTwo(this.onPlayerReleaseDomino,this),a.PlayTurnChanged.inst.addListenerOne(this.onPlayTurnChanged,this)},e.prototype.onPlayerReleaseDomino=function(t,e){this.onReleaseDomino(t,e,h.DominoOwner.Player)},e.prototype.onPlayTurnChanged=function(t){this.checkNeed2Draw()},e.prototype.checkCanConnect=function(t){return!!this.Model.RoundData.isDeskEmpty()||!(this.getHungryDominos(t).length<=0)&&null!=this.getTargetInfo(t)},e.prototype.onReleaseDomino=function(t,e,i){if(!e){if(this.Model.RoundData.isDeskEmpty())return this.Model.RoundData.addDomino(null,t,i,-1),void a.PlaceDomino.inst.dispatchOne(t);var o=this.getTargetInfo(t);if(null!=o){console.log("place target :",o.targetID,", connected point :",l.DominoPoint[o.targetVal]);var n=h.DominoModel.getDominoByID(t).getValPos(o.targetVal),s=h.DominoModel.getDominoByID(o.targetID).getValPos(o.targetVal);this.Model.RoundData.addDomino(o.targetID,t,i,o.targetVal),a.PlaceDomino.inst.dispatchFour(t,o.targetID,n,s)}}},e.prototype.getTargetInfo=function(t){var e=this.getHungryDominos(t);if(e.length<=0)return null;for(var i=this.connectJudgeDistance,o="",n=-1,a=0,s=e;a<s.length;a++){var r=s[a];c.default.getDistance(t,r.ID)<i&&(i=c.default.getDistance(t,r.ID),o=r.ID,n=h.DominoModel.getConnectedVal(t,o))}return""==o||-1==n?null:{targetVal:n,targetID:o}},e.prototype.checkNeed2Draw=function(){if(this.Model.RoundData.isDeskEmpty())return!1;for(var t=0,e=this.Model.currentTurn==l.Turn.AI?this.Model.getAIDominosInRound():this.Model.getPlayerDominosInRound();t<e.length;t++){var i=e[t];if(this.getHungryDominos(i.ID).length>0)return!1}if(this.Model.getDeskDominosInRound().length>0);else{for(var o=0,n=this.Model.currentTurn==l.Turn.AI?this.Model.getPlayerDominosInRound():this.Model.getAIDominosInRound();o<n.length;o++){i=n[o];if(this.getHungryDominos(i.ID).length>0)return a.SkipActionThisTurn.inst.dispatchOne(this.Model.currentTurn),this.Model.changeTurn(),!0}r.GameStateController.inst.roundEnd(r.RoundEndType.OutOfMove)}},e.prototype.onDispatchDominoDone=function(t,e){this.changeDominoOwner(e,t),r.GameStateController.inst.isRoundStart()||(this.roundDispatchCount++,this.roundDispatchCount>=s.Level.getDominoCountInRound(this.Model.Level)&&(this.checkNeed2Draw(),r.GameStateController.inst.roundStart()))},e.prototype.createRoundData=function(){this.Model.createRoundData()},e.prototype.initGametheme=function(){this.Model.initGametheme()},e.prototype.isPlayerTurn=function(){return this.Model.currentTurn==l.Turn.Player},e.prototype.nextRound=function(){d.DominoSelector.inst.free(!0),this.roundDispatchCount=0,r.GameStateController.inst.roundEnd(r.RoundEndType.Init),a.BeforeNextRoundSignal.inst.dispatch(),this.Model.nextRound(),a.ReadyDispatchDominoSignal.inst.dispatch()},e.prototype.getOriginDominoOnNewRound=function(){return this.Model.getTotalDominosInRound()},e.prototype.getPlayerDominos=function(){return this.Model.getPlayerDominosInRound()},e.prototype.getAIDominos=function(){return this.Model.getAIDominosInRound()},e.prototype.getDeskDominos=function(){return this.Model.getDeskDominosInRound()},e.prototype.getStackDominos=function(){return this.Model.getStackDominosInRound()},e.prototype.changeDominoOwner=function(t,e){h.DominoModel.getDominoByID(e).setOwner(t)},e.prototype.getHungryDominos=function(t){for(var e=[],i=0,o=this.Model.getDeskDominosInRound();i<o.length;i++){var n=o[i];h.DominoModel.checkCanConnect(t,n.ID)&&e.push(n)}return e},e}(o.SingleTon());i.PlayerModelProxy=u,cc._RF.pop()},{"../../Global/Level":"Level","../../Utils/ToSingleton":"ToSingleton","../Command/GamePlaySignal":"GamePlaySignal","../Controller/DominoSelector":"DominoSelector","../Controller/GameStateController":"GameStateController","../Model/DeskNodeModel":"DeskNodeModel","../Model/DominoModel":"DominoModel","../Model/GamePlayModel":"GamePlayModel","../Model/GameRule":"GameRule","../View/DominoControl/DominoNodePool":"DominoNodePool"}],PlayerScoreView:[function(t,e,i){"use strict";cc._RF.push(e,"e8edbOBuLtMSqa2yMYDJxJP","PlayerScoreView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./NumberChangedView"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.PlayerScoreChanged.inst.addListenerOne(this.onNumberChanged,this)},e.prototype.start=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../Command/GamePlaySignal":"GamePlaySignal","./NumberChangedView":"NumberChangedView"}],Random:[function(t,e,i){"use strict";cc._RF.push(e,"114f9Vox8JGQbohBr4HFlkf","Random"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.seededRandom=function(t,e,i){return e+1e6*((1711*t+88888)%302654/302654+(1722*t+55555)%302665/302665+(1755*t+23333)%302766/302766)%1e6/1e6*(i-e)},t.getRandom=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);var i=this.randomSeed,o=this.seededRandom(i,t,e),n=Math.floor(this.seededRandom(i,1,302766));return this.randomSeed+=n,o},t.setRandomSeed=function(t){console.log(" set random seed:",t),this.randomSeed=t,this.sharedSeed=t},t.randomRoundToInt=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),Math.round(this.getRandom(t,e))},t.randomSeed=Math.random(),t.sharedSeed=Math.random(),t}();i.Random=o,cc._RF.pop()},{}],ResourceController:[function(t,e,i){"use strict";cc._RF.push(e,"101438Z+apHT6Ap+WQKfVd2","ResourceController"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../Utils/ToSingleton"),n=t("../../Global/Theme"),a=t("../../Factory/GameFactory"),s=t("../View/DominoControl/DominoDeskTransform"),r={Number:{VerticalNormal:"bg_vertical",VerticalReverse:"bg_vertical",HorizontalLeft:"bg_across",HorizontalRight:"bg_across"},Sweet:{VerticalNormal:"bg_vertical",VerticalReverse:"bg_vertical",HorizontalLeft:"bg_across",HorizontalRight:"bg_across"}},h={Number:{0:"",1:"bg_point1",2:"bg_point2",3:"bg_point3",4:"bg_point4",5:"bg_point5",6:"bg_point6",7:"bg_point7"},Sweet:{0:"",1:"bg_point1circle",2:"bg_point2circletriangle",3:"bg_point3circlesquare",4:"bg_point4circleheart",5:"bg_point5circlestar",6:"bg_point6circlerainbow",7:"bg_point7circledonut"}},l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.UIAtlas=null,e}return __extends(e,t),e.prototype.setAtlas=function(t){console.assert(null!=t,"game atlas is null!"),this.UIAtlas=t},e.prototype.getPointSprite=function(t,e){var i=h[n.Theme[t]][e];return i&&""!=i?this.UIAtlas.getSpriteFrame(i):null},e.prototype.getFrontSprite=function(t,e){var i=r[n.Theme[t]][s.RotateState[e]];return i&&""!=i?this.UIAtlas.getSpriteFrame(i):null},e.prototype.getDomino=function(t){return a.gFactory.getObj("Domino",t)},e.prototype.putDomino=function(t){a.gFactory.putObj("Domino",t)},e}(o.SingleTon());i.ResourceController=l,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../../Global/Theme":"Theme","../../Utils/ToSingleton":"ToSingleton","../View/DominoControl/DominoDeskTransform":"DominoDeskTransform"}],RoundModel:[function(t,e,i){"use strict";cc._RF.push(e,"bf5bdkSPH5MipC9sR1nqP0P","RoundModel"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./DominoModel"),a=t("./DeskNodeModel"),s=t("../Command/GamePlaySignal");(function(t){t[t.AI=0]="AI",t[t.Player=1]="Player"})(o=i.DrawTarget||(i.DrawTarget={}));var r=function(){function t(t,e,i,o){this.playerDominos=[],this.AIDominos=[],this.DominoStack=[],this.DeskDominos=[],this.deskHeadDomino=null,this.playerDominos=t,this.AIDominos=e,this.DominoStack=i,this.deskHeadDomino=new a.DeskNodeModel(null,o)}return t.prototype.getDeskHeadDomino=function(){return this.deskHeadDomino},t.prototype.getTotalDominos=function(){return[].concat(this.AIDominos).concat(this.playerDominos).concat(this.DeskDominos).concat(this.DominoStack)},t.prototype.addPlayerDomino=function(t){this.playerDominos.push(t)},t.prototype.addDeskDomino=function(t){this.DeskDominos.push(t)},t.prototype.addAIDomino=function(t){this.AIDominos.push(t)},t.prototype.removeAIDomino=function(t){for(var e=0;e<this.AIDominos.length;e++)if(this.AIDominos[e].ID==t){this.AIDominos.splice(e,1);break}},t.prototype.removePlayerDomino=function(t){for(var e=0;e<this.playerDominos.length;e++)if(this.playerDominos[e].ID==t){this.playerDominos.splice(e,1);break}},t.prototype.removeDeskDomino=function(t){for(var e=0;e<this.DeskDominos.length;e++)if(this.DeskDominos[e].ID==t){this.DeskDominos.splice(e,1);break}},t.prototype.getPlayerDominos=function(){return this.playerDominos},t.prototype.getAIDominos=function(){return this.AIDominos},t.prototype.getStackDominos=function(){return this.DominoStack},t.prototype.getDeskDominos=function(){return this.DeskDominos},t.prototype.drawDomino=function(t,e){for(var i=0;i<this.DominoStack.length;++i)if(this.DominoStack[i].ID==t){console.log(o[e]," \u62bd\u724c:",t);var n=this.DominoStack.splice(i,1)[0];e==o.AI?this.addAIDomino(n):this.addPlayerDomino(n),s.BoneyardCountChanged.inst.dispatchOne(this.DominoStack.length);break}console.error(" Domino Stack has no this domino card:",t,", target:",o[e])},t.prototype.isDeskEmpty=function(){return 0==this.deskHeadDomino.hasChild()},t.prototype.isStackEmpty=function(){return this.DominoStack.length<=0},t.prototype.addDomino=function(t,e,i,o){var s=new a.DeskNodeModel(e);if(this.isDeskEmpty())this.deskHeadDomino.addChild(s.ID,o);else{var r=a.DeskNodeModel.getDeskNodeByDominoID(t);if(o>=0)n.DominoModel.getDominoByID(t).removePoint(o,1),n.DominoModel.getDominoByID(e).removePoint(o,1);r.addChild(s.ID,o)}i==n.DominoOwner.AI?this.removeAIDomino(e):i==n.DominoOwner.Player&&this.removePlayerDomino(e),this.addDeskDomino(n.DominoModel.getDominoByID(e))},t}();i.RoundModel=r,cc._RF.pop()},{"../Command/GamePlaySignal":"GamePlaySignal","./DeskNodeModel":"DeskNodeModel","./DominoModel":"DominoModel"}],RoundNumberView:[function(t,e,i){"use strict";cc._RF.push(e,"f1e3cYK7O5CubEBkE1PRV8Q","RoundNumberView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../View/BaseView"),n=t("../../Command/GamePlaySignal"),a=cc._decorator,s=a.ccclass,r=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.RoundNumberChanged.inst.addListenerOne(this.onRoundChanged,this)},e.prototype.onRoundChanged=function(t){this.node.getComponent(cc.Label).string=t.toString()},e.prototype.start=function(){},e=__decorate([s],e)}(o.default));i.default=r,cc._RF.pop()},{"../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal"}],Signal:[function(t,e,i){"use strict";cc._RF.push(e,"5e03fyVNOZPs7lLvT6ttunM","Signal"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listenerMap=[],e.onceListenerMap=[],e}return __extends(e,t),e.prototype.doDispatch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.excuteListener.apply(this,t),this.excuteOnce.apply(this,t)},e.prototype.excuteListener=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.listenerMap&&this.listenerMap.length>0)for(var i=0,o=this.listenerMap;i<o.length;i++){var n=o[i];n.callback.apply(n.target,t)}},e.prototype.excuteOnce=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var i=0,o=this.onceListenerMap;i<o.length;i++){var n=o[i];n.callback.apply(n.target,t)}this.onceListenerMap.length=0}},e.prototype.listen=function(t,e){this.listenerMap.push({callback:t,target:e})},e.prototype.listenOnce=function(t,e){this.onceListenerMap.push({callback:t,target:e})},e.prototype.removeListener=function(t,e){if(this.listenerMap&&this.listenerMap.length>0)for(var i=0;i<this.listenerMap.length;++i){var o=this.listenerMap[i];o.callback==t&&o.target==e&&(this.listenerMap.splice(i,1),--i)}},e.prototype.removeTarget=function(t){if(this.listenerMap&&this.listenerMap.length>0)for(var e=0;e<this.listenerMap.length;++e){this.listenerMap[e].target==t&&(this.listenerMap.splice(e,1),--e)}},e.prototype.dispatch=function(){this.doDispatch(null)},e.prototype.dispatchOne=function(t){this.doDispatch(t)},e.prototype.dispatchTwo=function(t,e){this.doDispatch(t,e)},e.prototype.dispatchThree=function(t,e,i){this.doDispatch(t,e,i)},e.prototype.dispatchFour=function(t,e,i,o){this.doDispatch(t,e,i,o)},e.prototype.dispatchFive=function(t,e,i,o,n){this.doDispatch(t,e,i,o,n)},e.prototype.addListener=function(t,e){this.listen(t,e)},e.prototype.addOnce=function(t,e){this.listenOnce(t,e)},e.prototype.addListenerOne=function(t,e){this.listen(t,e)},e.prototype.addListenerTwo=function(t,e){this.listen(t,e)},e.prototype.addListenerThree=function(t,e){this.listen(t,e)},e.prototype.addListenerFour=function(t,e){this.listen(t,e)},e.prototype.addListenerFive=function(t,e){this.listen(t,e)},e.prototype.addOnceOne=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceTwo=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceThree=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceFour=function(t,e){this.listenOnce(t,e)},e.prototype.addOnceFive=function(t,e){this.listenOnce(t,e)},e}(t("./ToSingleton").SingleTon());i.BaseSignal=o,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],SingleTouchMediator:[function(t,e,i){"use strict";cc._RF.push(e,"a548b2LkW5CxJKelhmtRBC7","SingleTouchMediator"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchid=null,e}return __extends(e,t),e.prototype.bind=function(t){this.view=t},Object.defineProperty(e.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),e.prototype.onRegister=function(){this.node.targetOff(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},e.prototype.onUnregister=function(){this.node.targetOff(this)},e.prototype.touchStart=function(t){null===this.touchid||this.touchid===t.getID()?(this.touchid=t.getID(),this.onTouchStart(t)):console.log(this.node.name," touch start  touchid is different: ",this.touchid,t.getID())},e.prototype.touchMove=function(t){null!==this.touchid&&this.touchid!==t.getID()||(this.touchid=t.getID(),this.onTouchMove(t))},e.prototype.touchEnd=function(t){null===this.touchid||this.touchid===t.getID()?null!=this.touchid&&(this.touchid=null,this.onTouchEnd(t),this.OnClick()):console.log(this.node.name," touch end  touchid is different: ",this.touchid,t.getID())},e.prototype.touchCancel=function(t){null===this.touchid||this.touchid===t.getID()?null!=this.touchid&&(this.touchid=null,this.onTouchCancel(t)):console.log(this.node.name," touch cancel  touchid is different: ",this.touchid,t.getID())},e.prototype.OnClick=function(){},e.prototype.onTouchStart=function(t){},e.prototype.onTouchMove=function(t){},e.prototype.onTouchEnd=function(t){},e.prototype.onTouchCancel=function(t){},e=__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],StartGameCommond:[function(t,e,i){"use strict";cc._RF.push(e,"1db594KvoJIVbc+cwfogrGn","StartGameCommond"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./InitSignal"),n=t("../../GamePlay/Facade/PlayerModelProxy"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){console.log("--------- excute StartGameCommond ---------"),n.PlayerModelProxy.inst.createRoundData(),n.PlayerModelProxy.inst.initGametheme(),o.GameReadySignal.inst.dispatch()},e}(puremvc.SimpleCommand);i.StartGameCommond=a,cc._RF.pop()},{"../../GamePlay/Facade/PlayerModelProxy":"PlayerModelProxy","./InitSignal":"InitSignal"}],StepManager:[function(t,e,i){"use strict";cc._RF.push(e,"83709TvPtJOVayPDGaPh6Ov","StepManager");(function(){function t(){this.totalStep=[],this.curStep=[]}t.prototype.register=function(t,e){this.completeCallback=t,this.totalStep=e},t.prototype.nextStep=function(t){this.totalStep.indexOf(t)<0?console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",t):this.curStep.indexOf(t)>=0?console.warn(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",t):(this.curStep.push(t),this.curStep.sort(function(t,e){return t>e?-1:1}),this.totalStep.sort(function(t,e){return t>e?-1:1}),console.log(" cur step:",this.curStep.join(",")),console.log(" total step:",this.totalStep.join(",")),this.curStep.join(",")==this.totalStep.join(",")&&(console.log(" step done"),this.totalStep.length=0,this.completeCallback(),this.completeCallback=null))}})();cc._RF.pop()},{}],Test:[function(t,e,i){"use strict";cc._RF.push(e,"5a43fKhvPtCNa/XTygKKeUt","Test"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../GamePlay/Command/GamePlaySignal"),n=cc._decorator,a=n.ccclass,s=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,function(){o.NextRoundSignal.inst.dispatch()},this)},e.prototype.start=function(){},e=__decorate([a],e)}(cc.Component));i.default=s,cc._RF.pop()},{"../GamePlay/Command/GamePlaySignal":"GamePlaySignal"}],ThemeView:[function(t,e,i){"use strict";cc._RF.push(e,"aefb6btN6dDsLbrbCsSRBfb","ThemeView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../View/BaseView"),n=t("../Command/InitSignal"),a=t("../../Global/Theme"),s=cc._decorator,r=s.ccclass,h=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},e.prototype.start=function(){},e.prototype.onThemeInit=function(t){for(var e=0,i=this.node.children;e<i.length;e++){var o=i[e];o.active=o.name==a.Theme[t]}},e=__decorate([r],e)}(o.default));i.default=h,cc._RF.pop()},{"../../Global/Theme":"Theme","../../View/BaseView":"BaseView","../Command/InitSignal":"InitSignal"}],Theme:[function(t,e,i){"use strict";cc._RF.push(e,"1eeb2LaYMZEfb4+fEga+UZy","Theme"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.Number=0]="Number",t[t.Sweet=1]="Sweet"}(i.Theme||(i.Theme={})),cc._RF.pop()},{}],Time:[function(t,e,i){"use strict";cc._RF.push(e,"87a24xcV95AoII6L5W1ABoI","Time"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.timeFormat=function(t){var e=Math.floor(t/60),i=Math.floor(t%60),o="00";return i<10&&(o="0"+i),e+"/"+o},t}();i.Time=o,cc._RF.pop()},{}],ToSingleton:[function(t,e,i){"use strict";cc._RF.push(e,"b07299nlSpOIIxOkIMBhUY9","ToSingleton"),Object.defineProperty(i,"__esModule",{value:!0}),i.SingleTon=function(){return function(){function t(){}return Object.defineProperty(t,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),t}()},cc._RF.pop()},{}],UpThemeView:[function(t,e,i){"use strict";cc._RF.push(e,"be1349NGflO6aWLqhbWgiHy","UpThemeView"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../View/BaseView"),n=t("../Command/InitSignal"),a=t("../../Global/Theme"),s=cc._decorator,r=s.ccclass,h=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){n.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},e.prototype.start=function(){},e.prototype.onThemeInit=function(t){for(var e=0,i=this.node.children;e<i.length;e++){var o=i[e];o.active=o.name==a.Theme[t]}},e=__decorate([r],e)}(o.default));i.default=h,cc._RF.pop()},{"../../Global/Theme":"Theme","../../View/BaseView":"BaseView","../Command/InitSignal":"InitSignal"}],UpdateController:[function(t,e,i){"use strict";cc._RF.push(e,"b3cadc9oLxMlaTWSqS0DgLW","UpdateController"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Utils/ToSingleton"),n=cc._decorator,a=n.ccclass,s=(n.property,function(t){function e(){var e=t.call(this)||this;return e.assetsManager=null,e.STORAGE_PATH=(window.jsb&&jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hot-update",e.MANIFEST_PAth="",e.isUpdating=!1,e.manifest=null,e.completeCallback=[],e.startCallback=[],e.errorCallback=[],e.progressCallback=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){window.jsb&&(this.assetsManager=new jsb.AssetsManager(this.MANIFEST_PAth,this.STORAGE_PATH,this.versionCompareHandle),this.assetsManager.setVerifyCallback(this.verifyCallback.bind(this)),cc.sys.os===cc.sys.OS_ANDROID&&this.assetsManager.setMaxConcurrentTask(2))},e.prototype.setManifest=function(t){this.manifest=t},e.prototype.getVersion=function(){return null==this.assetsManager?"":null==this.assetsManager.getLocalManifest()?"":this.assetsManager.getLocalManifest().getVersion()},e.prototype.addCompleteCallback=function(t,e){this.completeCallback.push({target:e,callback:t})},e.prototype.addErrorCallback=function(t,e){this.errorCallback.push({target:t,callback:e})},e.prototype.addStartCallback=function(t,e){this.startCallback.push({target:t,callback:e})},e.prototype.addProgressCallback=function(t,e){this.progressCallback.push({target:t,callback:e})},e.prototype.triggeError=function(t,e){void 0===e&&(e=!1),this.onError(t,e)},e.prototype.onError=function(t,e){void 0===e&&(e=!1),console.log(" this.errorCallback:",this.errorCallback.length,"error:",t);for(var i=0,o=this.errorCallback;i<o.length;i++){var n=o[i];n.callback.apply(n.target,[t,e])}},e.prototype.onComplete=function(t,e){void 0===e&&(e=!1),console.log(" on update complete:",this.getVersion()),console.log("storagePath:",this.getStoragePath()),console.log("search path:",this.getSearchPaths());for(var i=function(i){setTimeout(function(){i.callback.apply(i.target,[t,e])},0)},o=0,n=this.completeCallback;o<n.length;o++){i(n[o])}},e.prototype.getStoragePath=function(){return this.assetsManager?this.assetsManager.getStoragePath():""},e.prototype.getSearchPaths=function(){return window.jsb?jsb.fileUtils.getSearchPaths():""},e.prototype.onStart=function(t,e){void 0===e&&(e=!1),console.log(" this.startCallback:",this.startCallback.length);for(var i=0,o=this.startCallback;i<o.length;i++){var n=o[i];n.callback.apply(n.target,[t,e])}},e.prototype.onProgress=function(t,e){for(var i=0,o=this.progressCallback;i<o.length;i++){var n=o[i];n.callback.apply(n.target,[t,e])}},e.prototype.loadCustomManifest=function(t){if(null!=this.assetsManager&&this.assetsManager.getState()==jsb.AssetsManager.State.UNINITED){var e=new jsb.Manifest(t,this.STORAGE_PATH);this.assetsManager.loadLocalManifest(e,this.STORAGE_PATH)}},e.prototype.checkForUpdate=function(){if(null!=this.assetsManager){if(this.isUpdating)return"Version update is on process...";if(console.log(" start check for update ..."),this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var t=this.manifest.nativeUrl;console.log(" native url:",t),cc.loader.md5Pipe&&(t=cc.loader.md5Pipe.transformURL(t)),this.assetsManager.loadLocalManifest(t)}if(!this.assetsManager.getLocalManifest()||!this.assetsManager.getLocalManifest().isLoaded())return this.onError("Failed to load local manifest ..."),"Failed to load local manifest ...";this.assetsManager.setEventCallback(this.checkUpdateCallback.bind(this)),this.assetsManager.checkUpdate(),this.isUpdating=!0}else this.onComplete("no need to update.")},e.prototype.checkUpdateCallback=function(t){switch(console.log("checkUpdateCallback Code: "+t.getEventCode()),t.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:var e=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():" null",i=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null";this.onComplete("Already up to date with the latest remote version :"+e+", local version :"+i);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.isUpdating=!1;var o=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null",n=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():"null";if(console.log("New version found, old:",o,", new: ",n),"null"==o||"null"==n);else{console.log("storage path:",this.assetsManager.getStoragePath());var a=o.split(".")[0];n.split(".")[0]>a?this.onStart("new version found, go to store to download new app.",!0):(this.onStart("new version found, update process start.",!1),this.updateVersion())}break;default:return}},e.prototype.getUpdateDescription=function(){return""},e.prototype.updateVersion=function(){if(null!=this.assetsManager&&!this.isUpdating)if([jsb.AssetsManager.State.UPDATING,jsb.AssetsManager.State.UNZIPPING,jsb.AssetsManager.State.UP_TO_DATE].indexOf(this.assetsManager.getState())>=0)this.onComplete("no need to update: "+this.assetsManager.getState(),!1);else{if(this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var t=this.manifest.nativeUrl;cc.loader.md5Pipe&&(t=cc.loader.md5Pipe.transformURL(t)),this.assetsManager.loadLocalManifest(t)}this.assetsManager.setEventCallback(this.updateCallback.bind(this)),console.log(" start update ...:",this.assetsManager.getState()),this.assetsManager.update(),this.isUpdating=!0}},e.prototype.versionToInt=function(t){return parseInt(t.toString().split(".").join(""))},e.prototype.versionToString=function(t){return Math.floor(t/100)+"."+Math.floor(t/10)%10+"."+Math.floor(t)%10},e.prototype.updateCallback=function(t){var e=this,i=!1,o=!1,n=null;switch(console.log("update event code:",t.getEventCode()),t.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped."),o=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var a=t.getPercent();NaN!=a&&"number"==typeof a||(a=0),this.onProgress(t.getMessage()?"Updated file:"+t.getMessage():"Updating:"+(100*a).toFixed(0)+"%",a);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped."),o=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:n=function(){var t=e.assetsManager.getRemoteManifest()?e.assetsManager.getRemoteManifest().getVersion():" null";e.onComplete("Already up to date with the latest remote version :"+t)},o=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:n=function(){var i=e.assetsManager.getRemoteManifest()?e.assetsManager.getRemoteManifest().getVersion():" null";e.onComplete("Update finished. new : "+i+t.getMessage(),!0)},i=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.onError("Update failed. "+t.getMessage(),!0);break;case jsb.EventAssetsManager.ERROR_UPDATING:this.onError("Asset update error: "+t.getAssetId()+", "+t.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.onError(t.getMessage())}if(o&&(this.assetsManager.setEventCallback(null),this.isUpdating=!1),i){this.assetsManager.setEventCallback(null);var s=jsb.fileUtils.getSearchPaths();console.log("old searchPaths:",s);var r=this.assetsManager.getLocalManifest().getSearchPaths();console.log("new path:",JSON.stringify(r));for(var h=0,l=r;h<l.length;h++){var d=l[h];s.indexOf(d)<0&&Array.prototype.unshift.apply(s,d)}cc.sys.localStorage.setItem("select-game",JSON.stringify(s)),jsb.fileUtils.setSearchPaths(s),console.log("new searchPaths:",JSON.stringify(s)),console.log(" paths storage:",cc.sys.localStorage.getItem("select-game"))}n&&n()},e.prototype.restart=function(){cc.audioEngine.stopAll(),cc.game.restart()},e.prototype.retry=function(){null!=this.assetsManager&&0==this.isUpdating&&this.assetsManager.downloadFailedAssets()},e.prototype.versionCompareHandle=function(t,e){cc.log("JS Custom Version Compare: version A is "+t+", version B is "+e);for(var i=t.split("."),o=e.split("."),n=0;n<i.length;++n){var a=parseInt(i[n]),s=parseInt(o[n]||"0");if(a!==s)return a-s}return o.length>i.length?-1:0},e.prototype.verifyCallback=function(t,e){var i=e.compressed,o=e.md5,n=e.path;e.size;return i?("Verification passed : "+n,!0):("Verification passed : "+n+" ("+o+")",!0)},e.prototype.destory=function(){this.assetsManager&&this.assetsManager.setEventCallback(null),this.startCallback=[],this.completeCallback=[],this.errorCallback=[],this.progressCallback=[]},e=__decorate([a],e)}(o.SingleTon()));i.default=s,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}]},{},["App","GameFactory","GamePlaySignal","DominoSelector","GameStateController","ResourceController","PlayerModelProxy","DeskNodeModel","DominoModel","GamePlayModel","GameRule","RoundModel","DeskRootMediator","DeskRootView","DominoDeskTransform","DominoDeskTransformMediator","DominoNodePool","DominoTouchMediator","DominoTouchView","AICardRootMediator","AICardRootView","CardDrawRootMediator","CardDrawRootView","DominoRootMediator","DominoRootView","DominoStateMediator","DominoStateView","PlayerCardRootMediator","PlayerCardRootView","BoneyardView","CardBagView","NoviceScoreView","NumberChangedView","PlayerScoreView","RoundNumberView","Desk","FacadeGlobal","Level","Theme","InitSignal","InititalCommond","LoadAudioCommond","LoadPrefabCommond","StartGameCommond","InitialFacade","InitSceneView","LoadingPageMediator","LoadingView","ThemeView","UpThemeView","AudioManager","StepManager","UpdateController","CelerSDK","Cocos","FrameAniBase","HashMap","LogHandler","Random","Signal","Time","ToSingleton","BaseMediator","BaseView","SingleTouchMediator","Test"]);