window.__require=function e(t,o,n){function i(a,c){if(!o[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){return i(t[a][1][e]||e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({AdController:[function(e,t,o){"use strict";cc._RF.push(t,"bb578x+CdpD25LW0TzC7dbF","AdController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasBind=!1,t.finishCallback={},t.failedCallback={},t.adCount=0,t.msgMap={},t.musicVolume=0,t.effectVolume=0,t}return n(t,e),t.prototype.showAd=function(e,t,o){var n=this;0==this.hasBind&&this.bindCallback();var i=e+this.adCount;if(this.msgMap[i]=e,null==this.finishCallback[i]&&(this.finishCallback[i]=[]),this.finishCallback[i].push(t),null==this.failedCallback[i]&&(this.failedCallback[i]=[]),this.failedCallback[i].push(o),this.musicVolume=cc.audioEngine.getMusicVolume(),this.effectVolume=cc.audioEngine.getEffectsVolume(),CELER_X)celerSDK.showAd(i);else if(cc.director.getScene()&&cc.director.getScene().getChildByName("Canvas")){var r=cc.director.getScene().getChildByName("Canvas");if(r.getChildByName("adNode"))return;var a=new cc.Node("adNode"),c=a.addComponent(cc.VideoPlayer);c.remoteURL="https://vicat.wang/GameRes/catcatcat.mp4",r.width=1464,r.height=2400,r.addChild(a),a.setPosition(0,0),c.node.on("ready-to-play",function(){console.log("ready-to-play"),a.width=1080,a.height=1920,c.play()},this),c.node.on("meta-loaded",function(){console.log("meta-loaded")},this),c.node.on("clicked",function(){if(console.log("clicked"),a.pauseCount++,a.pauseCount>=5){for(var e=document.getElementsByClassName("cocosVideo"),t=0;t<e.length;t++){var o=e.item(t);o&&o.remove()}setTimeout(function(){a.removeFromParent(!0),n.onAddFaild(i)},0)}},this),c.node.on("playing",function(){console.log("playing")},this),a.pauseCount=0,c.node.on("paused",function(){if(console.log("paused"),a.pauseCount++,a.pauseCount>=5){for(var e=document.getElementsByClassName("cocosVideo"),t=0;t<e.length;t++){var o=e.item(t);o&&o.remove()}setTimeout(function(){a.removeFromParent(!0),n.onAddFaild(i)},0)}},this),c.node.on("stopped",function(){console.log("stopped")},this),c.node.on("completed",function(){console.log("completed"),c.stop();for(var e=document.getElementsByClassName("cocosVideo"),t=0;t<e.length;t++){var o=e.item(t);o&&o.remove()}setTimeout(function(){a.removeFromParent(!0),n.onAdFinish(i)},0)},this)}this.adCount++,console.log(" request ad:",i)},t.prototype.bindCallback=function(){this.hasBind=!0,CELER_X&&(celerSDK.onAdPlayFailed(this.onAddFaild.bind(this)),celerSDK.onAdPlayFinished(this.onAdFinish.bind(this)))},t.prototype.onAdFinish=function(e){if(this.finishCallback[e]){for(var t=0,o=this.finishCallback[e];t<o.length;t++){(0,o[t])(this.msgMap[e])}this.finishCallback[e]=null,this.failedCallback[e]=null,this.msgMap[e]=null}},t.prototype.onAddFaild=function(e){if(this.failedCallback[e]){for(var t=0,o=this.failedCallback[e];t<o.length;t++){(0,o[t])(this.msgMap[e])}this.failedCallback[e]=null,this.finishCallback[e]=null,this.msgMap[e]=null}},t}(e("../Utils/ToSingleton").SingleTon());o.AdController=i,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}],AdLayer:[function(e,t,o){"use strict";cc._RF.push(t,"307927KUuNLzLjVxgXVWIGs","AdLayer");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Ad/FlyCnicornAd"),a=e("./controller/AdController"),c=e("./table"),s=e("./Utils/GameStateController"),l=e("./Utils/Signal"),u=e("./WildAdButton"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(l.BaseSignal);o.AdWatchFinishSignal=h;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(l.BaseSignal);o.HideSubmitLayerSignal=p;var d,f=cc._decorator,g=f.ccclass,b=f.property,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(l.BaseSignal);o.AdFinishSignal=y,function(e){e[e.Time=0]="Time",e[e.Horce=1]="Horce"}(d||(d={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AdAtlas=null,t}return n(t,e),Object.defineProperty(t.prototype,"Panel",{get:function(){return this.node.getChildByName("NormalPanel")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WatchAd",{get:function(){return this.Panel.getChildByName("btn_adv_yes")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BackToGame",{get:function(){return this.Panel.getChildByName("btn_back")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content",{get:function(){return this.Panel.getChildByName("Content").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.Panel.getChildByName("font_title_freewild").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FailTip",{get:function(){return this.node.getChildByName("FailTip")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FailTipLabel",{get:function(){return this.FailTip.getChildByName("Label").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.node.active=!1,this.node.scale=1,u.WildAdButtonClick.inst.addListener(function(){e.Show()},this),r.FlyCnicornClickSignal.inst.addListener(function(){e.Show()},this),this.BackToGame.on(cc.Node.EventType.TOUCH_END,function(){setTimeout(function(){e.node.active=!1,s.GameStateController.inst.resume()},0)},this)},t.prototype.onAdFinish=function(e){var t=this;y.inst.dispatchOne(e),setTimeout(function(){e==d[d.Horce]&&(CELER_X&&u.HideWildAdButtonSignal.inst.dispatch(),h.inst.dispatch())},10),setTimeout(function(){t.Hide()},0)},t.prototype.onAdFailed=function(e){var t=this;this.FailTip.active=!0,this.Panel.active=!1,d[d.Time],setTimeout(function(){t.Hide()},2e3)},t.prototype.Hide=function(){0!=this.node.active&&(this.node.active=!1,s.GameStateController.inst.resume())},t.prototype.Show=function(){var e=this;1!=this.node.active&&(this.node.active=!0,this.FailTip.active=!1,this.Panel.active=!0,this.WatchAd.active=!0,this.Content.string=lan.t(c.En_View.GuangGaoJieMian,c.En_ID.XiaoMaQiuJiangLi),this.FailTipLabel.string=lan.t(c.En_View.GuangGaoJieMian,c.En_ID.KanGuangGaoShiBai),s.GameStateController.inst.pause(!0),this.WatchAd.targetOff(this),this.WatchAd.once(cc.Node.EventType.TOUCH_END,function(){setTimeout(function(){e.WatchAd.active=!1},0),a.AdController.inst.showAd(d[d.Horce],function(t){console.log(" watch ad success:",t),e.onAdFinish(t)},function(t){console.log(" watch ad fail:",t),e.onAdFailed(t)})},this))},i([b(cc.SpriteAtlas)],t.prototype,"AdAtlas",void 0),t=i([g],t)}(cc.Component);o.default=m,cc._RF.pop()},{"./Ad/FlyCnicornAd":"FlyCnicornAd","./Utils/GameStateController":"GameStateController","./Utils/Signal":"Signal","./WildAdButton":"WildAdButton","./controller/AdController":"AdController","./table":"table"}],AudioController:[function(e,t,o){"use strict";cc._RF.push(t,"c3611jDu5hL7auVf9iIBCz5","AudioController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=e("./EventManager"),r=e("./EventName"),a="sounds/";window.oncanplay&&(window.oncanplay=function(){c.canPlay=!0});var c=function(){function e(){this.audioID={},this.clips=new n.HashMap}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){console.log(" start load AudioClip ");var t=this;cc.loader.loadResDir(a,cc.AudioClip,function(o,n,i){if(o)console.error(o);else{for(var r=0,a=n;r<a.length;r++){var c=a[r];"string"==typeof c._audio&&cc.loader._cache&&cc.loader._cache[c._audio]&&cc.loader._cache[c._audio].buffer&&(c._audio=cc.loader._cache[c._audio].buffer),t.clips.add(c.name,c)}t.initEvent(),e&&e()}})},e.prototype.initEvent=function(){var e=this;i.gEventMgr.targetOff(this),this.playMusic("bgm"),i.gEventMgr.on(r.GlobalEvent.CHANGE_BGM,function(t){e.playMusic(t)},this),i.gEventMgr.on(r.GlobalEvent.PLAY_EFFECT,function(t){e.playEffect(t)},this)},e.prototype.playEffect=function(t,o){var n=this;if(void 0===o&&(o=!1),e.canPlay){if(!(cc.audioEngine.getEffectsVolume()<=.05)){var i=this.clips.get(t);i?this.audioID[t]=cc.audioEngine.playEffect(i,o):cc.loader.loadRes(a+t,cc.AudioClip,function(e,i){e?console.error(e):("string"==typeof i._audio&&cc.loader._cache&&cc.loader._cache[i._audio]&&cc.loader._cache[i._audio].buffer&&(i._audio=cc.loader._cache[i._audio].buffer),n.clips.add(i.name,i),n.audioID[t]=cc.audioEngine.playEffect(i,o))})}}else this.bindTouch()},e.prototype.playMusic=function(t,o){var n=this;if(void 0===o&&(o=!0),!e.canPlay)return this.bindTouch(),void e.PlayedList.push({loop:!0,volume:1,clipName:t,supTime:Date.now(),skip:!1,isBgm:!0});var i=this.clips.get(t);i?cc.audioEngine.playMusic(i,o):cc.loader.loadRes(a+t,cc.AudioClip,function(e,t){e?console.error(e):("string"==typeof t._audio&&cc.loader._cache&&cc.loader._cache[t._audio]&&cc.loader._cache[t._audio].buffer&&(t._audio=cc.loader._cache[t._audio].buffer),n.clips.add(t.name,t),cc.audioEngine.playMusic(t,o))})},e.prototype.bindTouch=function(){if(!e.hasBindTouch){var t=this,o=function(){var n;for(cc.game.canvas.removeEventListener("touchstart",o),e.canPlay=!0;(n=e.PlayedList.pop())&&t.clips.get(n.clipName)&&!n.skip;)cc.audioEngine.playMusic(t.clips.get(n.clipName),n.loop)};e.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",o)}},e.PlayedList=[],e.canPlay=!1,e.hasBindTouch=!1,e}();o.gAudio=c.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap","./EventManager":"EventManager","./EventName":"EventName"}],BaseMediator:[function(e,t,o){"use strict";cc._RF.push(t,"c720aebeYBBlpQjoG9tyivo","BaseMediator");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){console.error(" should override onRegister ")},t.prototype.onUnregister=function(){console.error(" should override onUnregister ")},t=i([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"865936i9StEfIaOCaqqjKDb","BaseView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.scale=0},t.prototype.Show=function(e){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()})))},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.active=!1,e&&e()})))},t.prototype.OnClick=function(){},t.prototype.BindMedaitor=function(e){if(!this.node.getComponent(e)){var t=this.node.addComponent(e);return t.bind&&t.bind(this),t.onRegister&&t.onRegister(),t}console.warn(" this node already has the same component..")},t.prototype.UnbindMedaitor=function(e){var t=this.node.getComponent(e);if(t)return t.onUnregister&&t.onUnregister(),t.bind&&t.bind(null),this.node.removeComponent(e),t;console.warn(" component already removed..")},t=i([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],BubbleMatrix:[function(e,t,o){"use strict";cc._RF.push(t,"3fc87k3ArdNNIwVYgSiAJGh","BubbleMatrix"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Const"),i=e("../Controller/Game");o.MatrixSize=14,o.UseSize=10;var r;(function(e){e[e.Normal=0]="Normal",e[e.Double=1]="Double",e[e.Boom=2]="Boom",e[e.Magic=3]="Magic",e[e.Horce=4]="Horce"})(r=o.SpecialType||(o.SpecialType={}));var a=function(){function e(){this.matrixData=[],this.addRowTotalCount=0,this.firstRow=0;for(var e=0;e<o.MatrixSize*o.MatrixSize;e++)this.matrixData[e]={color:n.BubbleType.Blank,bubble:null,type:r.Normal}}return Object.defineProperty(e.prototype,"data",{get:function(){return this.matrixData},enumerable:!0,configurable:!0}),e.prototype.addRow=function(e){var t=this.matrixData.length;this.matrixData.length+=e*o.MatrixSize;for(var i=t;i<this.matrixData.length;i++)this.matrixData[i]={color:n.BubbleType.Blank,bubble:null,type:r.Normal}},e.prototype.getRestRowCount=function(){return this.addRowTotalCount},e.prototype.getFirstRow=function(){return this.firstRow},e.prototype.moveRow=function(e){if(this.addRowTotalCount<=e){this.addRow(6),this.firstRow+=5,i.Game.startIndex+=5*o.MatrixSize,this.addRowTotalCount+=6;var t=6*o.MatrixSize;console.log(" \u65b0\u589e6\u884c\uff1a ",t,", total length:",this.data.length);for(var a=this.matrixData.length-1;a>=t;a--)this.matrixData[a-t]||(this.matrixData[a-t]={color:n.BubbleType.Blank,bubble:null,type:r.Normal}),this.matrixData[a].color=this.matrixData[a-t].color,this.matrixData[a].type=this.matrixData[a-t].type,this.matrixData[a].bubble=this.matrixData[a-t].bubble,this.matrixData[a-t]={color:n.BubbleType.Blank,bubble:null,type:r.Normal},this.matrixData[a].bubble&&this.matrixData[a].bubble.setIndex(a);var c=Math.ceil(CMath.getRandom(n.DoubleBubbleRange.Min,n.DoubleBubbleRange.Max)),s=Math.ceil(CMath.getRandom(n.BoomBubbleRange.Min,n.BoomBubbleRange.Max)),l=Math.ceil(CMath.getRandom(n.MagicBubbleRange.Min,n.MagicBubbleRange.Max));console.log(" double:",c,", boom:",s,", magic:",l);var u=[];for(a=0;a<=t-1;a++)this.index2j(a)>=2&&this.index2j(a)<=11&&u.push(a);for(var h=n.BubbleColors.concat(),p={};c>0&&h.length>0&&u.length>=0;){var d=u[v=Math.floor(CMath.getRandom(0,u.length))];u.splice(v,1);var f=h[y=Math.floor(CMath.getRandom(0,h.length))];h.splice(y,1),p[d]=f,c--}console.log(" ---------- \u53cc\u500d\u7403 --------------"),console.log(p);for(var g=n.BubbleColors.concat(),b={};s>0&&g.length>0&&u.length>=0;){d=u[v=Math.floor(CMath.getRandom(0,u.length))];u.splice(v,1);var y;f=g[y=Math.floor(CMath.getRandom(0,g.length))];g.splice(y,1),b[d]=f,s--}console.log(" ---------- \u70b8\u5f39\u7403 --------------"),console.log(b);for(var m={};l>0&&u.length>=0;){var v;d=u[v=Math.floor(CMath.getRandom(0,u.length))];u.splice(v,1),m[d]=n.BubbleType.Blank,l--}console.log(" ---------- \u9b54\u6cd5\u7403 --------------"),console.log(m);for(a=0;a<t-1;a++)this.matrixData[a].color=n.BubbleColors[Math.floor(CMath.getRandom()*n.BubbleColors.length)],this.matrixData[a].bubble=null,this.matrixData[a].type=r.Normal,null!=p[a]&&(this.matrixData[a].type=r.Double,this.matrixData[a].color=p[a]),null!=m[a]&&(this.matrixData[a].type=r.Magic,this.matrixData[a].color=m[a]),null!=b[a]&&(this.matrixData[a].type=r.Boom,this.matrixData[a].color=b[a])}else this.firstRow-=1,i.Game.startIndex-=o.MatrixSize;this.addRowTotalCount-=e,console.log(" \u5269\u4f59 ",this.addRowTotalCount," \u884c\u6570\u636e",", \u7b2c\u4e00\u884c\uff1a",this.firstRow,this.index2i(i.Game.startIndex))},e.prototype.ij2index=function(e,t){return e*o.MatrixSize+t},e.prototype.index2i=function(e){return Math.floor(e/o.MatrixSize)},e.prototype.index2j=function(e){return e%o.MatrixSize},e.prototype.getUseIndexStart=function(){return(o.MatrixSize-o.UseSize)/2*(o.MatrixSize+1)-1},e.prototype.getUseIndexEnd=function(){return o.MatrixSize*o.MatrixSize-this.getUseIndexStart()-1},e.prototype.getPosOfIndex=function(e){var t=this.index2i(e),o=this.index2j(e);return this.getPosOfij(t,o)},e.prototype.getPosOfij=function(e,t){var r=cc.v2(0,0);return r.x=(t-o.MatrixSize/2)*n.BubbleSize.width+(e+this.firstRow+i.Game.getMoveTimes())%2*n.BubbleSize.width/2+n.BubbleXOffset,r.y=(o.MatrixSize/2-e+i.Game.getMoveTimes()+this.firstRow-this.index2i(58))*(n.BubbleSize.height+n.BubbleHeightOffset)+n.BubbleYOffset,r},e.prototype.getNeiborMatrix=function(e,t,n){void 0===n&&(n=!1);for(var r=[],a=this.index2i(e),c=i.Game.getMoveTimes()+this.firstRow,s=0;s<=t;s++){var l=a+s,u=a%2==l%2,h=t-Math.floor(s/2);h=Math.min(h,t);for(var p=0;p<=h;p++){var d,f=e+s*o.MatrixSize+p,g=e-s*o.MatrixSize+p,b=e+s*o.MatrixSize-p,y=e-s*o.MatrixSize-p;if(e!=f&&r.indexOf(f)<0&&f>=0&&(f<this.matrixData.length||n))if(u||(l+c)%2==0||p<h)(d=this.index2j(f))>=2&&d<=11&&f>=i.Game.startIndex&&(this.data[f]&&this.data[f].bubble&&!n?r.push(f):!n||this.data[f]&&this.data[f].bubble||r.push(f));if(e!=g&&r.indexOf(g)<0&&g>=0&&(g<this.matrixData.length||n))(d=this.index2j(g))>=2&&d<=11&&g>=i.Game.startIndex&&(u||(l+c)%2==0||p<h)&&(this.data[g]&&this.data[g].bubble&&!n?r.push(g):!n||this.data[g]&&this.data[g].bubble||r.push(g));if(e!=b&&r.indexOf(b)<0&&b>=0&&(b<this.matrixData.length||n))(d=this.index2j(b))>=2&&d<=11&&b>=i.Game.startIndex&&(u||(l+c)%2||p<h)&&(this.data[b]&&this.data[b].bubble&&!n?r.push(b):!n||this.data[b]&&this.data[b].bubble||r.push(b));if(e!=y&&r.indexOf(y)<0&&y>=0&&(y<this.matrixData.length||n))(d=this.index2j(y))>=2&&d<=11&&y>=i.Game.startIndex&&(u||(l+c)%2||p<h)&&(this.data[y]&&this.data[y].bubble&&!n?r.push(y):!n||this.data[y]&&this.data[y].bubble||r.push(y))}}return r.sort(function(e,t){return e-t}),r},e.prototype.initBubbleData=function(){console.log(" init bubble data :",i.Game.MatchInfo.matchId,", seed:",i.Game.MatchInfo.sharedRandomSeed);var e=this.getUseIndexStart(),t=this.getUseIndexEnd();this.firstRow=this.index2i(i.Game.startIndex),this.addRowTotalCount=0;var o=Math.ceil(CMath.getRandom(n.DoubleBubbleInitRange.Min,n.DoubleBubbleInitRange.Max)),a=Math.ceil(CMath.getRandom(n.BoomBubbleInitRange.Min,n.BoomBubbleInitRange.Max)),c=Math.ceil(CMath.getRandom(n.MagicBubbleInitRange.Min,n.MagicBubbleInitRange.Max));console.log("start:",e,", end:",t,", firstRow:",this.firstRow),console.log(" double:",o,", boom:",a,", magic:",c);for(var s=[],l=i.Game.startIndex;l<=t;l++)this.index2j(l)>=2&&this.index2j(l)<=11&&s.push(l);for(var u=n.BubbleColors.concat(),h={};o>0&&s.length>=0;){var p=s[m=Math.floor(CMath.getRandom(0,s.length))];s.splice(m,1);var d=u[b=Math.floor(CMath.getRandom(0,u.length))];u.splice(b,1),h[p]=d,o--,u.length<=0&&(u=n.BubbleColors.concat())}console.log(" ---------- \u53cc\u500d\u7403 --------------"),console.log(h);for(var f=n.BubbleColors.concat(),g={};a>0&&s.length>=0;){p=s[m=Math.floor(CMath.getRandom(0,s.length))];s.splice(m,1);var b;d=f[b=Math.floor(CMath.getRandom(0,f.length))];f.splice(b,1),g[p]=d,a--,f.length<=0&&(f=n.BubbleColors.concat())}console.log(" ---------- \u70b8\u5f39\u7403 --------------"),console.log(g);for(var y={};c>0&&s.length>=0;){var m;p=s[m=Math.floor(CMath.getRandom(0,s.length))];s.splice(m,1),y[p]=n.BubbleType.Blank,c--}console.log(" ---------- \u9b54\u6cd5\u7403 --------------"),console.log(y);for(l=e;l<=t;l++){for(var v=this.getNeiborMatrix(l,1),_=[],S=0,C=v;S<C.length;S++){var M=C[S];this.matrixData[M].color!=n.BubbleType.Blank&&_.push(this.matrixData[M])}var T=this.getOtherColors(_);CMath.getRandom()<=.8&&T.length>0?this.matrixData[l].color=T[Math.floor(CMath.getRandom()*T.length)]:this.matrixData[l].color=n.BubbleColors[Math.floor(CMath.getRandom()*n.BubbleColors.length)];for(var B=0;B<v.length;B++){M=v[B];if(this.matrixData[M].color==n.BubbleType.Blank)if(CMath.getRandom()<=.8)this.matrixData[M]=this.matrixData[l];else{var E=this.getOtherColors([this.matrixData[l].color]);this.matrixData[M].color=E[Math.floor(CMath.getRandom()*E.length)]}for(var F=this.getNeiborMatrix(M,1),x=0;x<F.length;x++){var R=F[x];if(this.matrixData[R].color==n.BubbleType.Blank)if(CMath.getRandom()<=.8-.7&&this.matrixData[M]==this.matrixData[l])this.matrixData[R]=this.matrixData[M];else{var O=this.getOtherColors([this.matrixData[l].color,this.matrixData[M].color]);this.matrixData[R].color=O[Math.floor(CMath.getRandom()*O.length)]}}}}for(l=0;l<this.matrixData.length;l++)this.matrixData[l].color==n.BubbleType.Blank&&(this.matrixData[l].color=n.BubbleColors[Math.floor(CMath.getRandom()*n.BubbleColors.length)]),this.matrixData[l].type=r.Normal,null!=h[l]&&(this.matrixData[l].type=r.Double,this.matrixData[l].color=h[l]),null!=y[l]&&(this.matrixData[l].type=r.Magic,this.matrixData[l].color=y[l]),null!=g[l]&&(this.matrixData[l].type=r.Boom,this.matrixData[l].color=g[l])},e.prototype.getOtherColors=function(e){for(var t=n.BubbleColors.concat(),o=0,i=e;o<i.length;o++){var r=i[o],a=t.indexOf(r);a<0||t.splice(a,1)}return t},e}();o.BubbleMatrix=a,cc._RF.pop()},{"../Const":"Const","../Controller/Game":"Game"}],BubbleMove:[function(e,t,o){"use strict";cc._RF.push(t,"f122cLSg0BF5pRoYWwgPS74","BubbleMove");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Bubble"),a=e("./Controller/EventManager"),c=e("./Controller/EventName"),s=e("./Controller/Game"),l=e("./Const"),u=e("./Controller/GameFactory"),h=e("./Data/BubbleMatrix"),p=cc._decorator,d=p.ccclass;p.property;o.BorderX=455;o.DropBorder=-688,o.CollsionFactor=.3,o.CollsionOffset=40,o.CollsionMinFactor=.01;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=cc.v2(0,0),t.acceleration=cc.v2(0,0),t.hasCollision=!1,t.shooted=!1,t.isDrop=!1,t.animationCallback={},t}return n(t,e),Object.defineProperty(t.prototype,"Animation",{get:function(){return this.getComponent(cc.Animation)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bubble",{get:function(){return this.getComponent(r.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radis",{get:function(){return l.BubbleSize.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isShooterState",{get:function(){return"Shooter"==this.node.getParent().name&&this.node.getNumberOfRunningActions()<=0&&!this.hasCollision&&this.shooted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady2Shoot",{get:function(){return"Shooter"==this.node.getParent().name&&this.node.getNumberOfRunningActions()<=0},enumerable:!0,configurable:!0}),t.prototype.checkBorder=function(){this.isDrop||(this.node.x<=-o.BorderX||this.node.x>=o.BorderX)&&(this.node.x=this.node.x>0?o.BorderX:-o.BorderX,this.speed.x=-this.speed.x,this.acceleration.x=-this.acceleration.x)},t.prototype.forceMove=function(e){var t=this.node.getActionByTag(r.BubbleAction.Collision);if(!t||t.isDone()){var o=cc.sequence(cc.moveBy(.1,e).easing(cc.easeQuadraticActionIn()),cc.moveBy(.1,e.mul(-1)).easing(cc.easeQuadraticActionOut()));o.setTag(r.BubbleAction.Collision),this.node.runAction(o)}},t.prototype.checkCollisionBubble=function(){var e=this;if(this.isShooterState&&!this.isDrop)for(var t=s.Game.getCollisionIndexes(),o=s.Game.getMatrix(),n=function(t){var n=o.data[t].bubble;n||console.warn(" bubble \u4e0d\u5b58\u5728\uff01");var r=CMath.ConvertToNodeSpaceAR(i.node,n.node.parent);if(CMath.Distance(r,n.node.position)<=2*i.radis*.8){var l=o.getNeiborMatrix(t,1,!0),u=-1,p=100;console.log("\u78b0\u5230\uff1a",t),console.log(l);for(var d=0,f=l;d<f.length;d++){var g=f[d],b=o.index2i(g),y=o.index2j(g),m=o.getPosOfij(b,y);CMath.Distance(m,r)<p&&(p=CMath.Distance(m,r),u=g)}return i.bubble.Type==h.SpecialType.Magic?n.Type!=h.SpecialType.Magic&&n.node.active&&(i.bubble.setColor(n.Color,h.SpecialType.Normal),a.gEventMgr.emit(c.GlobalEvent.PLAY_EFFECT,"change_color"),i.bubble.playAnimation("bubble_change")):n.Type==h.SpecialType.Magic&&n.node.active&&i.bubble.Type!=h.SpecialType.Horce&&(n.setColor(i.bubble.Color,h.SpecialType.Normal),n.playAnimation("bubble_change"),a.gEventMgr.emit(c.GlobalEvent.PLAY_EFFECT,"change_color")),n.onCollision(),a.gEventMgr.emit(c.GlobalEvent.BUBBLE_FORCE,u),u<0?console.error(" target index -1"):i.onCollision(u,function(){s.Game.checkClear(e.bubble.getIndex(),e.bubble,n),s.Game.updateCollisionIndexes(),a.gEventMgr.emit(c.GlobalEvent.NEXT_BUBBLE)}),{value:void 0}}},i=this,r=0,l=t;r<l.length;r++){var u=n(l[r]);if("object"==typeof u)return u.value}},t.prototype.onCollision=function(e,t){console.log(" on collision:",e);var o=Math.abs(this.speed.x/this.speed.y),n=0==o||isNaN(o)?1.2:1/o,i=1/n;this.speed.x=0,this.speed.y=0,this.acceleration.x=0,this.acceleration.y=0,this.hasCollision=!0;var r=s.Game.getMatrix(),a=r.index2i(e),c=r.index2j(e),l=r.getPosOfij(a,c),u=CMath.ConvertToNodeSpaceAR(this.node,s.Game.BubbleLayer);this.node.x=u.x,this.node.y=u.y,this.node.setParent(s.Game.BubbleLayer),this.node.stopAllActions(),this.scaleBubble(n,i),this.bubble.setIndex(e),this.node.runAction(cc.sequence(cc.moveTo(.1,l),cc.callFunc(function(){t&&t(),s.Game.checkOutOfMove()},this)))},t.prototype.scaleBubble=function(e,t){e=CMath.Clamp(e,1.2,.8),t=CMath.Clamp(t,1.2,.8),this.node.runAction(cc.sequence(cc.scaleTo(.1,e,t),cc.scaleTo(.1,1,1)))},t.prototype.initEvent=function(){a.gEventMgr.targetOff(this),a.gEventMgr.on(c.GlobalEvent.BUBBLE_FORCE,this.force,this),this.Animation.on(cc.Animation.EventType.FINISHED,this.onAnimationComplete,this)},t.prototype.readyToShoot=function(){a.gEventMgr.once(c.GlobalEvent.SHOOT,this.shoot,this)},t.prototype.force=function(e){var t=this.bubble.getIndex();if(t!=e){var n=s.Game.getMatrix(),i=n.getPosOfIndex(e),r=n.getPosOfIndex(t),a=CMath.Distance(i,r),c=Math.ceil(a/(2*this.radis)),l=Math.pow(o.CollsionFactor,Math.max(0,c-1));this.forceMove(r.sub(i).normalize().mul(l*o.CollsionOffset))}},t.prototype.reuse=function(){this.initEvent(),this.hasCollision=!1,this.isDrop=!1,this.speed=cc.v2(0,0),this.acceleration=cc.v2(0,0),this.shooted=!1,this.node.group="default"},t.prototype.unuse=function(){this.enabled=!1,this.shooted=!1,this.isDrop=!1,a.gEventMgr.targetOff(this)},t.prototype.shoot=function(e){console.log("\u53d1\u5c04\uff01"),a.gEventMgr.emit(c.GlobalEvent.PLAY_EFFECT,"shoot"),this.enabled=!0,this.shooted=!0,e.normalizeSelf(),this.speed.x=4800*e.x,this.speed.y=4800*e.y,this.acceleration.x=800*e.x,this.acceleration.y=800*e.y},t.prototype.drop=function(){this.isDrop=!0,this.enabled=!0,this.speed.y=800+CMath.getRandom(0,1e3),this.acceleration.y=4*-this.speed.y,this.speed.x=this.node.x>0?-200:200,this.speed.x*=CMath.getRandom(0,1.5)+1,this.node.group="drop",s.Game.addBubbleDrop(this.bubble.Color),console.log(" \u6389\u843d:",this.enabled,this.bubble.getIndex(),this.speed,this.acceleration,this.hasCollision)},t.prototype.update=function(e){var t=this;if(this.isShooterState||this.isDrop){for(var n=0;n<10;n++){this.checkBorder(),this.checkCollisionBubble(),this.node.x+=this.speed.x*e/10,this.node.y+=this.speed.y*e/10,this.speed.x+=this.acceleration.x*e/10,this.speed.y+=this.acceleration.y*e/10;var i=CMath.ConvertToNodeSpaceAR(this.node,this.node.getParent().getParent());if(this.isDrop&&i.y<=o.DropBorder){this.enabled=!1,this.scaleBubble(1.1,.9),a.gEventMgr.emit(c.GlobalEvent.PLAY_EFFECT,"drop");var h=this.bubble.DoubleScore?2*r.BubbleDropScore:r.BubbleDropScore;s.Game.addScore(this.bubble.Color,h,1,CMath.ConvertToNodeSpaceAR(this.node,s.Game.TopNode).add(cc.v2(.5*l.BubbleSize.width,.5*l.BubbleSize.height))),this.playAnimation("bubble_drop",function(){u.gFactory.putBubble(t.node)});break}}"Shooter"==this.node.parent.name&&(Math.abs(this.node.x)>=600||this.node.y>1663||this.node.y<0)&&(u.gFactory.putBubble(this.node),this.enabled=!1,console.error("  error , not collision! bubble lost "),a.gEventMgr.emit(c.GlobalEvent.NEXT_BUBBLE))}},t.prototype.playAnimation=function(e,t){this.animationCallback[e]=t,this.Animation.playAdditive(e)},t.prototype.onAnimationComplete=function(e,t){t&&this.animationCallback[t.name]&&(this.animationCallback[t.name](),this.animationCallback[t.name]=null)},t=i([d],t)}(cc.Component);o.default=f,cc._RF.pop()},{"./Bubble":"Bubble","./Const":"Const","./Controller/EventManager":"EventManager","./Controller/EventName":"EventName","./Controller/Game":"Game","./Controller/GameFactory":"GameFactory","./Data/BubbleMatrix":"BubbleMatrix"}],Bubble:[function(e,t,o){"use strict";cc._RF.push(t,"ab9ae70D2ZFXoGg9F2uKBO0","Bubble");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=e("./Controller/EventManager"),c=e("./Controller/Game"),s=e("./Controller/EventName"),l=e("./Const"),u=e("./BubbleMove"),h=e("./Controller/GameFactory"),p=e("./Data/BubbleMatrix");o.BubbleDropScore=10,o.BubbleScoreStep=10,function(e){e[e.Bubble=0]="Bubble",e[e.Collision=1]="Collision"}(r=o.BubbleAction||(o.BubbleAction={}));var d=cc._decorator,f=d.ccclass,g=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=-1,t.color=l.BubbleType.Blank,t.type=p.SpecialType.Normal,t.animationCallback={},t.spriteAtlas=null,t.doubleScore=!1,t}return n(t,e),Object.defineProperty(t.prototype,"Animation",{get:function(){return this.getComponent(cc.Animation)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprite",{get:function(){return this.node.getChildByName("Bubble").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"move",{get:function(){return this.getComponent(u.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IndexLabel",{get:function(){return this.node.getChildByName("Index").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Double",{get:function(){return this.node.getChildByName("Bubble").getChildByName("Double")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDouble",{get:function(){return this.type==p.SpecialType.Double},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DoubleScore",{get:function(){return this.doubleScore},set:function(e){this.doubleScore=e},enumerable:!0,configurable:!0}),t.prototype.reuse=function(){this.node.active=!1,this.node.scale=0,this.type=arguments[0][0],this.color=arguments[0][2],this.spriteAtlas=arguments[0][3],this.sprite.node.opacity=255,this.Double.active=this.type==p.SpecialType.Double,this.doubleScore=!1,this.setIndex(arguments[0][1]),this.updateSprite(),this.initEvent(),this.IndexLabel.node.active=!1},t.prototype.unuse=function(){a.gEventMgr.targetOff(this),this.index=-1,this.IndexLabel.string="",this.node.stopAllActions(),this.Animation.targetOff(this),this.node.targetOff(this),this.node.active=!1},t.prototype.setColor=function(e,t){this.color!=e?(this.color=e,this.type=t):console.warn(" color:",l.BubbleType[this.color],l.BubbleType[e])},t.prototype.updateSprite=function(e){switch(void 0===e&&(e=!1),this.type){case p.SpecialType.Normal:case p.SpecialType.Double:this.sprite.spriteFrame=e?this.spriteAtlas.getSpriteFrame(l.BubbleLightColor[this.Color]):this.spriteAtlas.getSpriteFrame(l.BubbleColor[this.Color]);break;case p.SpecialType.Boom:this.sprite.spriteFrame=e?this.spriteAtlas.getSpriteFrame(l.BoomBubbleLightColor[this.Color]):this.spriteAtlas.getSpriteFrame(l.BoomBubbleColor[this.Color]);break;case p.SpecialType.Horce:this.sprite.spriteFrame=e?this.spriteAtlas.getSpriteFrame(l.HorseBubbleLight):this.spriteAtlas.getSpriteFrame(l.HorseBubble);break;case p.SpecialType.Magic:this.sprite.spriteFrame=e?this.spriteAtlas.getSpriteFrame(l.MagicBubbleLight):this.spriteAtlas.getSpriteFrame(l.MagicBubble)}},t.prototype.setIndex=function(e){if(e!=this.index){var t=c.Game.getMatrix();t.data[e]&&t.data[e].bubble?t.data[e].bubble!=this&&(console.error(this.index,"\u6570\u636e\u4e0d\u540c\u6b65\uff01",e,", oldIndex:",t.data[e].bubble.getIndex()),console.log(t.data[e])):t.data[e]={color:this.color,bubble:this,type:this.type},this.index=e}},t.prototype.updateIndex=function(){this.IndexLabel.string=this.index.toString()},t.prototype.getIndex=function(){return this.index},t.prototype.setActive=function(e,t,o){this.node.active!=e&&(this.node.active=e,this.node.active||(this.node.scale=0),this.node.active&&t&&this.bubbleScale(o))},t.prototype.initEvent=function(){a.gEventMgr.on(s.GlobalEvent.BUBBLE_SCALE_TEST,this.scaleTest,this),this.Animation.on(cc.Animation.EventType.FINISHED,this.onAnimationComplete,this),a.gEventMgr.on(s.GlobalEvent.UPDATE_INDEX,this.updateIndex,this),this.node._onSetParent=this.onSetParent.bind(this)},t.prototype.updateActive=function(e){void 0===e&&(e=0),this.setActive(this.node.y<this.node.parent.height,!0,e)},t.prototype.scaleTest=function(e){e.indexOf(this.index)<0||this.bubbleScale()},t.prototype.bubbleScale=function(e){void 0===e&&(e=0);var t=cc.sequence(cc.scaleTo(0,0),cc.delayTime(e),cc.scaleTo(.2,.9),cc.scaleTo(.1,1.1),cc.scaleTo(.1,1));t.setTag(r.Bubble),this.node.stopActionByTag(r.Bubble),this.node.runAction(t)},t.prototype.onSetParent=function(e){e&&(this.move.enabled="Shooter"==e.name)},t.prototype.onCollision=function(){a.gEventMgr.emit(s.GlobalEvent.PLAY_EFFECT,"colision")},t.prototype.onClear=function(e,t){var n=this;c.Game.addBubbleClear(this.Color),a.gEventMgr.emit(s.GlobalEvent.PLAY_EFFECT,this.type==p.SpecialType.Boom?"boom":"clear"),this.node.runAction(cc.sequence(cc.delayTime(.7*e),cc.callFunc(function(){var e=c.Game.getMatrix().index2i(n.index),i=c.Game.getMatrix().index2j(n.index),r=c.Game.getMatrix().index2i(t),a=c.Game.getMatrix().index2j(t),s=Math.max(Math.abs(e-r)+1,Math.abs(i-a)+1),u=Math.max(1,s)*o.BubbleScoreStep;n.DoubleScore&&(u*=2);var d=.1*s+1;c.Game.addScore(n.color,u,d,CMath.ConvertToNodeSpaceAR(n.node,c.Game.TopNode).add(cc.v2(.5*l.BubbleSize.width,.5*l.BubbleSize.height))),n.updateSprite(!0);var f=n.type==p.SpecialType.Boom?"bubble_boom":"bubble_disappear";n.playAnimation(f,function(){h.gFactory.putBubble(n.node)})},this)))},t.prototype.playAnimation=function(e,t){this.animationCallback[e]=t,this.Animation.playAdditive(e)},t.prototype.onAnimationComplete=function(e,t){t&&this.animationCallback[t.name]&&(this.animationCallback[t.name](),this.animationCallback[t.name]=null)},t.prototype.update=function(e){},t=i([f],t)}(cc.Component));o.default=g,cc._RF.pop()},{"./BubbleMove":"BubbleMove","./Const":"Const","./Controller/EventManager":"EventManager","./Controller/EventName":"EventName","./Controller/Game":"Game","./Controller/GameFactory":"GameFactory","./Data/BubbleMatrix":"BubbleMatrix"}],Const:[function(e,t,o){"use strict";var n,i,r;cc._RF.push(t,"f7b813ZcfJE5JVv1NvPFZPC","Const"),Object.defineProperty(o,"__esModule",{value:!0}),o.BubbleColor={0:"blank",1:"bg_popblue",2:"bg_popgreen",3:"bg_poporange",4:"bg_poppurple",5:"bg_popred",6:"bg_popyellow"},o.BubbleLightColor={0:"blank",1:"bg_popbluelight",2:"bg_popgreenlight",3:"bg_poporangelight",4:"bg_poppurplelight",5:"bg_popredlight",6:"bg_popyellowlight"},o.BoomBubbleLightColor={0:"blank",1:"bomb_bluelight",2:"bomb_greenlight",3:"bomb_orangelight",4:"bomb_purplelight",5:"bomb_redlight",6:"bomb_yellowlight"},o.BoomBubbleColor={0:"blank",1:"bomb_blue",2:"bomb_green",3:"bomb_orange",4:"bomb_purple",5:"bomb_red",6:"bomb_yellow"},o.HorseBubble="horse",o.HorseBubbleLight="horselight",o.MagicBubble="rainbow",o.MagicBubbleLight="rainbowlight",function(e){e[e.Blank=0]="Blank",e[e.Blue=1]="Blue",e[e.Green=2]="Green",e[e.Orange=3]="Orange",e[e.Purple=4]="Purple",e[e.Red=5]="Red",e[e.Yellow=6]="Yellow",e[e.Horce=7]="Horce",e[e.Treasure_200=200]="Treasure_200",e[e.Treasure_400=400]="Treasure_400",e[e.Treasure_600=600]="Treasure_600",e[e.Treasure_800=800]="Treasure_800",e[e.Treasure_1000=1e3]="Treasure_1000",e[e.Streak=1001]="Streak",e[e.Pause=1002]="Pause"}(n=o.BubbleType||(o.BubbleType={})),o.BubbleColors=[n.Yellow,n.Red,n.Purple,n.Orange,n.Green,n.Blue],o.BubbleHeightOffset=-15,o.BubbleYOffset=1265,o.BubbleXOffset=20,o.BubbleSize=cc.size(94,94),o.BubbleQueRange={Min:4,Max:9},o.isAndroidWeb=function(){return cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_ANDROID},o.isIOSWeb=function(){return cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_IOS},o.ClearTargetRange={Min:2,Max:6},o.GameTime=180,o.TargetRandomLimit=120,o.DefaultTaskCount=9,o.DoubleBubbleInitRange={Min:3,Max:5},o.DoubleBubbleRange={Min:1,Max:2},o.BoomBubbleRange={Min:1,Max:2},o.MagicBubbleRange={Min:0,Max:1},o.BoomBubbleInitRange={Min:3,Max:5},o.MagicBubbleInitRange={Min:0,Max:3},o.ClearCountLimit=3,o.ShooterDoubleRange={Min:6,Max:10},o.ShooterDoubleBubbleRange={Min:0,Max:1},o.ShooterBoomRange={Min:6,Max:10},o.ShooterBoomBubbleRange={Min:0,Max:1},o.ShooterMagicRange={Min:4,Max:6},o.ShooterMagicBubbleRange={Min:0,Max:1},o.TaskStreakAward=3,function(e){e[e.Spring=0]="Spring",e[e.Summer=1]="Summer",e[e.Autumn=2]="Autumn",e[e.Winter=3]="Winter"}(i=o.Season||(o.Season={})),o.SeasonPool=[i.Autumn,i.Spring,i.Summer,i.Winter],function(e){e[e.Level_200=200]="Level_200",e[e.Level_400=400]="Level_400",e[e.Level_600=600]="Level_600",e[e.Level_800=800]="Level_800",e[e.Level_1000=1e3]="Level_1000"}(r=o.TreasureType||(o.TreasureType={})),o.TreasurePool=[r.Level_200,r.Level_400,r.Level_600,r.Level_800,r.Level_1000],o.Treasure_Top={0:{200:"bg_sfinish200",400:"bg_sfinish400",600:"bg_sfinish600",800:"bg_sfinish800",1e3:"bg_sfinish1000"},1:{200:"bg_smfinish200",400:"bg_smfinish400",600:"bg_smfinish600",800:"bg_smfinish800",1e3:"bg_smfinish1000"},2:{200:"bg_afinish200",400:"bg_afinish400",600:"bg_afinish600",800:"bg_afinish800",1e3:"bg_afinish1000"},3:{200:"bg_wfinish200",400:"bg_wfinish400",600:"bg_wfinish600",800:"bg_wfinish800",1e3:"bg_wfinish1000"}},function(e){e[e.OUT_OF_MOVE=0]="OUT_OF_MOVE",e[e.TIME_UP=1]="TIME_UP",e[e.GAME_OVER=2]="GAME_OVER"}(o.OverType||(o.OverType={})),cc._RF.pop()},{}],EventManager:[function(e,t,o){"use strict";cc._RF.push(t,"1be43vsI5VEx6cptNa56Bfq","EventManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.eventTarget=new cc.EventTarget}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.emit=function(e,t,o,n,i,r){this.eventTarget.emit(e.toString(),t,o,n,i,r)},e.prototype.on=function(e,t,o,n){return this.eventTarget.on(e.toString(),t,o,n)},e.prototype.once=function(e,t,o){this.eventTarget.once(e.toString(),t,o)},e.prototype.dispatchEvent=function(e){this.eventTarget.dispatchEvent(e)},e.prototype.off=function(e,t,o){this.eventTarget.off(e.toString(),t,o)},e.prototype.hasEventListener=function(e){return this.eventTarget.hasEventListener(e.toString())},e.prototype.targetOff=function(e){this.eventTarget.targetOff(e)},e}();o.gEventMgr=n.inst,cc._RF.pop()},{}],EventName:[function(e,t,o){"use strict";cc._RF.push(t,"017c8l+T9FHF5CNitqArJpl","EventName"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.BUBBLE_SCALE_TEST=0]="BUBBLE_SCALE_TEST",e[e.SMALL_BGM=1]="SMALL_BGM",e[e.NORMAL_BGM=2]="NORMAL_BGM",e[e.SHOOT=3]="SHOOT",e[e.BUBBLE_FORCE=4]="BUBBLE_FORCE",e[e.ADD_BUBBLE=5]="ADD_BUBBLE",e[e.ADD_SCORE=6]="ADD_SCORE",e[e.GAME_OVER=7]="GAME_OVER",e[e.UPDATE_TASK=8]="UPDATE_TASK",e[e.NEXT_BUBBLE=9]="NEXT_BUBBLE",e[e.PLAY_EFFECT=10]="PLAY_EFFECT",e[e.HORCE_CLEAR=11]="HORCE_CLEAR",e[e.GET_TREASURE=12]="GET_TREASURE",e[e.CHECK_TREASURE=13]="CHECK_TREASURE",e[e.CHANGE_BGM=14]="CHANGE_BGM",e[e.SHOW_STREAK=15]="SHOW_STREAK",e[e.UPDATE_INDEX=16]="UPDATE_INDEX",e[e.HIDE_HELP=17]="HIDE_HELP"}(o.GlobalEvent||(o.GlobalEvent={})),cc._RF.pop()},{}],FlyAdCnicornAniamtion:[function(e,t,o){"use strict";cc._RF.push(t,"df82bE3jcpP0bURZ5D33BYC","FlyAdCnicornAniamtion");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Utils/FrameAniBase"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t=i([c],t)}(r.default));o.default=s,cc._RF.pop()},{"../Utils/FrameAniBase":"FrameAniBase"}],FlyCnicornAd:[function(e,t,o){"use strict";cc._RF.push(t,"36cb0yApqROmqNTDmiukrBP","FlyCnicornAd");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=e("../Utils/Signal"),c=cc._decorator,s=c.ccclass;c.property;(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"})(r=o.FlyOrigin||(o.FlyOrigin={}));var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.CnicornWatchFailSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.RemoveFlyCnicornSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.FlyCnicornAdDispearSignal=h;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.FlyCnicornClickSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.ShowFlyCnicornSignal=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return n(t,e),o=t,Object.defineProperty(t.prototype,"Fly",{get:function(){return this.node.getChildByName("Fly")},enumerable:!0,configurable:!0}),t.prototype.reuse=function(e,t){console.log("ShowFlyCnicorn:",r[e]),this.node.opacity=255,this.Fly.opacity=255;var n=0;this.Fly.y=t,e=r.Right,this.Fly.scaleX=-1,this.Fly.x=940,n=-940,this.Fly.once(cc.Node.EventType.TOUCH_END,this.onAddTouch,this),this.Fly.runAction(cc.sequence(cc.moveTo(10,n,this.Fly.y),cc.spawn(cc.fadeOut(2),cc.moveBy(2,376*this.Fly.scaleX,0)),cc.callFunc(function(){h.inst.dispatch(),o.ShowTimeRest=10})))},t.prototype.unuse=function(){},t.prototype.onLoad=function(){var e=this;u.inst.addOnce(function(){d.inst.removeTarget(e),l.inst.removeTarget(e),e.node.removeFromParent(!0)},this),l.inst.addListener(function(){o.ShowTimeRest=10},this),o.ShowTimeRest=10,d.inst.addListenerTwo(function(t,o){e.reuse(r.Right,-658.753)},this)},t.prototype.onAddTouch=function(e){this.Fly.stopAllActions(),this.Fly.runAction(cc.fadeOut(.2)),p.inst.dispatch()},t.prototype.update=function(e){},t.ShowTimeRest=0,t=o=i([s],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../Utils/Signal":"Signal"}],FrameAniBase:[function(e,t,o){"use strict";cc._RF.push(t,"2f7a6JvP/5Fp7KUTmo5XaJk","FrameAniBase");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=r.requireComponent,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Frames=null,t.PrefixName="",t.FrameCount=0,t.Interval=.05,t.Priority=0,t.Loop=!1,t.PlayOnLoad=!1,t.currentIndex=0,t.time=0,t.isPlay=!1,t.listener=[],t.complateEvent=[],t}var o;return n(t,e),o=t,Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{set:function(e){this.Frames=e},enumerable:!0,configurable:!0}),t.prototype.onFocusInEditor=function(){},t.prototype.onLostFocusInEditor=function(){clearInterval(o.intervalID)},t.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},t.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,0==this.isPlaying&&this.callEventComplete()},t.prototype.onStartPlay=function(){},t.prototype.playOnLoop=function(){this.Loop=!0,this.play()},t.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},t.prototype.pause=function(){this.isPlay=!1},t.prototype.resume=function(){this.isPlay=!0},t.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.updateCurrentFrame(),this.Loop=!1},t.prototype.updateCurrentFrame=function(){""!=this.PrefixName?this.Sprite.spriteFrame=this.Frames.getSpriteFrame(this.PrefixName+(this.currentIndex+1)):this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex]},t.prototype.onKeyFrame=function(e){},t.prototype.addKeyEventListener=function(e,t){this.listener.push({callback:e,target:t})},Object.defineProperty(t.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),t.prototype.clearAllListener=function(){return this.listener.length=0,this},t.prototype.onComplete=function(){},t.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var e=0,t=this.listener;e<t.length;e++){var o=t[e];o.callback.apply(o.target,[this.currentIndex,this.__classname__])}},t.prototype.callEventComplete=function(){this.onComplete();for(var e=0,t=this.complateEvent;e<t.length;e++){var o=t[e];o.f.apply(o.target,[this.__classname__])}},t.prototype.addCompleteEvent=function(e,t){this.complateEvent.push({f:e,target:t})},Object.defineProperty(t.prototype,"TotalFrameCount",{get:function(){return""!=this.PrefixName&&this.FrameCount>0?this.FrameCount:this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),t.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},t.prototype.start=function(){},Object.defineProperty(t.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var e=0,t=this.getComponents(o);e<t.length;e++){var n=t[e];if(n.Priority>this.Priority&&n.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(0==this.currentIndex&&this.onStartPlay(),this.updateCurrentFrame(),this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.TotalFrameCount,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},t.prototype.update=function(e){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=e},t.aniName="FrameAniBase",t.intervalID=-1,i([c(cc.SpriteAtlas)],t.prototype,"Frames",void 0),i([c],t.prototype,"PrefixName",void 0),i([c],t.prototype,"FrameCount",void 0),i([c],t.prototype,"Interval",void 0),i([c],t.prototype,"Priority",void 0),i([c],t.prototype,"Loop",void 0),i([c],t.prototype,"PlayOnLoad",void 0),t=o=i([a,s(cc.Sprite)],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],GameFactory:[function(e,t,o){"use strict";cc._RF.push(t,"949976qNuFDsoz+OUdWWlhf","GameFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../Utils/HashMap"),r=function(){function e(e,t,o){this._pool=[],this.poolHandlerComps=[],this.poolHandlerComps=o,this.template=e,this.initPool(t)}return e.prototype.initPool=function(e){for(var t=this,o=0;o<e;++o)if(e>1)setTimeout(function(){var e=cc.instantiate(t.template);t.put(e)});else{var n=cc.instantiate(this.template);this.put(n)}},e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy&&this._pool[t].destroy();this._pool.length=0},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){if(e.removeFromParent(!1),this.poolHandlerComps)for(var t=0,o=this.poolHandlerComps;t<o.length;t++){var n=o[t],i=e.getComponent(n);i&&i.unuse&&i.unuse.apply(i)}else for(var r=0,a=e.getComponents(cc.Component);r<a.length;r++){(n=a[r])&&n.unuse&&n.unuse.apply(n)}this._pool.push(e)}},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this._pool.length-1;o<0&&this.initPool(1),o=this._pool.length-1;var n=this._pool[o];if(this._pool.length=o,this.poolHandlerComps)for(var i=0,r=this.poolHandlerComps;i<r.length;i++){var a=r[i],c=n.getComponent(a);c&&c.reuse&&c.reuse.apply(c,arguments)}else for(var s=0,l=n.getComponents(cc.Component);s<l.length;s++){(a=l[s])&&a.reuse&&a.reuse.apply(a,arguments)}return n},e}();(function(e){e[e.INIT=0]="INIT",e[e.Bubble=4]="Bubble",e[e.Point=8]="Point",e[e.Task=16]="Task",e[e.Score=32]="Score",e[e.Font=64]="Font",e[e.DONE=124]="DONE"})(n||(n={}));var a=function(){function e(){this.step=n.INIT,this.BubblePool=new i.HashMap,this.PointPool=new i.HashMap,this.TaskPool=new i.HashMap,this.ScorePool=new i.HashMap,this.FontPool=new i.HashMap}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e,t,o,n,i,r){this.doneCallback=e,this.initBubble(110,t),this.initPoint(20,o),this.initTask(8,n),this.initScore(10,i),this.initFont(5,r)},e.prototype.nextStep=function(e){this.step|=e,this.step>=n.DONE&&this.doneCallback&&this.doneCallback()},e.prototype.initBubble=function(e,t){var o=this;t?(o.BubblePool.add("Bubble",new r(t,e)),o.nextStep(n.Bubble)):cc.loader.loadRes("prefabs/Bubble",cc.Prefab,function(t,i){t?console.error(t):(o.BubblePool.add("Bubble",new r(i,e)),o.nextStep(n.Bubble))})},e.prototype.getBubble=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.BubblePool.get("Bubble").get(e)},e.prototype.putBubble=function(e){this.BubblePool.get("Bubble").put(e)},e.prototype.initPoint=function(e,t){var o=this;t?(o.PointPool.add("Point",new r(t,e)),o.nextStep(n.Point)):cc.loader.loadRes("prefabs/Point",cc.Prefab,function(t,i){t?console.error(t):(o.PointPool.add("Point",new r(i,e)),o.nextStep(n.Point))})},e.prototype.getPoint=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.PointPool.get("Point").get(e)},e.prototype.putPoint=function(e){this.PointPool.get("Point").put(e)},e.prototype.initTask=function(e,t){var o=this;t?(o.TaskPool.add("Task",new r(t,e)),o.nextStep(n.Task)):cc.loader.loadRes("prefabs/Mission",cc.Prefab,function(t,i){t?console.error(t):(o.TaskPool.add("Task",new r(i,e)),o.nextStep(n.Task))})},e.prototype.getTask=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.TaskPool.get("Task").get(e)},e.prototype.putTask=function(e){this.TaskPool.get("Task").put(e)},e.prototype.initScore=function(e,t){var o=this;t?(o.ScorePool.add("Score",new r(t,e)),o.nextStep(n.Score)):cc.loader.loadRes("prefabs/ScoreFloat",cc.Prefab,function(t,i){t?console.error(t):(o.ScorePool.add("Score",new r(i,e)),o.nextStep(n.Score))})},e.prototype.getScore=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.ScorePool.get("Score").get(e)},e.prototype.putScore=function(e){this.ScorePool.get("Score").put(e)},e.prototype.initFont=function(e,t){var o=this;t?(o.FontPool.add("Font",new r(t,e)),o.nextStep(n.Font)):cc.loader.loadRes("prefabs/Font",cc.Prefab,function(t,i){t?console.error(t):(o.FontPool.add("Font",new r(i,e)),o.nextStep(n.Font))})},e.prototype.getFont=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.FontPool.get("Font").get(e)},e.prototype.putFont=function(e){this.FontPool.get("Font").put(e)},e}();o.gFactory=a.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],GameRule:[function(e,t,o){"use strict";cc._RF.push(t,"0f4067B8ZFOi5TK0unktG7M","GameRule"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Const");o.GetGameTime=function(e){return n.isIOSWeb()?120:60},cc._RF.pop()},{"./Const":"Const"}],GameScene:[function(e,t,o){"use strict";cc._RF.push(t,"63c91B5GQpJwrTOBvKO60W6","GameScene");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=e("./Controller/GameFactory"),c=e("./Controller/Game"),s=e("./Const"),l=e("./Data/BubbleMatrix"),u=e("./Bubble"),h=e("./Controller/EventManager"),p=e("./Controller/StepController"),d=e("./Controller/AudioController"),f=e("./Controller/EventName"),g=e("./Guide"),b=e("./ResultLayer"),y=e("./BubbleMove"),m=e("./Utils/LogHandler"),v=e("./Utils/GameStateController"),_=e("./Pause/MenuButton"),S=e("./WildAdButton"),C=e("./AdLayer"),M=e("./Ad/FlyCnicornAd"),T=e("./TableManager"),B=e("./Utils/Signal");(function(e){e.Prefab="Prefab",e.Audio="Audio",e.JSON="Json"})(r||(r={}));var E=cc._decorator,F=E.ccclass,x=E.property,R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(B.BaseSignal);o.HideLoadingImg=R;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BubblePrefab=null,t.PointPrefab=null,t.TaskPrefab=null,t.AddScorePrefab=null,t.BubbleAtlas=null,t.SpringBack=null,t.SummerBack=null,t.AutumnBack=null,t.WinterBack=null,t.TreasureAtlas=null,t.TreasureIconAtlas=null,t.Guide=null,t.Background=null,t.Effect=null,t.FontAtlas=null,t.TimeFont=null,t.FontPrefab=null,t.FontRoot=null,t.TreasureRoot=null,t.BigTreasure=null,t.SmallTreasure=null,t.ResultTitle=null,t.ResultFont=null,t.BubbleLayer=null,t.Shooter=null,t.TopNode=null,t.BulletArray=null,t.TaskArray=null,t.ShooterLayer=null,t.TimeLabel=null,t.ScoreLabel=null,t.showScore=0,t.score=0,t.addScoreStep=0,t}return n(t,e),t.prototype.onLoad=function(){this.ShooterLayer.active=!1,CELER_X&&m.LogHandler.inst.initLog(celerSDK.log),m.LogHandler.inst.log(" game scene on load"),cc.debug.setDisplayStats(!1),this.ResultFont.node.scale=0,c.Game.FontRoot=this.FontRoot,c.Game.BubbleLayer=this.BubbleLayer,c.Game.TopNode=this.TopNode;var e=this;CELER_X&&celerSDK.onStart(function(){e.celerOnStart()}.bind(this)),CELER_X&&celerSDK.provideScore(function(){return parseInt(c.Game.getScore().toString())}),p.gStep.register(this.celerReady.bind(this),[r.Audio,r.Prefab,r.JSON]),T.TableManager.inst.startLoad("/json",function(){p.gStep.nextStep(r.JSON)}),a.gFactory.init(function(){p.gStep.nextStep(r.Prefab)},this.BubblePrefab,this.PointPrefab,this.TaskPrefab,this.AddScorePrefab,this.FontPrefab),d.gAudio.init(function(){p.gStep.nextStep(r.Audio)}),this.initEvent(),this.TimeLabel.node.getChildByName("noTime").opacity=0},t.prototype.celerReady=function(){m.LogHandler.inst.log(" call celerx.ready"),CELER_X&&celerSDK.ready(),CELER_X||this.celerOnStart()},t.prototype.celerOnStart=function(){var e=CELER_X&&celerSDK.getMatch();c.Game.MatchInfo=e||{matchId:"",sharedRandomSeed:Math.random(),shouldLaunchTutorial:!0,difficultyLevel:2,locale:"en_US"},e&&e.sharedRandomSeed?(CMath.randomSeed=e.sharedRandomSeed,CMath.sharedSeed=e.sharedRandomSeed,console.log(" match id:",e.matchId)):(console.error(" match sharedRandomSeed null!"),CMath.randomSeed=Math.random()),this.initLocation(),m.LogHandler.inst.log(" celer on start:",c.Game.MatchInfo.matchId,", seed:",c.Game.MatchInfo.sharedRandomSeed),c.Game.MatchInfo&&c.Game.MatchInfo.shouldLaunchTutorial?(this.Guide.show(),S.HideWildAdButtonSignal.inst.dispatch(),M.RemoveFlyCnicornSignal.inst.dispatch()):this.Guide.hide(),CELER_X&&(1!=celerSDK.hasMethod("showAd")||this.isIOSWeb)&&(S.HideWildAdButtonSignal.inst.dispatch(),M.RemoveFlyCnicornSignal.inst.dispatch()),c.Game.prepare(),c.Game.start(),this.TimeLabel.string=CMath.TimeFormat(c.Game.getGameTime()),this.updateSeason(),this.show(),this.updateTreasure(),this.ShooterLayer.active=!0,CELER_X?(celerSDK.onPause(function(){v.GameStateController.inst.isPause()||_.ShowPauseSignal.inst.dispatch()}),celerSDK.onResume(function(){console.log(" game on forground")})):(cc.game.on(cc.game.EVENT_HIDE,function(){v.GameStateController.inst.isPause()||_.ShowPauseSignal.inst.dispatch()},this),cc.game.on(cc.game.EVENT_SHOW,function(){console.log(" game on forground")},this)),R.inst.dispatch(),cc.loader.loadRes("prefabs/"+s.Season[c.Game.Season]+"/ResultLayer")},t.prototype.initLocation=function(){c.Game.MatchInfo.locale=c.Game.MatchInfo.locale||"en_US",lan.set(c.Game.MatchInfo.locale);var e={},t=null;t=T.TableManager.inst.getAll_En_Data();var o=c.Game.MatchInfo.locale.split("_")[0].charAt(0).toUpperCase()+c.Game.MatchInfo.locale.split("_")[0].substring(1);if(T.TableManager.inst["getAll_"+o+"_Data"]&&T.TableManager.inst["getAll_"+o+"_Data"]()&&(t=T.TableManager.inst["getAll_"+o+"_Data"]()),t){for(var n in t){var i=t[n];e[i.View]||(e[i.View]={}),e[i.View][i.ID]=i.Text}lan.define(c.Game.MatchInfo.locale,e)}},t.prototype.updateTreasure=function(){for(var e=0,t=this.TreasureRoot.children;e<t.length;e++){(p=t[e]).getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.TreasureAtlas.getSpriteFrame(s.Treasure_Top[c.Game.Season][p.name])}console.log(" start load treasure");for(var o=[s.TreasureType.Level_1000,s.TreasureType.Level_800],n=function(e){var t=Math.floor(CMath.getRandom(0,o.length)),n=o[t];cc.loader.loadRes("prefabs/"+s.Season[c.Game.Season]+"/"+n,cc.Prefab,function(t,o){if(t)console.error(" load treasure err:",t);else{var n=cc.instantiate(o);e.addChild(n)}}),o.splice(t,1)},i=0,r=this.BigTreasure.children;i<r.length;i++){n(p=r[i])}for(var a=[s.TreasureType.Level_200,s.TreasureType.Level_400,s.TreasureType.Level_600],l=function(e){var t=Math.floor(CMath.getRandom(0,a.length)),o=a[t];cc.loader.loadRes("prefabs/"+s.Season[c.Game.Season]+"/"+o,cc.Prefab,function(t,o){if(t)console.error(" load treasure err:",t);else{var n=cc.instantiate(o);e.addChild(n),S.WildButtonReadySignal.inst.dispatch(),M.default.ShowTimeRest=10}}),a.splice(t,1)},u=0,h=this.SmallTreasure.children;u<h.length;u++){var p;l(p=h[u])}},t.prototype.updateSeason=function(){switch(c.Game.Season){case s.Season.Spring:console.log(" set Spring bg"),this.Background.spriteFrame=this.SpringBack;break;case s.Season.Autumn:console.log(" set Autumn bg"),this.Background.spriteFrame=this.AutumnBack;break;case s.Season.Summer:console.log(" set Summer bg"),this.Background.spriteFrame=this.SummerBack;break;case s.Season.Winter:console.log(" set Winter bg"),this.Background.spriteFrame=this.WinterBack}},t.prototype.updateIndex=function(){h.gEventMgr.emit(f.GlobalEvent.UPDATE_INDEX)},t.prototype.initEvent=function(){var e=this;h.gEventMgr.targetOff(this),this.BulletArray.on(cc.Node.EventType.CHILD_REMOVED,this.onBubbleQueRemoveChild,this),this.Shooter.on(cc.Node.EventType.CHILD_REMOVED,this.onShooterRemoveChild,this),h.gEventMgr.on(f.GlobalEvent.HORCE_CLEAR,function(){e.Effect.play("super_clear")},this),h.gEventMgr.on(f.GlobalEvent.GET_TREASURE,function(t){var o=e.TreasureRoot.getChildByName(t);o&&o.getComponent(cc.Animation).play()},this),h.gEventMgr.on(f.GlobalEvent.SHOW_STREAK,function(t,o){if(t){var n=null;switch(o){case 2:n=e.FontAtlas.getSpriteFrame("f_streak");break;case 3:n=e.FontAtlas.getSpriteFrame("f_sstreak");break;case 4:n=e.FontAtlas.getSpriteFrame("f_great");break;case 5:n=e.FontAtlas.getSpriteFrame("f_amazing");break;default:n=e.FontAtlas.getSpriteFrame("f_awesome")}var i=a.gFactory.getFont();i.getComponent(cc.Sprite).spriteFrame=n,i.scale=0,i.opacity=255,e.FontRoot.addChild(i),i.x=0;var r=1+.1*o;i.y=e.FontRoot.childrenCount*(150*r),h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"font"),i.runAction(cc.sequence(cc.scaleTo(.1,r),cc.delayTime(.3),cc.callFunc(function(){if(t){c.Game.addScore(s.BubbleType.Streak,25+15*(o-2),.3*(o-2)+2,CMath.ConvertToNodeSpaceAR(i,e.TopNode).add(cc.v2(i.width/2,i.height/2)))}},e),cc.spawn(cc.scaleTo(.2,1),cc.fadeTo(.2,0)),cc.callFunc(function(){a.gFactory.putFont(i)},e)))}},this),h.gEventMgr.on(f.GlobalEvent.ADD_BUBBLE,this.addNextBubble,this),h.gEventMgr.on(f.GlobalEvent.UPDATE_TASK,this.updateTask,this),h.gEventMgr.on(f.GlobalEvent.NEXT_BUBBLE,this.getShooterBubble,this),h.gEventMgr.on(f.GlobalEvent.ADD_SCORE,this.addScore,this),h.gEventMgr.once(f.GlobalEvent.GAME_OVER,function(t){c.Game.isStart=!1,t==s.OverType.OUT_OF_MOVE?e.ResultFont.spriteFrame=e.ResultTitle.getSpriteFrame("bg_result_font2"):t==s.OverType.GAME_OVER?e.ResultFont.spriteFrame=e.ResultTitle.getSpriteFrame("bg_result_font3"):e.ResultFont.spriteFrame=e.ResultTitle.getSpriteFrame("bg_result_font1"),e.ResultFont.node.runAction(cc.sequence(cc.scaleTo(.1,1.5),cc.delayTime(.3),cc.scaleTo(.1,1.2),cc.callFunc(function(){cc.loader.loadRes("prefabs/"+s.Season[c.Game.Season]+"/ResultLayer",cc.Prefab,function(o,n){if(o)cc.error("load result :",o),console.error(" submit score by open result err:",c.Game.MatchInfo.matchId,", seed:",c.Game.MatchInfo.sharedRandomSeed),celerSDK.submitScore(c.Game.getScore());else{var i=void 0;i=t==s.OverType.OUT_OF_MOVE?e.ResultTitle.getSpriteFrame("bg_result_font2"):t==s.OverType.GAME_OVER?e.ResultTitle.getSpriteFrame("bg_result_font3"):e.ResultTitle.getSpriteFrame("bg_result_font1");var r=cc.instantiate(n);r.getComponent(b.default).setTexture(i),e.node.addChild(r)}})},e)))},this),C.AdWatchFinishSignal.inst.addListener(function(){h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"change_horce"),e.currentBubble&&0==e.currentBubble.getComponent(y.default).isShooterState&&(e.currentBubble.getComponent(u.default).setColor(s.BubbleType.Horce,l.SpecialType.Horce),e.currentBubble.getComponent(u.default).playAnimation("bubble_horce"))},this)},t.prototype.updateTask=function(){for(var e=c.Game.getCurTarget(),t=0;t<Math.min(e.now,this.TaskArray.childrenCount);t++){var o=this.TaskArray.children[t],n=o.getChildByName("Complete");0==o.scale||n.scale>.5||n.runAction(cc.sequence(cc.scaleTo(.1,.9),cc.scaleTo(.1,.6)))}},t.prototype.addNextBubble=function(e){for(void 0===e&&(e=1);e--;)this.nextBubble()},t.prototype.show=function(){console.log(" game show !!!");this.addBubble(3,13,2,11),this.getNewTask(s.DefaultTaskCount)},t.prototype.nextBubble=function(){c.Game.addMoveTimes();var e=c.Game.getMatrix();e.moveRow(1),this.BubbleLayer.height+=s.BubbleSize.height+s.BubbleHeightOffset,this.BubbleLayer.runAction(cc.sequence(cc.moveBy(.2,0,-(s.BubbleSize.height+s.BubbleHeightOffset)),cc.callFunc(function(){c.Game.checkOutOfMove(),h.gEventMgr.emit(f.GlobalEvent.CHECK_TREASURE)},this))),this.addBubble(e.index2i(c.Game.startIndex)-1,e.index2i(c.Game.startIndex)-1,2,11,1);for(var t=c.Game.startIndex;t<=c.Game.startIndex+l.UseSize-1;t++){if(!e.data[t]||!e.data[t].bubble)return;e.data[t].bubble.updateActive(t/700+(t-c.Game.startIndex)/50)}},t.prototype.addBubble=function(e,t,o,n,i){void 0===i&&(i=0),console.log(" add bubble , istart:",e,", iend:",t,",jstart:",o,", jend:",n);for(var r=c.Game.getMatrix(),a=e;a<=t;a++)for(var s=o;s<=n;s++){var l=r.ij2index(a,s),h=c.Game.getBubble(r.data[l].type,l,r.data[l].color,this.BubbleAtlas);h||console.error(" bubble is null");var p=r.getPosOfij(a,s);h.x=p.x,h.y=p.y,this.BubbleLayer.addChild(h),r.data[l].bubble=h.getComponent(u.default),h.getComponent(u.default).updateActive(l/700+(l-c.Game.startIndex)/50*i)}c.Game.updateCollisionIndexes()},t.prototype.onShooterRemoveChild=function(){},t.prototype.getShooterBubble=function(e){if(this.BulletArray.childrenCount<=0){var t=c.Game.getCurTarget();return t.now<t.target&&this.addNextBubble(1),void this.getNewTask(e)}this.Shooter.childrenCount>0&&console.log(" shooter has bubble! getShooterBubble--");var o=this.BulletArray.children[0];o.setParent(this.Shooter),o.scale=.5,o.setPosition(CMath.ConvertToNodeSpaceAR(o,this.Shooter)),this.currentBubble=o,o.runAction(cc.spawn(cc.scaleTo(.2,1),cc.fadeTo(.2,255),cc.moveTo(.3,0,0),cc.callFunc(function(){o.getComponent(y.default).readyToShoot()})))},Object.defineProperty(t.prototype,"isAndroidWeb",{get:function(){return cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_ANDROID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIOSWeb",{get:function(){return cc.sys.isMobile&&cc.sys.isBrowser&&cc.sys.os==cc.sys.OS_IOS},enumerable:!0,configurable:!0}),t.prototype.getNewTask=function(e){var t=this;e||(e=Math.ceil(CMath.getRandom(s.BubbleQueRange.Min,s.BubbleQueRange.Max))),console.log("bubble que\uff1a",e);for(var o=[],n=0;n<e;n++)o.push(n);var i=Math.ceil(CMath.getRandom(s.ShooterDoubleRange.Min,s.ShooterDoubleRange.Max)),r=0,p=s.BubbleColors.concat(),d={};if(c.Game.getTaskLength()%i==0)for(r=Math.ceil(CMath.getRandom(s.ShooterDoubleBubbleRange.Min,s.ShooterDoubleBubbleRange.Max));r-- >0&&o.length>0;){var g=o[n=Math.floor(CMath.getRandom(0,o.length))];o.splice(n,1);var b=p[C=Math.floor(CMath.getRandom(0,p.length))];p.splice(C,1),p.length<=0&&(p=s.BubbleColors.concat()),d[g]=b}var m=Math.ceil(CMath.getRandom(s.ShooterBoomRange.Min,s.ShooterBoomRange.Max)),v=0,_=s.BubbleColors.concat(),S={};if(c.Game.getTaskLength()%m==0)for(v=Math.ceil(CMath.getRandom(s.ShooterBoomBubbleRange.Min,s.ShooterBoomBubbleRange.Max));v-- >0&&o.length>0;){g=o[n=Math.floor(CMath.getRandom(0,o.length))];o.splice(n,1);var C;b=_[C=Math.floor(CMath.getRandom(0,_.length))];_.splice(C,1),_.length<=0&&(_=s.BubbleColors.concat()),S[g]=b}var M=Math.ceil(CMath.getRandom(s.ShooterMagicRange.Min,s.ShooterMagicRange.Max)),T=0,B={};if(c.Game.getTaskLength()%M==0)for(T=Math.ceil(CMath.getRandom(s.ShooterMagicBubbleRange.Min,s.ShooterMagicBubbleRange.Max));T-- >0&&o.length>0;){g=o[n=Math.floor(CMath.getRandom(0,o.length))];o.splice(n,1),B[g]=s.BubbleType.Blank}var E=[];for(n=0;n<e;n++)E.push(s.BubbleColors[Math.floor(CMath.getRandom()*s.BubbleColors.length)]);var F=c.Game.getCurTarget();F.now>=F.target&&F.target>0?(c.Game.addTaskStreak(1),h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"task_success")):(c.Game.addTaskStreak(-c.Game.getTaskStreak()),F.target>0&&h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"task_fail"));var x=function(e){var t=E[e],o=l.SpecialType.Normal;d[e]&&(o=l.SpecialType.Double,t=d[e]),S[e]&&(o=l.SpecialType.Boom,t=S[e]),null!=B[e]&&(o=l.SpecialType.Magic,t=B[e]);var n=c.Game.getBubble(o,-1,t,R.BubbleAtlas);if(n.getComponent(u.default).setActive(!0,!0,e/50),n.scale=0,n.opacity=0,n.y=0,0==e){R.currentBubble=n,R.Shooter.childrenCount>0&&console.error(" shooter has bubble!"),n.x=-200,R.Shooter.addChild(n);var i=!1;c.Game.getTaskStreak()>=s.TaskStreakAward&&(c.Game.addTaskStreak(-c.Game.getTaskStreak()),i=!0),n.runAction(cc.spawn(cc.scaleTo(.2,1),cc.fadeTo(.2,255),cc.moveTo(.3,0,0),cc.callFunc(function(){i&&(h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"change_horce"),n.getComponent(u.default).setColor(s.BubbleType.Horce,l.SpecialType.Horce),n.getComponent(u.default).playAnimation("bubble_horce")),n.getComponent(y.default).readyToShoot()})))}else n.x=-200*e,R.BulletArray.addChild(n),n.runAction(cc.spawn(cc.scaleTo(.2,.5),cc.fadeTo(.2,255),cc.moveTo(.4,40-R.BulletArray.childrenCount*s.BubbleSize.width,0)))},R=this;for(n=0;n<E.length;n++)x(n);var O=CMath.getRandom(),P=0;if(P=c.Game.getGameTime()>=0?O<=.6?CMath.Clamp(e-Math.ceil(CMath.getRandom(2,10)),s.ClearTargetRange.Max,s.ClearTargetRange.Min):O<=.3?CMath.Clamp(e-Math.ceil(CMath.getRandom(1,2)),s.ClearTargetRange.Max,s.ClearTargetRange.Min):CMath.Clamp(e,s.ClearTargetRange.Max,s.ClearTargetRange.Min):O<=.6?CMath.Clamp(e-Math.ceil(CMath.getRandom(1,2)),s.ClearTargetRange.Max,s.ClearTargetRange.Min):O<=.2?CMath.Clamp(e-Math.ceil(CMath.getRandom(2,10)),s.ClearTargetRange.Max,s.ClearTargetRange.Min):CMath.Clamp(e,s.ClearTargetRange.Max,s.ClearTargetRange.Min),P=Math.min(e-1,P),console.log("task count\uff1a",P),this.TaskArray.childrenCount>0){var A=function(e){var o=G.TaskArray.children[e],n=o.getChildByName("Complete"),i=o.getChildByName("Fail");F.now>=F.target?o.runAction(cc.sequence(cc.delayTime(e/10),cc.scaleTo(.1,0),cc.callFunc(function(){e==t.TaskArray.childrenCount-1&&h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"new_task"),n.scale=0,i.scale=0,e<=P-1&&o.runAction(cc.sequence(cc.delayTime(0),cc.scaleTo(.1,1.2),cc.delayTime(.05),cc.scaleTo(.1,1)))}))):(n.stopAllActions(),n.scale=0,i.runAction(cc.sequence(cc.delayTime(e/10),cc.scaleTo(.1,1),cc.delayTime(.2),cc.callFunc(function(){e==t.TaskArray.childrenCount-1&&h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"new_task"),o.runAction(cc.sequence(cc.delayTime(e/10),cc.scaleTo(.1,0),cc.callFunc(function(){i.scale=0,e<=P-1&&o.runAction(cc.sequence(cc.delayTime(0),cc.scaleTo(.1,1.2),cc.delayTime(.05),cc.scaleTo(.1,1)))})))}))))},G=this;for(n=0;n<this.TaskArray.childrenCount;n++)A(n)}else for(h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"new_task");this.TaskArray.childrenCount<6;){var w=a.gFactory.getTask();w.y=0,w.x=this.TaskArray.childrenCount*w.width*1.3+30,w.scale=0,this.TaskArray.childrenCount<P&&w.runAction(cc.sequence(cc.delayTime(this.TaskArray.childrenCount/10),cc.scaleTo(.1,1.2),cc.delayTime(.05),cc.scaleTo(.1,1))),this.TaskArray.addChild(w),w.getChildByName("Complete").scale=0,w.getChildByName("Fail").scale=0}c.Game.pushTarget({now:0,target:P}),console.log(" add new task done:",this.Shooter.childrenCount)},t.prototype.onBubbleQueRemoveChild=function(){for(var e=0,t=this.BulletArray.children;e<t.length;e++){t[e].runAction(cc.moveBy(.2,s.BubbleSize.width,0))}},t.prototype.addScore=function(e,t,o){var n=this;void 0===o&&(o=cc.v2(0,0)),t*=1.1;var i=a.gFactory.getScore();i.scale=0,i.opacity=255,e>0?(i.getComponent(cc.Label).string="/"+e.toString(),i.getChildByName("500").active=!1):(i.getComponent(cc.Label).string="",i.getChildByName("500").active=!0,i.getChildByName("500").scale=2),this.TopNode.addChild(i),i.setPosition(o);var r=CMath.Distance(o,this.ScoreLabel.node.position)/1560;i.runAction(cc.sequence(cc.delayTime(.4),cc.fadeTo(r+.3,0))),i.runAction(cc.sequence(cc.scaleTo(.1,1.2*t),cc.delayTime(.2),cc.scaleTo(.1,1*t),cc.moveTo(r,this.ScoreLabel.node.position).easing(cc.easeInOut(1)),cc.scaleTo(.3,0),cc.callFunc(function(){n.score=c.Game.getScore(),n.addScoreStep=(n.score-n.showScore)/20,a.gFactory.putScore(i)})))},t.prototype.updateTimeCount=function(){var e=Math.floor(c.Game.getGameTime());if(!(e>5)){var t=this.TimeLabel.node.getChildByName("font").getComponent(cc.Sprite),o=this.TimeFont.getSpriteFrame("bg_time"+e);t.spriteFrame!=o&&(h.gEventMgr.emit(f.GlobalEvent.PLAY_EFFECT,"count"),t.spriteFrame=o,t.node.runAction(cc.sequence(cc.fadeTo(.2,255),cc.scaleTo(.1,1.2),cc.delayTime(.5),cc.scaleTo(.1,1),cc.fadeTo(.1,0))))}},t.prototype.update=function(e){c.Game.isStart&&(this.Guide.node.active||0!=v.GameStateController.inst.isPause()||(M.default.ShowTimeRest>0&&(M.default.ShowTimeRest-=e,M.default.ShowTimeRest<=0&&M.ShowFlyCnicornSignal.inst.dispatch()),c.Game.addGameTime(-e),this.TimeLabel.string=CMath.TimeFormat(c.Game.getGameTime()),30==Math.floor(c.Game.getGameTime())&&this.TimeLabel.node.getChildByName("noTime").opacity<=0&&(this.TimeLabel.getComponent(cc.Animation).play(),h.gEventMgr.emit(f.GlobalEvent.CHANGE_BGM,"bgm_30")),this.updateTimeCount()),this.showScore!=this.score&&(this.showScore+=this.addScoreStep,this.showScore=Math.min(this.score,this.showScore),this.ScoreLabel.string=Math.floor(this.showScore).toString()))},i([x(cc.Prefab)],t.prototype,"BubblePrefab",void 0),i([x(cc.Prefab)],t.prototype,"PointPrefab",void 0),i([x(cc.Prefab)],t.prototype,"TaskPrefab",void 0),i([x(cc.Prefab)],t.prototype,"AddScorePrefab",void 0),i([x(cc.SpriteAtlas)],t.prototype,"BubbleAtlas",void 0),i([x(cc.SpriteFrame)],t.prototype,"SpringBack",void 0),i([x(cc.SpriteFrame)],t.prototype,"SummerBack",void 0),i([x(cc.SpriteFrame)],t.prototype,"AutumnBack",void 0),i([x(cc.SpriteFrame)],t.prototype,"WinterBack",void 0),i([x(cc.SpriteAtlas)],t.prototype,"TreasureAtlas",void 0),i([x(cc.SpriteAtlas)],t.prototype,"TreasureIconAtlas",void 0),i([x(g.default)],t.prototype,"Guide",void 0),i([x(cc.Sprite)],t.prototype,"Background",void 0),i([x(cc.Animation)],t.prototype,"Effect",void 0),i([x(cc.SpriteAtlas)],t.prototype,"FontAtlas",void 0),i([x(cc.SpriteAtlas)],t.prototype,"TimeFont",void 0),i([x(cc.Prefab)],t.prototype,"FontPrefab",void 0),i([x(cc.Node)],t.prototype,"FontRoot",void 0),i([x(cc.Node)],t.prototype,"TreasureRoot",void 0),i([x(cc.Node)],t.prototype,"BigTreasure",void 0),i([x(cc.Node)],t.prototype,"SmallTreasure",void 0),i([x(cc.SpriteAtlas)],t.prototype,"ResultTitle",void 0),i([x(cc.Sprite)],t.prototype,"ResultFont",void 0),i([x(cc.Node)],t.prototype,"BubbleLayer",void 0),i([x(cc.Node)],t.prototype,"Shooter",void 0),i([x(cc.Node)],t.prototype,"TopNode",void 0),i([x(cc.Node)],t.prototype,"BulletArray",void 0),i([x(cc.Node)],t.prototype,"TaskArray",void 0),i([x(cc.Node)],t.prototype,"ShooterLayer",void 0),i([x(cc.Label)],t.prototype,"TimeLabel",void 0),i([x(cc.Label)],t.prototype,"ScoreLabel",void 0),t=i([F],t)}(cc.Component);o.default=O,cc._RF.pop()},{"./Ad/FlyCnicornAd":"FlyCnicornAd","./AdLayer":"AdLayer","./Bubble":"Bubble","./BubbleMove":"BubbleMove","./Const":"Const","./Controller/AudioController":"AudioController","./Controller/EventManager":"EventManager","./Controller/EventName":"EventName","./Controller/Game":"Game","./Controller/GameFactory":"GameFactory","./Controller/StepController":"StepController","./Data/BubbleMatrix":"BubbleMatrix","./Guide":"Guide","./Pause/MenuButton":"MenuButton","./ResultLayer":"ResultLayer","./TableManager":"TableManager","./Utils/GameStateController":"GameStateController","./Utils/LogHandler":"LogHandler","./Utils/Signal":"Signal","./WildAdButton":"WildAdButton"}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"66b11VhuCtB54L0B65tz+AU","GameStateController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("../Controller/Game"),a=e("./Signal"),c=e("./ToSingleton");(function(e){e[e.Complete=0]="Complete",e[e.Over=1]="Over",e[e.TimeUp=2]="TimeUp"})(i=o.RoundEndType||(o.RoundEndType={}));var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.GamePauseSignal=s;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pauseCount=0,t.roundstart=!1,t.isReady=!1,t.isOver=!1,t.currentRound=0,t.onResumeCallbacks=[],t}return n(t,e),t.prototype.start=function(){this.pauseCount=0},t.prototype.canStart=function(){return this.isReady},t.prototype.roundStart=function(){this.isOver||(console.log(" round start:",++this.currentRound),this.roundstart=!0)},t.prototype.roundEnd=function(e){console.log("round end :",i[e]),this.roundstart=!1,this.isOver=!0},t.prototype.isRoundStart=function(){return this.roundstart},t.prototype.pause=function(e){void 0===e&&(e=!1),0==this.isPause()&&(this.onResumeCallbacks.length=0,s.inst.dispatch(),e||this.onResumeCallbacks.push(function(){r.Game.reduceFreePauseCount()})),this.pauseCount++},t.prototype.testEndComplete=function(){this.roundEnd(i.Complete)},t.prototype.testEndTimeUp=function(){},t.prototype.clearResumeCallback=function(){this.onResumeCallbacks.length=0},t.prototype.resume=function(){if(this.pauseCount--,console.assert(this.pauseCount>=0," pause count smaller than 0!!!"),this.pauseCount=Math.max(this.pauseCount,0),this.pauseCount<=0){for(var e=0,t=this.onResumeCallbacks;e<t.length;e++){(0,t[e])()}this.onResumeCallbacks.length=0}},t.prototype.isPause=function(){return this.pauseCount>0},t.prototype.addResumeCallback=function(e){this.onResumeCallbacks||(this.onResumeCallbacks=[]),this.onResumeCallbacks.push(e)},t.prototype.isGameOver=function(){return this.isOver},t}(c.SingleTon());o.GameStateController=l,!CELER_X&&(window.GameState=l.inst),cc._RF.pop()},{"../Controller/Game":"Game","./Signal":"Signal","./ToSingleton":"ToSingleton"}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"f56074wKGJAf7tmCkTOJ+cK","Game"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Data/BubbleMatrix"),i=e("../Const"),r=e("./GameFactory"),a=e("../BubbleMove"),c=e("./EventManager"),s=e("./EventName"),l=e("../GameRule"),u=e("../AdLayer"),h=function(){function e(){this.BubbleLayer=null,this.TopNode=null,this.FontRoot=null,this.moveTimes=0,this.bubbleMatrix=new n.BubbleMatrix,this.score=0,this.streak=0,this.maxStreak=0,this.taskStreak=0,this.maxTaskStreak=0,this.bubbleScore={},this.bubbleClear={},this.bubbleDrop={},this.collisionIndexes=[],this.targets=[],this.clearIndex=[],this.dropIndex=[],this.fixedIndex=[],this.forceIndex=[],this.gameTime=0,this.isStart=!1,this.lastIndex=58,this.freePauseCount=3,this._startIndex=58,this.isEnd=!1}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Season",{get:function(){return this.season},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startIndex",{get:function(){return this._startIndex},set:function(e){this._startIndex=e,console.log(" startIndex:",this.startIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FreePauseCount",{get:function(){return this.freePauseCount},enumerable:!0,configurable:!0}),e.prototype.reduceFreePauseCount=function(){if(this.freePauseCount--,this.freePauseCount<0){if(this.freePauseCount=0,this.isEnd)return;this.addScore(i.BubbleType.Pause,-500,1)}},e.prototype.start=function(){this.moveTimes=0,this.score=0,this.collisionIndexes.length=0,this.targets.length=0,this.clearIndex.length=0,this.dropIndex.length=0,this.forceIndex.length=0,this.gameTime=l.GetGameTime(this.MatchInfo.difficultyLevel),this.streak=0,this.maxStreak=0,this.taskStreak=0,this.maxTaskStreak=0;for(var e=0,t=i.BubbleColors;e<t.length;e++){var o=t[e];this.bubbleClear[o]=0,this.bubbleDrop[o]=0,this.bubbleScore[o]=0}for(var n=0;n<10;n++)this.season=i.SeasonPool[Math.floor(CMath.getRandom(0,i.SeasonPool.length))];console.log(" Season:",i.Season[this.season])},e.prototype.getBubbleScore=function(){return this.bubbleScore},e.prototype.getTaskLength=function(){return this.targets.length},e.prototype.getCurTarget=function(){return 0==this.targets.length?{target:0,now:0}:this.targets[this.targets.length-1]},e.prototype.addTarget=function(e){0!=this.targets.length&&(this.targets[this.targets.length-1].now+=e,c.gEventMgr.emit(s.GlobalEvent.UPDATE_TASK))},e.prototype.pushTarget=function(e){this.streak=0,this.targets.push(e)},e.prototype.getCollisionIndexes=function(){return this.collisionIndexes},e.prototype.updateCollisionIndexes=function(){this.collisionIndexes.length=0;for(var e=this.bubbleMatrix.data,t=0;t<e.length;t++){if(e[t]&&e[t].bubble)this.bubbleMatrix.getNeiborMatrix(t,1).length<6&&this.collisionIndexes.push(t)}for(t=0;t<e.length;t++)if(e[t]&&e[t].bubble&&!(this.collisionIndexes.indexOf(t)>=0)){for(var o=!0,i=0,r=this.bubbleMatrix.getNeiborMatrix(t,1);i<r.length;i++){var a=r[i];if(this.collisionIndexes.indexOf(a)<0){o=!1;break}}o&&this.collisionIndexes.push(t)}for(t=this.startIndex-n.MatrixSize;t<this.startIndex-n.MatrixSize+n.UseSize;t++);},e.prototype.getScore=function(){return this.score},e.prototype.addScore=function(e,t,o,n){void 0===n&&(n=cc.v2(0,0)),this.score+=t,this.score=Math.max(0,this.score),this.addBubbleScore(e,t),c.gEventMgr.emit(s.GlobalEvent.ADD_SCORE,t,o,n)},e.prototype.getMatrix=function(){return this.bubbleMatrix},e.prototype.prepare=function(){this.bubbleMatrix.initBubbleData()},e.prototype.getLastI=function(){return this.bubbleMatrix.index2i(this.lastIndex)},e.prototype.addGameTime=function(e){this.gameTime+=e,this.gameTime<=0&&(this.gameTime=0,this.isStart=!1,c.gEventMgr.emit(s.GlobalEvent.GAME_OVER,i.OverType.TIME_UP))},e.prototype.gameEnd=function(){this.isEnd=!0,console.log("End manul."),c.gEventMgr.emit(s.GlobalEvent.GAME_OVER,i.OverType.GAME_OVER)},e.prototype.checkOutOfMove=function(){for(var e=null,t=this.bubbleMatrix.data.length-1;t>=this.startIndex;t--)if(this.bubbleMatrix.data[t]&&this.bubbleMatrix.data[t].bubble&&this.bubbleMatrix.data[t].bubble.node.active){e=this.bubbleMatrix.data[t].bubble;break}if(e){var o=CMath.ConvertToNodeSpaceAR(e.node,e.node.getParent().getParent());console.log(" check out of move:",o.y),o.y<=a.DropBorder&&c.gEventMgr.emit(s.GlobalEvent.GAME_OVER,i.OverType.OUT_OF_MOVE)}},e.prototype.getGameTime=function(){return this.gameTime},e.prototype.addMoveTimes=function(e){void 0===e&&(e=1),this.moveTimes+=e},e.prototype.getMoveTimes=function(){return this.moveTimes},e.prototype.getBubble=function(e,t,o,n){return r.gFactory.getBubble(e,t,o,n)},e.prototype.checkRecurily=function(e,t){if(!(this.clearIndex.indexOf(e)>=0||e<this.startIndex)){this.clearIndex.push(e);for(var o=0,n=this.bubbleMatrix.getNeiborMatrix(e,1);o<n.length;o++){var i=n[o];if(!(i<this.startIndex)){var r=this.bubbleMatrix.data[i].bubble;r&&r.node.active&&t.Color==r.Color&&this.checkRecurily(i,t)}}}},e.prototype.addBubbleScore=function(e,t){this.bubbleScore[e]||(this.bubbleScore[e]=0),this.bubbleScore[e]+=t},e.prototype.addBubbleDrop=function(e){this.bubbleDrop[e]++},e.prototype.addBubbleClear=function(e){this.bubbleClear[e]++},e.prototype.checkBoomBubble=function(e){for(var t=0,o=e;t<o.length;t++){var i=o[t];if(this.bubbleMatrix.data[i].type==n.SpecialType.Boom){for(var r=[],a=0,c=this.bubbleMatrix.getNeiborMatrix(i,1,!1);a<c.length;a++){var s=c[a];this.clearIndex.indexOf(s)<0&&s>=this.startIndex&&(this.clearIndex.push(s),this.bubbleMatrix.data[s].type==n.SpecialType.Boom&&r.push(s))}this.checkBoomBubble(r)}}},e.prototype.checkClear=function(e,t,o){if(this.clearIndex.length=0,t.Type==n.SpecialType.Horce){console.log("\u5c0f\u9a6c\u7403"),this.clearIndex.push(e);for(var r=this.startIndex;r<this.bubbleMatrix.data.length;r++)this.bubbleMatrix.data[r]&&this.bubbleMatrix.data[r].bubble&&this.bubbleMatrix.data[r].bubble.node.active&&this.bubbleMatrix.data[r].color==o.Color&&this.clearIndex.push(r)}else this.checkRecurily(e,t);if(this.clearIndex.length<i.ClearCountLimit&&t.Type!=n.SpecialType.Horce)return this.clearIndex.length=0,void(this.streak=0);console.log(" --------------- \u68c0\u6d4b\u6d88\u9664 start---------------:",this.startIndex),console.log(this.clearIndex),console.log(" --------------- \u68c0\u6d4b\u6d88\u9664 end---------------"),this.checkBoomBubble(this.clearIndex),this.streak++,this.streak>=2&&c.gEventMgr.emit(s.GlobalEvent.SHOW_STREAK,!0,this.streak),this.clearIndex.length>=5&&(this.clearIndex.length<=8?c.gEventMgr.emit(s.GlobalEvent.SHOW_STREAK,!1,4):this.clearIndex.length<=12?c.gEventMgr.emit(s.GlobalEvent.SHOW_STREAK,!1,5):c.gEventMgr.emit(s.GlobalEvent.SHOW_STREAK,!1,6)),this.maxStreak=Math.max(this.streak,this.maxStreak);var a=0;for(a=this.bubbleMatrix.data.length-1;a>=this.startIndex;a--){var l=this.bubbleMatrix.data[a];if(l&&l.color&&l.bubble&&l.bubble.node.active)break}this.lastIndex=a;for(var u=!1,h=0;h<this.clearIndex.length;h++){var p=this.clearIndex[h];if((f=this.bubbleMatrix.data[p].bubble)&&f.isDouble){u=!0,c.gEventMgr.emit(s.GlobalEvent.PLAY_EFFECT,"double_score");break}}t.Type==n.SpecialType.Horce&&(c.gEventMgr.emit(s.GlobalEvent.PLAY_EFFECT,"super_clear"),c.gEventMgr.emit(s.GlobalEvent.HORCE_CLEAR));for(var d=0;d<this.clearIndex.length;d++){var f;p=this.clearIndex[d];(f=this.bubbleMatrix.data[p].bubble)&&(u&&(f.DoubleScore=!0),f.onClear(.1*d,e),this.bubbleMatrix.data[p].bubble=null,this.bubbleMatrix.data[p].color=i.BubbleType.Blank,this.bubbleMatrix.data[p].type=n.SpecialType.Normal)}this.clearIndex.length=0,this.checkBubbleDrop(),this.addTarget(1),c.gEventMgr.emit(s.GlobalEvent.CHECK_TREASURE),this.checkAddBubble()},e.prototype.checkAddBubble=function(){for(var e=0,t=this.startIndex;t<=this.startIndex+9;t++)this.bubbleMatrix.data[t]&&this.bubbleMatrix.data[t].bubble&&this.bubbleMatrix.data[t].bubble.node.active&&e++;e<=5&&c.gEventMgr.emit(s.GlobalEvent.ADD_BUBBLE,3)},e.prototype.checkDrop=function(e){for(var t=this.bubbleMatrix.getNeiborMatrix(e,1,!1),o=0,n=t;o<n.length;o++){var i=n[o];if(this.fixedIndex.indexOf(i)>=0){this.fixedIndex=this.fixedIndex.concat(t),this.fixedIndex.push(e);break}}},e.prototype.checkBubbleDrop=function(){this.dropIndex.length=0,this.fixedIndex.length=0;for(var e=this.startIndex;e<this.startIndex+n.UseSize;e++)this.bubbleMatrix.data[e]&&this.bubbleMatrix.data[e].bubble&&this.fixedIndex.push(e);for(e=this.startIndex;e<this.bubbleMatrix.data.length;e++)e>=this.startIndex+n.UseSize&&this.bubbleMatrix.data[e]&&this.bubbleMatrix.data[e].bubble&&this.dropIndex.push(e);if(!(this.dropIndex.length<=0)){for(var t=0,o=this.dropIndex;t<o.length;t++){var r=o[t];this.checkDrop(r)}for(var a=0,c=this.fixedIndex;a<c.length;a++){r=c[a];(e=this.dropIndex.indexOf(r))>=0&&this.dropIndex.splice(e,1)}console.log(" \u68c0\u6d4b\u6389\u843d---------------"),console.log(this.dropIndex);for(var s=0,l=this.dropIndex;s<l.length;s++){r=l[s];if(this.bubbleMatrix.data[r]){var u=this.bubbleMatrix.data[r].bubble;u&&(u.move.drop(),this.bubbleMatrix.data[r].bubble=null,this.bubbleMatrix.data[r].color=i.BubbleType.Blank,this.bubbleMatrix.data[r].type=n.SpecialType.Normal)}}this.dropIndex.length=0}},e.prototype.addTaskStreak=function(e){this.taskStreak+=e,this.taskStreak=Math.max(0,this.taskStreak),this.maxTaskStreak=Math.max(this.maxTaskStreak,this.taskStreak)},e.prototype.getTaskStreak=function(){return this.taskStreak},e.prototype.testGetHorce=function(){u.AdWatchFinishSignal.inst.dispatch()},e}();o.Game=h.inst,cc._RF.pop()},{"../AdLayer":"AdLayer","../BubbleMove":"BubbleMove","../Const":"Const","../Data/BubbleMatrix":"BubbleMatrix","../GameRule":"GameRule","./EventManager":"EventManager","./EventName":"EventName","./GameFactory":"GameFactory"}],GlobalSingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"50484YTu+lAFp2acGVLgU7t","GlobalSingleTouchMediator");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../SingleTouchMediator"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.node._touchListener.swallowTouches=!1},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t=i([c],t)}(r.default));o.default=s,cc._RF.pop()},{"../SingleTouchMediator":"SingleTouchMediator"}],GlobalSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"4cc97bBcEZPu7Haxk0HdV9+","GlobalSingleTouchView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../BaseView"),a=e("./GlobalSingleTouchMediator"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.BindMedaitor(a.default)},t.prototype.start=function(){},t=i([s],t)}(r.default));o.default=l,cc._RF.pop()},{"../BaseView":"BaseView","./GlobalSingleTouchMediator":"GlobalSingleTouchMediator"}],GuidePageLabel:[function(e,t,o){"use strict";cc._RF.push(t,"639d4F/XQ9Ee7opMwEgiut/","GuidePageLabel");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./table"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.renderText()},t.prototype.renderText=function(){this.getComponent(cc.RichText).string=lan.t(r.En_View.BangZhuJieMian,r.En_ID.BangZhuYeMian1+parseInt(this.node.name))},t=i([c],t)}(cc.Component));o.default=s,cc._RF.pop()},{"./table":"table"}],Guide:[function(e,t,o){"use strict";cc._RF.push(t,"4d6d2YvErVK1L2MNAsgprAA","Guide");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Controller/EventManager"),a=e("./Controller/EventName"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ButtonAtlas=null,t.Next=null,t.Content=null,t.GuideView=null,t.callback=null,t}return n(t,e),t.prototype.onLoad=function(){this.Next.node.on(cc.Node.EventType.TOUCH_END,this.nextPage,this),r.gEventMgr.on(a.GlobalEvent.HIDE_HELP,this.hide,this),this.GuideView.node.on("scroll-ended",this.updateButton,this)},t.prototype.start=function(){},t.prototype.hide=function(){this.node.active=!1,this.callback&&this.callback(),cc.Node.maxTouchNum=1,cc.Node.touchNum=0},t.prototype.show=function(e){cc.Node.maxTouchNum=10,cc.Node.touchNum=0,this.node.active=!0,this.callback=e,this.GuideView.scrollToPage(0,0),this.Next.node.active=!0,this.Next.node.getComponent(cc.Sprite).spriteFrame=this.ButtonAtlas.getSpriteFrame("btn_next")},t.prototype.nextPage=function(){if(this.GuideView.getCurrentPageIndex()>=this.GuideView.content.childrenCount-1)this.hide();else{var e=(this.GuideView.getCurrentPageIndex()+1)%this.GuideView.content.childrenCount;this.GuideView.setCurrentPageIndex(e),this.updateButton()}},t.prototype.forwardPage=function(){if(this.GuideView.getCurrentPageIndex()<=0);else{var e=(this.GuideView.getCurrentPageIndex()-1)%this.GuideView.content.childrenCount;this.GuideView.setCurrentPageIndex(e),this.updateButton()}},t.prototype.updateButton=function(){this.GuideView.getCurrentPageIndex()>=this.GuideView.content.childrenCount-1?this.Next.node.getComponent(cc.Sprite).spriteFrame=this.ButtonAtlas.getSpriteFrame("btn_resume"):this.Next.node.getComponent(cc.Sprite).spriteFrame=this.ButtonAtlas.getSpriteFrame("btn_next")},i([l(cc.SpriteAtlas)],t.prototype,"ButtonAtlas",void 0),i([l(cc.Button)],t.prototype,"Next",void 0),i([l(cc.Node)],t.prototype,"Content",void 0),i([l(cc.PageView)],t.prototype,"GuideView",void 0),t=i([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./Controller/EventManager":"EventManager","./Controller/EventName":"EventName"}],HashMap:[function(e,t,o){"use strict";cc._RF.push(t,"834d8P+ikFOAYgMzFmudtRR","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._list=new Array,this.clear()}return e.prototype.getIndexByKey=function(e){for(var t=this._list.length,o=0;o<t;o++){if(this._list[o].key==e)return o}return-1},e.prototype.keyOf=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];if(n.value==e)return n.key}return null},Object.defineProperty(e.prototype,"keys",{get:function(){for(var e=new Array,t=0,o=this._list;t<o.length;t++){var n=o[t];n&&e.push(n.key)}return e},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var o={key:e,value:t},n=this.getIndexByKey(e);-1!=n?this._list[n]=o:this._list.push(o)},Object.defineProperty(e.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.getIndexByKey(e);if(-1!=t){var o=this._list[t];return this._list.splice(t,1),o}return null},e.prototype.has=function(e){return-1!=this.getIndexByKey(e)},e.prototype.get=function(e){var t=this.getIndexByKey(e);return-1!=t?this._list[t].value:null},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.sort=function(e){this._list.sort(e)},e.prototype.forEachKeyValue=function(e){for(var t=this._list.length,o=0;o<t;o++){e(this._list[o])}},e.prototype.forEach=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];e(n.key,n.value)}},e.prototype.clear=function(){this._list=[]},e}();o.HashMap=n,cc._RF.pop()},{}],LoadingImg:[function(e,t,o){"use strict";cc._RF.push(t,"8bc1akHpdtIqLbK6SnheTLJ","LoadingImg");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./GameScene"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){var e=this;this.node.scale=1;r.HideLoadingImg.inst.addListener(function(){e.node.runAction(cc.fadeOut(.3)),setTimeout(function(){e.node.destroy()},300)},this)},t=i([c],t)}(cc.Component));o.default=s,cc._RF.pop()},{"./GameScene":"GameScene"}],LogHandler:[function(e,t,o){"use strict";cc._RF.push(t,"4e3f0ZIKgdJt7KKOAGW0fes","LogHandler");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var o=e.call(this)||this;if(o.logFunc=console.log,o.logMsg=null,o.frameTimes=0,o.now=0,o.Frame=20,o.totalFrames=0,o.startTime=0,window.addEventListener)for(var n=0,i=t.LISTENNING_EVENTS;n<i.length;n++){var r=i[n],a="trigger"+r.charAt(0).toLocaleUpperCase()+r.substring(1);o[a]&&"function"==typeof o[a]&&window.addEventListener(r,o[a].bind(o))}return o}return n(t,e),t.prototype.dumpFrameInfo=function(){var e=(Date.now()-this.startTime)/1e3,t=e/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",e+"s"," , per frame cost time ave:"+t+"s")},t.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLog.apply(this,e),this.sendLog()},t.prototype.ready=function(){console.log(t.VERSION)},t.prototype.initLog=function(e){var o=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){o.frameTimes=0,o.now=Date.now(),o.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){o.frameTimes++,o.totalFrames++,o.frameTimes>=o.Frame&&(o.frameTimes=0,o.now=Date.now())},this),this.logFunc=e,window.consoleError=console.error,window.consoleWarn=console.warn,window.consoleLog=console.log,window.consoleAssert=console.assert,console.error=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[ERROR]"].concat(o))},console.warn=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[WARN]"].concat(o))},console.log=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[INFO]"].concat(o))},console.assert=function(e){for(var o,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];e||(o=t.inst).log.apply(o,["[ASSERT ERROR]"].concat(n))}},t.prototype.formatLogArguments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o="",n=0;n<arguments.length;n++){var i=typeof arguments[n];"string"==i||"number"==i?o+=" "+arguments[n]:"object"==i?o+=" "+JSON.stringify(arguments[n]):"boolean"==i&&arguments[n].toString&&(o+=arguments[n].toString())}return o},t.prototype.addLog=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==this.logMsg&&(this.logMsg={});var n=this.formatLogArguments.apply(this,e),i=this.getFullTime(new Date);this.logMsg[i]=t.VERSION+n},t.prototype.getFullTime=function(e){var t="";t+=e.getFullYear();var o=e.getMonth()+1;t+="-"+(o>=10?o:"0"+o);var n=e.getDate();t+="-"+(n>=10?n:"0"+n);var i=e.getHours();t+="  "+(i>=10?i:"0"+i);var r=e.getMinutes();t+=":"+(r>=10?r:"0"+r);var a=e.getSeconds();return t+=":"+(a>=10?a:"0"+a)},t.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},t.prototype.triggerClose=function(e){this.addLog("triggerClose"),this.sendLog()},t.prototype.triggerLoad=function(e){this.addLog("triggerLoad"),this.sendLog()},t.prototype.triggerUnload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerOnunload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerError=function(e){this.addLog("triggerError"),this.addLog(e.message),this.sendLog()},t.prototype.triggerFocus=function(e){this.addLog("triggerFocus"),this.sendLog()},t.prototype.triggerBlur=function(e){this.addLog("triggerBlur"),this.sendLog()},t.prototype.triggerAbort=function(e){this.addLog("triggerAbort"),this.sendLog()},t.prototype.triggerSuspend=function(e){this.addLog("triggerSuspend"),this.sendLog()},t.prototype.beforeunload=function(e){this.addLog("beforeunload"),this.sendLog()},t.VERSION=window.GAME_VERSION||" --- ",t.LISTENNING_EVENTS=["error"],t}(e("./ToSingleton").SingleTon());o.LogHandler=i,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],MenuButton:[function(e,t,o){"use strict";cc._RF.push(t,"2e76eOdRTpPNI1Z2h4BTcu/","MenuButton");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Utils/Signal"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(r.BaseSignal));o.MenuButtonClickSignal=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(r.BaseSignal);o.ShowPauseSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,function(){s.inst.dispatch()},this)},t=i([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../Utils/Signal":"Signal"}],MenuLayer:[function(e,t,o){"use strict";cc._RF.push(t,"5918dvHUFNKR73rVJGzF1oU","MenuLayer");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../AdLayer"),a=e("../Controller/Game"),c=e("../Guide"),s=e("../table"),l=e("../Utils/BaseView"),u=e("../Utils/GameStateController"),h=e("./MenuButton"),p=cc._decorator,d=p.ccclass,f=p.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.PauseAtlas=null,t.Guide=null,t}return n(t,e),Object.defineProperty(t.prototype,"SoundButton",{get:function(){return this.node.getChildByName("Sound")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HelpButton",{get:function(){return this.node.getChildByName("Help")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseLabel",{get:function(){return this.node.getChildByName("PauseLabel").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("Resume")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Info",{get:function(){return this.node.getChildByName("bg_free").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"End",{get:function(){return this.node.getChildByName("End")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content",{get:function(){return this.node.getChildByName("Content").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),h.ShowPauseSignal.inst.addListener(function(){t.node.active||(t.Show(),t.updateInfo(),u.GameStateController.inst.pause())},this),r.HideSubmitLayerSignal.inst.addListener(function(){t.Hide(),u.GameStateController.inst.resume()},this),h.MenuButtonClickSignal.inst.addListener(function(){t.node.active||(t.Show(),t.updateInfo(),u.GameStateController.inst.pause())},this),this.Resume.on(cc.Node.EventType.TOUCH_END,function(){t.Hide(),u.GameStateController.inst.resume()},this),this.End.on(cc.Node.EventType.TOUCH_END,function(){t.Hide(),a.Game.gameEnd(),u.GameStateController.inst.resume()},this),this.SoundButton.on(cc.Node.EventType.TOUCH_END,function(){cc.audioEngine.getEffectsVolume()>0?(cc.audioEngine.setEffectsVolume(0),cc.audioEngine.setMusicVolume(0)):(cc.audioEngine.setEffectsVolume(1),cc.audioEngine.setMusicVolume(1)),t.updateSound()},this),this.HelpButton.on(cc.Node.EventType.TOUCH_END,function(){t.Guide.show()},this),this.node.active=!1},t.prototype.updateInfo=function(){this.updateSound(),a.Game.FreePauseCount>0?this.Content.string=lan.t(s.En_View.ZanTingJieMian,s.En_ID.MianFeiZanTingCiShu,[a.Game.FreePauseCount.toString(),"-500"]):this.Content.string=lan.t(s.En_View.ZanTingJieMian,s.En_ID.ZanTingKouFen,["-500"])},t.prototype.updateSound=function(){cc.audioEngine.getEffectsVolume()>0?this.SoundButton.getComponent(cc.Sprite).spriteFrame=this.PauseAtlas.getSpriteFrame("btn_sound"):this.SoundButton.getComponent(cc.Sprite).spriteFrame=this.PauseAtlas.getSpriteFrame("btn_nosound")},i([f(cc.SpriteAtlas)],t.prototype,"PauseAtlas",void 0),i([f(c.default)],t.prototype,"Guide",void 0),t=i([d],t)}(l.default);o.default=g,cc._RF.pop()},{"../AdLayer":"AdLayer","../Controller/Game":"Game","../Guide":"Guide","../Utils/BaseView":"BaseView","../Utils/GameStateController":"GameStateController","../table":"table","./MenuButton":"MenuButton"}],ResultLayer:[function(e,t,o){"use strict";cc._RF.push(t,"6cddevafb1BXoHh5PEsKHRP","ResultLayer");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Controller/Game"),a=e("./Const"),c=e("./Controller/EventManager"),s=e("./Controller/EventName"),l=e("./Utils/LogHandler"),u=e("./table"),h=cc._decorator,p=h.ccclass,d=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Result=null,t.Submit=null,t.TreasureRoot=null,t.Title=null,t.FinalScore=null,t.GameScore=null,t.Bonus=null,t.BonusScore=null,t.gameScore=0,t.showGameScore=0,t.bonus=0,t.showBonus=0,t.bonusScore=0,t.showBonusScore=0,t.totalScore=0,t.showTotalScore=0,t.scoreStep=0,t.submit=!1,t.show=!1,t.canSubmit=!1,t}return n(t,e),Object.defineProperty(t.prototype,"Content",{get:function(){return this.Result.getChildByName("Content").getComponent(cc.RichText)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;l.LogHandler.inst.dumpFrameInfo();for(var t=0,o=this.TreasureRoot.children;t<o.length;t++){o[t].getChildByName("icon").opacity=0}var n=r.Game.getBubbleScore();console.log(n);for(var i=0,c=a.TreasurePool;i<c.length;i++){var s=c[i];n[s]&&(this.bonusScore+=n[s],this.bonus+=1)}switch(this.totalScore=r.Game.getScore(),this.gameScore=this.totalScore-this.bonusScore,this.scoreStep=Math.max(Math.floor(Math.min(this.totalScore/100,this.gameScore/100)),10),r.Game.Season){case a.Season.Autumn:this.Content.string=lan.t(u.En_View.JieSuanJieMian,u.En_ID.YouXiDeFen,["#fffc9f"]);break;case a.Season.Spring:this.Content.string=lan.t(u.En_View.JieSuanJieMian,u.En_ID.YouXiDeFen,["#fcffcb"]);break;case a.Season.Summer:this.Content.string=lan.t(u.En_View.JieSuanJieMian,u.En_ID.YouXiDeFen,["#ffe7c2"]);break;case a.Season.Winter:this.Content.string=lan.t(u.En_View.JieSuanJieMian,u.En_ID.YouXiDeFen,["#fbe19b"])}this.Submit.scale=0,this.Result.scale=0,this.Result.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1),cc.callFunc(this.showScore,this))),this.Submit.on(cc.Node.EventType.TOUCH_END,function(){e.canSubmit&&(e.submit||(console.log(" submit score by click:",r.Game.MatchInfo.matchId,", seed:",r.Game.MatchInfo.sharedRandomSeed),CELER_X&&celerSDK.submitScore(r.Game.getScore()),e.submit=!0))},this)},t.prototype.setTexture=function(e){this.Title.spriteFrame=e},t.prototype.showScore=function(){var e=this;c.gEventMgr.emit(s.GlobalEvent.PLAY_EFFECT,"over"),this.show=!0;for(var t=0,o=r.Game.getBubbleScore(),n=function(n){o[n]&&setTimeout(function(){e.TreasureRoot.getChildByName(n.toString()).getComponent(cc.Animation).play()},300*++t)},i=0,l=a.TreasurePool;i<l.length;i++){n(l[i])}},t.prototype.update=function(){var e=this;this.show&&(this.showGameScore<this.gameScore&&(this.showGameScore+=this.scoreStep,this.showGameScore=Math.min(this.showGameScore,this.gameScore),this.GameScore.string=this.showGameScore.toString()),this.showBonus<this.bonus&&(this.showBonus+=.1,this.showBonus=Math.min(this.showBonus,this.bonus),this.Bonus.string=Math.floor(this.showBonus).toString()),this.showBonusScore<this.bonusScore&&(this.showBonusScore+=this.scoreStep,this.showBonusScore=Math.min(this.showBonusScore,this.bonusScore),this.BonusScore.string=this.showBonusScore.toString()),this.showGameScore==this.gameScore&&this.showTotalScore<this.totalScore&&(this.showTotalScore+=this.scoreStep,this.showTotalScore=Math.min(this.totalScore,this.showTotalScore),this.FinalScore.string=this.showTotalScore.toString()),this.showTotalScore==this.totalScore&&(this.show=!1,this.Submit.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){e.canSubmit=!0,setTimeout(function(){e.submit||(console.log(" submit score by timeout:",r.Game.MatchInfo.matchId,", seed:",r.Game.MatchInfo.sharedRandomSeed),CELER_X&&celerSDK.submitScore(r.Game.getScore()),e.submit=!0)},3e3)},this)))))},i([d(cc.Node)],t.prototype,"Result",void 0),i([d(cc.Node)],t.prototype,"Submit",void 0),i([d(cc.Node)],t.prototype,"TreasureRoot",void 0),i([d(cc.Sprite)],t.prototype,"Title",void 0),i([d(cc.Label)],t.prototype,"FinalScore",void 0),i([d(cc.Label)],t.prototype,"GameScore",void 0),i([d(cc.Label)],t.prototype,"Bonus",void 0),i([d(cc.Label)],t.prototype,"BonusScore",void 0),t=i([p],t)}(cc.Component);o.default=f,cc._RF.pop()},{"./Const":"Const","./Controller/EventManager":"EventManager","./Controller/EventName":"EventName","./Controller/Game":"Game","./Utils/LogHandler":"LogHandler","./table":"table"}],ShooterLayer:[function(e,t,o){"use strict";cc._RF.push(t,"a86feZkxotMl5W4gIeRr5Ex","ShooterLayer");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Controller/EventManager"),a=e("./Controller/EventName"),c=e("./Bubble"),s=e("./BubbleMove"),l=e("./Controller/GameFactory"),u=e("./Controller/Game"),h=cc._decorator,p=h.ccclass,d=h.property,f=20,g={0:"bg_pointrainbow",1:"bg_pointblue",2:"bg_pointgreen",3:"bg_pointorange",4:"bg_pointpurple",5:"bg_pointred",6:"bg_pointyellow",7:"bg_pointhorse"},b={0:"bg_signrainbow",1:"bg_signblue",2:"bg_signgreen",3:"bg_signorange",4:"bg_signpurple",5:"bg_signred",6:"bg_signyellow",7:"bg_signhorse"},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShooterStar=null,t.Shooter=null,t.PointAtlas=null,t.Point=null,t.pointCount=f,t.isStart=!1,t}return n(t,e),t.prototype.onLoad=function(){this.ShooterStar.active=!1,this.Point.active=!1,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.start=function(){},t.prototype.updateStarPosition=function(e){var t=CMath.GetWorldPosition(this.Shooter),o=this.node.getParent().convertToNodeSpaceAR(e),n=CMath.getK(e,t);if(null===n){var i=t.y<=e.y?1:-1;this.ShooterStar.x=0,this.ShooterStar.y=o.y+150*i,this.updatePoint(n,i)}else{var r=Math.atan(n);i=t.x<=e.x?1:-1;this.ShooterStar.x=o.x+150*Math.cos(r)*i,this.ShooterStar.y=o.y+150*Math.sin(r)*i,this.updatePoint(n,i)}return e.sub(t)},t.prototype.updatePoint=function(e,t){for(;this.Point.childrenCount>this.pointCount;)l.gFactory.putPoint(this.Point.children[this.Point.childrenCount-1]);for(;this.Point.childrenCount<this.pointCount;)this.Point.addChild(l.gFactory.getPoint());var o=this.Point.childrenCount;if(null===e)for(var n=0;n<o;n++){(r=this.Point.children[n]).x=0,r.y=60*n*t,r.opacity=255-n/o*200,r.getComponent(cc.Sprite).spriteFrame=this.PointAtlas.getSpriteFrame(g[this.Shooter.children[0].getComponent(c.default).Color])}else{var i=Math.atan(e);for(n=0;n<o;n++){var r;(r=this.Point.children[n]).opacity=255-n/o*200,r.x=60*n*Math.cos(i)*t;for(var a=-1==t?1:2;Math.abs(r.x)>s.BorderX;)r.x-=(Math.abs(r.x)-s.BorderX)*Math.pow(-1,a++)*2;r.y=60*n*Math.sin(i)*t,r.getComponent(cc.Sprite).spriteFrame=this.PointAtlas.getSpriteFrame(g[this.Shooter.children[0].getComponent(c.default).Color])}}},t.prototype.onTouchStart=function(e){this.Shooter.childrenCount<=0?console.log(" shooter has no bubble"):(u.Game.isStart||this.isStart||(u.Game.isStart=!0,this.isStart=!0),u.Game.isStart?(this.updateStarPosition(e.getLocation()),this.ShooterStar.active=!0,this.Point.active=!0,this.ShooterStar.getComponent(cc.Sprite).spriteFrame=this.PointAtlas.getSpriteFrame(b[this.Shooter.children[0].getComponent(c.default).Color])):console.log(" game not start "))},t.prototype.onTouchMove=function(e){this.Shooter.childrenCount<=0||u.Game.isStart&&(this.ShooterStar.active=!0,this.Point.active=!0,this.ShooterStar.getComponent(cc.Sprite).spriteFrame=this.PointAtlas.getSpriteFrame(b[this.Shooter.children[0].getComponent(c.default).Color]),this.updateStarPosition(e.getLocation()))},t.prototype.onTouchEnd=function(e){if(u.Game.isStart)if(this.ShooterStar.active=!1,this.Point.active=!1,this.Shooter.childrenCount<=0)console.log(" shooter has no bubble, on touchend");else{var t=this.updateStarPosition(e.getLocation());this.ShooterStar.y>=-700?(console.log(" shoot vector :",t.x,",",t.y),r.gEventMgr.emit(a.GlobalEvent.SHOOT,t)):console.log(" \u53d1\u5c04\u89d2\u5ea6\u4e0d\u5728\u6709\u6548\u8303\u56f4")}else console.log(" on touch end ,is not start")},i([d(cc.Node)],t.prototype,"ShooterStar",void 0),i([d(cc.Node)],t.prototype,"Shooter",void 0),i([d(cc.SpriteAtlas)],t.prototype,"PointAtlas",void 0),i([d(cc.Node)],t.prototype,"Point",void 0),t=i([p],t)}(cc.Component);o.default=y,cc._RF.pop()},{"./Bubble":"Bubble","./BubbleMove":"BubbleMove","./Controller/EventManager":"EventManager","./Controller/EventName":"EventName","./Controller/Game":"Game","./Controller/GameFactory":"GameFactory"}],Signal:[function(e,t,o){"use strict";cc._RF.push(t,"e5f0b6e+W1MSreXM7nFlCQa","Signal");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listenerMap=[],t.onceListenerMap=[],t}return n(t,e),t.prototype.doDispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.excuteListener.apply(this,e),this.excuteOnce.apply(this,e)},t.prototype.excuteListener=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.listenerMap&&this.listenerMap.length>0)for(var o=0,n=this.listenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}},t.prototype.excuteOnce=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var o=0,n=this.onceListenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}this.onceListenerMap.length=0}},t.prototype.listen=function(e,t){this.listenerMap.push({callback:e,target:t})},t.prototype.listenOnce=function(e,t){this.onceListenerMap.push({callback:e,target:t})},t.prototype.removeListener=function(e,t){if(this.listenerMap&&this.listenerMap.length>0)for(var o=0;o<this.listenerMap.length;++o){var n=this.listenerMap[o];n.callback==e&&n.target==t&&(this.listenerMap.splice(o,1),--o)}},t.prototype.removeTarget=function(e){if(this.listenerMap&&this.listenerMap.length>0)for(var t=0;t<this.listenerMap.length;++t){this.listenerMap[t].target==e&&(this.listenerMap.splice(t,1),--t)}},t.prototype.dispatch=function(){this.doDispatch(null)},t.prototype.dispatchOne=function(e){this.doDispatch(e)},t.prototype.dispatchTwo=function(e,t){this.doDispatch(e,t)},t.prototype.dispatchThree=function(e,t,o){this.doDispatch(e,t,o)},t.prototype.dispatchFour=function(e,t,o,n){this.doDispatch(e,t,o,n)},t.prototype.dispatchFive=function(e,t,o,n,i){this.doDispatch(e,t,o,n,i)},t.prototype.addListener=function(e,t){this.listen(e,t)},t.prototype.addOnce=function(e,t){this.listenOnce(e,t)},t.prototype.addListenerOne=function(e,t){this.listen(e,t)},t.prototype.addListenerTwo=function(e,t){this.listen(e,t)},t.prototype.addListenerThree=function(e,t){this.listen(e,t)},t.prototype.addListenerFour=function(e,t){this.listen(e,t)},t.prototype.addListenerFive=function(e,t){this.listen(e,t)},t.prototype.addOnceOne=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceTwo=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceThree=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFour=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFive=function(e,t){this.listenOnce(e,t)},t}(e("./ToSingleton").SingleTon());o.BaseSignal=i,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],SingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"65515MWYjpOd7Z76x4YMonB","SingleTouchMediator");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return n(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){this.node.targetOff(this),this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.onUnregister=function(){this.node.targetOff(this)},t.prototype.touchStart=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch start  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();this.touchid=e.getID(),this.onTouchStart(e)},t.prototype.touchMove=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchMove(e)):e.stopPropagation()},t.prototype.touchEnd=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch end  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchEnd(e),this.OnClick()):e.stopPropagation()},t.prototype.touchCancel=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch cancel  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchCancel(e)):e.stopPropagation()},t.prototype.OnClick=function(){},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=i([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],SingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"5f7e70+ZMFBirKQ2EsFEQYu","SingleTouchView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./BaseView"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return n(t,e),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.start=function(){},t.prototype.touchStart=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchStart(e)):console.log(this.node.name," touch start  touchid is different! ")},t.prototype.touchMove=function(e){null!==this.touchid&&this.touchid!==e.getID()||(this.touchid=e.getID(),this.onTouchMove(e))},t.prototype.touchEnd=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchEnd(e)):console.log(this.node.name," touch end  touchid is different! ")},t.prototype.touchCancel=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchCancel(e)):console.log(this.node.name," touch cancel  touchid is different! ")},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=i([c],t)}(r.default));o.default=s,cc._RF.pop()},{"./BaseView":"BaseView"}],SkipButton:[function(e,t,o){"use strict";cc._RF.push(t,"d27deHURgRHkKYiE1yVPDaT","SkipButton");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Controller/EventManager"),a=e("./Controller/EventName"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,function(){r.gEventMgr.emit(a.GlobalEvent.HIDE_HELP)},this)},t.prototype.start=function(){},t.prototype.update=function(e){},t=i([s],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./Controller/EventManager":"EventManager","./Controller/EventName":"EventName"}],StepController:[function(e,t,o){"use strict";cc._RF.push(t,"09ac2ySMaBKF6e+GcvfUxR0","StepController"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.totalStep=[],this.curStep=[]}return Object.defineProperty(e,"inst",{get:function(){return this._ins?this._ins:this._ins=new e},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t){this.completeCallback=e,this.totalStep=t},e.prototype.nextStep=function(e){this.totalStep.indexOf(e)<0?console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",e):this.curStep.indexOf(e)>=0?console.error(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",e):(this.curStep.push(e),this.curStep.sort(function(e,t){return e>t?-1:1}),this.totalStep.sort(function(e,t){return e>t?-1:1}),console.log(" cur step:",this.curStep.join(",")),console.log(" total step:",this.totalStep.join(",")),this.curStep.join(",")==this.totalStep.join(",")&&(this.totalStep.length=0,this.completeCallback(),this.completeCallback=null))},e}();o.gStep=n.inst,cc._RF.pop()},{}],TableManager:[function(e,t,o){"use strict";cc._RF.push(t,"49c68YD7IFIspqffsN4qGNo","TableManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.load=e.JSON_URL&&""!=e.JSON_URL?cc.loader.load.bind(cc.loader):cc.loader.loadRes.bind(cc.loader),this.fileFormat=e.JSON_URL&&""!=e.JSON_URL?".json?time="+Date.now():"",this.total=0,this.complete=0,this.En={},this.Es={},this.Fil={},this.Id={},this.In={},this.Pt={},this.Tl={}}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.startLoad=function(t,o,n){this.completeCallback=o,this.progressCallback=n;var i=this;console.log("Base URL:",e.JSON_URL),this.load(e.JSON_URL+t.trim().split("/").join("")+"/file_list"+this.fileFormat,function(e,o){if(e)console.error(e.errorMessage);else{var n="Array"==o.constructor.name?o:o.json;this.total=n.length;for(var r=0,a=n;r<a.length;r++){var c=a[r];i.loadJson(t.trim().split("/").join("")+"/"+c.replace(".json",""))}}}.bind(this))},e.prototype.loadJson=function(t){console.log("start load:"+t);var o=this,n=t.split("/")[1];n=n.charAt(0).toUpperCase()+n.slice(1,n.length),this.load(e.JSON_URL+t+this.fileFormat,function(e,t){if(e)console.error(e.errorMessage);else{for(var i=0,r="Array"==t.constructor.name?t:t.json;i<r.length;i++){var a=r[i];o[n][a.ID]=a}o.completeLoad()}}.bind(this))},e.prototype.completeLoad=function(){this.complete++,this.progressCallback&&this.progressCallback(this.complete/this.total),this.complete>=this.total&&this.completeCallback&&this.completeCallback()},e.prototype.getEn=function(e){return this.En[e]?this.En[e]:(console.error("En \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_En_Data=function(){return this.En},e.prototype.getEs=function(e){return this.Es[e]?this.Es[e]:(console.error("Es \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Es_Data=function(){return this.Es},e.prototype.getFil=function(e){return this.Fil[e]?this.Fil[e]:(console.error("Fil \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Fil_Data=function(){return this.Fil},e.prototype.getId=function(e){return this.Id[e]?this.Id[e]:(console.error("Id \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Id_Data=function(){return this.Id},e.prototype.getIn=function(e){return this.In[e]?this.In[e]:(console.error("In \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_In_Data=function(){return this.In},e.prototype.getPt=function(e){return this.Pt[e]?this.Pt[e]:(console.error("Pt \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Pt_Data=function(){return this.Pt},e.prototype.getTl=function(e){return this.Tl[e]?this.Tl[e]:(console.error("Tl \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Tl_Data=function(){return this.Tl},e.JSON_URL="",e}();o.TableManager=n,cc._RF.pop()},{}],ToSingleton:[function(e,t,o){"use strict";cc._RF.push(t,"7cd590SSbxKTrWLJc8fpc7h","ToSingleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleTon=function(){return function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),e}()},cc._RF.pop()},{}],Treasure:[function(e,t,o){"use strict";cc._RF.push(t,"839c8WNoRJFOZY4LdvRkdlU","Treasure");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Controller/Game"),a=e("./Const"),c=e("./Controller/EventManager"),s=e("./Controller/EventName"),l=cc._decorator,u=l.ccclass,h=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isCollider=!0,t}return n(t,e),Object.defineProperty(t.prototype,"Self",{get:function(){return this.node.getChildByName("self")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Alpha",{get:function(){return this.node.getChildByName("alpha")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.node.group="default",this.node.opacity=255,this.Alpha.opacity=80,c.gEventMgr.on(s.GlobalEvent.CHECK_TREASURE,function(){r.Game.isStart&&e.checkCollider()},this)},t.prototype.update=function(){},t.prototype.checkCollider=function(){this.isCollider=!1;for(var e=r.Game.getMatrix(),t=r.Game.startIndex;t<e.data.length;t++)if(e.data[t]&&e.data[t].bubble&&e.data[t].bubble.node.active){var o=e.data[t].bubble;if(cc.Intersection.polygonCircle(this.getComponent(cc.PolygonCollider).points,{position:CMath.ConvertToNodeSpaceAR(o.node,this.node.getParent()),radius:o.getComponent(cc.CircleCollider).radius})){this.isCollider=!0;break}}this.isCollider||this.getTreasure()},t.prototype.getTreasure=function(){var e=this,t=CMath.ConvertToNodeSpaceAR(r.Game.TopNode.getChildByName("TreasureRoot").getChildByName(this.node.name),this.node.getParent()),o=CMath.Distance(t,this.node.position)/1500;this.enabled=!1,this.node.group="treasure",c.gEventMgr.emit(s.GlobalEvent.PLAY_EFFECT,"get_treasure"),this.Alpha.runAction(cc.sequence(cc.delayTime(.3),cc.spawn(cc.scaleTo(.2,5),cc.fadeOut(.2)))),this.Self.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.1,2),cc.delayTime(.3),cc.callFunc(function(){r.Game.addScore(a.BubbleType["Treasure_"+e.node.name],parseInt(e.node.name),parseInt(e.node.name)/200*.1+1,CMath.ConvertToNodeSpaceAR(e.Self,r.Game.TopNode))}),cc.scaleTo(.1,1),cc.moveTo(o,t),cc.fadeTo(.1,0),cc.callFunc(function(){c.gEventMgr.emit(s.GlobalEvent.GET_TREASURE,e.node.name),e.node.removeFromParent()})))},t=i([u],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./Const":"Const","./Controller/EventManager":"EventManager","./Controller/EventName":"EventName","./Controller/Game":"Game"}],WildAdAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"6a6b7Ded9ZMXIMUiUfkX56J","WildAdAnimation");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../utils/FrameAniBase"),a=e("../Utils/Signal"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal));o.WildAdAnimationIsPlaySignal=l;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isStart=!1,t}return n(t,e),t.prototype.onStartPlay=function(){var e=this;l.inst.dispatchOne(!0),0==this.isStart&&(this.isStart=!0,setTimeout(function(){e.isStart=!1,e.stop(),e.node.opacity=0,l.inst.dispatchOne(!1),setTimeout(function(){e.node.opacity=255,e.Loop=!0,e.play()},8e3)},2e3))},t.prototype.onComplete=function(){},t=i([s],t)}(r.default);o.default=u,cc._RF.pop()},{"../Utils/Signal":"Signal","../utils/FrameAniBase":"FrameAniBase"}],WildAdButton:[function(e,t,o){"use strict";cc._RF.push(t,"98acfoEYL1NWaV4RFQgolJw","WildAdButton");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Animation/WildAdAnimation"),a=e("./utils/Signal"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal));o.HideWildAdButtonSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.WildAdButtonClick=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(a.BaseSignal);o.WildButtonReadySignal=h;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultScale=.94,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.node.active=!1,this.node.scale=0,h.inst.addOnce(function(){console.log(" Wild button :",e.node.active),e.node.active&&(e.node.getComponent(cc.Button).transition=cc.Button.Transition.NONE,e.node.runAction(cc.sequence(cc.scaleTo(.1,e.defaultScale),cc.callFunc(function(){e.initial()}))))},this),l.inst.addListener(function(){e.node.active=!1},this)},t.prototype.initial=function(){var e=this;this.node.getComponent(cc.Button).transition=cc.Button.Transition.SCALE,this.node.on(cc.Node.EventType.TOUCH_END,function(){u.inst.dispatch()},this),r.WildAdAnimationIsPlaySignal.inst.addListenerOne(function(t){t?e.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.05*3,1.2),cc.scaleTo(.05*3,1)))):(e.node.stopAllActions(),e.node.scale=e.defaultScale)},this)},t=i([s],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./Animation/WildAdAnimation":"WildAdAnimation","./utils/Signal":"Signal"}],table:[function(e,t,o){"use strict";cc._RF.push(t,"743eeDwjhZI5a8K4WfdHCfH","table"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.En_ID||(o.En_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.En_View||(o.En_View={})),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.Es_ID||(o.Es_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.Es_View||(o.Es_View={})),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.Fil_ID||(o.Fil_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.Fil_View||(o.Fil_View={})),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.Id_ID||(o.Id_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.Id_View||(o.Id_View={})),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.In_ID||(o.In_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.In_View||(o.In_View={})),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.Pt_ID||(o.Pt_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.Pt_View||(o.Pt_View={})),function(e){e[e.XiaoMaQiuJiangLi=1]="XiaoMaQiuJiangLi",e[e.KanGuangGaoShiBai=2]="KanGuangGaoShiBai",e[e.ZanTingMiaoShu=3]="ZanTingMiaoShu",e[e.MianFeiZanTingCiShu=4]="MianFeiZanTingCiShu",e[e.ZanTingKouFen=5]="ZanTingKouFen",e[e.BangZhuYeMian1=6]="BangZhuYeMian1",e[e.BangZhuYeMian2=7]="BangZhuYeMian2",e[e.BangZhuYeMian3=8]="BangZhuYeMian3",e[e.BangZhuYeMian4=9]="BangZhuYeMian4",e[e.YouXiDeFen=10]="YouXiDeFen",e[e.BaoCangHuoDeGeShu=11]="BaoCangHuoDeGeShu",e[e.BaoCangDeFen=12]="BaoCangDeFen",e[e.ZuiZhongZongFen=13]="ZuiZhongZongFen"}(o.Tl_ID||(o.Tl_ID={})),function(e){e[e.ZanTingJieMian=100]="ZanTingJieMian",e[e.BangZhuJieMian=200]="BangZhuJieMian",e[e.GuangGaoJieMian=300]="GuangGaoJieMian",e[e.JieSuanJieMian=400]="JieSuanJieMian"}(o.Tl_View||(o.Tl_View={})),cc._RF.pop()},{}]},{},["AdLayer","FlyCnicornAd","FlyAdCnicornAniamtion","WildAdAnimation","Bubble","BubbleMove","Const","AdController","AudioController","EventManager","EventName","Game","GameFactory","StepController","BubbleMatrix","GameRule","GameScene","Guide","GuidePageLabel","LoadingImg","MenuButton","MenuLayer","ResultLayer","ShooterLayer","SkipButton","TableManager","Treasure","BaseMediator","BaseView","FrameAniBase","GameStateController","GlobalSingleTouchMediator","GlobalSingleTouchView","HashMap","LogHandler","Signal","SingleTouchMediator","SingleTouchView","ToSingleton","WildAdButton","table"]);