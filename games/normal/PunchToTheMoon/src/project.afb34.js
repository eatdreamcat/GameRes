window.__require=function e(t,n,i){function o(r,s){if(!n[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){return o(t[r][1][e]||e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({AchieveIcon:[function(e,t,n){"use strict";cc._RF.push(t,"45123KumJlIFbgtyATs0I1z","AchieveIcon"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Game","AchieveIcon")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Game",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Game","AchieveIcon").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Game")},t.prototype.onConstruct=function(){this.m_Icon=this.getChild("Icon"),this.m_Label=this.getChild("Label")},t.URL="ui://vmvonsvyx3z2tv",t}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],AltitudeBar:[function(e,t,n){"use strict";cc._RF.push(t,"051e5xfoCJDIJtMO2slRI3e","AltitudeBar"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Game","AltitudeBar")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Game",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Game","AltitudeBar").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Game")},t.prototype.onConstruct=function(){this.m_altitudeSlider=this.getChild("altitudeSlider"),this.m_rangeSlider=this.getChild("rangeSlider")},t.URL="ui://vmvonsvybvnmrt",t}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],AltitudeTag:[function(e,t,n){"use strict";cc._RF.push(t,"65a4cwbKFJOqo+uakuodSTf","AltitudeTag"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../Config/Config"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.root=null,t.world=null,t.isShow=!1,t}return __extends(t,e),t.prototype.onLoad=function(){i.gEventMgr.on(o.GlobalEvent.SYNC_ACHIEVE,this.updateHeight,this),i.gEventMgr.on(o.GlobalEvent.NEW_ENEMY,this.startGame,this)},t.prototype.start=function(){},t.prototype.startGame=function(){this.isShow=!1},t.prototype.updateHeight=function(e,t){if(!this.isShow){e=Math.max(e,0);var n="SolarRoot"==this.root.name?a.Config.Pexil2MeterSky:a.Config.Pexil2MeterGround,r=CMath.NumberFormat(Math.floor(e/n))+"m",s=t.node.parent.convertToWorldSpace(t.node.position),c=this.node.parent.convertToWorldSpace(this.node.position).mulSelf(this.root.scale),l=this.world.convertToNodeSpaceAR(s);this.world.convertToNodeSpaceAR(c).y<=l.y&&t.speed.y>0&&0==this.isShow&&(this.isShow=!0,i.gEventMgr.emit(o.GlobalEvent.SHOW_ACHIEVE_ICON,!0,this.node.name,r),console.warn(" ------------------------------------- \u6210\u5c31\uff1a",this.node.name," : ",r))}},__decorate([c(cc.Node)],t.prototype,"root",void 0),__decorate([c(cc.Node)],t.prototype,"world",void 0),t=__decorate([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../Config/Config":"Config","../Event/EventManager":"EventManager","../Event/EventName":"EventName"}],AudioController:[function(e,t,n){"use strict";cc._RF.push(t,"e558ctwViNCeaIBGBAYeN3x","AudioController"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Utils/HashMap"),o=e("../Event/EventManager"),a=e("../Event/EventName"),r=e("../Entity/GameMgr"),s=function(){function e(){this.curBgm=-1,this.curBgmName="",this.clips=new i.HashMap}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){console.warn(" start load AudioClip ");var t=this;cc.loader.loadResDir("AudioClip",cc.AudioClip,function(n,i,o){if(n)console.error(n);else{for(var a=0,r=i;a<r.length;a++){var s=r[a];t.clips.add(s.name,s)}t.initEvent(),e&&e()}})},e.prototype.initEvent=function(){var e=this;o.gEventMgr.targetOff(this),this.curBgm=this.play("normal_bgm",!0,.7,!0),this.curBgmName="normal_bgm",o.gEventMgr.on(a.GlobalEvent.UPDATE_HP,function(){console.log(" cur hp percent:",r.Game.getHpPercent(),e.curBgmName),r.Game.getHpPercent()<=30?"super_bgm"!=e.curBgmName&&(e.curBgm>=0&&e.stop(e.curBgmName,e.curBgm),e.curBgm=e.play("super_bgm",!0,.7,!0),e.curBgmName="super_bgm"):"normal_bgm"!=e.curBgmName&&(e.curBgm>=0&&e.stop(e.curBgmName,e.curBgm),e.curBgm=e.play("normal_bgm",!0,.7,!0),e.curBgmName="normal_bgm")},this),o.gEventMgr.on(a.GlobalEvent.PLAY_XP,function(){e.play("xp_effect")},this),o.gEventMgr.on(a.GlobalEvent.QTE_ATTACK_1,function(){e.play("qte_1")},this),o.gEventMgr.on(a.GlobalEvent.QTE_ATTACK_2,function(){e.play("qte_2")},this),o.gEventMgr.on(a.GlobalEvent.NORMAL_PUNCH,function(){e.play("long_jiao")},this),o.gEventMgr.on(a.GlobalEvent.ENEMY_ATTACK,function(){e.play(r.Game.curEnemy.mod+"_attack")},this),o.gEventMgr.on(a.GlobalEvent.ENEMY_HIT,function(){e.play(r.Game.curEnemy.mod+"_hit")},this),o.gEventMgr.on(a.GlobalEvent.LONG_DAMAGE_POINT,function(){e.play("long_attack"),e.play(r.Game.curEnemy.mod+"_hit")},this),o.gEventMgr.on(a.GlobalEvent.PLAYER_HIT,function(){e.play("hit")},this),o.gEventMgr.on(a.GlobalEvent.ENEMY_HIT_OUT,function(){e.play("kick_away")},this),o.gEventMgr.on(a.GlobalEvent.MISS_PUNCH,function(){e.play("miss_punch")},this),o.gEventMgr.on(a.GlobalEvent.SHOW_ACHIEVE_ICON,function(t,n,i){void 0===n&&(n=""),void 0===i&&(i=""),t&&"3000m"==n&&e.play("flyBoat")},this)},e.prototype.stop=function(t,n){if(e.canPlay)cc.audioEngine.stop(n);else for(var i=0,o=e.PlayedList;i<o.length;i++){var a=o[i];a.skip=a.clipName==t}},e.prototype.play=function(t,n,i,o){if(void 0===n&&(n=!1),void 0===i&&(i=1),void 0===o&&(o=!1),!e.canPlay&&!e.hasBindTouch){e.hasBindTouch=!0;var a=this,r=function(){var t;for(cc.game.canvas.removeEventListener("touchstart",r),e.canPlay=!0;(t=e.PlayedList.pop())&&a.clips.get(t.clipName)&&!t.skip;){var n=cc.audioEngine.play(a.clips.get(t.clipName),t.loop,t.volume);t.isBgm?(a.curBgm=n,cc.audioEngine.setCurrentTime(n,(Date.now()-t.supTime)/1e3%cc.audioEngine.getDuration(n))):cc.audioEngine.setCurrentTime(n,(Date.now()-t.supTime)/1e3)}};cc.game.canvas.addEventListener("touchstart",r)}return this.clips.get(t)?e.canPlay?cc.audioEngine.play(this.clips.get(t),n,i):(e.PlayedList.push({clipName:t,loop:n,volume:i,supTime:Date.now(),skip:!1,isBgm:o}),-2):-1},e.PlayedList=[],e.canPlay=cc.sys.os.toLowerCase()!=cc.sys.OS_IOS.toLowerCase(),e.hasBindTouch=!1,e}();n.gAudio=s.inst,cc._RF.pop()},{"../Entity/GameMgr":"GameMgr","../Event/EventManager":"EventManager","../Event/EventName":"EventName","../Utils/HashMap":"HashMap"}],Base:[function(e,t,n){"use strict";cc._RF.push(t,"7744a1YYZVMsL0N3JZWWKL+","Base"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../Config/Config"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minScale=.03,t.heightLimit=cc.winSize.height*a.Config.BaseHeightLimit,t.moveFactor=0,t.speedY=0,t.baseBg=null,t.grass=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.opacity=255,i.gEventMgr.on(o.GlobalEvent.SCALE_SCENE,this.scaleScene,this)},t.prototype.scaleScene=function(e,t,n){this.speedY=this.moveFactor*e;var i=Math.max(0,1-t/this.heightLimit),o=this.minScale;i<this.minScale&&this.node.opacity<=50?(this.node.scale-=3e-5,o=0):this.node.scale=i;var r=Math.max(cc.winSize.height,t-cc.winSize.height*a.Config.OpacityFactorLimit);this.node.opacity=255*cc.winSize.height/r,this.node.scale=CMath.Clamp(this.node.scale,1,o),this.baseBg.opacity=this.node.opacity,this.grass.opacity=.9*this.node.opacity},t.prototype.start=function(){},t.prototype.update=function(e){},__decorate([c(cc.Node)],t.prototype,"baseBg",void 0),__decorate([c(cc.Node)],t.prototype,"grass",void 0),t=__decorate([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../Config/Config":"Config","../Event/EventManager":"EventManager","../Event/EventName":"EventName"}],Boom:[function(e,t,n){"use strict";cc._RF.push(t,"13a00UQRMdDWZpj6Sw8C11H","Boom"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Enemy"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.enemy=null,t}return __extends(t,e),t.prototype.boom=function(){this.enemy.isToTheMoon&&(this.enemy.speed.y=-6e4)},t.prototype.start=function(){},__decorate([r(i.default)],t.prototype,"enemy",void 0),t=__decorate([a],t)}(cc.Component);n.default=s,cc._RF.pop()},{"./Enemy":"Enemy"}],ButterFlySpring:[function(e,t,n){"use strict";cc._RF.push(t,"00ebeNacGtCZYnQZk+sHqkH","ButterFlySpring"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.material=new i.ButterflySpringMaterial,t.time=0,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this.getComponent(cc.Sprite);e&&(e._spriteMaterial=this.material,e._activateMaterial())},t.prototype.start=function(){},t.prototype.update=function(e){this.time+=10*e},t=__decorate([a],t)}(cc.Component));n.default=r,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],CameraController:[function(e,t,n){"use strict";cc._RF.push(t,"f6d660an69HtZK2e/g3qrOR","CameraController"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../Config/Config"),r=function(){function e(){this.minZoomRatio=.03,this.maxMoveYRatio=10,this.disabled=!1,this.zoomRatioSense=1,this.isEnableCameraZoom=!0,this.MainCamera=null,this.UICamera=null,this.PlayerCamera=null,this.EnemyCamera=null,this.target=null,this.enableFollow=!0,this.canZoomOut=!0,cc.director.on(cc.Director.EVENT_AFTER_UPDATE,this.lateUpdate.bind(this),this)}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.shake=function(e){void 0===e&&(e=1),console.log(" shake !!!!!!!!!!!!!!!!");var t=cc.sequence(cc.moveBy(.03*e,cc.v2(25,0)),cc.moveBy(.06*e,cc.v2(-50,0)),cc.moveBy(.03*e,cc.v2(25,0))),n=cc.repeat(t,5);this.MainCamera.node.runAction(n)},e.prototype.initCamera=function(){i.gEventMgr.on(o.GlobalEvent.XP_BEGIN,this.xpBegin,this),i.gEventMgr.on(o.GlobalEvent.XP_END,this.xpEnd,this)},e.prototype.zoomIn=function(){this.enableFollow=!1,this.MainCamera.node.stopActionByTag(101);var e=cc.moveTo(.4,cc.v2(0,360));e.setTag(100),this.MainCamera.node.runAction(e)},e.prototype.zoomOut=function(){if(this.canZoomOut&&!CAMERA_SHOW_ALL){var e=cc.moveTo(.2,cc.v2(0,0));e.setTag(101),this.MainCamera.node.stopActionByTag(100),this.MainCamera.node.runAction(e),this.enableFollow=!0}},e.prototype.bindUICamera=function(e){this.UICamera=e},e.prototype.bindMainCamera=function(e){this.MainCamera=e},e.prototype.bindPlayerCamera=function(e){this.PlayerCamera=e},e.prototype.bindEnemyCamera=function(e){this.EnemyCamera=e},e.prototype.setTarget=function(e){CAMERA_SHOW_ALL||(this.target=e,this.target||this.readyRocket(!1))},e.prototype.readyRocket=function(e){CAMERA_SHOW_ALL||this.enableFollow!=!e&&(console.log("enable follow:"+this.enableFollow),e?this.zoomIn():this.zoomOut())},e.prototype.enemyAttack=function(){this.EnemyCamera.depth>this.PlayerCamera.depth||(console.log(" enemy attack camera!!!!!!!!!"),this.EnemyCamera.depth=1,this.PlayerCamera.depth=0)},e.prototype.playerAttack=function(){this.EnemyCamera.depth<this.PlayerCamera.depth||(this.EnemyCamera.depth=0,this.PlayerCamera.depth=1)},e.prototype.xpBegin=function(){console.log(" !!!!!!!!!!!!!!!!!!!!!!!!!!!!! xp begin !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),this.EnemyCamera.depth=11},e.prototype.xpEnd=function(){console.log(" !!!!!!!!!!!!!!!!!!!!!!!!!!!!! xp end !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),this.EnemyCamera.depth=1},e.prototype.syncCamera=function(){this.PlayerCamera.zoomRatio=this.MainCamera.zoomRatio,this.PlayerCamera.node.x=this.MainCamera.node.x,this.PlayerCamera.node.y=this.MainCamera.node.y,this.EnemyCamera.zoomRatio=this.MainCamera.zoomRatio,this.EnemyCamera.node.x=this.MainCamera.node.x,this.EnemyCamera.node.y=this.MainCamera.node.y},e.prototype.lateUpdate=function(){if(!this.disabled&&this.MainCamera&&this.MainCamera.node&&this.UICamera&&this.UICamera.node)return CAMERA_SHOW_ALL||!this.enableFollow?(this.MainCamera.zoomRatio>.5&&(this.MainCamera.zoomRatio-=.03,this.MainCamera.zoomRatio=this.MainCamera.zoomRatio<.5?.5:this.MainCamera.zoomRatio),void this.syncCamera()):this.target&&this.target.isValid?void this.syncMainCamera():(this.MainCamera.zoomRatio<1?this.MainCamera.zoomRatio+=.05:this.MainCamera.zoomRatio>1&&(this.MainCamera.zoomRatio-=.05),this.MainCamera.zoomRatio=CMath.Clamp(this.MainCamera.zoomRatio,1,0),void this.syncCamera())},e.prototype.syncMainCamera=function(){var e=.5*a.Config.EnemyRealMaxHeight;this.target.y>e?this.MainCamera.node.y=this.target.y-e:this.MainCamera.node.y=0,this.syncCamera()},e}();n.gCamera=r.inst,cc._RF.pop()},{"../Config/Config":"Config","../Event/EventManager":"EventManager","../Event/EventName":"EventName"}],Config:[function(e,t,n){"use strict";cc._RF.push(t,"eb447veLk1FD49yF65cvqPa","Config"),Object.defineProperty(n,"__esModule",{value:!0}),n.Config={isMultiPlayer:!1,FPS:60,AUTO_TOSS:!1,BaseHeightLimit:1.5,OpacityFactorLimit:1.5,PhyTimes:10,PlayerID:7e4,TotalPower:50,PowerAdd:10,XP_UP_RATE:1,XP_DOWN_RATE:5,Pexil2MeterGround:100,Pexil2MeterSky:10,EnemyRealMaxHeight:600,SlowdownPoint:1280,Height2Score:1},cc._RF.pop()},{}],Enemy:[function(e,t,n){"use strict";cc._RF.push(t,"956e6Rq+CNAdoMYMuFS51KT","Enemy"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../Controller/CameraController"),r=e("../Config/Config"),s=e("./GameMgr"),c=e("../TableMgr"),l=e("../Controller/UIManager"),u=e("../UI/export/Window/OverWindow"),h=e("../UI/OverWinUI"),p=cc._decorator,m=p.ccclass,d=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startHeight=0,t.firstTossHeight=0,t.tossRange=n.tossRange.x,t.tossRangeMin=n.tossRange.y,t.y=0,t.x=0,t.inity=0,t.idlePoint=-501,t.diePoint=-600,t.tossStart=0,t.fly=null,t.upFrame=null,t.downFrame=null,t.boom=null,t.ground=null,t.gravity=cc.v2(0,-6e3),t.minScale=.2,t.tossMinNode=null,t.tossMaxNode=null,t.timeScale=1,t.ready=!1,t.speed=cc.v2(0,0),t.spine=null,t.isQteFailed=!1,t.isToTheMoon=!1,t.hp=0,t.xpTimes=2,t.clickCount=1e4,t.clickTime=2,t.count=0,t}var n;return __extends(t,e),n=t,Object.defineProperty(t.prototype,"Spine",{get:function(){return this.spine?this.spine:this.spine=this.getComponent(sp.Skeleton)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;s.Game.enemyClass=this,this.tossMinNode.y=this.tossRangeMin-this.tossMaxNode.parent.y,a.gCamera.setTarget(this.node),this.Spine.setCompleteListener(this.onComplete.bind(this)),this.Spine.setEventListener(this.eventListener.bind(this)),this.node.x=850,this.inity=this.node.y,this.idlePoint=this.node.y,i.gEventMgr.on(o.GlobalEvent.NEW_ENEMY,this.startGame,this),i.gEventMgr.on(o.GlobalEvent.ENEMY_HIT_OUT,this.enemyHitOut,this),i.gEventMgr.on(o.GlobalEvent.ENEMY_HIT,this.hit,this),i.gEventMgr.on(o.GlobalEvent.QTE_FAILED,this.qteFailed,this),i.gEventMgr.on(o.GlobalEvent.ENEMY_ROTATE,this.enemyRotate,this),this.fly.getComponent(cc.Animation).on(cc.Animation.EventType.FINISHED,function(){s.Game.canGetTool=!1},this),this.boom.on(cc.Animation.EventType.FINISHED,function(){e.boom.node.active=!1},this),this.setMix()},t.prototype.enemyRotate=function(){this.speed.y<=0||s.Game.rotateCD>0||(s.Game.rotateCD=1,this.fly.getComponent(cc.Animation).play(this.enemyData.mod+"_rotate",0),s.Game.canGetTool=!0)},t.prototype.setMix=function(){for(var e=this.Spine.skeletonData.skeletonJson.animations,t=0,n=e;t<n.length;t++)for(var i=n[t],o=0,a=e;o<a.length;o++){var r=a[o];i!=r&&this.Spine.setMix(r,i,.2)}},t.prototype.startGame=function(e){this.enemyData=e,this.tossRange=0,this.node.x=700,this.xpTimes=2,s.Game.canGetTool=!1,s.Game.isCanAutoToss=!1,s.Game.isPerfectAutoToss=!1,this.node.y=this.inity;var t=e.kg/s.Game.playerData.kg;this.gravity.y=n.Gravity*t,this.firstTossHeight=n.FirstTossHeight*t,this.hp=e.hp_1,this.isToTheMoon=!1,this.boom.node.active=!1,i.gEventMgr.emit(o.GlobalEvent.UPDATE_RANGE_VALUE,0),i.gEventMgr.emit(o.GlobalEvent.UPDATE_ENEMY_HP,this.hp/this.enemyData.hp_1*100,this.hp),this.startHeight=this.node.y,this.tossStart=this.node.y,this.y=this.node.y,this.x=this.node.x;var a=this;this.count=0,cc.loader.loadRes("Texture/"+e.mod+"_down",cc.SpriteFrame,function(e,t){e?console.error(e):(a.downFrame=t,a.Count++)}),cc.loader.loadRes("Texture/"+e.mod+"_up",cc.SpriteFrame,function(e,t){e?console.error(e):(a.upFrame=t,a.Count++)}),cc.loader.loadRes("spine/"+e.mod,sp.SkeletonData,function(e,t){e?console.error(e):(a.Spine.skeletonData=t,a.Count++)})},Object.defineProperty(t.prototype,"Count",{get:function(){return this.count},set:function(e){this.count=e,console.log(" ---------- count:",e),this.count>=3&&(this.count=0,this.startMove())},enumerable:!0,configurable:!0}),t.prototype.startMove=function(){i.gEventMgr.emit(o.GlobalEvent.PXIEL_ENABLE),this.playAnimation("run",!0),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.fadeIn(0),cc.moveTo(1.5,50,this.inity),cc.callFunc(this.attack,this))),this.isQteFailed=!1},t.prototype.qteFailed=function(){this.isQteFailed=!0,a.gCamera.enemyAttack(),this.playAnimation("attack",!1)},t.prototype.enemyBePunched=function(e,t){if(void 0===t&&(t=!1),!(this.hp<=0))return this.hp+=e,this.hp<=0&&(this.hp=0,i.gEventMgr.emit(o.GlobalEvent.ENEMY_DIE,t),t&&a.gCamera.shake(),this.boom.node.active=!0,this.boom.play("boom",0),this.fly.enabled=!1),i.gEventMgr.emit(o.GlobalEvent.UPDATE_ENEMY_HP,this.hp/this.enemyData.hp_1*100,this.hp),this.hp>0},t.prototype.eventListener=function(e,t){switch(t.stringValue){case"attack1":this.isQteFailed&&s.Game.addHp(-this.enemyData.attack_1),i.gEventMgr.emit(o.GlobalEvent.PLAYER_HIT,t.stringValue);break;case"attack2":i.gEventMgr.emit(o.GlobalEvent.PLAYER_HIT,t.stringValue),this.isQteFailed&&s.Game.addHp(-this.enemyData.attack_1)}},t.prototype.hit=function(){this.playAnimation("hit",!1)},t.prototype.enemyHitOut=function(){this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(.2,650,this.inity),cc.callFunc(this.nextEnemy,this)))},t.prototype.enemyDieOut=function(){s.Game.tossTimes=0,s.Game.canToss=!1,this.flyDown(),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.fadeOut(0),cc.moveTo(0,650,this.inity),cc.fadeIn(0),cc.callFunc(this.nextEnemy,this)))},t.prototype.toTheMoon=function(){s.Game.tossTimes=0,s.Game.canToss=!1,this.node.stopAllActions(),this.node.runAction(cc.fadeOut(3)),this.speed.y>0&&(this.speed.y=0),this.timeScale=r.Config.XP_DOWN_RATE,this.enemyBePunched(-this.hp,!0)},t.prototype.nextEnemy=function(){s.Game.nextLevel(),this.timeScale=1,s.Game.isGameOver&&l.UIMgr.openWindow(u.default,h.default)},t.prototype.attack=function(){this.playAnimation("idle",!0),s.Game.canToss=!0,s.Game.qteTimes=1,i.gEventMgr.emit(o.GlobalEvent.PUNCH_READY,!1,!0),this.toss(!1,!1)},t.prototype.playAnimation=function(e,t){this.Spine.enabled=!0,this.fly.enabled=!1,this.Spine.animation==e&&"hit"!=e||(this.Spine.loop=t,this.Spine.animation=e)},t.prototype.addSpeed=function(e){this.speed.addSelf(e)},t.prototype.applySpeed=function(e){this.speed=e},t.prototype.start=function(){},t.prototype.onComplete=function(e){switch(e.animation.name){case"attack":this.isQteFailed||(this.playAnimation("idle",!0),this.node.zIndex=0,i.gEventMgr.emit(o.GlobalEvent.PLAYER_START_PUNCH))}},t.prototype.toss=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),!s.Game.canToss||this.hp<=0)return!1;var a=c.TableMgr.inst.getPunch_the_moon_speed(0==s.Game.tossTimes?1:s.Game.tossTimes);a?(this.tossRange=a.range,!t&&this.clickCount>=this.clickTime&&a.rangeMax&&this.speed.y<0&&this.y<=a.rangeMax&&this.y>=this.tossRangeMin&&(s.Game.isCanAutoToss=!0,s.Game.isPerfectAutoToss=this.y<=.4*a.rangeMax,console.log("speedRate:",s.Game.isPerfectAutoToss,this.y,.6*a.rangeMax)),this.clickCount=0):this.tossRange=n.tossRange.x,this.tossMaxNode.y=this.tossRange-this.tossMaxNode.parent.y;var l=!1;if(this.xpTimes=e?Math.max(2,s.Game.tossTimes+1):1,Math.abs(this.speed.y)<.01){var u=Math.sqrt(2*c.TableMgr.inst.getPunch_the_moon_speed(1).height*Math.abs(this.gravity.y));this.speed.y=u,i.gEventMgr.emit(o.GlobalEvent.LONG_DAMAGE_POINT)}else{if(!(this.speed.y<0&&this.y<=this.tossRange*this.xpTimes&&this.y>=this.tossRangeMin*this.xpTimes))return s.Game.isPunched=!1,!1;i.gEventMgr.emit(o.GlobalEvent.LONG_DAMAGE_POINT);u=0;u=a?Math.sqrt(2*a.height*Math.abs(this.gravity.y)):Math.sqrt(2*s.Game.maxHeight*Math.abs(this.gravity.y)),this.speed.y=u,this.node.y<=this.tossRange&&this.node.y>=.6*this.tossRange&&!e&&(console.log(" perfect toss"),i.gEventMgr.emit(o.GlobalEvent.PERFECT_TOSS),s.Game.addPower(r.Config.PowerAdd),l=!0)}if(s.Game.isPunched=!0,console.error(" is use xp:"+e,"speed:",this.speed.y),e){u=Math.sqrt(5*s.Game.maxHeightLimit*2*Math.abs(this.gravity.y));this.speed.y=u,this.timeScale=r.Config.XP_UP_RATE,i.gEventMgr.emit(o.GlobalEvent.XP_BEGIN)}else this.timeScale=1,s.Game.addHp(-2);return this.enemyBePunched(-s.Game.playerData.attack_1)?(i.gEventMgr.emit(o.GlobalEvent.TOSS),this.tossStart=this.y,s.Game.tossTimes++,e?(s.Game.maxHeight=s.Game.maxHeightLimit,s.Game.addPower(-s.Game.totalPower),s.Game.addHp(30)):(s.Game.maxHeight=Math.abs(this.speed.y*this.speed.y/(2*this.gravity.y)),s.Game.maxHeight>s.Game.maxHeightLimit&&(s.Game.maxHeight=s.Game.maxHeightLimit)),i.gEventMgr.emit(o.GlobalEvent.UPDATE_RANGE_VALUE,0==s.Game.maxHeight?0:Math.max(this.tossRange-this.tossStart,0)/s.Game.maxHeight),console.warn(" speedRate: ",a,s.Game.maxHeight),l):(this.speed.y=300,s.Game.addScore(this.enemyData.score),this.enemyDieOut(),l)},t.prototype.updateLogic=function(e){var t=this.speed.mul(e).add(this.gravity.mul(.5*e*e));return this.x+=t.x,this.y+=t.y,this.speed.addSelf(this.gravity.mul(e)),t},t.prototype.update=function(e){if(!s.Game.paused){this.clickCount+=e,s.Game.rotateCD>0&&(s.Game.rotateCD-=e,s.Game.rotateCD=Math.max(0,s.Game.rotateCD));for(var t=r.Config.PhyTimes*(s.Game.tossTimes+1),c=t,l=0,u=0;c-- >0;){(s.Game.isCanAutoToss||r.Config.AUTO_TOSS)&&!s.Game.QTE&&this.y<=(s.Game.isPerfectAutoToss?this.tossRange:.6*this.tossRange)&&this.hp>0&&s.Game.canToss&&(i.gEventMgr.emit(o.GlobalEvent.PUNCH_READY,!1),this.toss(!1,!0),s.Game.isCanAutoToss=!1,s.Game.isPerfectAutoToss=!1);this.updateLogic(e/t*this.timeScale);this.speed.y<=0&&(s.Game.isPunched=!1),this.y<=this.tossRange*Math.max(2,this.xpTimes)&&this.node.y>=.8*this.tossRangeMin&&this.speed.y<0&&this.hp>s.Game.playerData.attack_1?i.gEventMgr.emit(o.GlobalEvent.SHOW_XP_BUTTON,!0):i.gEventMgr.emit(o.GlobalEvent.SHOW_XP_BUTTON,!1),this.y<=this.idlePoint&&this.Spine.enabled&&(this.y=this.idlePoint,this.applySpeed(cc.v2(0,0))),this.node.y<n.HitPoint&&!this.Spine.enabled&&s.Game.tossTimes>=1&&s.Game.qteTimes>0&&(s.Game.addHp(-this.enemyData.attack_1),s.Game.addScore(.5*this.enemyData.score),s.Game.qteTimes=0,this.speed.y=100,i.gEventMgr.emit(o.GlobalEvent.PLAYER_HIT)),this.y<=this.diePoint&&!this.Spine.enabled&&(this.y=this.diePoint,this.applySpeed(cc.v2(0,0)),s.Game.tossTimes>=1?this.enemyBePunched(-this.enemyData.hp_1)||(this.enemyDieOut(),i.gEventMgr.emit(o.GlobalEvent.MISS_PUNCH)):this.isToTheMoon&&(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(0,650,this.inity),cc.fadeIn(0))),i.gEventMgr.emit(o.GlobalEvent.TO_THE_MOON),this.isToTheMoon=!1)),this.node.y=this.y,this.node.y>=r.Config.EnemyRealMaxHeight&&(this.node.y=r.Config.EnemyRealMaxHeight),a.gCamera.syncMainCamera(),l=Math.ceil(this.y-this.tossStart),u=Math.floor(this.y-this.startHeight),l>=s.Game.maxHeightLimit&&!this.isToTheMoon&&(this.isToTheMoon=!0,s.Game.addScore(2*this.enemyData.score),i.gEventMgr.emit(o.GlobalEvent.XP_END)),this.isToTheMoon&&this.toTheMoon(),i.gEventMgr.emit(o.GlobalEvent.UPDATE_HEIGHT,0==s.Game.maxHeight?0:l/s.Game.maxHeight*100,u,this.speed.y,0==s.Game.maxHeight?0:Math.max(this.tossRange-this.tossRangeMin,0)/s.Game.maxHeight*100,this.ground&&this.ground.scale<=.1),i.gEventMgr.emit(o.GlobalEvent.SCALE_SCENE,this.speed.y,this.y,s.Game.maxHeight),i.gEventMgr.emit(o.GlobalEvent.SYNC_ACHIEVE,u,this),this.speed.y>0&&this.node.y>0?this.flyUp():this.speed.y<0&&s.Game.tossTimes>=1?this.flyDown():this.hp>0&&this.ready&&this.playAnimation("idle",!0)}this.node.scale=1-(this.y-this.startHeight)/(2.5*cc.winSize.height),this.node.scale=CMath.Clamp(this.node.scale,1,this.minScale),this.boom.node.scale=1/this.node.scale,s.Game.tossTimes>=1&&(this.node.x*=this.node.scale)}},t.prototype.flyUp=function(){this.fly.spriteFrame==this.upFrame&&0==this.Spine.enabled||(this.fly.spriteFrame=this.upFrame,this.Spine.enabled=!1,this.fly.enabled=this.hp>0,a.gCamera.enemyAttack(),i.gEventMgr.emit(o.GlobalEvent.PXIEL_ENABLE))},t.prototype.flyDown=function(){this.fly.spriteFrame==this.downFrame&&0==this.Spine.enabled||(this.fly.spriteFrame=this.downFrame,this.Spine.enabled=!1,this.fly.enabled=this.hp>0,a.gCamera.enemyAttack(),i.gEventMgr.emit(o.GlobalEvent.PXIEL_ENABLE))},t.tossRange=cc.v2(750,-450),t.perfectTossRange=cc.v2(750,300),t.xpShowRange=400,t.autoTossStartPoint=100,t.Gravity=-3e3,t.FirstTossHeight=1500,t.HitPoint=-480,__decorate([d(cc.Sprite)],t.prototype,"fly",void 0),__decorate([d(cc.SpriteFrame)],t.prototype,"upFrame",void 0),__decorate([d(cc.SpriteFrame)],t.prototype,"downFrame",void 0),__decorate([d(cc.Animation)],t.prototype,"boom",void 0),__decorate([d(cc.Node)],t.prototype,"ground",void 0),__decorate([d(cc.Float)],t.prototype,"minScale",void 0),__decorate([d(cc.Node)],t.prototype,"tossMinNode",void 0),__decorate([d(cc.Node)],t.prototype,"tossMaxNode",void 0),t=n=__decorate([m],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../Config/Config":"Config","../Controller/CameraController":"CameraController","../Controller/UIManager":"UIManager","../Event/EventManager":"EventManager","../Event/EventName":"EventName","../TableMgr":"TableMgr","../UI/OverWinUI":"OverWinUI","../UI/export/Window/OverWindow":"OverWindow","./GameMgr":"GameMgr"}],EventManager:[function(e,t,n){"use strict";cc._RF.push(t,"08087AgT2lFU4a4ivbGEBGM","EventManager"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(){this.eventTarget=new cc.EventTarget}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.emit=function(e,t,n,i,o,a){this.eventTarget.emit(e.toString(),t,n,i,o,a)},e.prototype.on=function(e,t,n,i){return this.eventTarget.on(e.toString(),t,n,i)},e.prototype.once=function(e,t,n){this.eventTarget.once(e.toString(),t,n)},e.prototype.dispatchEvent=function(e){this.eventTarget.dispatchEvent(e)},e.prototype.off=function(e,t,n){this.eventTarget.off(e.toString(),t,n)},e.prototype.hasEventListener=function(e){return this.eventTarget.hasEventListener(e.toString())},e.prototype.targetOff=function(e){this.eventTarget.targetOff(e)},e}();n.gEventMgr=i.inst,cc._RF.pop()},{}],EventName:[function(e,t,n){"use strict";cc._RF.push(t,"1adc6DjmVtFpaWu1lI0FvRv","EventName"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.PXIEL_ENABLE=0]="PXIEL_ENABLE",e[e.PUNCH_READY=1]="PUNCH_READY",e[e.PUNCH=2]="PUNCH",e[e.UPDATE_HEIGHT=3]="UPDATE_HEIGHT",e[e.SCALE_SCENE=4]="SCALE_SCENE",e[e.TOSS=5]="TOSS",e[e.UPDATE_HP=6]="UPDATE_HP",e[e.UPDATE_SCORE=7]="UPDATE_SCORE",e[e.UPDATE_POWER=8]="UPDATE_POWER",e[e.ENEMY_DIE=9]="ENEMY_DIE",e[e.MISS_PUNCH=10]="MISS_PUNCH",e[e.PLAYER_START_PUNCH=11]="PLAYER_START_PUNCH",e[e.QTE=12]="QTE",e[e.QTE_OVER=13]="QTE_OVER",e[e.QTE_SUCCESS=14]="QTE_SUCCESS",e[e.QTE_FAILED=15]="QTE_FAILED",e[e.NEW_ENEMY=16]="NEW_ENEMY",e[e.ENEMY_HIT_OUT=17]="ENEMY_HIT_OUT",e[e.PLAYER_HIT=18]="PLAYER_HIT",e[e.ENEMY_HIT=19]="ENEMY_HIT",e[e.UPDATE_ENEMY_HP=20]="UPDATE_ENEMY_HP",e[e.SHOW_XP_BUTTON=21]="SHOW_XP_BUTTON",e[e.TO_THE_MOON=22]="TO_THE_MOON",e[e.XP_RESUME=23]="XP_RESUME",e[e.XP_BEGIN=24]="XP_BEGIN",e[e.XP_END=25]="XP_END",e[e.SYNC_ACHIEVE=26]="SYNC_ACHIEVE",e[e.SHOW_ACHIEVE_ICON=27]="SHOW_ACHIEVE_ICON",e[e.QTE_ATTACK_1=28]="QTE_ATTACK_1",e[e.QTE_ATTACK_2=29]="QTE_ATTACK_2",e[e.PLAY_XP=30]="PLAY_XP",e[e.NORMAL_PUNCH=31]="NORMAL_PUNCH",e[e.ENEMY_ATTACK=32]="ENEMY_ATTACK",e[e.LONG_DAMAGE_POINT=33]="LONG_DAMAGE_POINT",e[e.STARS_CHANGE=34]="STARS_CHANGE",e[e.NEW_LEVEL=35]="NEW_LEVEL",e[e.ENEMY_ROTATE=36]="ENEMY_ROTATE",e[e.PERFECT_TOSS=37]="PERFECT_TOSS",e[e.UPDATE_RANGE_VALUE=38]="UPDATE_RANGE_VALUE"}(n.GlobalEvent||(n.GlobalEvent={})),cc._RF.pop()},{}],GameBinder:[function(e,t,n){"use strict";cc._RF.push(t,"d22de/N1yxMwpFKClwORumF","GameBinder"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./AltitudeBar"),o=e("./Record"),a=e("./PunchButton"),r=e("./fguiMainUI"),s=e("./AchieveIcon"),c=e("./rangeSlider"),l=function(){function e(){}return e.bindAll=function(){fgui.UIObjectFactory.setExtension(i.default.URL,i.default),fgui.UIObjectFactory.setExtension(o.default.URL,o.default),fgui.UIObjectFactory.setExtension(a.default.URL,a.default),fgui.UIObjectFactory.setExtension(r.default.URL,r.default),fgui.UIObjectFactory.setExtension(s.default.URL,s.default),fgui.UIObjectFactory.setExtension(c.default.URL,c.default)},e}();n.default=l,cc._RF.pop()},{"./AchieveIcon":"AchieveIcon","./AltitudeBar":"AltitudeBar","./PunchButton":"PunchButton","./Record":"Record","./fguiMainUI":"fguiMainUI","./rangeSlider":"rangeSlider"}],GameFactory:[function(e,t,n){"use strict";cc._RF.push(t,"3779bGiGolJfqHjyLy/0qU/","GameFactory"),Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("../TableMgr"),a=e("../Utils/HashMap"),r=function(){function e(e,t,n){this._pool=[],this.poolHandlerComps=[],this.poolHandlerComps=n,this.template=e,this.initPool(t)}return e.prototype.initPool=function(e){for(var t=0;t<e;++t){var n=cc.instantiate(this.template);this.put(n)}},e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy&&this._pool[t].destroy();this._pool.length=0},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){if(e.removeFromParent(!1),this.poolHandlerComps)for(var t=0,n=this.poolHandlerComps;t<n.length;t++){var i=n[t],o=e.getComponent(i);o&&o.unuse&&o.unuse.apply(o)}else for(var a=0,r=e.getComponents(cc.Component);a<r.length;a++){(i=r[a])&&i.unuse&&i.unuse.apply(i)}this._pool.push(e)}},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._pool.length-1;n<0&&(console.warn(" last < 0 "),this.initPool(10)),n=this._pool.length-1;var i=this._pool[n];if(this._pool.length=n,this.poolHandlerComps)for(var o=0,a=this.poolHandlerComps;o<a.length;o++){var r=a[o],s=i.getComponent(r);s&&s.reuse&&s.reuse.apply(s,arguments)}else for(var c=0,l=i.getComponents(cc.Component);c<l.length;c++){(r=l[c])&&r.reuse&&r.reuse.apply(r,arguments)}return i},e}();(function(e){e[e.INIT=0]="INIT",e[e.ITEM=16]="ITEM",e[e.DONE=16]="DONE"})(i||(i={}));var s=function(){function e(){this.step=i.INIT,this.itemPool=new a.HashMap}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){this.doneCallback=e,this.initItems()},e.prototype.nextStep=function(e){this.step|=e,console.log("Factory Step:"+i[e]),this.step>=i.DONE&&this.doneCallback&&this.doneCallback()},e.prototype.initItems=function(){var e=o.TableMgr.inst.getAll_Punch_the_moon_prop_Data(),t=this,n=0,a=0;for(var s in e)a++;var c=function(e){var o=e;cc.loader.loadRes(o,cc.Prefab,function(o,s){if(o)console.error(o);else{var c=cc.instantiate(s);t.itemPool.add(e,new r(c,10)),++n>=a&&t.nextStep(i.ITEM)}})};for(var s in e)c(s)},e.prototype.getItems=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return console.log(e),this.itemPool.get(e).get(t)},e.prototype.puItems=function(e,t){this.itemPool.get(e).put(t)},e}();n.gFactory=s.inst,cc._RF.pop()},{"../TableMgr":"TableMgr","../Utils/HashMap":"HashMap"}],GameMgr:[function(e,t,n){"use strict";cc._RF.push(t,"487faakth9CkaTeb6IvpVyK","GameMgr"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../TableMgr"),r=e("../Config/Config"),s=function(){function e(){this.maxHeightLimit=6e5,this.maxHeight=0,this.totalMaxHeight=0,this.canToss=!1,this.isCanAutoToss=!1,this.isPerfectAutoToss=!1,this.isPunched=!1,this.qteTimes=0,this.isGameOver=!0,this.paused=!1,this.QTE=!1,this.rotateCD=0,this.canGetTool=!1,this.tossTimes=0,this.level=90001,this.levels=new Array,this.hp=100,this.power=r.Config.TotalPower,this.score=0,this.totalPower=r.Config.TotalPower}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(){console.log(" game start "),this.score=0,this.tossTimes=0,this.canToss=!1,this.isGameOver=!1,this.maxHeight=0,this.QTE=!1,this.qteTimes=0,this.rotateCD=0,this.canGetTool=!1,this.hp=this.playerData.hp_1,this.power=0,i.gEventMgr.emit(o.GlobalEvent.UPDATE_HP),i.gEventMgr.emit(o.GlobalEvent.UPDATE_SCORE),i.gEventMgr.emit(o.GlobalEvent.UPDATE_POWER,this.power/this.totalPower*100),i.gEventMgr.emit(o.GlobalEvent.UPDATE_HEIGHT,0,0,0,0)},e.prototype.addHp=function(e){this.isGameOver||(this.hp+=e,console.log(" player hp:",this.hp),this.hp=CMath.Clamp(this.hp,this.playerData.hp_1,0),i.gEventMgr.emit(o.GlobalEvent.UPDATE_HP),this.hp<=0&&!this.isGameOver&&this.gameOver())},e.prototype.getHpPercent=function(){return this.hp/this.playerData.hp_1*100},e.prototype.start=function(){var e=a.TableMgr.inst.getAll_Punch_the_moon_paly_level_Data();for(var t in e)this.levels.push(e[t]);this.levels.sort(function(e,t){return e.ID>t.ID?1:-1}),console.log("=-=========================== all levels =================================="),console.log(this.levels),this.playerData||(this.playerData=a.TableMgr.inst.getPunch_the_moon_role(r.Config.PlayerID)),this.init()},e.prototype.nextLevel=function(){if(this.levels.length<=0)return console.log(" game over "),void this.gameOver();if(!this.isGameOver){this.curLevel=this.levels.shift();for(var e=0,t=[],n=0,r=this.curLevel.weight;n<r.length;n++){e+=h=r[n],t.push(e)}var s=CMath.getRandom();console.error("----------------------------------------------------"),console.log(t),console.log(e),console.log(s);for(var c=0,l=0,u=t;l<u.length;l++){var h;s>=(h=u[l])/e&&(c=t.indexOf(h)+1)}console.warn(" ------------------------ index:",c),c=CMath.Clamp(c,3,1),this.curEnemy=a.TableMgr.inst.getPunch_the_moon_role(this.curLevel["foe"+c]),this.rotateCD=0,this.canGetTool=!1,i.gEventMgr.emit(o.GlobalEvent.NEW_ENEMY,this.curEnemy),i.gEventMgr.emit(o.GlobalEvent.NEW_LEVEL)}},e.prototype.addQteTimes=function(){this.qteTimes++,this.qteTimes>=n.Game.curEnemy.QTE&&(n.Game.canToss=!0)},e.prototype.getHp=function(){return this.hp},e.prototype.addScore=function(e){this.isGameOver||(this.score+=e,this.score=Math.ceil(this.score),i.gEventMgr.emit(o.GlobalEvent.UPDATE_SCORE))},e.prototype.getScore=function(){return this.score},e.prototype.addPower=function(e){return this.power+=e,this.power=CMath.Clamp(this.power,this.totalPower,0),console.log(" add power:",e,"--------------------------------------------",this.power),i.gEventMgr.emit(o.GlobalEvent.UPDATE_POWER,this.power/this.totalPower*100),this.power>=this.totalPower},e.prototype.getPower=function(){return this.power},e.prototype.gameOver=function(){this.isGameOver=!0},e}();n.Game=s.inst,cc._RF.pop()},{"../Config/Config":"Config","../Event/EventManager":"EventManager","../Event/EventName":"EventName","../TableMgr":"TableMgr"}],GameScene:[function(e,t,n){"use strict";cc._RF.push(t,"c17413XIeBGRbTZZ+mY6f8C","GameScene"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Controller/CameraController"),o=e("../Controller/UIManager"),a=e("../UI/export/Game/fguiMainUI"),r=e("../UI/MainUI"),s=e("../Entity/GameMgr"),c=cc._decorator,l=c.ccclass,u=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UICamera=null,t.MainCamera=null,t.PlayerCamera=null,t.EnemyCamera=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.setScale(1,1),i.gCamera.bindMainCamera(this.MainCamera),i.gCamera.bindUICamera(this.UICamera),i.gCamera.bindEnemyCamera(this.EnemyCamera),i.gCamera.bindPlayerCamera(this.PlayerCamera),i.gCamera.initCamera()},t.prototype.start=function(){s.Game.start(),o.UIMgr.openGUI(a.default,r.default)},__decorate([u(cc.Camera)],t.prototype,"UICamera",void 0),__decorate([u(cc.Camera)],t.prototype,"MainCamera",void 0),__decorate([u(cc.Camera)],t.prototype,"PlayerCamera",void 0),__decorate([u(cc.Camera)],t.prototype,"EnemyCamera",void 0),t=__decorate([l],t)}(cc.Component);n.default=h,cc._RF.pop()},{"../Controller/CameraController":"CameraController","../Controller/UIManager":"UIManager","../Entity/GameMgr":"GameMgr","../UI/MainUI":"MainUI","../UI/export/Game/fguiMainUI":"fguiMainUI"}],HashMap:[function(e,t,n){"use strict";cc._RF.push(t,"7c7b206TJdKHLPT8OttWnGJ","HashMap"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(){this._list=new Array,this.clear()}return e.prototype.getIndexByKey=function(e){for(var t=this._list.length,n=0;n<t;n++){if(this._list[n].key==e)return n}return-1},Object.defineProperty(e.prototype,"keys",{get:function(){for(var e=new Array,t=0,n=this._list;t<n.length;t++){var i=n[t];i&&e.push(i.key)}return e},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var n={key:e,value:t},i=this.getIndexByKey(e);-1!=i?this._list[i]=n:this._list.push(n)},Object.defineProperty(e.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.getIndexByKey(e);if(-1!=t){var n=this._list[t];return this._list.splice(t,1),n}return null},e.prototype.has=function(e){return-1!=this.getIndexByKey(e)},e.prototype.get=function(e){var t=this.getIndexByKey(e);return-1!=t?this._list[t].value:null},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.sort=function(e){this._list.sort(e)},e.prototype.forEachKeyValue=function(e){for(var t=this._list.length,n=0;n<t;n++){e(this._list[n])}},e.prototype.forEach=function(e){for(var t=this._list.length,n=0;n<t;n++){var i=this._list[n];e(i.key,i.value)}},e.prototype.clear=function(){this._list=[]},e}();n.HashMap=i,cc._RF.pop()},{}],MainUI:[function(e,t,n){"use strict";cc._RF.push(t,"8bab8ACSRpOXJccC9/XWJhm","MainUI"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Controller/UIManager"),o=e("../Event/EventManager"),a=e("../Event/EventName"),r=e("../Entity/GameMgr"),s=e("../Config/Config"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uiView=null,t.curMaxHeight=0,t.curMaxHeightInMeter=0,t.minRecordLineY=-600,t.okMaxScale=1.85,t.okMinScale=.8,t.perfectMax=1.35,t.perfectMin=1.25,t.tipCount=0,t}return __extends(t,e),t.prototype.register=function(e){return this.uiView=e,this.init(),this},t.prototype.init=function(){var e=this;this.tipCount=0,this.uiView.m_Tip.node.opacity=255,this.updateHpBar(),this.updateScore(),this.showAchieveIcon(!1),this.uiView.m_perfect.node.runAction(cc.fadeOut(0)),this.updatePowerBar(r.Game.getPower()/r.Game.totalPower*100),this.uiView.m_altitudeBar.m_altitudeSlider.value=0,this.uiView.m_altitudeBar.m_rangeSlider.value=0,this.uiView.m_altitudeLabel.title="",this.uiView.m_Record.m_label.title=this.curMaxHeight.toFixed(2)+"m",this.uiView.m_Record.setPosition(0,this.minRecordLineY),this.uiView.m_XPBg.visible=!1,this.uiView.onClick(function(){console.warn(" uiView punch!!!!!!!!!!!! isPunched:",r.Game.isPunched,"Game.canToss:",r.Game.canToss),r.Game.isGameOver||r.Game.canToss&&(r.Game.enemyClass&&r.Game.enemyClass.speed.y>0?o.gEventMgr.emit(a.GlobalEvent.ENEMY_ROTATE):(e.showXpButton(!1),o.gEventMgr.emit(a.GlobalEvent.PUNCH_READY,!1),r.Game.enemyClass&&r.Game.enemyClass.toss(!1)))},this),this.uiView.m_xpButton.onClick(this.useXp,this),this.uiView.m_startButton.onClick(function(){r.Game.nextLevel(),e.uiView.m_StartButtonAni.stop(!0),e.uiView.m_startButton.visible=!1},this),this.uiView.m_Tip.onClick(function(){this.tipCount<1?this.uiView.m_Tip.node.runAction(cc.sequence(cc.moveBy(.25,cc.v2(-720,0)),cc.callFunc(function(){this.tipCount++},this))):this.uiView.m_Tip.node.runAction(cc.sequence(cc.moveBy(.25,cc.v2(-720,0)),cc.callFunc(function(){this.tipCount++,r.Game.nextLevel()},this)))}.bind(this),this),this.uiView.m_altitudeBar.m_altitudeSlider.touchable=!1,this.uiView.m_altitudeBar.m_rangeSlider.touchable=!1,this.uiView.m_punchButton.visible=!1,o.gEventMgr.on(a.GlobalEvent.UPDATE_HEIGHT,this.updateCurHeight,this),o.gEventMgr.on(a.GlobalEvent.UPDATE_HP,this.updateHpBar,this),o.gEventMgr.on(a.GlobalEvent.UPDATE_SCORE,this.updateScore,this),o.gEventMgr.on(a.GlobalEvent.UPDATE_POWER,this.updatePowerBar,this),o.gEventMgr.on(a.GlobalEvent.PERFECT_TOSS,this.showPerfect,this),o.gEventMgr.on(a.GlobalEvent.QTE,this.startQTE,this),o.gEventMgr.on(a.GlobalEvent.QTE_OVER,this.overQTE,this),o.gEventMgr.on(a.GlobalEvent.UPDATE_ENEMY_HP,this.updateEnemyHp,this),o.gEventMgr.on(a.GlobalEvent.SHOW_XP_BUTTON,this.showXpButton,this),o.gEventMgr.on(a.GlobalEvent.SHOW_ACHIEVE_ICON,this.showAchieveIcon,this),o.gEventMgr.on(a.GlobalEvent.NEW_ENEMY,this.startGame,this),o.gEventMgr.on(a.GlobalEvent.UPDATE_RANGE_VALUE,this.updateRangeValue,this),o.gEventMgr.on(a.GlobalEvent.ENEMY_DIE,function(){r.Game.addScore(e.curMaxHeightInMeter/s.Config.Height2Score),e.curMaxHeightInMeter=0},this),o.gEventMgr.on(a.GlobalEvent.XP_BEGIN,function(){e.uiView.m_XPBg.visible=!0},this),o.gEventMgr.on(a.GlobalEvent.XP_END,function(){e.uiView.m_XPBg.visible=!1},this),this.uiView.m_punchButton.m_punch.onClick(this.punch,this),this.uiView.m_punchButton.m_rangeChangAni.timeScale=.5,this.uiView.m_punchButton.m_rangeChangAni.setHook("End",function(){r.Game.canToss||(e.qteFailed(),e.overQTE())}),this.uiView.m_playerXpAni.setHook("End",function(){o.gEventMgr.emit(a.GlobalEvent.XP_RESUME)})},t.prototype.updateRangeValue=function(e){console.log(" m_altitudeBar value:"+e),this.uiView.m_altitudeBar.m_rangeSlider.value=100*e},t.prototype.startGame=function(e){console.log(" ----------------------------------- new enemy ------------------------------------"),this.uiView.m_altitudeBar.m_altitudeSlider._gripObject.url="ui://Game/"+e.mod+"_grip",this.curMaxHeightInMeter=0},t.prototype.useXp=function(e){console.warn(" use xp is punched:",r.Game.isPunched,"totalFrame:",cc.director.getTotalFrames()),r.Game.isGameOver||(r.Game.canToss&&!r.Game.isPunched&&(r.Game.isPunched=!0,o.gEventMgr.emit(a.GlobalEvent.PUNCH_READY,!0),r.Game.enemyClass&&r.Game.enemyClass.toss(!0),r.Game.paused=!0,this.uiView.m_playerXpAni.play()),e.stopPropagation())},t.prototype.updateEnemyHp=function(e,t){},t.prototype.startQTE=function(){console.log(" qte start"),this.uiView.m_punchButton.visible=!0,r.Game.QTE=!0},t.prototype.overQTE=function(){console.log(" qte over"),this.uiView.m_punchButton.visible=!1,r.Game.QTE=!1},t.prototype.qteFailed=function(){console.log(" qte \u5931\u8d25"),o.gEventMgr.emit(a.GlobalEvent.QTE_FAILED)},t.prototype.updateHpBar=function(){this.uiView.m_hpBar.value=r.Game.getHpPercent(),this.uiView.m_playerHpLabel.title=r.Game.getHp().toString()},t.prototype.showXpButton=function(e){if(this.uiView.m_xpButton.enabled!=e){var t=e&&this.uiView.m_powerBar.value>=100&&!r.Game.isPunched;this.uiView.m_xpButton.visible,this.uiView.m_xpButton.enabled=t,this.uiView.m_xpButton.enabled?this.uiView.m_xpButton.node.opacity=255:this.uiView.m_xpButton.node.opacity=0}},t.prototype.updatePowerBar=function(e){console.log("!!!!!!!!!!!!!!!!!!!!!power:",e),this.uiView.m_powerBar.value=e,e<100&&this.showXpButton(!1)},t.prototype.showAchieveIcon=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=""),e?(this.uiView.m_IconLoader.node.stopAllActions(),this.uiView.m_IconLoader.m_Icon.url="ui://Game/"+t,this.uiView.m_IconLoader.m_Label.title=n,this.uiView.m_IconLoader.node.runAction(cc.sequence(cc.fadeIn(0),cc.delayTime(2),cc.fadeOut(0)))):this.uiView.m_IconLoader.node.runAction(cc.fadeOut(0))},t.prototype.updateScore=function(){this.uiView.m_Score.title=r.Game.getScore().toString()},t.prototype.showPerfect=function(){this.uiView.m_perfect.node.stopAllActions(),this.uiView.m_perfect.node.runAction(cc.sequence(cc.fadeIn(0),cc.delayTime(1),cc.fadeOut(0)))},t.prototype.punch=function(e){if(!r.Game.isGameOver){var t=this.uiView.m_punchButton.m_rangeMove.node.scale;t>=this.okMinScale&&t<=this.okMaxScale?(t>=this.perfectMin&&t<=this.perfectMax?(console.log("perfect"),r.Game.addPower(s.Config.PowerAdd),this.showPerfect()):console.log("\u4e00\u822c\u822c\u5566"),r.Game.addQteTimes(),o.gEventMgr.emit(a.GlobalEvent.QTE_SUCCESS)):this.qteFailed(),this.overQTE(),e.stopPropagation()}},t.prototype.updateCurHeight=function(e,t,n,i){this.uiView.m_altitudeBar.m_altitudeSlider.value=e,t=Math.max(t,0);var o=i?s.Config.Pexil2MeterSky:s.Config.Pexil2MeterGround;this.curMaxHeightInMeter=Math.ceil(Math.max(this.curMaxHeightInMeter,Math.floor(t/o))),r.Game.totalMaxHeight=Math.max(r.Game.totalMaxHeight,this.curMaxHeightInMeter);var a=CMath.NumberFormat(Math.floor(t/o))+"m";this.uiView.m_altitudeLabel.title=a,this.uiView.m_altitudeLabel.visible=t>0,t>=this.curMaxHeight&&(this.curMaxHeight=t,this.uiView.m_Record.m_label.title=a),0==this.curMaxHeight&&(this.curMaxHeight=1),this.uiView.m_Record.y=this.minRecordLineY*(1-t/this.curMaxHeight),this.uiView.m_Record.y=CMath.Clamp(this.uiView.m_Record.y,0,this.minRecordLineY)},t.prototype.update=function(e){if(!r.Game.isGameOver&&r.Game.QTE){var t=this.uiView.m_punchButton.m_rangeMove.node.scale;t>=this.perfectMin&&t<=this.perfectMax&&s.Config.AUTO_TOSS&&this.punch(new fgui.Event("OK",!1))}},t=__decorate([l],t)}(i.BaseUI));n.default=u,cc._RF.pop()},{"../Config/Config":"Config","../Controller/UIManager":"UIManager","../Entity/GameMgr":"GameMgr","../Event/EventManager":"EventManager","../Event/EventName":"EventName"}],OverWinUI:[function(e,t,n){"use strict";cc._RF.push(t,"841493Ot6NFBblvnF5HKCit","OverWinUI"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Controller/UIManager"),o=e("./export/Window/OverWindow"),a=e("../Entity/GameMgr"),r=e("../TableMgr"),s=e("../Utils/celerx"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return __extends(t,e),n=t,t.prototype.register=function(e){return this.uiView=e,this.init(),this},t.prototype.init=function(){this.uiView.m_confirm.visible=!1,this.uiView.m_confirm.onClick(function(){a.Game.start(),a.Game.nextLevel(),i.UIMgr.closeWindow(o.default,n,!1)},this);var e=r.TableMgr.inst.getAll_Punch_the_moon_evaluate_Data(),t=a.Game.getScore(),c="1";for(var l in e){var u=e[l];if(t<u.min)break;c=l}this.uiView.m_level.url="ui://Window/bg_battleover_"+e[c].evaluate,this.uiView.m_Score.title=t.toString(),this.uiView.m_Record.title=a.Game.totalMaxHeight.toString()+"m",setTimeout(function(){s.submitScore(t)},2e3)},t.prototype.onLoad=function(){},t.prototype.start=function(){},t=n=__decorate([l],t)}(i.BaseUI));n.default=u,cc._RF.pop()},{"../Controller/UIManager":"UIManager","../Entity/GameMgr":"GameMgr","../TableMgr":"TableMgr","../Utils/celerx":"celerx","./export/Window/OverWindow":"OverWindow"}],OverWindow:[function(e,t,n){"use strict";cc._RF.push(t,"84cc33xy4RJjZazZwUZeQ3t","OverWindow"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Window","OverWindow")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Window",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Window","OverWindow").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Window")},t.prototype.onConstruct=function(){this.m_bg=this.getChild("bg"),this.m_confirm=this.getChild("confirm"),this.m_level=this.getChild("level"),this.m_Record=this.getChild("Record"),this.m_Score=this.getChild("Score")},t.URL="ui://sfqyqzehk1rs3",t}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],PixelSprite:[function(e,t,n){"use strict";cc._RF.push(t,"2b15abBxSNPNrI23Xj19DUq","PixelSprite"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderManager"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.material=new i.PixelStyleMaterial,t.spineMaterial=new i.PixelSpineMaterial,t.oldMaterial=null,t.oldSpineMaterial=null,t.sampleCount=800,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.init=function(){if(PXIEL){var e=this.getComponent(cc.Sprite),t=this.getComponent(sp.Skeleton),n=this.getComponent(cc.Label);this.material.setDefine("disableColor",!1),this.spineMaterial.setDefine("disableColor",!1),this.material.setProperty("sampleCount",this.sampleCount),this.spineMaterial.setProperty("sampleCount",this.sampleCount),e&&(this.oldMaterial=e._spriteMaterial,e._spriteMaterial=this.material,e._activateMaterial()),n&&(this.oldMaterial=n._material,n._frame&&n._frame._texture&&(this.material.texture=n._frame._texture),n._material=this.material,n._activateMaterial()),t&&(this.oldSpineMaterial=t._material,t._updateMaterial(this.spineMaterial))}},t.prototype.reset=function(){var e=this.getComponent(cc.Sprite),t=this.getComponent(sp.Skeleton),n=this.getComponent(cc.Label);e&&this.oldMaterial&&(e._spriteMaterial=this.oldMaterial,e._activateMaterial()),n&&this.oldMaterial&&(n._material=this.oldMaterial,n._activateMaterial()),t&&this.oldSpineMaterial&&t._updateMaterial(this.oldSpineMaterial)},__decorate([r(cc.Integer)],t.prototype,"sampleCount",void 0),t=__decorate([a],t)}(cc.Component);n.default=s,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],Player:[function(e,t,n){"use strict";cc._RF.push(t,"0b2b8UA771NAq1r4Ezauy2i","Player"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventName"),o=e("../Event/EventManager"),a=e("./GameMgr"),r=e("./Enemy"),s=e("../Controller/CameraController"),c=cc._decorator,l=c.ccclass,u=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Enemy=null,t.shadow=null,t.SkillEffect=null,t.isQteFailed=!1,t.isUseXp=!1,t.isPerfect=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"Spine",{get:function(){return this.spine?this.spine:this.spine=this.getComponent(sp.Skeleton)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;o.gEventMgr.on(i.GlobalEvent.TOSS,this.toss,this),this.playAnimation("idle",!0),this.Spine.timeScale=1,this.Spine.setCompleteListener(this.onComplete.bind(this)),this.Spine.setEventListener(this.eventListener.bind(this)),o.gEventMgr.on(i.GlobalEvent.PLAYER_START_PUNCH,this.startPunch,this),o.gEventMgr.on(i.GlobalEvent.PUNCH_READY,this.punchReady,this),o.gEventMgr.on(i.GlobalEvent.QTE_SUCCESS,this.QTESuccess,this),o.gEventMgr.on(i.GlobalEvent.QTE_FAILED,this.qteFailed,this),o.gEventMgr.on(i.GlobalEvent.PLAYER_HIT,this.hit,this),o.gEventMgr.on(i.GlobalEvent.TO_THE_MOON,this.toTheMoon,this),o.gEventMgr.on(i.GlobalEvent.XP_RESUME,this.xpResume,this),o.gEventMgr.on(i.GlobalEvent.NEW_ENEMY,function(){e.isUseXp=!1},this),this.setMix()},t.prototype.perfectToss=function(){this.isPerfect=!0},t.prototype.toTheMoon=function(){this.playAnimation("ohye",!1)},t.prototype.setMix=function(){for(var e=this.Spine.skeletonData.skeletonJson.animations,t=0,n=e;t<n.length;t++)for(var i=n[t],o=0,a=e;o<a.length;o++){var r=a[o];i!=r&&this.Spine.setMix(r,i,.2)}},t.prototype.xpResume=function(){this.Spine.paused&&(this.Spine.paused=!1),a.Game.paused=!1,o.gEventMgr.emit(i.GlobalEvent.PLAY_XP)},t.prototype.punchReady=function(e){this.Enemy.speed.y>0||"skill2"==this.Spine.animation&&0==e||"skill1"==this.Spine.animation&&0==e||(this.isUseXp=e,this.playAnimation("skill2",!1),this.isUseXp||o.gEventMgr.emit(i.GlobalEvent.NORMAL_PUNCH))},t.prototype.eventListener=function(e,t){switch(t.stringValue){case"circle":a.Game.curEnemy.QTE>=1&&this.startQTE();break;case"bingo":o.gEventMgr.emit(i.GlobalEvent.QTE_ATTACK_1),o.gEventMgr.emit(i.GlobalEvent.ENEMY_HIT);break;case"hittarget":a.Game.curEnemy.QTE>=2&&this.startQTE();break;case"backhit":a.Game.canToss&&a.Game.tossTimes<=0&&(this.isPerfect=this.Enemy.toss(this.isUseXp),o.gEventMgr.emit(i.GlobalEvent.QTE_OVER)),this.isUseXp=!1,this.Spine.timeScale=1,this.Enemy.Spine.timeScale=1;break;case"kill":this.isPerfect&&this.SkillEffect.play("skill",0),this.isPerfect=!1;break;case"attack":o.gEventMgr.emit(i.GlobalEvent.ENEMY_HIT),o.gEventMgr.emit(i.GlobalEvent.ENEMY_HIT_OUT)}},t.prototype.hit=function(){this.playAnimation("hit",!1)},t.prototype.startPunch=function(){this.isQteFailed=!1,s.gCamera.playerAttack(),this.playAnimation("skill1",!1)},t.prototype.playAnimation=function(e,t){this.Spine.animation==e&&"hit"!=e||(this.Spine.timeScale="skill2"==e?10:1,this.Spine.loop=t,this.Spine.animation=e)},t.prototype.startQTE=function(){this.isQteFailed||(this.Spine.timeScale=.1,this.Enemy.Spine.timeScale=.1,o.gEventMgr.emit(i.GlobalEvent.QTE))},t.prototype.QTESuccess=function(){this.Spine.timeScale=1,this.Enemy.Spine.timeScale=1},t.prototype.qteFailed=function(){this.Spine.timeScale=1,this.Enemy.Spine.timeScale=1,this.isQteFailed=!0,this.playAnimation("hit",!1)},t.prototype.attackEnemy=function(){s.gCamera.playerAttack(),this.playAnimation("attack",!1)},t.prototype.onComplete=function(e){switch(e.animation.name){case"skill1":s.gCamera.enemyAttack(),o.gEventMgr.emit(i.GlobalEvent.ENEMY_HIT),o.gEventMgr.emit(i.GlobalEvent.QTE_ATTACK_2),this.playAnimation("skill2",!1),a.Game.curEnemy.QTE>=3?this.startQTE():(a.Game.canToss=a.Game.curEnemy.QTE<=0,a.Game.canToss&&(a.Game.qteTimes=1));break;case"skill2":case"attack":this.playAnimation("idle",!0);break;case"hit":this.isQteFailed?this.attackEnemy():this.playAnimation("idle",!0);break;case"ohye":a.Game.nextLevel(),this.playAnimation("idle",!0)}},t.prototype.toss=function(){},t.prototype.start=function(){},t.prototype.update=function(e){this.shadow.x=this.node.x},__decorate([u(r.default)],t.prototype,"Enemy",void 0),__decorate([u(cc.Node)],t.prototype,"shadow",void 0),__decorate([u(cc.Animation)],t.prototype,"SkillEffect",void 0),t=__decorate([l],t)}(cc.Component);n.default=h,cc._RF.pop()},{"../Controller/CameraController":"CameraController","../Event/EventManager":"EventManager","../Event/EventName":"EventName","./Enemy":"Enemy","./GameMgr":"GameMgr"}],PointWave:[function(e,t,n){"use strict";cc._RF.push(t,"24b0dt3YqhEQqqnV84jUdhq","PointWave"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.material=new i.PointWaveMaterial,t.time=0,t.waveRange=.01,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;console.log(this.node);var t=this.getComponent(cc.Sprite);t&&(t._spriteMaterial=this.material,t._activateMaterial(),this.material.setProperty("range",.01),this.node.on(cc.Node.EventType.TOUCH_END,function(t){var n=e.node.convertToNodeSpace(t.getLocation());n.x/=e.node.getContentSize().width,n.y/=e.node.getContentSize().height,n.y=1-n.y,e.time=0,e.waveRange=.01,e.material.setProperty("time",e.time),e.material.setProperty("range",e.waveRange),e.material.setProperty("point",n)},this))},t.prototype.start=function(){},t.prototype.update=function(e){this.material.setProperty("range",this.waveRange),this.material.setProperty("time",this.time),this.material.setProperty("deltaTime",e),this.time+=e/2,this.waveRange>.1&&(this.waveRange=.1)},t=__decorate([a],t)}(cc.Component));n.default=r,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],PunchButton:[function(e,t,n){"use strict";cc._RF.push(t,"32facVKN9xAKIsABqtWIRl3","PunchButton"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Game","PunchButton")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Game",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Game","PunchButton").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Game")},t.prototype.onConstruct=function(){this.m_punch=this.getChild("punch"),this.m_rangeMove=this.getChild("rangeMove"),this.m_rangeChangAni=this.getTransition("rangeChangAni")},t.URL="ui://vmvonsvyni8jrn",t}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],Record:[function(e,t,n){"use strict";cc._RF.push(t,"25052x4q7BLRJgn5I6NP8v1","Record"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Game","Record")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Game",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Game","Record").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Game")},t.prototype.onConstruct=function(){this.m_line=this.getChild("line"),this.m_label=this.getChild("label")},t.URL="ui://vmvonsvyhxexrh",t}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],ShaderManager:[function(e,t,n){"use strict";cc._RF.push(t,"33f74kNXkxB/K9XULryyDE2","ShaderManager"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderTemplate"),o=cc.renderer.renderEngine,a=o.Material,r=o.renderer,s=o.gfx,c=function(){function e(){var e=cc.renderer._forward._programLib;if(e)for(var t=0,n=i.templates;t<n.length;t++){var o=n[t];e._templates[o.name]||e.define(o.name,o.vert,o.frag,o.defines)}else console.error("programLib not exist!")}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e}();n.ShaderManager=c;var l=function(e){function t(){var t=e.call(this)||this;t.time=0,t.range=.1;var n=new r.Pass("transition_sprite");n.setDepth(!1,!1),n.setCullMode(s.CULL_NONE),n.setBlend(s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA,s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA);var i=new r.Technique(["transparent"],[{name:"texture",type:r.PARAM_TEXTURE_2D},{name:"color",type:r.PARAM_COLOR4},{name:"time",type:r.PARAM_FLOAT},{name:"range",type:r.PARAM_FLOAT}],[n]);return t._color={r:1,g:1,b:1,a:1},t._effect=new r.Effect([i],{color:t._color,time:t.time,range:t.range},[{name:"useTexture",value:!0},{name:"useModel",value:!1},{name:"useColor",value:!0}]),t._mainTech=i,t._texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useModel",{get:function(){return this._effect.getDefine("useModel")},set:function(e){this._effect.define("useModel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTexture",{get:function(){return this._effect.getDefine("useTexture")},set:function(e){this._effect.define("useTexture",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useColor",{get:function(){return this._effect.getDefine("useColor")},set:function(e){this._effect.define("useColor",e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this._effect.setProperty(e,t)},t.prototype.clone=function(){var e=new t;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.useTexture=this.useTexture,e.useModel=this.useModel,e.useColor=this.useColor,e.updateHash(),e},t}(a);n.TransitionMaterial=l;var u=function(e){function t(){var t=e.call(this)||this;t.time=0,t.range=2,t.deltaTime=0;var n=new r.Pass("wave_sprite");n.setDepth(!1,!1),n.setCullMode(s.CULL_NONE),n.setBlend(s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA,s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA);var i=new r.Technique(["transparent"],[{name:"texture",type:r.PARAM_TEXTURE_2D},{name:"color",type:r.PARAM_COLOR4},{name:"time",type:r.PARAM_FLOAT},{name:"deltaTime",type:r.PARAM_FLOAT},{name:"range",type:r.PARAM_FLOAT}],[n]);return t._color={r:1,g:1,b:1,a:1},t._effect=new r.Effect([i],{color:t._color,time:t.time,range:t.range,deltaTime:t.deltaTime},[{name:"useTexture",value:!0},{name:"useModel",value:!1},{name:"useColor",value:!0}]),t._mainTech=i,t._texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useModel",{get:function(){return this._effect.getDefine("useModel")},set:function(e){this._effect.define("useModel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTexture",{get:function(){return this._effect.getDefine("useTexture")},set:function(e){this._effect.define("useTexture",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useColor",{get:function(){return this._effect.getDefine("useColor")},set:function(e){this._effect.define("useColor",e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this._effect.setProperty(e,t)},t.prototype.clone=function(){var e=new l;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.useTexture=this.useTexture,e.useModel=this.useModel,e.useColor=this.useColor,e.updateHash(),e},t}(a);n.WaveMaterial=u;var h=function(e){function t(){var t=e.call(this)||this,n=new r.Pass("butterfly_spring");n.setDepth(!1,!1),n.setCullMode(s.CULL_NONE),n.setBlend(s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA,s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA);var i=new r.Technique(["transparent"],[{name:"texture",type:r.PARAM_TEXTURE_2D},{name:"color",type:r.PARAM_COLOR4}],[n]);return t._color={r:1,g:1,b:1,a:1},t._effect=new r.Effect([i],{color:t._color},[{name:"useTexture",value:!0},{name:"useModel",value:!1},{name:"useColor",value:!0}]),t._mainTech=i,t._texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useModel",{get:function(){return this._effect.getDefine("useModel")},set:function(e){this._effect.define("useModel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTexture",{get:function(){return this._effect.getDefine("useTexture")},set:function(e){this._effect.define("useTexture",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useColor",{get:function(){return this._effect.getDefine("useColor")},set:function(e){this._effect.define("useColor",e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this._effect.setProperty(e,t)},t.prototype.setDefine=function(e,t){this._effect.define(e,t)},t.prototype.clone=function(){var e=new l;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.useTexture=this.useTexture,e.useModel=this.useModel,e.useColor=this.useColor,e.updateHash(),e},t}(a);n.ButterflySpringMaterial=h;var p=function(e){function t(){var t=e.call(this)||this;t.time=0,t.range=2,t.deltaTime=0,t.point=cc.v2(0,0);var n=new r.Pass("point_wave");n.setDepth(!1,!1),n.setCullMode(s.CULL_NONE),n.setBlend(s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA,s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA);var i=new r.Technique(["transparent"],[{name:"texture",type:r.PARAM_TEXTURE_2D},{name:"color",type:r.PARAM_COLOR4},{name:"point",type:r.PARAM_FLOAT2},{name:"time",type:r.PARAM_FLOAT},{name:"deltaTime",type:r.PARAM_FLOAT},{name:"range",type:r.PARAM_FLOAT}],[n]);return t._color={r:1,g:1,b:1,a:1},t._effect=new r.Effect([i],{color:t._color,time:t.time,range:t.range,deltaTime:t.deltaTime,point:t.point},[{name:"useTexture",value:!0},{name:"useModel",value:!1},{name:"useColor",value:!0}]),t._mainTech=i,t._texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useModel",{get:function(){return this._effect.getDefine("useModel")},set:function(e){this._effect.define("useModel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTexture",{get:function(){return this._effect.getDefine("useTexture")},set:function(e){this._effect.define("useTexture",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useColor",{get:function(){return this._effect.getDefine("useColor")},set:function(e){this._effect.define("useColor",e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this._effect.setProperty(e,t)},t.prototype.setDefine=function(e,t){this._effect.define(e,t)},t.prototype.clone=function(){var e=new l;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.useTexture=this.useTexture,e.useModel=this.useModel,e.useColor=this.useColor,e.updateHash(),e},t}(a);n.PointWaveMaterial=p;var m=function(e){function t(){var t=e.call(this)||this,n=new r.Pass("pixel_style");n.setDepth(!1,!1),n.setCullMode(s.CULL_NONE),n.setBlend(s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA,s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA);var i=new r.Technique(["transparent"],[{name:"texture",type:r.PARAM_TEXTURE_2D},{name:"color",type:r.PARAM_COLOR4},{name:"sampleCount",type:r.PARAM_FLOAT}],[n]);return t._color={r:1,g:1,b:1,a:1},t._effect=new r.Effect([i],{color:t._color,sampleCount:100},[{name:"useTexture",value:!0},{name:"useModel",value:!1},{name:"disableColor",value:!1},{name:"useColor",value:!0}]),t._mainTech=i,t._texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useModel",{get:function(){return this._effect.getDefine("useModel")},set:function(e){this._effect.define("useModel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTexture",{get:function(){return this._effect.getDefine("useTexture")},set:function(e){this._effect.define("useTexture",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useColor",{get:function(){return this._effect.getDefine("useColor")},set:function(e){this._effect.define("useColor",e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this._effect.setProperty(e,t)},t.prototype.setDefine=function(e,t){this._effect.define(e,t)},t.prototype.clone=function(){var e=new l;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.useTexture=this.useTexture,e.useModel=this.useModel,e.useColor=this.useColor,e.updateHash(),e},t}(a);n.PixelStyleMaterial=m;var d=function(e){function t(){var t=e.call(this)||this,n=new r.Pass("spine_pxiel");n.setDepth(!1,!1),n.setCullMode(s.CULL_NONE),n.setBlend(s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA,s.BLEND_FUNC_ADD,s.BLEND_SRC_ALPHA,s.BLEND_ONE_MINUS_SRC_ALPHA);var i=new r.Technique(["transparent"],[{name:"texture",type:r.PARAM_TEXTURE_2D},{name:"sampleCount",type:r.PARAM_FLOAT}],[n]);return t._effect=new r.Effect([i],{sampleCount:100},[{name:"useModel",value:!0},{name:"disableColor",value:!1},{name:"alphaTest",value:!1},{name:"use2DPos",value:!0},{name:"useTint",value:!1}]),t._mainTech=i,t._texture=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useModel",{get:function(){return this._effect.getDefine("useModel")},set:function(e){this._effect.define("useModel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"use2DPos",{get:function(){return this._effect.getDefine("use2DPos")},set:function(e){this._effect.define("use2DPos",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alphaTest",{get:function(){return this._effect.getDefine("alphaTest")},set:function(e){this._effect.define("alphaTest",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTint",{get:function(){return this._effect.getDefine("useTint")},set:function(e){this._effect.define("useTint",e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){this._effect.setProperty(e,t)},t.prototype.setDefine=function(e,t){this._effect.define(e,t)},t.prototype.clone=function(){var e=new l;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.useTexture=this.useTexture,e.useModel=this.useModel,e.updateHash(),e},t}(a);n.PixelSpineMaterial=d,cc._RF.pop()},{"./ShaderTemplate":"ShaderTemplate"}],ShaderTemplate:[function(e,t,n){"use strict";cc._RF.push(t,"1949dMh6s5BRK3S3vf90vES","ShaderTemplate"),Object.defineProperty(n,"__esModule",{value:!0}),n.templates=[{name:"transition_sprite",vert:"\n    uniform mat4 viewProj;\n    attribute vec3 a_position;\n    attribute lowp vec4 a_color;\n    varying mediump vec4 v_pos;\n    #ifdef useModel \n        uniform mat4 model;\n    #endif\n    #ifdef useTexture\n        attribute mediump vec2 a_uv0;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifndef useColor \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {\n        mat4 mvp;\n        #ifdef useModel\n             mvp = viewProj * model;\n        #else\n             mvp = viewProj;  \n        #endif  \n        vec4 pos = mvp * vec4(a_position, 1);\n        #ifndef useColor\n             v_fragmentColor = a_color;\n        #endif\n        #ifdef useTexture    \n             uv0 = a_uv0;  \n        #endif  \n        v_pos = pos;\n        gl_Position = pos;\n    }",frag:"\n    uniform float time;\n    uniform float range;\n    varying mediump vec4 v_pos;\n    #ifdef useTexture  \n        uniform sampler2D texture;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifdef useColor\n        uniform lowp vec4 color;\n    #else  \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {  \n        #ifdef useColor    \n             vec4 o = color;\n        #else\n             vec4 o = v_fragmentColor;  \n        #endif  \n        #ifdef useTexture    \n             o *= texture2D(texture, uv0); \n             if (uv0.x <= time) {\n                float factor = time - uv0.x;\n                if (factor > range) o.w *= 0.0;\n                else o.w *= (1.0-factor/range);\n                \n            } else {\n                o.w *=  1.0;\n            }\n        #else\n            float px = v_pos.x + 1.0;\n            if (px <= time*2.0) {\n                float factor = time*2.0 - px;\n                if (factor > range) o.w *= 0.0;\n                else o.w *= (1.0-factor/range);\n            } else {\n                o.w *=  1.0;\n            }\n        #endif  \n        \n        gl_FragColor = o;\n    }",defines:[{name:"useModel"},{name:"useTexture"},{name:"useColor"}]},{name:"butterfly_spring",vert:"\n  \n    uniform mat4 viewProj;\n    attribute vec3 a_position;\n    attribute lowp vec4 a_color;\n    #ifdef useModel \n        uniform mat4 model;\n    #endif\n    #ifdef useTexture\n        attribute mediump vec2 a_uv0;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifndef useColor \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {\n        mat4 mvp;\n        #ifdef useModel\n             mvp = viewProj * model;\n        #else\n             mvp = viewProj;  \n        #endif  \n        vec4 pos = mvp * vec4(a_position, 1);\n        #ifndef useColor\n             v_fragmentColor = a_color;\n        #endif\n        #ifdef useTexture    \n             uv0 = a_uv0;  \n        #endif  \n    \n        gl_Position = pos;\n    }",frag:"\n    #ifdef useTexture  \n        uniform sampler2D texture;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifdef useColor\n        uniform lowp vec4 color;\n    #else  \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {  \n        #ifdef useColor    \n             vec4 o = color;\n        #else\n             vec4 o = v_fragmentColor;  \n        #endif  \n        #ifdef useTexture    \n             vec2 uv_temp = uv0;\n             float x = uv_temp.x;\n             float y = uv_temp.y;\n             float offset = uv0.x * 3.14 / 2.0;\n             o.r = offset;\n             o *= texture2D(texture, uv_temp); \n\n        #endif  \n        gl_FragColor = o;\n    }",defines:[{name:"useModel"},{name:"useTexture"},{name:"useColor"}]},{name:"wave_sprite",vert:"\n    uniform float time;\n    uniform float deltaTime;\n    varying float v_time;\n    varying float v_deltaTime;\n    uniform mat4 viewProj;\n    attribute vec3 a_position;\n    attribute lowp vec4 a_color;\n    #ifdef useModel \n        uniform mat4 model;\n    #endif\n    #ifdef useTexture\n        attribute mediump vec2 a_uv0;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifndef useColor \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {\n        mat4 mvp;\n        #ifdef useModel\n             mvp = viewProj * model;\n        #else\n             mvp = viewProj;  \n        #endif  \n        vec4 pos = mvp * vec4(a_position, 1);\n        #ifndef useColor\n             v_fragmentColor = a_color;\n        #endif\n        #ifdef useTexture    \n             uv0 = a_uv0;  \n        #endif  \n        v_time = time;\n        v_deltaTime = deltaTime;\n        gl_Position = pos;\n    }",frag:"\n    varying float v_time;\n    varying float v_deltaTime;\n    \n    uniform float range;\n    #ifdef useTexture  \n        uniform sampler2D texture;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifdef useColor\n        uniform lowp vec4 color;\n    #else  \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {  \n        #ifdef useColor    \n             vec4 o = color;\n        #else\n             vec4 o = v_fragmentColor;  \n        #endif  \n        #ifdef useTexture    \n             vec2 uv_temp = uv0;\n             float x = uv_temp.x;\n             float y = uv_temp.y;\n             uv_temp.x += range*(sin(v_deltaTime + v_time + y) - sin(v_time + y));\n             uv_temp.y += range*(sin(v_deltaTime + v_time + x) - sin(v_time + x));\n             \n             o *= texture2D(texture, uv_temp); \n            \n        #endif  \n        //if (abs(o.x - 1.0) < 0.05 && abs(o.y - 1.0) < 0.05 && abs(o.z - 1.0) < 0.05) o.w = 0.0;\n        gl_FragColor = o;\n    }",defines:[{name:"useModel"},{name:"useTexture"},{name:"useColor"}]},{name:"point_wave",vert:"\n    uniform float time;\n    uniform float deltaTime;\n    varying float v_time;\n    varying float v_deltaTime;\n    uniform mat4 viewProj;\n    attribute vec3 a_position;\n    attribute lowp vec4 a_color;\n    #ifdef useModel \n        uniform mat4 model;\n    #endif\n    #ifdef useTexture\n        attribute mediump vec2 a_uv0;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifndef useColor \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {\n        mat4 mvp;\n        #ifdef useModel\n             mvp = viewProj * model;\n        #else\n             mvp = viewProj;  \n        #endif  \n        vec4 pos = mvp * vec4(a_position, 1);\n        #ifndef useColor\n             v_fragmentColor = a_color;\n        #endif\n        #ifdef useTexture    \n             uv0 = a_uv0;  \n        #endif  \n        v_time = time;\n        v_deltaTime = deltaTime;\n        gl_Position = pos;\n    }",frag:"\n    varying float v_time;\n    varying float v_deltaTime;\n    uniform mediump vec2 point;  \n    uniform float range;\n    #ifdef useTexture  \n        uniform sampler2D texture;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifdef useColor\n        uniform lowp vec4 color;\n    #else  \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {  \n        #ifdef useColor    \n             vec4 o = color;\n        #else\n             vec4 o = v_fragmentColor;  \n        #endif  \n        #ifdef useTexture    \n             vec2 uv_temp = uv0;\n             float x = uv_temp.x;\n             float y = uv_temp.y;\n             float r = sqrt((x-point.x)*(x-point.x) + (y-point.y)*(y-point.y));\n             float f = abs(range - abs(r - v_time));\n             if (abs(r - v_time) < range) {\n                 if(x > point.x) {\n                    uv_temp.x -= 0.01;\n                 } else if (x < point.x) {\n                     uv_temp.x += 0.01;\n                 }\n               \n                 if(y > point.y) {\n                    uv_temp.y -= 0.01;\n                 } else if (y > point.y) {\n                     uv_temp.y += 0.01;\n                 }\n                 \n                o.r *= (1.0 + f);\n                o.b *= (1.0 + f);\n                o.g *= (1.0 + f);\n             \n             } else {\n                #ifdef useShadow\n                 if (f > 0.3) f = 0.3;\n                o.r *= (1.0 - f);\n                o.b *= (1.0 - f);\n                o.g *= (1.0 - f);\n                #endif \n\n             }\n             o *= texture2D(texture, uv_temp); \n            \n        #endif  \n        //if (abs(o.x - 1.0) < 0.05 && abs(o.y - 1.0) < 0.05 && abs(o.z - 1.0) < 0.05) o.w = 0.0;\n        gl_FragColor = o;\n    }",defines:[{name:"useModel"},{name:"useTexture"},{name:"useColor"}]},{name:"pixel_style",vert:"\n    uniform mat4 viewProj;\n    attribute vec3 a_position;\n    attribute lowp vec4 a_color;\n    #ifdef useModel \n        uniform mat4 model;\n    #endif\n    #ifdef useTexture\n        attribute mediump vec2 a_uv0;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifndef useColor \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {\n        mat4 mvp;\n        #ifdef useModel\n             mvp = viewProj * model;\n        #else\n             mvp = viewProj;  \n        #endif  \n        vec4 pos = mvp * vec4(a_position, 1);\n        #ifndef useColor\n             v_fragmentColor = a_color;\n        #endif\n        #ifdef useTexture    \n             uv0 = a_uv0;  \n        #endif  \n        gl_Position = pos;\n    }",frag:"\n    uniform float sampleCount;\n    #ifdef useTexture  \n        uniform sampler2D texture;  \n        varying mediump vec2 uv0;\n    #endif\n    #ifdef useColor\n        uniform lowp vec4 color;\n    #else  \n        varying lowp vec4 v_fragmentColor;\n    #endif\n    void main () {  \n        #ifdef useColor    \n             vec4 o = color;\n        #else\n             vec4 o = v_fragmentColor;  \n        #endif  \n        #ifdef useTexture    \n             vec2 uv_temp = uv0;\n             float count = 1.0 / sampleCount;\n\n             float i = floor(uv0.x / count);\n             float j = floor(uv0.y / count);\n             float startX = count * i;\n             float endX = startX + count;\n             float pointX = (startX + endX) / 2.0;\n             \n\n             float startY = count * j;\n             float endY= startY + count;\n             float pointY = (startY + endY) / 2.0;\n             \n             if (uv0.x > startX && uv0.x < endX && uv0.y > startY && uv0.y < endY) {\n                uv_temp.x = pointX;\n                uv_temp.y = pointY;\n            }\n             o *= texture2D(texture, uv_temp); \n             #ifdef disableColor  \n                 float av = (o.r+o.g+o.b) / 3.0;  \n                 o.r = av;\n                 o.g = av;\n                 o.b = av;\n            #endif  \n        #endif  \n        gl_FragColor = o;\n    }",defines:[{name:"useModel"},{name:"useTexture"},{name:"useColor"}]},{name:"spine_pxiel",vert:"\n    uniform mat4 viewProj;\n    #ifdef use2DPos\n      attribute vec2 a_position;\n    #else\n      attribute vec3 a_position;\n    #endif\n    attribute lowp vec4 a_color;\n    #ifdef useTint\n      attribute lowp vec4 a_color0;\n    #endif\n    #ifdef useModel  \n      uniform mat4 model;\n    #endif\n    attribute mediump vec2 a_uv0;\n    varying mediump vec2 uv0;\n    varying lowp vec4 v_light;\n    #ifdef useTint  \n      varying lowp vec4 v_dark;\n    #endif\n    void main () {\n        mat4 mvp;\n        #ifdef useModel    \n           mvp = viewProj * model;  \n        #else    \n           mvp = viewProj;  \n        #endif\n        #ifdef use2DPos  \n           vec4 pos = mvp * vec4(a_position, 0, 1);\n        #else  \n           vec4 pos = mvp * vec4(a_position, 1);  \n        #endif  \n        v_light = a_color;  \n        #ifdef useTint    \n           v_dark = a_color0;  \n        #endif  \n        uv0 = a_uv0;  \n        gl_Position = pos;\n    }",frag:"\n        uniform float sampleCount;\n        uniform sampler2D texture;\n        varying mediump vec2 uv0;\n        #ifdef alphaTest  \n           uniform lowp float alphaThreshold;\n        #endif\n        varying lowp vec4 v_light;\n        #ifdef useTint\n           varying lowp vec4 v_dark;\n        #endif\n        void main () {\n                vec2 uv_temp = uv0;\n                float count = 1.0 / sampleCount;\n\n                float i = floor(uv0.x / count);\n                float j = floor(uv0.y / count);\n                float startX = count * i;\n                float endX = startX + count;\n                float pointX = (startX + endX) / 2.0;\n             \n\n                float startY = count * j;\n                float endY= startY + count;\n                float pointY = (startY + endY) / 2.0;\n             \n                if (uv0.x > startX && uv0.x < endX && uv0.y > startY && uv0.y < endY) {\n                   uv_temp.x = pointX;\n                   uv_temp.y = pointY;\n                }\n\n                vec4 texColor = texture2D(texture, uv_temp);\n                vec4 finalColor;  \n                #ifdef useTint\n                    finalColor.a = v_light.a * texColor.a;    \n                    finalColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;  \n                #else\n                    finalColor = texColor * v_light;\n                #endif  \n                #ifdef alphaTest    \n                    if (finalColor.a <= alphaThreshold)      \n                        discard;  \n                #endif  \n                #ifdef disableColor    \n                    float av = (finalColor.r+finalColor.g+finalColor.b) / 3.0;  \n                    finalColor.r = av;\n                    finalColor.g = av;\n                    finalColor.b = av;\n                #endif  \n                gl_FragColor = finalColor;\n        }",defines:[{name:"useModel"},{name:"alphaTest"},{name:"use2DPos"},{name:"useTint"}]}],cc._RF.pop()},{}],Solar:[function(e,t,n){"use strict";cc._RF.push(t,"66900C1/KhAO4HonDMvabMT","Solar"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../Config/Config"),r=e("./GameMgr"),s=e("../Factory/GameFactory"),c=cc._decorator,l=c.ccclass,u=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveFactor=-.01,t.planet=null,t.stars=null,t.meteorites=null,t.solarSystem=null,t.solarRoot=null,t.toolRoot1=null,t.toolRoot2=null,t.toolRoot3=null,t.speedY=0,t.speed=0,t.speedPoint=0,t.starsBasePos=[],t.maxX=-640,t.minX=-11600,t.itemRoots=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.itemRoots=[this.toolRoot1,this.toolRoot2,this.toolRoot3],this.basePos=cc.v2(this.node.x,this.node.y),this.planetBasePos=cc.v2(this.planet.x,this.planet.y),this.meteBasePos=cc.v2(this.meteorites.x,this.meteorites.y);for(var e=0;e<this.stars.childrenCount;e++){var t=this.stars.children[e];this.starsBasePos[e]=cc.v2(t.x,t.y)}this.node.active=!0,i.gEventMgr.on(o.GlobalEvent.SCALE_SCENE,this.scaleScene,this),this.node.opacity=0,this.solarSystem.opacity=0,this.solarSystem.active=!1,this.solarRoot.opacity=255},t.prototype.onNewLevel=function(){for(var e=0,t=this.itemRoots;e<t.length;e++)for(var n=0,i=t[e].children;n<i.length;n++){var o=i[n];s.gFactory.puItems(o.name,o)}for(var a=r.Game.curLevel,c=1;c<=3;c++){var l=a["prop"+c];if(l)for(var u=CMath.getRandom(),h=this.itemRoots[c-1].height/l.length,p=h*u,m=0;m<l.length;m++){(o=s.gFactory.getItems(l[m].toString(),null)).setPosition(0,p+h*m),this.itemRoots[c-1].addChild(o)}}},t.prototype.scaleScene=function(e,t,n){this.speed=e;var i=Math.max(cc.winSize.height,t-cc.winSize.height*a.Config.OpacityFactorLimit);this.node.opacity=255*(1-cc.winSize.height/i);var o=Math.max(0,t-1e6);if(this.solarRoot.opacity=255-this.solarSystem.opacity,o=Math.max(0,t-11e5),this.solarSystem.y=583*CMath.Clamp(1-o/2e5,1,0),o=Math.max(0,t-13e5),this.solarSystem.opacity>=255&&(this.solarSystem.scaleX=10*CMath.Clamp(1-o/2e5,1,0),this.solarSystem.scaleY=this.solarSystem.scaleX),this.node.opacity>180)this.speedY=this.moveFactor*e;else{this.node.setPosition(this.basePos),this.planet.setPosition(this.planetBasePos),this.meteorites.setPosition(this.meteBasePos);for(var r=0;r<this.stars.childrenCount;r++){this.stars.children[r].setPosition(this.starsBasePos[r])}this.speedY=0}},t.prototype.start=function(){},t.prototype.update=function(e){var t,n,a=this.speedY*e,r=0;this.speed>this.speedPoint&&this.speed<0&&0!=this.speedPoint?r+=a:(this.node.y+=a,this.speed<0&&(this.speedPoint=0)),this.node.y<this.minX?(r+=this.node.y-this.minX,this.node.y=this.minX,0==this.speedPoint&&(this.speedPoint=-this.speed)):this.node.y>this.maxX&&(r+=this.node.y-this.maxX,this.node.y=this.maxX),this.planet.y+=1.5*a+r,this.meteorites.y+=.5*a+r,this.stars.children[0].y+=.25*a+r,this.stars.children[1].y+=.25*a+r;var s=this.node.y<=-2850?"stars":"clouds";this.speed>0?this.stars.children[0].y+this.node.y+640<-1300&&(this.stars.children[0].y=this.stars.children[1].y+1280,i.gEventMgr.emit(o.GlobalEvent.STARS_CHANGE,s,this.stars.children[0].name),t=[this.stars.children[1],this.stars.children[0]],this.stars.children[0]=t[0],this.stars.children[1]=t[1]):this.stars.children[1].y+this.node.y+640>1300&&(this.stars.children[1].y=this.stars.children[0].y-1280,i.gEventMgr.emit(o.GlobalEvent.STARS_CHANGE,s,this.stars.children[1].name),n=[this.stars.children[1],this.stars.children[0]],this.stars.children[0]=n[0],this.stars.children[1]=n[1])},__decorate([u(cc.Float)],t.prototype,"moveFactor",void 0),__decorate([u(cc.Node)],t.prototype,"planet",void 0),__decorate([u(cc.Node)],t.prototype,"stars",void 0),__decorate([u(cc.Node)],t.prototype,"meteorites",void 0),__decorate([u(cc.Node)],t.prototype,"solarSystem",void 0),__decorate([u(cc.Node)],t.prototype,"solarRoot",void 0),__decorate([u(cc.Node)],t.prototype,"toolRoot1",void 0),__decorate([u(cc.Node)],t.prototype,"toolRoot2",void 0),__decorate([u(cc.Node)],t.prototype,"toolRoot3",void 0),t=__decorate([l],t)}(cc.Component);n.default=h,cc._RF.pop()},{"../Config/Config":"Config","../Event/EventManager":"EventManager","../Event/EventName":"EventName","../Factory/GameFactory":"GameFactory","./GameMgr":"GameMgr"}],Stars:[function(e,t,n){"use strict";cc._RF.push(t,"327deEUjatJDIh4UqVebdul","Stars"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cloudSpriteFrame=null,t.starFrame=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;i.gEventMgr.on(o.GlobalEvent.STARS_CHANGE,this.starsChange,this),i.gEventMgr.on(o.GlobalEvent.NEW_ENEMY,function(){e.getComponent(cc.Sprite).spriteFrame=e.cloudSpriteFrame},this),this.cloudSpriteFrame=this.getComponent(cc.Sprite).spriteFrame},t.prototype.starsChange=function(e,t){this.node.parent.name==t&&(this.getComponent(cc.Sprite).spriteFrame="stars"==e?this.starFrame:this.cloudSpriteFrame)},t.prototype.start=function(){},__decorate([s(cc.SpriteFrame)],t.prototype,"starFrame",void 0),t=__decorate([r],t)}(cc.Component);n.default=c,cc._RF.pop()},{"../Event/EventManager":"EventManager","../Event/EventName":"EventName"}],TableMgr:[function(e,t,n){"use strict";cc._RF.push(t,"884297Uj29L8bDc20pwjuOc","TableMgr"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(){this.load=e.JSON_URL&&""!=e.JSON_URL?cc.loader.load.bind(cc.loader):cc.loader.loadRes.bind(cc.loader),this.fileFormat=e.JSON_URL&&""!=e.JSON_URL?".json?time="+Date.now():"",this.total=0,this.complete=0,this.Punch_the_moon_evaluate={},this.Punch_the_moon_paly_level={},this.Punch_the_moon_prop={},this.Punch_the_moon_role={},this.Punch_the_moon_speed={}}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.startLoad=function(t,n,i){this.completeCallback=n,this.progressCallback=i;var o=this;console.log("Base URL:",e.JSON_URL),this.load(e.JSON_URL+t.trim().split("/").join("")+"/file_list"+this.fileFormat,function(e,n){if(e)console.error(e.errorMessage);else{var i="Array"==n.constructor.name?n:n.json;this.total=i.length;for(var a=0,r=i;a<r.length;a++){var s=r[a];o.loadJson(t.trim().split("/").join("")+"/"+s.replace(".json",""))}}}.bind(this))},e.prototype.loadJson=function(t){console.log("start load:"+t);var n=this,i=t.split("/")[1];i=i.charAt(0).toUpperCase()+i.slice(1,i.length),this.load(e.JSON_URL+t+this.fileFormat,function(e,t){if(e)console.error(e.errorMessage);else{for(var o=0,a="Array"==t.constructor.name?t:t.json;o<a.length;o++){var r=a[o];n[i][r.ID]=r}n.completeLoad()}}.bind(this))},e.prototype.completeLoad=function(){this.complete++,this.complete>=this.total&&this.completeCallback&&this.completeCallback()},e.prototype.getPunch_the_moon_evaluate=function(e){return this.Punch_the_moon_evaluate[e]?this.Punch_the_moon_evaluate[e]:(console.error("Punch_the_moon_evaluate \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Punch_the_moon_evaluate_Data=function(){return this.Punch_the_moon_evaluate},e.prototype.getPunch_the_moon_paly_level=function(e){return this.Punch_the_moon_paly_level[e]?this.Punch_the_moon_paly_level[e]:(console.error("Punch_the_moon_paly_level \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Punch_the_moon_paly_level_Data=function(){return this.Punch_the_moon_paly_level},e.prototype.getPunch_the_moon_prop=function(e){return this.Punch_the_moon_prop[e]?this.Punch_the_moon_prop[e]:(console.error("Punch_the_moon_prop \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Punch_the_moon_prop_Data=function(){return this.Punch_the_moon_prop},e.prototype.getPunch_the_moon_role=function(e){return this.Punch_the_moon_role[e]?this.Punch_the_moon_role[e]:(console.error("Punch_the_moon_role \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Punch_the_moon_role_Data=function(){return this.Punch_the_moon_role},e.prototype.getPunch_the_moon_speed=function(e){return this.Punch_the_moon_speed[e]?this.Punch_the_moon_speed[e]:(console.error("Punch_the_moon_speed \u4e0d\u5b58key\uff1a"+e),null)},e.prototype.getAll_Punch_the_moon_speed_Data=function(){return this.Punch_the_moon_speed},e.JSON_URL="",e}();n.TableMgr=i,cc._RF.pop()},{}],Tool:[function(e,t,n){"use strict";cc._RF.push(t,"e4ca9QJEr5Iw64ltqdeoqk8","Tool"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Event/EventManager"),o=e("../Event/EventName"),a=e("../table"),r=e("../TableMgr"),s=e("./GameMgr"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isShow=!1,t.world=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.reuse()},t.prototype.reuse=function(){console.log(" --------------------------- item reuse -------------------"),i.gEventMgr.on(o.GlobalEvent.SYNC_ACHIEVE,this.updateHeight,this),i.gEventMgr.on(o.GlobalEvent.NEW_ENEMY,this.startGame,this),this.world=cc.director.getScene().getChildByName("Canvas"),this.toolData=r.TableMgr.inst.getPunch_the_moon_prop(this.node.name),this.node.opacity=255},t.prototype.unuse=function(){console.log(" ---------------------- item unuse ---------------- "),i.gEventMgr.targetOff(this),this.node.opacity=0},t.prototype.start=function(){},t.prototype.startGame=function(){this.isShow=!1},t.prototype.updateHeight=function(e,t){if(!this.isShow){e=Math.max(e,0);var n=t.node.parent.convertToWorldSpace(t.node.position),i=this.node.parent.convertToWorldSpace(this.node.position),o=this.world.convertToNodeSpaceAR(n),r=this.world.convertToNodeSpaceAR(i);Math.abs(r.y-o.y)<=120&&t.speed.y>0&&0==this.isShow&&s.Game.canGetTool&&this.node.opacity>0&&(this.isShow=!0,this.toolData.form==a.Punch_the_moon_prop_form.HuiXie?(s.Game.addHp(this.toolData.recover),s.Game.addPower(.5*s.Game.totalPower)):s.Game.addScore(this.toolData.score),this.unuse())}},t=__decorate([l],t)}(cc.Component));n.default=u,cc._RF.pop()},{"../Event/EventManager":"EventManager","../Event/EventName":"EventName","../TableMgr":"TableMgr","../table":"table","./GameMgr":"GameMgr"}],TransitionMask:[function(e,t,n){"use strict";cc._RF.push(t,"08619DCzsFP6qP811EwquC2","TransitionMask"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transitionMaterial=new i.TransitionMaterial,t.startTrans=!1,t.time=0,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this.getComponent(cc.Mask);e._material=this.transitionMaterial,e._activateMaterial(),this.transitionMaterial.setProperty("range",.1)},t.prototype.start=function(){},t.prototype.update=function(e){this.startTrans&&(this.time+=1.2*e,this.transitionMaterial.setProperty("time",this.time))},t=__decorate([a],t)}(cc.Component));n.default=r,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],TransitionSprite:[function(e,t,n){"use strict";cc._RF.push(t,"8f657dtmIRFtbSyVO1VxUsJ","TransitionSprite"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transitionMaterial=new i.TransitionMaterial,t.time=0,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this.getComponent(cc.Sprite);e._spriteMaterial=this.transitionMaterial,e._activateMaterial(),this.transitionMaterial.setProperty("range",.1)},t.prototype.start=function(){},t.prototype.update=function(e){this.node.active?(this.Time+=.8*e,this.time>2&&(this.Time=0,this.node.active=!1)):this.Time=0},Object.defineProperty(t.prototype,"Time",{get:function(){return this.time},set:function(e){this.time=e,this.transitionMaterial.setProperty("time",this.time)},enumerable:!0,configurable:!0}),t=__decorate([a],t)}(cc.Component));n.default=r,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],UIManager:[function(e,t,n){"use strict";cc._RF.push(t,"0637bWDjtNKJorZPZNuT2pe","UIManager"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Utils/HashMap"),o=e("../UI/export/Game/GameBinder"),a=e("../UI/export/Window/WindowBinder"),r=cc._decorator.ccclass,s=function(){function e(){this.isInit=!1,this.guiMap=new i.HashMap,this.windowMap=new i.HashMap}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(){fgui.addLoadHandler(),cc.view.setResizeCallback(this.onResize.bind(this)),cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){fgui.GRoot.create(),console.info("########################### fgui.GRoot.create ###########################")},this),this.isInit=!0},e.prototype.loadUIPackage=function(e){console.warn(" start load loadUIPackage "),this.isInit||this.init(),this.windowMap.clear(),this.guiMap.clear(),fgui.UIPackage._instById={},cc.loader.loadResDir("UI/sync",function(t,n,i){if(console.log(i),t)e(t);else{for(var r=0,s=i;r<s.length;r++){var c=s[r];/atlas/.test(c)||fgui.UIPackage.addPackage(c)}o.default.bindAll(),a.default.bindAll(),e(null)}})},e.prototype.onResize=function(){var e=cc.view.getCanvasSize();e.width/=cc.view.getScaleX(),e.height/=cc.view.getScaleY(),this.guiMap.forEach(function(t,n){n.setPosition((e.width-n.width)/2,(e.height-n.height)/2)}),this.windowMap.forEach(function(t,n){n.setPosition((e.width-n.width)/2,(e.height-n.height)/2)})},e.prototype.openGUI=function(e,t){var n=this.guiMap.get(e.URL);if(n){var i=n.node.getComponent(t);return n.node.active?console.warn("UI is showed:"+e.URL):i.show(),i}var o=e.createInstanceSync();return o.setPosition((fgui.GRoot.inst.width-o.width)/2,(fgui.GRoot.inst.height-o.height)/2),fgui.GRoot.inst.addChild(o),this.guiMap.add(e.URL,o),o.node.addComponent(t).register(o).show()},e.prototype.closeGUI=function(e,t){var n=this.guiMap.get(e.URL);return n?n.node.getComponent(t).hide():(console.error("UI not exist:"+e.URL),null)},e.prototype.openWindow=function(e,t){var n=this,i=this.windowMap.get(e.URL);if(i){var o=i.node.getComponent(t);i.node.active?console.warn("UI is showed:"+e.URL):o.show()}else e.createInstance(function(i){var o=new fgui.Window;o.contentPane=i,o.modal=!0,o.show(),o.setPosition((fgui.GRoot.inst.width-o.width)/2,(fgui.GRoot.inst.height-o.height)/2),n.windowMap.add(e.URL,o),o.node.addComponent(t).register(i).show()})},e.prototype.closeWindow=function(e,t,n){void 0===n&&(n=!0);var i=this.windowMap.get(e.URL);if(!i)return console.error("UI not exist:"+e.URL),!1;i.hide();var o=i.node.getComponent(t).hide(n);return n&&e.releaseInstance(),this.windowMap.remove(e.URL),o},e}();n.UIMgr=s.inst;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onShow=function(){},t.prototype.onHide=function(){},t.prototype.show=function(){return this.node.isValid?(this.node.active||(this.node.active=!0),this.onShow(),this):(console.error(" node valid!"),this)},t.prototype.hide=function(e){return void 0===e&&(e=!1),this.node.isValid?(this.node.active&&(this.node.active=!1),this.onHide(),e&&this.node.removeFromParent(e),!0):(console.error(" node valid!"),!1)},t=__decorate([r],t)}(cc.Component);n.BaseUI=c,cc._RF.pop()},{"../UI/export/Game/GameBinder":"GameBinder","../UI/export/Window/WindowBinder":"WindowBinder","../Utils/HashMap":"HashMap"}],WaveSprite:[function(e,t,n){"use strict";cc._RF.push(t,"313bfIxOzREdKYyjG/uVSPs","WaveSprite"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ShaderManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wave=new i.WaveMaterial,t.time=0,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this.getComponent(cc.Sprite);e&&(e._spriteMaterial=this.wave,e._activateMaterial(),this.wave.setProperty("range",1))},t.prototype.start=function(){},t.prototype.update=function(e){this.time+=10*e,this.wave.setProperty("time",this.time),this.wave.setProperty("deltaTime",e)},t=__decorate([a],t)}(cc.Component));n.default=r,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],WelcomeScene:[function(e,t,n){"use strict";cc._RF.push(t,"8bdc2kTeilDGqLTs2cFtYeY","WelcomeScene"),Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("../Config/Config"),a=e("../TableMgr"),r=e("../Shader/ShaderManager"),s=e("../Controller/AudioController"),c=e("../Controller/UIManager"),l=e("../Utils/celerx"),u=cc._decorator,h=u.ccclass,p=u.property;(function(e){e[e.READY=2]="READY",e[e.INIT=4]="INIT",e[e.REGISTER=8]="REGISTER",e[e.LOGIN=16]="LOGIN",e[e.MATCH=32]="MATCH",e[e.JSON_PARSE=64]="JSON_PARSE",e[e.ANIMATION_DONE=128]="ANIMATION_DONE",e[e.SCENE_DONE=256]="SCENE_DONE",e[e.AUDIO=512]="AUDIO",e[e.UI=1024]="UI",e[e.CELER=2048]="CELER",e[e.DONE=4094]="DONE"})(i=n.LOAD_STEP||(n.LOAD_STEP={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nextSceneName="game",t.percentLabel=null,t.maxPercent=0,t.curPercent=0,t._step=i.READY,t.startTime=0,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;l.ready(),CMath.randomSeed=(new Date).getMonth();var t=this;l.onStart(function(){t.onCelerStart()}),this.onCelerStart(),this.startTime=Date.now(),r.ShaderManager.inst,cc.game.setFrameRate(o.Config.FPS),this.maxPercent=0,this.defaultAnimation=this.node.getComponent(cc.Animation),this.defaultAnimation?this.defaultAnimation.once(cc.Animation.EventType.FINISHED,this.animationDone,this):this.nextStep(i.ANIMATION_DONE),o.Config.isMultiPlayer||(this.nextStep(i.LOGIN),this.nextStep(i.MATCH),this.nextStep(i.REGISTER),this.nextStep(i.INIT)),a.TableMgr.inst.startLoad("json/",function(){e.nextStep(i.JSON_PARSE)}),s.gAudio.init(function(){this.nextStep(i.AUDIO)}.bind(this)),cc.director.preloadScene(this.nextSceneName,null,function(t,n){t?console.error("\u573a\u666f\u52a0\u8f7d\u9519\u8bef"):(e.nextScene=n.scene,e.nextStep(i.SCENE_DONE))}),c.UIMgr.loadUIPackage(function(t){t?console.error("UI \u52a0\u8f7d\u9519\u8bef:",t):e.nextStep(i.UI)})},t.prototype.onCelerStart=function(){var e=l.getMatch();e&&e.sharedRandomSeed?CMath.randomSeed=e.sharedRandomSeed:CMath.randomSeed=Date.now(),this.nextStep(i.CELER)},t.prototype.update=function(e){this.curPercent+=e/5,this.curPercent>=this.maxPercent&&(this.curPercent=this.maxPercent),this.percentLabel.string=(100*this.curPercent).toFixed(2)+"%",this.curPercent>=1&&this.node.emit("load_done")},t.prototype.animationDone=function(){this.defaultAnimation.off(cc.Animation.EventType.FINISHED),this.nextStep(i.ANIMATION_DONE)},t.prototype.nextStep=function(e){var t=this;this.calLoadTime(e),this._step|=e,e!=i.ANIMATION_DONE&&console.log("CUR STEP:"+i[e]+", total: "+this._step),this.maxPercent=(this._step&(65535^i.ANIMATION_DONE))/(i.DONE&(65535^i.ANIMATION_DONE)),this._step>=i.DONE?(this.node.once("load_done",function(){t.nextScene?cc.director.runSceneImmediate(t.nextScene):cc.director.loadScene(t.nextSceneName)},this),this.defaultAnimation&&(this.defaultAnimation.play().wrapMode=cc.WrapMode.Loop)):e==i.ANIMATION_DONE&&this.defaultAnimation&&(this._step&=65535^i.ANIMATION_DONE,this.defaultAnimation.once(cc.Animation.EventType.FINISHED,this.animationDone,this),this.defaultAnimation.play())},t.prototype.calLoadTime=function(e){switch(e){case i.AUDIO:console.warn(" audio cost time:",Date.now()-this.startTime,"ms");break;case i.JSON_PARSE:console.warn(" table cost time:",Date.now()-this.startTime,"ms");break;case i.UI:console.warn(" UI cost time:",Date.now()-this.startTime,"ms");break;case i.SCENE_DONE:console.warn(" Scene cost time:",Date.now()-this.startTime,"ms")}},__decorate([p({displayName:"\u6e38\u620f\u573a\u666f\u540d",tooltip:"\u9ed8\u8ba4\u8fdb\u5165game\u573a\u666f\uff0c\u5982\u679c\u9700\u8981\u6307\u5b9a\u573a\u666f\uff0c\u53ef\u4ee5\u6307\u5b9a"})],t.prototype,"nextSceneName",void 0),__decorate([p(cc.Label)],t.prototype,"percentLabel",void 0),t=__decorate([h],t)}(cc.Component);n.default=m,cc._RF.pop()},{"../Config/Config":"Config","../Controller/AudioController":"AudioController","../Controller/UIManager":"UIManager","../Shader/ShaderManager":"ShaderManager","../TableMgr":"TableMgr","../Utils/celerx":"celerx"}],WindowBinder:[function(e,t,n){"use strict";cc._RF.push(t,"6d897HzfxxKer5X5xvRpfcZ","WindowBinder"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("./OverWindow"),o=function(){function e(){}return e.bindAll=function(){fgui.UIObjectFactory.setExtension(i.default.URL,i.default)},e}();n.default=o,cc._RF.pop()},{"./OverWindow":"OverWindow"}],celerx:[function(e,t,n){"use strict";cc._RF.push(t,"deadatK8OBKe71sPvMQnU76","celerx");var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){var t=new Uint8Array(e);e=[];for(var n=0,i=Array(3),o=Array(4),a=t.length,r=0;a--;)if(i[n++]=t[r++],3==n){for(o[0]=(252&i[0])>>2,o[1]=((3&i[0])<<4)+((240&i[1])>>4),o[2]=((15&i[1])<<2)+((192&i[2])>>6),o[3]=63&i[2],n=0;4>n;n++)e+=c.charAt(o[n]);n=0}if(n){for(t=n;3>t;t++)i[t]=0;for(o[0]=(252&i[0])>>2,o[1]=((3&i[0])<<4)+((240&i[1])>>4),o[2]=((15&i[1])<<2)+((192&i[2])>>6),o[3]=63&i[2],t=0;t<n+1;t++)e+=c.charAt(o[t]);for(;3>n++;)e+="="}return e}function a(e){var t,n,i,o,a,r=[],s=0;if((o=e)!=(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""))&&alert("Warning! Characters outside Base64 range in input string ignored."),e.length%4)return alert("Error: Input length is not a multiple of 4 bytes."),"";for(var c=0;s<e.length;)t=(t=l.indexOf(e.charAt(s++)))<<2|(n=l.indexOf(e.charAt(s++)))>>4,n=(15&n)<<4|(o=l.indexOf(e.charAt(s++)))>>2,i=(3&o)<<6|(a=l.indexOf(e.charAt(s++))),r[c++]=t,64!=o&&(r[c++]=n),64!=a&&(r[c++]=i);return r}var r="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)},s={default:void 0,call:function(e,t,n){var i="";if("function"==typeof t&&(n=t,t={}),t={data:void 0===t?null:t},"function"==typeof n){var o="dscb"+window.dscb++;window[o]=n,t._dscbstub=o}return t=JSON.stringify(t),window._dsbridge?i=_dsbridge.call(e,t):(window._dswk||-1!=navigator.userAgent.indexOf("_dsbridge"))&&(i=prompt("_dsbridge="+e,t)),JSON.parse(i||"{}").data},register:function(e,t,n){n=n?window._dsaf:window._dsf,window._dsInit||(window._dsInit=!0,setTimeout(function(){s.call("_dsb.dsinit")},0)),"object"==(void 0===t?"undefined":r(t))?n._obs[e]=t:n[e]=t},registerAsyn:function(e,t){this.register(e,t,!0)},hasNativeMethod:function(e,t){return this.call("_dsb.hasNativeMethod",{name:e,type:t||"all"})},disableJavascriptDialogBlock:function(e){this.call("_dsb.disableJavascriptDialogBlock",{disable:!1!==e})}};!function(){if(!window._dsf){var e,t={_dsf:{_obs:{}},_dsaf:{_obs:{}},dscb:0,celerx:s,close:function(){s.call("_dsb.closePage")},_handleMessageFromNative:function(e){var t=JSON.parse(e.data),n={id:e.callbackId,complete:!0},i=this._dsf[e.method],o=this._dsaf[e.method],a=function(e,i){n.data=e.apply(i,t),s.call("_dsb.returnValue",n)},r=function(e,i){t.push(function(e,t){n.data=e,n.complete=!1!==t,s.call("_dsb.returnValue",n)}),e.apply(i,t)};if(i)a(i,this._dsf);else if(o)r(o,this._dsaf);else if(i=e.method.split("."),!(2>i.length)){e=i.pop();i=i.join(".");var c=(o=(o=this._dsf._obs)[i]||{})[e];c&&"function"==typeof c?a(c,o):(c=(o=(o=this._dsaf._obs)[i]||{})[e])&&"function"==typeof c&&r(c,o)}}};for(e in t)window[e]=t[e];s.register("_hasJavascriptMethod",function(e,t){return 2>(t=e.split(".")).length?!(!_dsf[t]&&!_dsaf[t]):(e=t.pop(),t=t.join("."),(t=_dsf._obs[t]||_dsaf._obs[t])&&!!t[e])})}}();var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.exports={onStateReceived:function(e){return s.register("onStateReceived",function(t){return t=a(t),e(new Uint8Array(t))})},onCourtModeStarted:function(e){return s.register("onCourtModeStarted",e)},getMatch:function(){var e=s.call("getMatch","123");try{e=JSON.parse(e)}catch(e){}return e},showCourtModeDialog:function(){return s.call("showCourtModeDialog")},start:function(){return s.call("start")},sendState:function(e){return s.call("sendState",o(e))},draw:function(e){return s.call("draw",o(e))},win:function(e){return s.call("win",o(e))},lose:function(e){return s.call("lose",o(e))},surrender:function(e){return s.call("surrender",o(e))},applyAction:function(e,t){return s.call("applyAction",o(e),t)},getOnChainState:function(e){return s.call("getOnChainState","123",function(t){return t=a(t),e(new Uint8Array(t))})},getOnChainActionDeadline:function(e){return s.call("getOnChainActionDeadline","123",e)},getCurrentBlockNumber:function(){return s.call("getCurrentBlockNumber","123")},finalizeOnChainGame:function(e){return s.call("finalizeOnChainGame","123",e)},submitScore:function(e){return s.call("submitScore",e)},ready:function(){return s.call("ready")},onStart:function(e){return s.register("onStart",e)}},cc._RF.pop()},{}],fguiMainUI:[function(e,t,n){"use strict";cc._RF.push(t,"e623cRBazxLHr5uB47CCyBN","fguiMainUI"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Game","fguiMainUI")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Game",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Game","fguiMainUI").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Game")},t.prototype.onConstruct=function(){this.m_XPBg=this.getChild("XPBg"),this.m_Record=this.getChild("Record"),this.m_punchButton=this.getChild("punchButton"),this.m_altitudeBar=this.getChild("altitudeBar"),this.m_hpBar=this.getChild("hpBar"),this.m_powerBar=this.getChild("powerBar"),this.m_xpButton=this.getChild("xpButton"),this.m_Score=this.getChild("Score"),this.m_altitudeLabel=this.getChild("altitudeLabel"),this.m_PlayerXPImg=this.getChild("PlayerXPImg"),this.m_playerHpLabel=this.getChild("playerHpLabel"),this.m_IconLoader=this.getChild("IconLoader"),this.m_perfect=this.getChild("perfect"),this.m_Tip=this.getChild("Tip"),this.m_startButton=this.getChild("startButton"),this.m_playerXpAni=this.getTransition("playerXpAni"),this.m_StartButtonAni=this.getTransition("StartButtonAni")},t.URL="ui://vmvonsvyv7i62",t}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],rangeSlider:[function(e,t,n){"use strict";cc._RF.push(t,"97ae2IPdIVCdIkDykLjoWtD","rangeSlider"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createInstanceSync=function(){return fgui.UIPackage.createObject("Game","rangeSlider")},t.createInstance=function(e){fgui.UIPackage.loadPackage("UI/dync/Game",function(t){t?console.error("load package error:",t):e(fgui.UIPackage.createObject("Game","rangeSlider").asCom)})},t.releaseInstance=function(){fgui.UIPackage.removePackage("Game")},t.prototype.onConstruct=function(){this.m_1=this.getChild("1")},t.URL="ui://vmvonsvyyglgtm",t}(fgui.GSlider);n.default=i,cc._RF.pop()},{}],table:[function(e,t,n){"use strict";cc._RF.push(t,"e1a74J8tcJNy4RWW77X8AbS","table"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.HuiXie=1]="HuiXie",e[e.JiaFen=2]="JiaFen"}(n.Punch_the_moon_prop_form||(n.Punch_the_moon_prop_form={})),cc._RF.pop()},{}]},{},["Config","AudioController","CameraController","UIManager","AltitudeTag","Base","Boom","Enemy","GameMgr","Player","Solar","Stars","Tool","EventManager","EventName","GameFactory","GameScene","WelcomeScene","ButterFlySpring","PixelSprite","PointWave","ShaderManager","ShaderTemplate","TransitionMask","TransitionSprite","WaveSprite","TableMgr","MainUI","OverWinUI","AchieveIcon","AltitudeBar","GameBinder","PunchButton","Record","fguiMainUI","rangeSlider","OverWindow","WindowBinder","HashMap","celerx","table"]);