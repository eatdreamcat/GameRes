window.__require=function e(t,o,n){function i(s,a){if(!o[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!a&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({AnswerView:[function(e,t,o){"use strict";cc._RF.push(t,"b55dfV3kjNJ7bx5aiEK2cYI","AnswerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=cc._decorator,r=i.ccclass,s=i.property,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.AnswerViewShowSignal=a;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.active=!CELER_X,a.inst.addListenerOne(function(t){e.label.string=t},this)},__decorate([s(cc.Label)],t.prototype,"label",void 0),t=__decorate([r],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../Utils/Signal":"Signal"}],App:[function(e,t,o){"use strict";cc._RF.push(t,"eaeeaWDD5pJfqkUameEwNsk","App"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Controller/ResourceController"),i=e("../Initialization/Facade/InitialFacade"),r=e("../Model/PlayModelProxy"),s=e("../Utils/HashMap"),a=cc._decorator,c=a.ccclass,l=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UI=null,t.Animation=null,t.Add=null,t.Sub=null,t.ShowScore=null,t.TimeRed=null,t.TimeWhite=null,t.Result=null,t.HintButton=null,t}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){console.log(" app onload "),o.HintRoot=this.HintButton,cc.debug.setDisplayStats(!1),this.UI&&n.ResourceController.inst.setAtlas(this.UI),this.Animation&&n.ResourceController.inst.setAnimationAtlas(this.Animation),this.Result&&n.ResourceController.inst.setFont(n.Font.ResultScore,this.Result),this.Add&&n.ResourceController.inst.setFont(n.Font.AddScore,this.Add),this.Sub&&n.ResourceController.inst.setFont(n.Font.SubScore,this.Sub),this.ShowScore&&n.ResourceController.inst.setFont(n.Font.ShowScore,this.ShowScore),this.TimeRed&&n.ResourceController.inst.setFont(n.Font.TimeRed,this.TimeRed),this.TimeWhite&&n.ResourceController.inst.setFont(n.Font.TimeWhite,this.TimeWhite)},t.prototype.start=function(){i.InitialFacade.inst.start()},t.prototype.update=function(e){r.PlayModelProxy.inst.addGameTime(-e)},t.TuneMatchMap=new s.HashMap,t.TuneRootMap=new s.HashMap,__decorate([l(cc.SpriteAtlas)],t.prototype,"UI",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"Animation",void 0),__decorate([l(cc.Font)],t.prototype,"Add",void 0),__decorate([l(cc.Font)],t.prototype,"Sub",void 0),__decorate([l(cc.Font)],t.prototype,"ShowScore",void 0),__decorate([l(cc.Font)],t.prototype,"TimeRed",void 0),__decorate([l(cc.Font)],t.prototype,"TimeWhite",void 0),__decorate([l(cc.Font)],t.prototype,"Result",void 0),__decorate([l(cc.Node)],t.prototype,"HintButton",void 0),t=o=__decorate([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../Controller/ResourceController":"ResourceController","../Initialization/Facade/InitialFacade":"InitialFacade","../Model/PlayModelProxy":"PlayModelProxy","../Utils/HashMap":"HashMap"}],AudioManager:[function(e,t,o){"use strict";cc._RF.push(t,"88c70Ktw0pBKKUTDtyQ2NkZ","AudioManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=e("../Command/CommonSignal"),r=e("../Controller/GameStateController"),s=e("../Utils/ToSingleton"),a=e("../Utils/Signal"),c=e("../GamePlay/View/UI/SkipButtonView");window.oncanplay&&(window.oncanplay=function(){m.canPlay=!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.GoodSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.NiceSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.GreatSignal=h;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.KillSuccessSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.MoveSuccessSignal=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.MoveFailSignal=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.Oop3ToNextSignal=y;var g="sounds/",m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioID={},t.clips=new n.HashMap,t.effectVolumeScale=1,t.musicVolumeScale=.8,t}return __extends(t,e),t.prototype.init=function(e){var t=this;console.log(" start load AudioClip ");var o=this;cc.loader.loadRes(g+"bgm",cc.AudioClip,function(t,n){t?console.error(t):("string"==typeof n._audio&&cc.loader._cache&&cc.loader._cache[n._audio]&&cc.loader._cache[n._audio].buffer&&(n._audio=cc.loader._cache[n._audio].buffer),o.clips.add(n.name,n),e&&e(),o.playMusic("bgm",!0))}),cc.loader.loadResDir(g,function(e,o,n){if(e)console.error(e);else for(var i=0,r=o;i<r.length;i++){var s=r[i];"string"==typeof s._audio&&cc.loader._cache&&cc.loader._cache[s._audio]&&cc.loader._cache[s._audio].buffer&&(s._audio=cc.loader._cache[s._audio].buffer),t.clips.has(s.name)||t.clips.add(s.name,s)}}),this.bindSignal()},t.prototype.setEffectVolume=function(e){this.effectVolumeScale=1,cc.audioEngine.setEffectsVolume(e*this.effectVolumeScale)},t.prototype.setMusicVolume=function(e){this.musicVolumeScale=1,cc.audioEngine.setMusicVolume(e*this.musicVolumeScale)},Object.defineProperty(t.prototype,"EffectVolume",{get:function(){return cc.audioEngine.getEffectsVolume()/this.effectVolumeScale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MusicVolume",{get:function(){return cc.audioEngine.getMusicVolume()/this.musicVolumeScale},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){var e=this;this.setEffectVolume(1),this.setMusicVolume(1),y.inst.addListener(function(){e.playEffect("oop3tonext")},this),p.inst.addListener(function(){e.playEffect("kill_success")},this),f.inst.addListener(function(){e.playEffect("move_fail")},this),d.inst.addListener(function(){e.playEffect("move_success")},this),l.inst.addListener(function(){e.playEffect("GOOD")},this),u.inst.addListener(function(){e.playEffect("NICE")},this),h.inst.addListener(function(){e.playEffect("GREAT")},this),i.UpdateTimeNumber.inst.addListenerOne(function(t){if(t>=30){if(cc.audioEngine.getState(e.audioID.bgm)==cc.audioEngine.AudioState.PLAYING)return;e.playMusic("bgm",!0)}else{if(cc.audioEngine.getState(e.audioID.bgm_30)==cc.audioEngine.AudioState.PLAYING)return;e.playMusic("bgm_30",!0)}},this),i.ScoreCountingSignal.inst.addListener(function(){e.audioID.scoreCount||e.playEffect("scoreCount",!1,function(){e.audioID.scoreCount=null})},this),i.ShowSubmitSignal.inst.addListener(function(){e.audioID.scoreCount&&cc.audioEngine.stopEffect(e.audioID.scoreCount),e.playEffect("showSubmit")},this),i.OpenResultLayerSignal.inst.addListenerOne(function(t){t==r.RoundEndType.TimeUp?e.playEffect("show_result"):(r.RoundEndType.Complete,e.playEffect("show_result"))},this),i.PlayerScoreChanged.inst.addListenerThree(function(e,t,o){},this),c.SkipSignal.inst.addListener(function(){e.playEffect("skip")},this),i.GamePauseSignal.inst.addListener(function(){e.playEffect("pause")},this),i.ButtonClickSignal.inst.addListener(function(){e.playEffect("click")},this),i.CountDownSignal.inst.addListener(function(){e.playEffect("countDown")},this),i.GameOverSignal.inst.addListenerOne(function(t){switch(t){case r.RoundEndType.Complete:e.playEffect("complete");break;case r.RoundEndType.TimeUp:e.playEffect("timeup");break;case r.RoundEndType.Over:e.playEffect("over")}},this)},t.prototype.playEffect=function(e,o,n){var i=this;if(void 0===o&&(o=!1),t.canPlay){if(!(cc.audioEngine.getEffectsVolume()<=.05)){var r=this.clips.get(e);r?(this.audioID[e]=cc.audioEngine.playEffect(r,o),cc.audioEngine.setFinishCallback(this.audioID[e],function(){n&&n()})):cc.loader.loadRes(g+e,cc.AudioClip,function(t,r){t?console.error(t):("string"==typeof r._audio&&cc.loader._cache&&cc.loader._cache[r._audio]&&cc.loader._cache[r._audio].buffer&&(r._audio=cc.loader._cache[r._audio].buffer),i.clips.add(r.name,r),i.audioID[e]=cc.audioEngine.playEffect(r,o),cc.audioEngine.setFinishCallback(i.audioID[e],function(){n&&n()}))})}}else this.bindTouch()},t.prototype.playMusic=function(e,o){var n=this;if(void 0===o&&(o=!0),!t.canPlay)return this.bindTouch(),void t.PlayedList.push({loop:!0,volume:1,clipName:e,supTime:Date.now(),skip:!1,isBgm:!0});var i=this.clips.get(e);i?this.audioID[e]=cc.audioEngine.playMusic(i,o):cc.loader.loadRes(g+e,cc.AudioClip,function(t,i){t?console.error(t):("string"==typeof i._audio&&cc.loader._cache&&cc.loader._cache[i._audio]&&cc.loader._cache[i._audio].buffer&&(i._audio=cc.loader._cache[i._audio].buffer),n.clips.add(i.name,i),n.audioID[e]=cc.audioEngine.playMusic(i,o))})},t.prototype.bindTouch=function(){if(!t.hasBindTouch){var e=this,o=function(){var n;for(cc.game.canvas.removeEventListener("touchstart",o),t.canPlay=!0;(n=t.PlayedList.pop())&&e.clips.get(n.clipName)&&!n.skip;)cc.audioEngine.playMusic(e.clips.get(n.clipName),n.loop)};t.hasBindTouch=!0,cc.game.canvas.addEventListener("touchstart",o)}},t.PlayedList=[],t.canPlay=cc.sys.WIN32==cc.sys.platform,t.hasBindTouch=!1,t}(s.SingleTon());o.gAudio=m.inst,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","../GamePlay/View/UI/SkipButtonView":"SkipButtonView","../Utils/HashMap":"HashMap","../Utils/Signal":"Signal","../Utils/ToSingleton":"ToSingleton"}],BaseMediator:[function(e,t,o){"use strict";cc._RF.push(t,"a76c1ySm3tAQId4zbAsdr/d","BaseMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){console.error(" should override onRegister ")},t.prototype.onUnregister=function(){console.error(" should override onUnregister ")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"6daedF7tVNJ3qN565kuohVZ","BaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=0},t.prototype.Show=function(e){this.node.active=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()})))},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.active=!1,e&&e()})))},t.prototype.OnClick=function(){},t.prototype.BindMedaitor=function(e){if(!this.node.getComponent(e)){var t=this.node.addComponent(e);return t.bind&&t.bind(this),t.onRegister&&t.onRegister(),t}console.warn(" this node already has the same component..")},t.prototype.UnbindMedaitor=function(e){var t=this.node.getComponent(e);if(t)return t.onUnregister&&t.onUnregister(),t.bind&&t.bind(null),this.node.removeComponent(e),t;console.warn(" component already removed..")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],BlackView:[function(e,t,o){"use strict";cc._RF.push(t,"f7137KIFk5HzYzsbeidU/gx","BlackView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.GameOverSignal.inst.addListenerOne(function(t){t!=i.RoundEndType.Complete&&(e.node.active=!0)},this),this.node.active=!1},t.prototype.start=function(){},t=__decorate([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController"}],CelerSDK:[function(e,t,o){"use strict";cc._RF.push(t,"34a72Ol/DRKJb0NyonTxi8g","CelerSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ToSingleton"),i=e("../LogHandler"),r=e("../Random"),s=e("../../Command/CommonSignal"),a=e("../../Model/PlayModelProxy"),c=e("../../Controller/GameStateController"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alreadySubmit=!1,t.isNewPlayer=!0,t.celerStartCallback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"MatchID",{get:function(){return this.match.matchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MatchRandomSeed",{get:function(){return this.match.sharedRandomSeed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DifficultyLevel",{get:function(){return this.match.difficultyLevel},enumerable:!0,configurable:!0}),t.prototype.init=function(e){this.alreadySubmit=!1,CELER_X&&celerSDK.onStart(this.onCelerStart.bind(this)),CELER_X&&celerSDK.provideScore(function(){return a.PlayModelProxy.inst.getTotalScore()}),this.celerStartCallback=e,i.LogHandler.inst.ready(),CELER_X?i.LogHandler.inst.initLog(celerSDK.log):console.log("v 1.4")},t.prototype.celerXReady=function(){console.log(" invoke celerx.ready() "),CELER_X?celerSDK.ready():this.onCelerStart()},t.prototype.isNew=function(){return this.isNewPlayer},t.prototype.isOnCelerPlatform=function(){return CELER_X},t.prototype.onCelerStart=function(){console.log(" celerx onStart call"),this.match=CELER_X?celerSDK.getMatch():{matchId:"error : can not get id",shouldLaunchTutorial:!1,sharedRandomSeed:Math.random(),difficultyLevel:0},console.log("match id:",this.match.matchId,", seed:",this.match.sharedRandomSeed),r.Random.setRandomSeed(this.match.sharedRandomSeed),this.match&&this.match.shouldLaunchTutorial?this.isNewPlayer=!0:this.isNewPlayer=!1,CELER_X?(celerSDK.onPause(function(){console.log(" on pause "),c.GameStateController.inst.isGameOver()||s.ShowPauseLayerSignal.inst.dispatch()}),celerSDK.onResume(function(){console.log(" on resume ")})):(cc.game.on(cc.game.EVENT_HIDE,function(){console.log(" on pause "),c.GameStateController.inst.isGameOver()||s.ShowPauseLayerSignal.inst.dispatch()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log(" on resume ")})),this.celerStartCallback&&(this.celerStartCallback(),this.celerStartCallback=null)},t.prototype.submitScore=function(e){this.alreadySubmit||(this.alreadySubmit=!0,console.log(" submit score:",e,", match id:",this.match.matchId,", seed:",this.match.sharedRandomSeed),CELER_X?celerSDK.submitScore(e):window.location.reload())},t}(n.SingleTon());o.CelerSDK=l,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Model/PlayModelProxy":"PlayModelProxy","../LogHandler":"LogHandler","../Random":"Random","../ToSingleton":"ToSingleton"}],ChessGridTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"69ccbKV/qlBO5b4Bq3W2I1I","ChessGridTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../Utils/Signal"),r=e("../../../View/SingleTouchView"),s=e("./ChessGridView"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.ChessGridTouchSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){this.getComponent(s.default)&&this.getComponent(s.default).isReady()&&!n.GameStateController.inst.isGameOver()&&l.inst.dispatchOne(this.node.name+"."+this.node.parent.name)},t=__decorate([c],t)}(r.default);o.default=u,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","./ChessGridView":"ChessGridView"}],ChessGridView:[function(e,t,o){"use strict";cc._RF.push(t,"7147bdUgPxCeZkSdF+9gPdD","ChessGridView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../../Model/GameLogic"),r=e("../../Model/GamePlayModel"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.CheckPassingWaySignal=c;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.SplicePassingWaySignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Hint",{get:function(){return this.node.getChildByName("hint")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HintRed",{get:function(){return this.node.getChildByName("hintRed")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HintOrange",{get:function(){return this.node.getChildByName("hintOrange")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.Hint.active=!1,this.HintRed.active=!1,this.HintOrange.active=!1,c.inst.addListenerTwo(this.onPassingWayUpdate,this),l.inst.addListenerTwo(this.onSpliceWayUpdate,this),r.NextRoundSignal.inst.addListener(this.onLevelUpdated,this),i.CheckAnswerDoneSignal.inst.addListenerTwo(this.onAnswerCheck,this),i.KillKingSignal.inst.addListenerTwo(function(t,o){e.onKingKill(o)},this),i.HintAnswerSignal.inst.addListenerOne(this.onAnswerHint,this)},t.prototype.onAnswerHint=function(e){var t=e.split(".");if(t[0]==this.node.name&&t[1]==this.node.parent.name){this.Hint.active;this.Hint.active=!0,this.Hint.opacity=0,this.Hint.stopAllActions(),this.Hint.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.2),cc.fadeOut(.25))))}},t.prototype.onAnswerCheck=function(e,t){var o=this,n=r.pos2WordPos(t).split(".");n[0]==this.node.name&&n[1]==this.node.parent.name&&(e?(this.Hint.active=!0,this.Hint.opacity=0,this.Hint.stopAllActions(),this.Hint.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.15))),setTimeout(function(){o.Hint.active=!1,o.Hint.opacity=255},250)):(this.HintRed.active=!0,this.HintRed.opacity=0,this.HintRed.stopAllActions(),this.HintRed.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.15))),setTimeout(function(){o.HintRed.active=!1,o.HintRed.opacity=255},250)))},t.prototype.onKingKill=function(e){var t=this,o=r.pos2WordPos(e).split(".");o[0]==this.node.name&&o[1]==this.node.parent.name&&(this.HintOrange.active=!0,this.HintOrange.opacity=0,this.HintOrange.stopAllActions(),this.HintOrange.runAction(cc.sequence(cc.fadeIn(.1),cc.fadeOut(.15))),setTimeout(function(){t.HintOrange.active=!1,t.HintOrange.opacity=255},250))},t.prototype.onPassingWayUpdate=function(e){this.Hint.active=!1;for(var t=0,o=e;t<o.length;t++){var n=o[t],i=r.pos2WordPos(n).split(".");if(i[0]==this.node.name&&i[1]==this.node.parent.name)return this.Hint.stopAllActions(),this.Hint.opacity=255,void(this.Hint.active=!0)}},t.prototype.onPassingWayUpdateTest=function(e,t){if(!CELER_X)for(var o=0,n=e;o<n.length;o++){var i=n[o],s=r.pos2WordPos(i).split(".");if(s[0]==this.node.name&&s[1]==this.node.parent.name)return this.Hint.active=!0,void(t&&this.Hint.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.2,100),cc.delayTime(.2),cc.fadeTo(.3,255),cc.delayTime(.1)))))}},t.prototype.onSpliceWayUpdate=function(e,t){if(!CELER_X){this.HintRed.active=!1;for(var o=0,n=e;o<n.length;o++){var i=n[o],s=r.pos2WordPos(i).split(".");if(s[0]==this.node.name&&s[1]==this.node.parent.name)return this.HintRed.active=!0,void(t&&this.HintRed.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.2,100),cc.delayTime(.2),cc.fadeTo(.3,255),cc.delayTime(.1)))))}}},t.prototype.onLevelUpdated=function(){this.Hint.active=!1,this.HintRed.active=!1,this.HintOrange.active=!1,this.HintRed.stopAllActions(),this.Hint.stopAllActions(),this.HintOrange.stopAllActions(),this.HintOrange.opacity=255,this.Hint.opacity=255,this.HintRed.opacity=255},t.prototype.isReady=function(){return this.Hint.active||this.HintOrange.active},t=__decorate([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../../Model/GameLogic":"GameLogic","../../Model/GamePlayModel":"GamePlayModel"}],ChessModel:[function(e,t,o){"use strict";cc._RF.push(t,"05db0+MNgVPaJn7FGD3Gaqt","ChessModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Global/Chess"),i=e("../../Utils/HashMap"),r=e("../../Utils/Signal"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.ChessCreatedSignal=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.ChessDestorySignal=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal);o.ChessPosChangedSignal=c;var l=function(){function e(t,o,i){this.id=e.objCount+++"-"+n.ChessRole[o]+"-"+n.ChessType[t],this.type=t,this.role=o,this.position={i:i.i,j:i.j},e.chessMap.add(this.id,this),s.inst.dispatchOne(this)}return e.getModelByID=function(e){return this.chessMap.get(e)},Object.defineProperty(e.prototype,"ID",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Role",{get:function(){return this.role},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WordRole",{get:function(){return n.ChessRole[this.role]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Position",{get:function(){return this.position},set:function(e){this.position={i:e.i,j:e.j},c.inst.dispatchTwo(this.id,this.position)},enumerable:!0,configurable:!0}),e.prototype.removeSelf=function(){a.inst.dispatchOne(this),e.chessMap.remove(this.id)},e.chessMap=new i.HashMap,e.objCount=0,e}();o.ChessModel=l,cc._RF.pop()},{"../../Global/Chess":"Chess","../../Utils/HashMap":"HashMap","../../Utils/Signal":"Signal"}],ChessPositionView:[function(e,t,o){"use strict";cc._RF.push(t,"35aa17b8U9IGIxfJQwPHMuH","ChessPositionView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Global/Chess"),i=e("../../../Utils/Signal"),r=e("../../../View/Transform/PositionView"),s=e("../../Model/ChessModel"),a=e("./PrefabBaseView"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.ChessMoveDoneSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.getComponent(a.default)?this.getComponent(a.default).Model:null},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),s.ChessPosChangedSignal.inst.addListenerTwo(this.onChessPositionChanged,this)},t.prototype.onChessPositionChanged=function(e,t){var o=this;this.Model&&this.Model.ID==e&&(this.node.zIndex=cc.macro.MAX_ZINDEX,this.onPositionChanged(n.GetChessPos(n.chessPos2Index(this.Model.Position)),.1,function(){o.node.zIndex=0,u.inst.dispatchOne(e)}))},t=__decorate([l],t)}(r.default);o.default=h,cc._RF.pop()},{"../../../Global/Chess":"Chess","../../../Utils/Signal":"Signal","../../../View/Transform/PositionView":"PositionView","../../Model/ChessModel":"ChessModel","./PrefabBaseView":"PrefabBaseView"}],ChessRandomUtil:[function(e,t,o){"use strict";cc._RF.push(t,"2e11eDIrbNPFKmqBTjc+lgh","ChessRandomUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Global/Chess"),i=e("../../Utils/Cocos"),r=e("../../Utils/Random"),s=e("./GridUtil"),a=function(){function e(){}return e.GetKingPosRange=function(e,t){var o=[];if(e==n.Play.AI)for(var r=4;r<=7;r++)for(var a=0;a<=7;a++)s.GridUtil.CheckIsFree({i:r,j:a},t)&&o.push({i:r,j:a});else for(r=0;r<=3;r++)for(a=0;a<=7;a++)s.GridUtil.CheckIsFree({i:r,j:a},t)&&o.push({i:r,j:a});return i.disOrderArray(o),o},e.GetPawnPosRange=function(e,t){var o=[],r=1,a=6;t==n.Play.AI?r=2:a=5;for(var c=r;c<=a;++c)for(var l=0;l<=7;++l)s.GridUtil.CheckIsFree({i:c,j:l},e)&&o.push({i:c,j:l});return i.disOrderArray(o),o},e.GetBishopPosRange=function(e,t){for(var o=[],n=0;n<=7;++n)for(var r=0;r<=7;++r)(n+r)%2==(e.i+e.j)%2&&s.GridUtil.CheckIsFree({i:n,j:r},t)&&o.push({i:n,j:r});return i.disOrderArray(o),o},e.GetAllPosRange=function(e){for(var t=[],o=0;o<=7;++o)for(var n=0;n<=7;++n)s.GridUtil.CheckIsFree({i:o,j:n},e)&&t.push({i:o,j:n});return i.disOrderArray(t),t},e.GenRandomChess=function(e,t,o,s,a){var c=[];o==n.Play.Player?a&&(a.i<1||a.i>=7)&&(e[n.ChessRole.Pawn]=0):a&&(a.i<=0||a.i>6)&&(e[n.ChessRole.Pawn]=0);for(var l=null==e[n.ChessRole.Pawn]?15:e[n.ChessRole.Pawn];c.length<l&&!s.checkChessIsFull(n.ChessRole.Pawn,t,null);)c.push(n.ChessRole.Pawn);a||(a={i:0,j:1},s.checkChessIsFull(n.ChessRole.Bishop,t,a)&&(a={i:0,j:0}));var u=null==e[n.ChessRole.Bishop]?20:e[n.ChessRole.Bishop];for(u+=c.length;c.length<u&&(!s.checkChessIsFull(n.ChessRole.Bishop,t,a)||!s.checkChessIsFull(n.ChessRole.Bishop,t,a));)c.push(n.ChessRole.Bishop);var h=null==e[n.ChessRole.Knight]?25:e[n.ChessRole.Knight];for(h+=c.length;c.length<h&&!s.checkChessIsFull(n.ChessRole.Knight,t,null);)c.push(n.ChessRole.Knight);var p=null==e[n.ChessRole.Rook]?20:e[n.ChessRole.Rook];for(p+=c.length;c.length<p&&!s.checkChessIsFull(n.ChessRole.Rook,t,null);)c.push(n.ChessRole.Rook);var d=null==e[n.ChessRole.Queen]?20:e[n.ChessRole.Queen];for(d+=c.length;c.length<d&&!s.checkChessIsFull(n.ChessRole.Queen,t,null);)c.push(n.ChessRole.Queen);return i.disOrderArray(c),c[r.Random.randomFloorToInt(0,c.length)]},e}();o.ChessRandomUtil=a,cc._RF.pop()},{"../../Global/Chess":"Chess","../../Utils/Cocos":"Cocos","../../Utils/Random":"Random","./GridUtil":"GridUtil"}],ChessRoleView:[function(e,t,o){"use strict";cc._RF.push(t,"f5545UFzKxCTpxK8HhGiUrt","ChessRoleView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=e("../../../Global/Chess"),r=e("../../../Model/PlayModelProxy"),s=e("../../Model/GameLogic"),a=e("../../Model/GamePlayModel"),c=e("../Animation/KillAnimation"),l=e("./PrefabBaseView"),u=cc._decorator,h=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Icon",{get:function(){return this.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Kill",{get:function(){return this.node.getChildByName("Kill").getComponent(c.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;s.KillKingSignal.inst.addListenerOne(function(t){e.model&&e.model.ID==t&&(e.Kill.node.active=!0,e.Kill.node.opacity=255,e.Kill.play(),r.PlayModelProxy.inst.addScore(20*(3-r.PlayModelProxy.inst.MoveCount),a.ScoreType.Normal,e.node),e.Kill.onComplete=function(){e.Kill.node.runAction(cc.sequence(cc.fadeOut(.1),cc.callFunc(function(){e.Kill.node.active=!1})))})},this)},t.prototype.onReuse=function(){this.Kill.node.active=!1,this.Icon.spriteFrame=n.ResourceController.inst.getAltas(i.ChessIcon[this.model.Type][this.model.Role])},t.prototype.checkIsAnswer=function(){CELER_X||r.PlayModelProxy.inst.Model.AnswerChess==this.model.Role&&this.model.Type==r.PlayModelProxy.inst.Model.PlayType&&this.model.Position.i==r.PlayModelProxy.inst.Model.KeyStartPos.i&&r.PlayModelProxy.inst.Model.KeyStartPos.j==this.model.Position.j&&this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.2,1.1),cc.delayTime(.2),cc.scaleTo(.3,.9),cc.delayTime(.1))))},t.prototype.onUnuse=function(){this.node.stopAllActions(),this.node.scale=1},t=__decorate([h],t)}(l.default));o.default=p,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController","../../../Global/Chess":"Chess","../../../Model/PlayModelProxy":"PlayModelProxy","../../Model/GameLogic":"GameLogic","../../Model/GamePlayModel":"GamePlayModel","../Animation/KillAnimation":"KillAnimation","./PrefabBaseView":"PrefabBaseView"}],ChessRootView:[function(e,t,o){"use strict";cc._RF.push(t,"e68635tkK9IMZeRAt4s+61n","ChessRootView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Factory/GameFactory"),i=e("../../../Global/Chess"),r=e("../../Model/ChessModel"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){r.ChessCreatedSignal.inst.addListenerOne(this.onChessCreated,this),r.ChessDestorySignal.inst.addListenerOne(this.onChessDestory,this)},t.prototype.onChessCreated=function(e){var t=n.gFactory.getObj("Chess",e);t.setPosition(i.GetChessPos(i.chessPos2Index(e.Position))),t.name=e.ID,this.node.addChild(t)},t.prototype.onChessDestory=function(e){var t=this.node.getChildByName(e.ID);t&&n.gFactory.putObj("Chess",t)},t=__decorate([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../../../Factory/GameFactory":"GameFactory","../../../Global/Chess":"Chess","../../Model/ChessModel":"ChessModel"}],ChessTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"581edRyUhNPqpP16FPidxPr","ChessTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../Utils/Signal"),r=e("../../../View/SingleTouchView"),s=e("../Game/PrefabBaseView"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.ChessTouchSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.getComponent(s.default)?this.getComponent(s.default).Model:null},enumerable:!0,configurable:!0}),t.prototype.onTouchEnd=function(){0==n.GameStateController.inst.isRoundStart()||n.GameStateController.inst.isGameOver()||null!=this.Model&&l.inst.dispatchOne(this.Model)},t=__decorate([c],t)}(r.default);o.default=u,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../Game/PrefabBaseView":"PrefabBaseView"}],ChessUtil:[function(e,t,o){"use strict";cc._RF.push(t,"bddc9nnqc9LmJcKYLRBxLyK","ChessUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Global/Chess"),i=e("./GridUtil"),r=function(){function e(){}return e.GetAllDestinationByOrigin=function(e,t,o,i,r,s){void 0===s&&(s=!1);var a=[];switch(e){case n.ChessRole.King:a=this.GetKingDestinationByOrigin(o,i,r);break;case n.ChessRole.Queen:a=this.GetQueenDestinationByOrigin(o,i,r);break;case n.ChessRole.Bishop:a=this.GetBishopDestinationByOrigin(o,i,r);break;case n.ChessRole.Knight:a=this.GetKnightDestinationByOrigin(o,i,r);break;case n.ChessRole.Rook:a=this.GetRookDestinationByOrigin(o,i,r);break;case n.ChessRole.Pawn:if(a=this.GetPawnDestinationByOrigin(t,o,i,r),s)for(var c=0;c<a.length;++c)a[c].j==o.j&&(a.splice(c,1),--c)}return a},e.GetAllOriginByDestination=function(e,t,o,i,r,s){void 0===s&&(s=!1);var a=[];switch(e){case n.ChessRole.King:a=this.GetKingOriginByDestination(o,i,r);break;case n.ChessRole.Queen:a=this.GetQueenOriginByDestination(o,i,r);break;case n.ChessRole.Bishop:a=this.GetBishopOriginByDestination(o,i,r);break;case n.ChessRole.Knight:a=this.GetKnightOriginByDestination(o,i,r);break;case n.ChessRole.Rook:a=this.GetRookOriginByDestination(o,i,r);break;case n.ChessRole.Pawn:if(a=this.GetPawnOriginByDestination(t,o,i,r),s)for(var c=0;c<a.length;++c)a[c].j==o.j&&(a.splice(c,1),--c)}return a},e.GetKingReachRangeByOrigin=function(e,t,o){return i.GridUtil.GetSquaredWayByOrigin(e,t,o)},e.GetKingDestinationByOrigin=function(e,t,o){return this.GetKingReachRangeByOrigin(e,t,o)},e.GetKingOriginByDestination=function(e,t,o){var n=this.GetKingReachRangeByOrigin(e,t,o);return this.SpliceGridNoFree(n,t,o),n},e.GetQueenReachRangeByOrigin=function(e,t,o){var n=[];return n=(n=(n=n.concat(i.GridUtil.GetHorizontalWayByOrigin(e,t,o))).concat(i.GridUtil.GetVerticalWayByOrigin(e,t,o))).concat(i.GridUtil.GetDiagonalWayByOrigin(e,t,o))},e.GetQueenDestinationByOrigin=function(e,t,o){return this.GetQueenReachRangeByOrigin(e,t,o)},e.GetQueenOriginByDestination=function(e,t,o){var n=this.GetQueenReachRangeByOrigin(e,t,o);return this.SpliceGridNoFree(n,t,o),n},e.GetBishopReachRangeByOrigin=function(e,t,o){return i.GridUtil.GetDiagonalWayByOrigin(e,t,o)},e.GetBishopDestinationByOrigin=function(e,t,o){return this.GetBishopReachRangeByOrigin(e,t,o)},e.GetBishopOriginByDestination=function(e,t,o){var n=this.GetBishopReachRangeByOrigin(e,t,o);return this.SpliceGridNoFree(n,t,o),n},e.GetKnightReachRangeByOrigin=function(e,t,o){return i.GridUtil.GetSunWay(e,t,o)},e.GetKnightDestinationByOrigin=function(e,t,o){return this.GetKnightReachRangeByOrigin(e,t,o)},e.GetKnightOriginByDestination=function(e,t,o){var n=this.GetKnightReachRangeByOrigin(e,t,o);return this.SpliceGridNoFree(n,t,o),n},e.GetRookReachRangeByOrigin=function(e,t,o){var n=[];return n=(n=n.concat(i.GridUtil.GetHorizontalWayByOrigin(e,t,o))).concat(i.GridUtil.GetVerticalWayByOrigin(e,t,o))},e.GetRookDestinationByOrigin=function(e,t,o){return this.GetRookReachRangeByOrigin(e,t,o)},e.GetRookOriginByDestination=function(e,t,o){var n=this.GetRookReachRangeByOrigin(e,t,o);return this.SpliceGridNoFree(n,t,o),n},e.SpliceGridNoFree=function(e,t,o){for(var n=0;n<e.length;++n)i.GridUtil.CheckForwardType(e[n],t,o)!=i.ForwardType.Free&&(e.splice(n,1),--n)},e.GetPawnDestinationByOrigin=function(e,t,o,r){if(e==n.Play.Player){if(t.i>7||t.i<1)return console.error(" player pawn cant pos at:",t),[]}else if(t.i>6||t.i<0)return console.error(" AI pawn cant pos at:",t),[];var s=i.GridUtil.GetKongWayDestinationByOrigin(t,o,r);if(e==n.Play.Player)for(var a=0;a<s.length;++a)s[a].i<=1||s[a].i>7||s[a].i<t.i?(s.splice(a,1),--a):1!=t.i&&s[a].i-t.i>1&&(s.splice(a,1),--a);else for(a=0;a<s.length;++a)s[a].i>=6||s[a].i<0||s[a].i>t.i?(s.splice(a,1),--a):6!=t.i&&t.i-s[a].i>1&&(s.splice(a,1),--a);return s},e.GetPawnOriginByDestination=function(e,t,o,r){if(e==n.Play.Player){if(t.i>7||t.i<=2)return console.error(" player pawn cant reach:",t),[]}else if(t.i>=7||t.i<0)return console.error(" AI pawn cant reach:",t),[];var s=i.GridUtil.GetKongWayOriginByDestination(t,o,r);if(e==n.Play.Player)for(var a=0;a<s.length;++a)s[a].i<1||s[a].i>=7||s[a].i>=t.i||i.GridUtil.CheckForwardType(s[a],o,r)!=i.ForwardType.Free?(s.splice(a,1),--a):3!=t.i&&t.i-s[a].i>1&&(s.splice(a,1),--a);else for(a=0;a<s.length;++a)s[a].i>6||s[a].i<=0||s[a].i<=t.i||i.GridUtil.CheckForwardType(s[a],o,r)!=i.ForwardType.Free?(s.splice(a,1),--a):4!=t.i&&s[a].i-t.i>1&&(s.splice(a,1),--a);return s},e.CheckHasDuplicatePos=function(e,t){for(var o=[],n=0;n<e.length;++n)for(var i=0;i<t.length;++i)e[n].i==t[i].i&&e[n].j==t[i].j&&o.push({i:e[n].i,j:e[n].j});return o},e.SpliceDuplicatePos=function(e,t){for(var o=0;o<e.length;++o)for(var n=0;n<t.length;++n)t[n].i==e[o].i&&t[n].j==e[o].j&&(t.splice(n,1),--n)},e.GetPassingWay=function(e,t,o){switch(e){case n.ChessRole.King:case n.ChessRole.Knight:return[];case n.ChessRole.Pawn:return Math.abs(t.i-o.i)>1?t.i>o.i?[{i:t.i-1,j:t.j}]:[{i:t.i+1,j:t.j}]:[];case n.ChessRole.Queen:var i=[];if(t.i==o.i)for(var r=Math.min(t.j,o.j);++r<Math.max(t.j,o.j);)i.push({i:t.i,j:r});else if(t.j==o.j)for(var s=Math.min(t.i,o.i);++s<Math.max(t.i,o.i);)i.push({i:s,j:t.j});else if(t.j>o.j&&t.i>o.i)for(var a=t.i,c=t.j;--a>o.i&&--c>o.j;)i.push({i:a,j:c});else if(t.j<o.j&&t.i<o.i)for(a=t.i,c=t.j;++a<o.i&&++c<o.j;)i.push({i:a,j:c});else if(t.j>o.j&&t.i<o.i)for(a=t.i,c=t.j;++a<o.i&&--c>o.j;)i.push({i:a,j:c});else if(t.j<o.j&&t.i>o.i)for(a=t.i,c=t.j;--a>o.i&&++c<o.j;)i.push({i:a,j:c});else console.error(" get passing error of queen:",t,o);return i;case n.ChessRole.Rook:var l=[];if(t.i==o.i)for(r=Math.min(t.j,o.j);++r<Math.max(t.j,o.j);)l.push({i:t.i,j:r});else if(t.j==o.j)for(s=Math.min(t.i,o.i);++s<Math.max(t.i,o.i);)l.push({i:s,j:t.j});else console.error(" get passing error of rook:",t,o);return l;case n.ChessRole.Bishop:var u=[];if(t.j>o.j&&t.i>o.i)for(a=t.i,c=t.j;--a>o.i&&--c>o.j;)u.push({i:a,j:c});else if(t.j<o.j&&t.i<o.i)for(a=t.i,c=t.j;++a<o.i&&++c<o.j;)u.push({i:a,j:c});else if(t.j>o.j&&t.i<o.i)for(a=t.i,c=t.j;++a<o.i&&--c>o.j;)u.push({i:a,j:c});else if(t.j<o.j&&t.i>o.i)for(a=t.i,c=t.j;--a>o.i&&++c<o.j;)u.push({i:a,j:c});else console.error(" get passing error of bishop:",t,o);return u}},e}();o.ChessUtil=r,cc._RF.pop()},{"../../Global/Chess":"Chess","./GridUtil":"GridUtil"}],Chess:[function(e,t,o){"use strict";var n,i,r,s;cc._RF.push(t,"8b5d45kMcVJE4srAQx3GQBE","Chess"),Object.defineProperty(o,"__esModule",{value:!0});var a,c,l=e("../Utils/Cocos");o.MapSize=cc.size(128,128),o.GetChessPos=function(e,t){void 0===t&&(t=8);var n=l.Index2i(e,t),i=(l.Index2j(e,t)-3.5)*o.MapSize.width,r=-(3.5-n)*o.MapSize.height;return cc.v2(i,r)},o.chessPos2Index=function(e){return 8*e.i+e.j},function(e){e[e.A=0]="A",e[e.B=1]="B",e[e.C=2]="C",e[e.D=3]="D",e[e.E=4]="E",e[e.F=5]="F",e[e.G=6]="G",e[e.H=7]="H"}(o.ChessHorizonal||(o.ChessHorizonal={})),function(e){e[e.Unsolvable=0]="Unsolvable",e[e.Solvable=1]="Solvable"}(o.RoundType||(o.RoundType={})),function(e){e[e.King=1]="King",e[e.Queen=2]="Queen",e[e.Bishop=3]="Bishop",e[e.Knight=4]="Knight",e[e.Rook=5]="Rook",e[e.Pawn=6]="Pawn"}(a=o.ChessRole||(o.ChessRole={})),o.ChessRoleCN=((n={})[a.King]="\u738b",n[a.Queen]="\u540e",n[a.Bishop]="\u8c61",n[a.Knight]="\u9a6c",n[a.Rook]="\u8f66",n[a.Pawn]="\u5175",n),function(e){e[e.White=1]="White",e[e.Black=2]="Black",e[e.Any=3]="Any"}(c=o.ChessType||(o.ChessType={})),function(e){e[e.Player=1]="Player",e[e.AI=2]="AI"}(o.Play||(o.Play={})),o.ChessIcon=((i={})[c.Black]=((r={})[a.King]="chess_b_king",r[a.Queen]="chess_b_queen",r[a.Bishop]="chess_b_Bishop",r[a.Knight]="chess_b_knight",r[a.Rook]="chess_b_rook",r[a.Pawn]="chess_b_pawn",r),i[c.White]=((s={})[a.King]="chess_w_king",s[a.Queen]="chess_w_queen",s[a.Bishop]="chess_w_Bishop",s[a.Knight]="chess_w_knight",s[a.Rook]="chess_w_rook",s[a.Pawn]="chess_w_pawn",s),i),cc._RF.pop()},{"../Utils/Cocos":"Cocos"}],Cocos:[function(e,t,o){"use strict";cc._RF.push(t,"d9795RGCWVCp5Zf4JNywPPb","Cocos"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Random");function i(e){return e&&e.getParent&&e.getParent()?e.getParent().convertToWorldSpaceAR(e.position):cc.v2(0,0)}o.GetWorldPosition=i,o.ConvertToNodeSpaceAR=function(e,t){if(!t)return cc.v2(0,0);var o=i(e);return t.convertToNodeSpaceAR(o)},o.Distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},o.AreaOf2CrossRect=function(e,t){var o=e.x,n=e.y,i=e.x+e.width,r=e.y+e.height,s=t.x,a=t.y,c=t.x+t.width,l=t.y+t.height;return Math.max(0,Math.min(i,c)-Math.max(o,s))*Math.max(0,Math.min(r,l)-Math.max(n,a))},o.disOrderArray=function(e){for(var t,o=0;o<e.length;++o){var i=n.Random.randomFloorToInt(0,e.length);t=[e[i],e[o]],e[o]=t[0],e[i]=t[1]}},o.Clamp=function(e,t,o){return Math.max(Math.min(e,t),o)},o.Index2i=function(e,t){return Math.floor(e/t)},o.Index2j=function(e,t){return e%t},cc._RF.pop()},{"./Random":"Random"}],CommonSignal:[function(e,t,o){"use strict";cc._RF.push(t,"f95914FtRVEIaVFtfSVd+lO","CommonSignal"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Signal"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowPauseLayerSignal=i;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.HidePauseLayerSignal=r;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameThemeInit=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowHelpLayerSignal=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.HideHelpLayerSignal=c;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.OpenResultLayerSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowSubmitSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ScoreCountingSignal=h;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ButtonClickSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.TimeAnimationStateChanged=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.UpdateTimeNumber=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameReadySignal=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.ShowTutorialSignal=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameStartSignal=m;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GameOverSignal=C;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.GamePauseSignal=S;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.PlayerScoreChanged=R;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.NoviceScoreChanged=v;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.CountDownSignal=P,cc._RF.pop()},{"../Utils/Signal":"Signal"}],CompleteAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"965c8TM5dpGloy6/r/s7dUd","CompleteAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],CompleteView:[function(e,t,o){"use strict";cc._RF.push(t,"ba3d1yfxbBDUoRT1kaH73rI","CompleteView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../App/App"),i=e("../../../Command/CommonSignal"),r=e("../../../Controller/GameStateController"),s=e("../../../Controller/ResourceController"),a=e("../../../Model/PlayModelProxy"),c=e("../../Model/GamePlayModel"),l=e("../Animation/CompleteAnimation"),u=cc._decorator,h=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Font",{get:function(){return this.node.getChildByName("Font").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Con",{get:function(){return this.node.getChildByName("Con")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Sign",{get:function(){return this.node.getChildByName("bg_comsign")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteAnimation",{get:function(){return this.node.getChildByName("CompleteAnimation").getComponent(l.default)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){i.GameOverSignal.inst.addOnceOne(this.onGameOver,this),this.Font.node.active=!1,this.Con.active=!1,this.Sign.active=!1,this.CompleteAnimation.node.active=!1},t.prototype.start=function(){this.CompleteAnimation.node.active=!1},t.prototype.onGameOver=function(e){var t=this;switch(this.Font.node.active=!0,a.PlayModelProxy.inst.addScore(a.PlayModelProxy.inst.HintBonus,c.ScoreType.Normal,n.default.HintRoot),e){case r.RoundEndType.Complete:this.CompleteAnimation.node.active=!0,this.CompleteAnimation.node.opacity=0,this.Con.active=!0,this.Font.spriteFrame=s.ResourceController.inst.getAnimationAtlas("bg_com");break;case r.RoundEndType.Over:this.Font.spriteFrame=s.ResourceController.inst.getAnimationAtlas("bg_gameover");break;case r.RoundEndType.TimeUp:this.Font.spriteFrame=s.ResourceController.inst.getAnimationAtlas("bg_timeup")}this.Font.node.active&&(this.Font.node.scaleX=0,this.Font.node.runAction(cc.scaleTo(.1,1,1))),this.Con.active&&(this.Con.scale=0,this.Con.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.delayTime(.15),cc.scaleTo(.1,1))),setTimeout(function(){t.Sign.active=!0,t.Sign.scale=0,t.Sign.runAction(cc.sequence(cc.scaleTo(.1,.9),cc.scaleTo(.05,1),cc.callFunc(function(){t.CompleteAnimation.node.active=!0,t.CompleteAnimation.node.opacity=255,t.CompleteAnimation.play(),t.CompleteAnimation.onComplete=function(){t.CompleteAnimation.node.runAction(cc.fadeOut(.1))}})))},200)),setTimeout(function(){i.OpenResultLayerSignal.inst.dispatchOne(e)},3e3)},t=__decorate([h],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../../../App/App":"App","../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Model/PlayModelProxy":"PlayModelProxy","../../Model/GamePlayModel":"GamePlayModel","../Animation/CompleteAnimation":"CompleteAnimation"}],EaseBaseView:[function(e,t,o){"use strict";cc._RF.push(t,"fc226Q7q/NHwZUZiG7X+tIZ","EaseBaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../BaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetVal=new cc.Vec3(0,0,0),t.startTime=0,t.lastTime=0,t.completeCallback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"StartTime",{get:function(){return this.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastTime",{get:function(){return this.lastTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Target",{get:function(){return this.targetVal},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.startUpdate=function(e,t,o,n){void 0===n&&(n=0),this.targetVal=e,this.startTime=Date.now()+1e3*n,this.lastTime=1e3*t,this.completeCallback=o},t.prototype.complete=function(){if(this.startTime=this.lastTime=0,this.completeCallback){var e=this.completeCallback;this.completeCallback=null,e()}},t.prototype.update=function(e){0!=this.startTime&&0!=this.canUpdate()&&(this.isComplete()?(this.onComplete(),this.complete()):this.canStart()&&this.onStep())},t.prototype.canStart=function(){return Date.now()>=this.startTime&&0!=this.startTime},t.prototype.isComplete=function(){return Date.now()>=this.startTime+this.lastTime},t.prototype.canUpdate=function(){return console.error("you should override this method."),!0},t.prototype.onStep=function(){},t.prototype.onComplete=function(){},t.prototype.ease=function(e,t){return this.lastTime<=0?t:(t-e)*(Date.now()-this.startTime)/this.lastTime+e},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"../BaseView":"BaseView"}],FireWorkAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"fdcc6mLSFRPvZPIgAxSjpVB","FireWorkAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onComplete=function(){this.node.runAction(cc.fadeOut(.1))},t.prototype.play=function(){this.node.active=!0,this.node.opacity=255,e.prototype.play.call(this)},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase"}],FrameAniBase:[function(e,t,o){"use strict";cc._RF.push(t,"6298cJI+OZK9J9ZyfrpqPP2","FrameAniBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,s=n.requireComponent,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Frames=null,t.PrefixName="",t.FrameCount=0,t.Interval=.1,t.Priority=0,t.Loop=!1,t.PlayOnLoad=!1,t.currentIndex=0,t.time=0,t.isPlay=!1,t.listener=[],t.complateEvent=[],t}var o;return __extends(t,e),o=t,Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.node.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Animation",{set:function(e){this.Frames=e},enumerable:!0,configurable:!0}),t.prototype.onFocusInEditor=function(){},t.prototype.onLostFocusInEditor=function(){clearInterval(o.intervalID)},t.prototype.onLoad=function(){this.time=this.Interval,this.isPlay=this.PlayOnLoad},t.prototype.play=function(){this.isPlay=!0,this.currentIndex=0,0==this.isPlaying&&this.callEventComplete()},t.prototype.playOnLoop=function(){this.Loop=!0,this.play()},t.prototype.playByStep=function(){this.isPlay=!0,this.nextFrame(),this.isPlay=!1},t.prototype.pause=function(){this.isPlay=!1},t.prototype.resume=function(){this.isPlay=!0},t.prototype.stop=function(){this.isPlay=!1,this.currentIndex=0,this.updateCurrentFrame(),this.Loop=!1},t.prototype.updateCurrentFrame=function(){""!=this.PrefixName?this.Sprite.spriteFrame=this.Frames.getSpriteFrame(this.PrefixName+this.currentIndex):this.Sprite.spriteFrame=this.Frames.getSpriteFrames()[this.currentIndex]},t.prototype.onKeyFrame=function(e){},t.prototype.addKeyEventListener=function(e,t){this.listener.push({callback:e,target:t})},Object.defineProperty(t.prototype,"ListenerCount",{get:function(){return this.listener.length},enumerable:!0,configurable:!0}),t.prototype.clearAllListener=function(){return this.listener.length=0,this},t.prototype.onComplete=function(){},t.prototype.callEventFrame=function(){this.onKeyFrame(this.currentIndex);for(var e=0,t=this.listener;e<t.length;e++){var o=t[e];o.callback.apply(o.target,[this.currentIndex,this.__classname__])}},t.prototype.callEventComplete=function(){this.onComplete();for(var e=0,t=this.complateEvent;e<t.length;e++){var o=t[e];o.f.apply(o.target,[this.__classname__])}},t.prototype.addCompleteEvent=function(e,t){this.complateEvent.push({f:e,target:t})},Object.defineProperty(t.prototype,"TotalFrameCount",{get:function(){return""!=this.PrefixName&&this.FrameCount>0?this.FrameCount:this.Frames&&this.Frames.getSpriteFrames?this.Frames.getSpriteFrames().length:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteEventCount",{get:function(){return this.complateEvent.length},enumerable:!0,configurable:!0}),t.prototype.clearCompleteEvent=function(){return this.complateEvent.length=0,this},t.prototype.start=function(){},Object.defineProperty(t.prototype,"isPlaying",{get:function(){if(this.isPlay&&this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0){for(var e=0,t=this.getComponents(o);e<t.length;e++){var n=t[e];if(n.Priority>this.Priority&&n.isPlaying)return!1}return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.nextFrame=function(){0!=this.isPlaying?this.Frames&&this.Frames.getSpriteFrames&&this.Frames.getSpriteFrames().length>0&&(this.updateCurrentFrame(),this.callEventFrame(),this.currentIndex=(this.currentIndex+1)%this.TotalFrameCount,0==this.currentIndex&&0==this.Loop&&(this.isPlay=!1,this.callEventComplete())):this.time=this.Interval},t.prototype.update=function(e){this.time>=this.Interval&&(this.time=0,this.nextFrame()),this.time+=e},t.aniName="FrameAniBase",t.intervalID=-1,__decorate([r(cc.SpriteAtlas)],t.prototype,"Frames",void 0),__decorate([r],t.prototype,"PrefixName",void 0),__decorate([r],t.prototype,"FrameCount",void 0),__decorate([r],t.prototype,"Interval",void 0),__decorate([r],t.prototype,"Priority",void 0),__decorate([r],t.prototype,"Loop",void 0),__decorate([r],t.prototype,"PlayOnLoad",void 0),t=o=__decorate([i,s(cc.Sprite)],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],FrontView:[function(e,t,o){"use strict";cc._RF.push(t,"a7fe8WWCZVPgYx/jpZQ6l8q","FrontView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.update=function(e){this.node.parent.scaleX>=0?this.node.scaleX=1:this.node.scaleX=0,this.node.parent.scaleY<0?this.node.scaleY=1:this.node.scaleY=0},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],GameFactory:[function(e,t,o){"use strict";cc._RF.push(t,"93d23kfnY1A76OtZSkIyJ5r","GameFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/HashMap"),i=function(){function e(e,t,o){this._pool=[],this.totalSize=0,this.initTime=[],this.completeHandler=o,this.template=e,this.totalSize=t,this.hashKey="ObjPool:"+this.template.name+" - "+this.totalSize,this.initPool(t)}return e.prototype.initPool=function(e,t){var o=this;if(void 0===t&&(t=!1),t)for(var n=0;n<e;++n){this.initTime.push(Date.now());var i=cc.instantiate(this.template);this.put(i)}else for(n=0;n<e;++n)this.initTime.push(Date.now()),setTimeout(function(){var e=cc.instantiate(o.template);o.put(e)},n)},e.prototype.size=function(){return this._pool.length},e.prototype.clear=function(){for(var e=this._pool.length,t=0;t<e;++t)this._pool[t].destroy&&this._pool[t].destroy();this._pool.length=0},e.prototype.put=function(e){if(e&&-1===this._pool.indexOf(e)){e.removeFromParent(!1);for(var t=0,o=e.getComponents(cc.Component);t<o.length;t++){var n=o[t];n&&n.unuse&&n.unuse.apply(n)}this._pool.push(e),this.completeHandler&&this.totalSize<=this._pool.length&&(this.completeHandler(),this.completeHandler=null)}},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this._pool.length-1;o<0&&(console.warn(" last < 0 "),this.initPool(1,!0)),o=this._pool.length-1;var n=this._pool[o];this._pool.length=o;for(var i=0,r=n.getComponents(cc.Component);i<r.length;i++){var s=r[i];s&&s.reuse&&s.reuse.apply(s,arguments)}return n},e}(),r=function(){function e(){this.count=0,this.totalCount=0,this.objPool=new n.HashMap,this.startTime=0}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;this.doneCallback=e,this.startTime=Date.now(),cc.loader.loadResDir("prefabs/",cc.Prefab,function(e,o,n){if(e)console.error(" Game Factory init failed:",e);else{t.totalCount=o.length;for(var r=function(e){var n=o[e],r=n.name.split("."),s=r[0],a=r[1]?parseInt(r[1]):30;console.log(" init pool:",s,", count:",a),setTimeout(function(){var e=new i(n,a,t.addCount.bind(t));t.objPool.add(s,e)},10*e)},s=0;s<o.length;s++)r(s)}})},e.prototype.addCount=function(){this.count++,this.count>=this.totalCount&&(console.log(" factory cost time:",(Date.now()-this.startTime).toFixed(2)+"ms"),this.doneCallback&&(this.doneCallback(),this.doneCallback=null))},e.prototype.getObj=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return this.objPool.has(e)?(t=this.objPool.get(e)).get.apply(t,o):(console.error(" objPool dosen't exists this obj:",e),null)},e.prototype.putObj=function(e,t){if(this.objPool.has(e))return this.objPool.get(e).put(t);console.error(" objPool dosen't exists this obj:",e)},e}();o.gFactory=r.inst,cc._RF.pop()},{"../Utils/HashMap":"HashMap"}],GameLogic:[function(e,t,o){"use strict";cc._RF.push(t,"9ebadbzIUBEK7Y8/pZSYWFE","GameLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../App/App"),i=e("../../Command/CommonSignal"),r=e("../../Global/Chess"),s=e("../../Manager/AudioManager"),a=e("../../Utils/Signal"),c=e("../Command/GamePlaySignal"),l=e("../View/Game/ChessGridTouchView"),u=e("../View/Game/ChessGridView"),h=e("../View/Game/ChessPositionView"),p=e("../View/Interaction/ChessTouchView"),d=(e("../View/UI/AnswerView"),e("../View/UI/HintButtonView")),f=e("../View/UI/HintCostLabelView"),y=e("../View/UI/SolutionButtonView"),g=e("./ChessModel"),m=e("./ChessUtil"),C=e("./GamePlayModel"),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.CheckAnswerDoneSignal=S;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.KillChessSignal=R;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.KillKingSignal=v;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.FreeHintCountUpdateSignal=P;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.HintNoAnswerSignal=_;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal);o.HintAnswerSignal=b;var w=function(){function e(e){this.currentSelectChessID="",this.currentSelectAIID="",this._isRoundStart=!1,this.freeHintCount=3,this.currentHintID="",this.hintCost=0,this.hasMoveChess=!1,this.moveRecord=[],this.answer=null,this.gamePlay=e,this.bindSignal()}return Object.defineProperty(e.prototype,"HasMoveChess",{get:function(){return this.hasMoveChess},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRoundStart",{get:function(){return this._isRoundStart},set:function(e){this._isRoundStart=e,console.log(" \u662f\u5426\u53ef\u4ee5\u4ea4\u4e92\uff1a",this._isRoundStart)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HintCount",{get:function(){return this.freeHintCount},set:function(e){this.freeHintCount=e,this.gamePlay.addPlayerScore(this.hintCost,C.ScoreType.HintCost,1,n.default.HintRoot),this.freeHintCount<=0&&(this.hintCost,this.hintCost-=20,f.NextHintCostUpdateSignal.inst.dispatchOne(this.hintCost)),P.inst.dispatchOne(this.freeHintCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HintBonus",{get:function(){if(this.freeHintCount<=0||!this.hasMoveChess)return 0;for(var e=0,t=0,o=0;o<this.freeHintCount;++o)t+=e+=20;return t},enumerable:!0,configurable:!0}),e.prototype.bindSignal=function(){var e=this;p.ChessTouchSignal.inst.addListenerOne(this.onChessTouch,this),C.OnLevelUpdatedSignal.inst.addListener(function(){e.isRoundStart=!1},this),y.StartMoveChessSignal.inst.addListener(function(){e.isRoundStart=!0,e.currentHintID=""},this),l.ChessGridTouchSignal.inst.addListenerOne(this.onGridTouch,this),h.ChessMoveDoneSignal.inst.addListenerOne(this.checkIsCorrect,this),d.HintButtonClickSignal.inst.addListener(this.onHintAsk,this),f.NextHintCostUpdateSignal.inst.dispatchOne(0),this.HintCount=3,i.GameStartSignal.inst.addListener(function(){C.LevelGenDoneSignal.inst.dispatchTwo(e.gamePlay.currentRoundInfo.play,!0)},this)},e.prototype.onHintAsk=function(){if(0!=this.isRoundStart)if(this.gamePlay.currentRoundInfo.hasAnswer){this.currentHintID!=this.gamePlay.getFirstAnswerID()&&this.HintCount--,this.currentHintID=this.gamePlay.getFirstAnswerID();var e=g.ChessModel.getModelByID(this.currentHintID);e?b.inst.dispatchOne(C.pos2WordPos(e.Position)):console.log(" no answer chess: ",this.currentHintID)}else"no_solution"!=this.currentHintID&&this.HintCount--,this.currentHintID="no_solution",_.inst.dispatch()},e.prototype.onGridTouch=function(e){if(0!=this.isRoundStart){var t=C.wordPos2Pos(e),o=null;if(""!=this.currentSelectChessID&&(o=g.ChessModel.getModelByID(this.currentSelectChessID)),o){var n=m.ChessUtil.GetAllDestinationByOrigin(o.Role,r.Play.Player,o.Position,o.Type,this.gamePlay.Map);m.ChessUtil.CheckHasDuplicatePos([t],n).length<=0?console.error(g.ChessModel[o.Role]," cant move from ",C.pos2LogPos(o.Position)," to ",C.pos2LogPos(t)):this.moveChess(o,o.Position,t,null),this.setSelectModel(o)}}},e.prototype.onChessTouch=function(e){var t=null;if(""!=this.currentSelectChessID&&(t=g.ChessModel.getModelByID(this.currentSelectChessID)),e.Type==this.gamePlay.currentRoundInfo.ai){if(t&&this.isRoundStart){var o=m.ChessUtil.GetAllDestinationByOrigin(t.Role,r.Play.Player,t.Position,t.Type,this.gamePlay.Map,!0);m.ChessUtil.CheckHasDuplicatePos([e.Position],o).length<=0||this.moveChess(t,t.Position,e.Position,e),this.setSelectModel(t)}}else this.setSelectModel(e)},e.prototype.setSelectModel=function(e){var t=[];e.ID==this.currentSelectChessID?this.currentSelectChessID="":(this.currentSelectChessID=e.ID,(t=m.ChessUtil.GetAllDestinationByOrigin(e.Role,r.Play.Player,e.Position,e.Type,this.gamePlay.Map)).push(e.Position)),u.CheckPassingWaySignal.inst.dispatchOne(t)},e.prototype.moveChess=function(e,t,o,n){this.moveRecord.push({moveChess:{ID:e.ID,type:e.Type,from:t,to:o},killChess:n?{role:n.Role,type:n.Type,origin:n.Position}:null}),this.answer={chessID:e.ID,targetPos:o},this.hasMoveChess=!0,this.doMoveChess(e,t,o,n)},e.prototype.doMoveChess=function(e,t,o,n){this.isRoundStart=!1,n&&(R.inst.dispatchOne(n),this.gamePlay.removeChess(n)),this.move(e,t,o)},e.prototype.revert=function(){if(!(this.moveRecord.length<=0)){var e=this.moveRecord.pop(),t=g.ChessModel.getModelByID(e.moveChess.ID);null!=t?(this.move(t,t.Position,e.moveChess.from),e.killChess&&this.gamePlay.genChess(e.killChess.type,e.killChess.role,e.killChess.origin)):console.error(" cantt find model:",e.moveChess)}},e.prototype.move=function(e,t,o){this.gamePlay.setOccupy(C.pos2WordPos(t),null),this.gamePlay.setOccupy(C.pos2WordPos(o),e.Type),e.Position=o},e.prototype.checkIsCorrect=function(e){var t=this;if(console.log("on move done:",e,this.answer),this.answer){if(this.answer.chessID==e){var o=this.gamePlay.checkIsCorrect(this.answer.chessID,this.answer.targetPos);S.inst.dispatchTwo(o,this.answer.targetPos),console.log("isCorrect:",o),1!=o?(this.gamePlay.MoveCount++,setTimeout(function(){t.revert()},250),s.MoveFailSignal.inst.dispatch()):(s.MoveSuccessSignal.inst.dispatch(),c.LevelDoneSignal.inst.dispatchTwo(!0,this.gamePlay.MoveCount),v.inst.dispatchTwo(this.gamePlay.currentRoundInfo.kingID,this.gamePlay.currentRoundInfo.keyKingPos))}this.answer=null}else this.isRoundStart=!0},e}();o.GameLogic=w,cc._RF.pop()},{"../../App/App":"App","../../Command/CommonSignal":"CommonSignal","../../Global/Chess":"Chess","../../Manager/AudioManager":"AudioManager","../../Utils/Signal":"Signal","../Command/GamePlaySignal":"GamePlaySignal","../View/Game/ChessGridTouchView":"ChessGridTouchView","../View/Game/ChessGridView":"ChessGridView","../View/Game/ChessPositionView":"ChessPositionView","../View/Interaction/ChessTouchView":"ChessTouchView","../View/UI/AnswerView":"AnswerView","../View/UI/HintButtonView":"HintButtonView","../View/UI/HintCostLabelView":"HintCostLabelView","../View/UI/SolutionButtonView":"SolutionButtonView","./ChessModel":"ChessModel","./ChessUtil":"ChessUtil","./GamePlayModel":"GamePlayModel"}],GamePlayModel:[function(e,t,o){"use strict";cc._RF.push(t,"3a3dbMmjXZDlbutv0S4vxKQ","GamePlayModel"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../Global/Theme"),r=e("../../Global/GameRule"),s=e("../../Command/CommonSignal"),a=e("../../Global/Level"),c=e("../../Utils/Random"),l=e("../../Utils/Signal"),u=e("../View/UI/RevertButtonView"),h=e("../View/UI/MoveCountLabelView"),p=e("../../Controller/GameStateController"),d=e("../View/UI/SubmitLayerView"),f=e("../../Global/Chess"),y=e("../../Utils/HashMap"),g=e("./ChessModel"),m=e("../../Utils/Cocos"),C=e("../View/UI/SkipButtonView"),S=e("./ChessUtil"),R=(e("../../Utils/Celer/CelerSDK"),e("./GridUtil")),v=e("./ChessRandomUtil"),P=e("../View/UI/HasAnswerView"),_=e("./GameLogic"),b=e("../View/UI/AnswerView"),w=e("../View/UI/TurnView"),T=e("../Command/GamePlaySignal"),M=e("../../Manager/AudioManager");(function(e){e[e.Combo=0]="Combo",e[e.HintCost=1]="HintCost",e[e.TimeBonus=2]="TimeBonus",e[e.Normal=3]="Normal"})(n=o.ScoreType||(o.ScoreType={})),o.ChessboardHorizonal=[f.ChessHorizonal[f.ChessHorizonal.A],f.ChessHorizonal[f.ChessHorizonal.B],f.ChessHorizonal[f.ChessHorizonal.C],f.ChessHorizonal[f.ChessHorizonal.D],f.ChessHorizonal[f.ChessHorizonal.E],f.ChessHorizonal[f.ChessHorizonal.F],f.ChessHorizonal[f.ChessHorizonal.G],f.ChessHorizonal[f.ChessHorizonal.H]],o.ChessboardVertical=["1","2","3","4","5","6","7","8"];var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.GameTypeInitSignal=I;var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.RevertButtonStateChangedSignal=k;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.BallSortDoneSignal=G;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.OnLevelUpdatedSignal=F;var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.NextRoundSignal=O;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.OnLevelReachSignal=A;var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.RoundGenDoneSignal=L;var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);o.LevelGenDoneSignal=B;var j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(l.BaseSignal);function V(e){return f.ChessHorizonal[e.j]+"."+e.i}function U(e){return f.ChessHorizonal[e.j]+"."+(e.i+1)}o.GameLevelAllEndSignal=j,o.pos2WordPos=V,o.pos2LogPos=U,o.wordPos2Pos=function(e){var t=e.split(".");return{i:parseInt(t[1])%8,j:f.ChessHorizonal[t[0]]}};var x=function(){function e(){this.level=0,this.playerScore=0,this.noviceScore=0,this.gameTime=r.TotalTime,this.pauseCount=0,this.pauseScore=0,this.streak=0,this.totalStreak=0,this.maxSteak=0,this.moveCount=0,this.reverts=[],this.scoreMap={},this.playerScoreMap={},this.chessCountLimit={},this.currentChessTypeCount={},this.currentRoundInfo=null,this.currentAnswers=new y.HashMap,this.genTryTimes=0,this.maxTryTimes=10,this.solvedCount=0,this.noAnswerCount=0,this.randomSeed={},this.pawnPosLimit={},this.chessModels=new y.HashMap,this.map={},this.init()}return Object.defineProperty(e.prototype,"HintBonus",{get:function(){return this.solvedCount<=0?0:this.logic.HintBonus},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.logic=new _.GameLogic(this),u.RevertSignal.inst.addListener(this.revertAction,this),d.EndNowSignal.inst.addListener(this.onEndNow,this),C.NextLevelSignal.inst.addListener(function(t){void 0===t&&(t=!1),t&&e.solvedCount++,A.inst.dispatchTwo(t,e.Level),e.Level>=10?p.GameStateController.inst.roundEnd(e.solvedCount>=10?p.RoundEndType.Complete:p.RoundEndType.Over):(e.Level++,e.recordRandomSeed(),e.MoveCount=0,e.nextRound(),B.inst.dispatchOne(e.currentRoundInfo.play))},this)},Object.defineProperty(e.prototype,"Map",{get:function(){return this.map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Time",{get:function(){return this.gameTime},set:function(e){this.gameTime=e,this.gameTime=Math.max(0,this.gameTime)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Theme",{get:function(){return this.theme},set:function(e){console.log("set game theme:",i.Theme[e]),this.theme=e,s.GameThemeInit.inst.dispatchOne(this.theme)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this.level},set:function(e){console.log("set game Level:",e),this.level=e,this.genTryTimes=0,F.inst.dispatchOne(this.Level)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalScore",{get:function(){return Math.max(this.Timebonus+this.ScoreSpread+this.playerScore,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Timebonus",{get:function(){return this.solvedCount<=0||0==this.logic.HasMoveChess?0:Math.floor((this.solvedCount/10*1.2+.5)*this.gameTime)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScoreSpread",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerScore",{get:function(){return this.playerScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MoveCount",{get:function(){return this.moveCount},set:function(e){this.moveCount=e,this.moveCount>=3&&(M.Oop3ToNextSignal.inst.dispatch(),T.LevelDoneSignal.inst.dispatchOne(!1)),h.MoveCountChangedSignal.inst.dispatchOne(this.moveCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseScore",{get:function(){return this.pauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NoviceScore",{get:function(){return this.noviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalCombo",{get:function(){return this.totalStreak},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PauseCount",{get:function(){return this.pauseCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AnswerChess",{get:function(){return this.currentRoundInfo.uniqueKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayType",{get:function(){return this.currentRoundInfo.play},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"KeyStartPos",{get:function(){return this.currentRoundInfo.keyStartPos},enumerable:!0,configurable:!0}),e.prototype.onEndNow=function(){this.checkCompleteScore(),p.GameStateController.inst.roundEnd(p.RoundEndType.Over)},e.prototype.addRevert=function(e){CELER_X&&(this.reverts.length=0),this.reverts.push(e),k.inst.dispatchOne(!0)},e.prototype.revertAction=function(){1!=this.Level&&(this.Level--,c.Random.setRandomSeed(this.randomSeed[this.Level]),this.nextRound())},e.prototype.checkCompleteScore=function(){},e.prototype.initGametheme=function(){var e=a.Level.getThemeRandomPool(this.Level);this.Theme=e[Math.floor(c.Random.getRandom()*e.length)]},e.prototype.initGameData=function(){console.log("init game data."),this.Level++,this.recordRandomSeed(),this.nextRound(),B.inst.dispatch()},e.prototype.recordRandomSeed=function(){this.randomSeed[this.level]=c.Random.Seed,console.log(" seed:",this.randomSeed)},e.prototype.setOccupy=function(e,t){this.map[e]=t},e.prototype.freeMap=function(e){this.map[e]=null},e.prototype.getType=function(e){return this.map[e]},e.prototype.resetChessCountLimit=function(){var e,t,o,n;this.currentChessTypeCount=((e={})[f.ChessType.Black]=0,e[f.ChessType.White]=0,e),this.chessCountLimit=((t={})[f.ChessType.Black]=((o={})[f.ChessRole.King]=1,o[f.ChessRole.Queen]=1,o[f.ChessRole.Bishop]={0:1,1:1},o[f.ChessRole.Knight]=2,o[f.ChessRole.Rook]=2,o[f.ChessRole.Pawn]=8,o),t[f.ChessType.White]=((n={})[f.ChessRole.King]=1,n[f.ChessRole.Queen]=1,n[f.ChessRole.Bishop]={0:1,1:1},n[f.ChessRole.Knight]=2,n[f.ChessRole.Rook]=2,n[f.ChessRole.Pawn]=8,n),t)},e.prototype.checkChessIsFull=function(e,t,o){if(e==f.ChessRole.Bishop){if(this.chessCountLimit[t]&&this.chessCountLimit[t][e]&&this.chessCountLimit[t][e][(o.i+o.j)%2]&&this.chessCountLimit[t][e][(o.i+o.j)%2]>0)return!1}else if(this.chessCountLimit[t]&&this.chessCountLimit[t][e]&&this.chessCountLimit[t][e]>0)return!1;return!0},e.prototype.checkIsPawnPosLimit=function(e,t){return!!(this.pawnPosLimit[e.j]&&this.pawnPosLimit[e.j][t]&&this.pawnPosLimit[e.j][t]>=2)},e.prototype.nextRound=function(){var e,t,o,n,i,r,s,a;this.genTryTimes++,console.log("try gen chess round:",this.genTryTimes),O.inst.dispatch();var l=Date.now();this.resetChessCountLimit(),this.map={},this.currentAnswers.clear(),this.pawnPosLimit={0:(e={},e[f.ChessType.Black]=0,e[f.ChessType.White]=0,e),1:(t={},t[f.ChessType.Black]=0,t[f.ChessType.White]=0,t),2:(o={},o[f.ChessType.Black]=0,o[f.ChessType.White]=0,o),3:(n={},n[f.ChessType.Black]=0,n[f.ChessType.White]=0,n),4:(i={},i[f.ChessType.Black]=0,i[f.ChessType.White]=0,i),5:(r={},r[f.ChessType.Black]=0,r[f.ChessType.White]=0,r),6:(s={},s[f.ChessType.Black]=0,s[f.ChessType.White]=0,s),7:(a={},a[f.ChessType.Black]=0,a[f.ChessType.White]=0,a)},this.clearChessboard(),this.currentRoundInfo={play:this.checkPlayerType(),ai:null,uniqueKey:null,aiStr:"",uniqueKeyStr:"",playStr:"",keyStartPos:null,keyAnswerPos:null,keyKingPos:null,protector:[],protectorPos:[],protectorTartget:[],chessboardData:{},hasAnswer:!1,realAnswer:{},kingID:""},w.OnTurnInitSignal.inst.dispatchOne(this.currentRoundInfo.play),this.currentRoundInfo.ai=this.currentRoundInfo.play==f.ChessType.Black?f.ChessType.White:f.ChessType.Black,this.currentRoundInfo.playStr=f.ChessType[this.currentRoundInfo.play],this.currentRoundInfo.aiStr=f.ChessType[this.currentRoundInfo.ai],this.genAIKing(this.currentRoundInfo.ai),this.currentRoundInfo.uniqueKey=this.genUniqueKeyChess(),this.currentRoundInfo.uniqueKeyStr=f.ChessRole[this.currentRoundInfo.uniqueKey];var u=this.getOriginByTargetKill(this.currentRoundInfo.keyKingPos,this.currentRoundInfo.uniqueKey,f.Play.Player,this.currentRoundInfo.play);if(u.length<=0)this.genTryTimes>=this.maxTryTimes?console.error(" answer pool is empty!",this.currentRoundInfo):(this.recordRandomSeed(),this.nextRound());else{this.currentRoundInfo.keyAnswerPos=u[c.Random.randomFloorToInt(0,u.length)];var h=S.ChessUtil.GetAllOriginByDestination(this.currentRoundInfo.uniqueKey,f.Play.Player,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.play,this.map);if(this.spliceCheckingOrigin(h,this.currentRoundInfo.keyKingPos,this.currentRoundInfo.uniqueKey,this.currentRoundInfo.ai,this.currentRoundInfo.play),h.length<=0)this.maxTryTimes<=this.genTryTimes?console.error(" key start pos pool is empty:",this.currentRoundInfo):(this.recordRandomSeed(),this.nextRound());else{this.currentRoundInfo.keyStartPos=h[c.Random.randomFloorToInt(0,h.length)],this.genChess(this.currentRoundInfo.play,this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos);var p=S.ChessUtil.GetAllDestinationByOrigin(f.ChessRole.King,f.Play.AI,this.currentRoundInfo.keyKingPos,this.currentRoundInfo.ai,this.map,!0);if(S.ChessUtil.CheckHasDuplicatePos([this.currentRoundInfo.keyAnswerPos],p).length>0&&(null!=this.randomAnswerProtector(this.currentRoundInfo.keyAnswerPos)?console.log(" \u751f\u6210\u4fdd\u62a4\u68cb\u5b50 "):console.error(" \u6ca1\u6709\u4fdd\u62a4\u68cb\u5b50 ")),this.blockAnswerDuplicateWay(),this.limitKingRunWay(),this.genOtherChess(),this.checkAnswerWayBlock(),this.genPlayerKing(),console.log("\u8fde\u7eed\u65e0\u89e3\u7684\u6570\u91cf\uff1a",this.noAnswerCount),this.checkAnswerAndEscape())b.AnswerViewShowSignal.inst.dispatchOne("\u6709\u89e3"),this.currentRoundInfo.hasAnswer=!0,this.noAnswerCount=0;else if(this.noAnswerCount++,this.noAnswerCount>=3){if(this.genTryTimes<this.maxTryTimes)return void this.nextRound();console.log("\u8fde\u7eed",this.noAnswerCount,"\u9898\u65e0\u89e3\uff0c\u8d85\u8fc7\u6700\u5927\u751f\u6210\u6b21\u6570:",this.genTryTimes)}else b.AnswerViewShowSignal.inst.dispatchOne("\u65e0\u89e3"),this.currentRoundInfo.hasAnswer=!1;L.inst.dispatch(),console.log(this.currentRoundInfo,"cost time:",Date.now()-l," ms")}}},e.prototype.checkAnswerAndEscape=function(){var e=this,t=!1;return this.chessModels.forEach(function(t,o){if(o.Type==e.currentRoundInfo.play)for(var n=function(t){if(e.isCheckTarget(e.currentRoundInfo.ai,e.currentRoundInfo.keyKingPos,o.Role,t,o.Type,f.Play.Player)){var n=e.hasEscapeWay(o.Role,o.Position,t),i=e.getAIProtector(o.Role,o.Position,t,e.currentRoundInfo.keyKingPos);if(e.currentAnswers.has(o.ID)){var r=[];i.length>0?i.forEach(function(t,o){var n=e.chessModels.get(t);r.push({aiRole:n.Role,from:n.Position,to:o})}):r.push(null);var s=e.currentAnswers.get(o.ID);s.targetPos.push(t),s.escapePos.push(n),s.protector.push(r)}else{var a=[];a[0]=[],i.length>0?i.forEach(function(t,o){var n=e.chessModels.get(t);a[0].push({aiRole:n.Role,from:n.Position,to:o})}):a[0].push(null),e.currentAnswers.add(o.ID,{targetPos:[t],startPos:o.Position,escapePos:[n],protector:a})}}},i=0,r=S.ChessUtil.GetAllDestinationByOrigin(o.Role,f.Play.Player,o.Position,o.Type,e.map);i<r.length;i++){n(r[i])}}),!(this.currentAnswers.length<=0)&&(this.currentAnswers.forEach(function(o,n){for(var i=0;i<n.targetPos.length;++i){e.chessModels.get(o);var r=n.escapePos[i],s=n.protector[i],a=n.targetPos[i];if(null==r||r.length<=0)if(null==s||s.length<=0)t=!0,e.currentRoundInfo.realAnswer[o]?e.currentRoundInfo.realAnswer[o].push(V(a)):e.currentRoundInfo.realAnswer[o]=[V(a)];else{for(var c=!1,l=0,u=s;l<u.length;l++){if(u[l]){c=!0;break}}0==c&&(t=!0,e.currentRoundInfo.realAnswer[o]?e.currentRoundInfo.realAnswer[o].push(V(a)):e.currentRoundInfo.realAnswer[o]=[V(a)])}}}),P.HasAnswerSignal.inst.dispatchOne(this.currentAnswers),t)},e.prototype.getAIProtector=function(e,t,o,n){var i=this,r=new y.HashMap,s=S.ChessUtil.GetPassingWay(e,o,n),a=this.getType(V(o)),c=this.getType(V(t));return this.setOccupy(V(t),null),this.setOccupy(V(o),this.currentRoundInfo.play),s.push(o),this.chessModels.forEach(function(e,t){if(t.Type==i.currentRoundInfo.ai&&t.Role!=f.ChessRole.King){for(var o,n=S.ChessUtil.GetAllDestinationByOrigin(t.Role,f.Play.AI,t.Position,t.Type,i.map),a=function(e){var r=n[e],s=i.getType(V(r)),a=i.getType(V(t.Position));i.setOccupy(V(r),i.currentRoundInfo.ai),i.setOccupy(V(t.Position),null);var c=!1;i.chessModels.forEach(function(e,t){if(t.Type==i.currentRoundInfo.play&&t.Role!=f.ChessRole.King){var o=S.ChessUtil.GetAllDestinationByOrigin(t.Role,f.Play.Player,t.Position,t.Type,i.map,!0);S.ChessUtil.CheckHasDuplicatePos([i.currentRoundInfo.keyKingPos],o).length>0&&(c=!0)}}),c&&(n.splice(e,1),e--),i.setOccupy(V(r),s),i.setOccupy(V(t.Position),a),o=e},c=0;c<n.length;++c)a(c),c=o;var l=S.ChessUtil.CheckHasDuplicatePos(n,s);l.length>0&&(r.has(t.ID)?r.add(t.ID,r.get(t.ID).concat(l)):r.add(t.ID,l))}}),this.setOccupy(V(o),a),this.setOccupy(V(t),c),r},e.prototype.checkAnswerWayBlock=function(){var e=this,t=!1;this.chessModels.forEach(function(o,n){if(n.Type==e.currentRoundInfo.play&&0==t)for(var i=function(o){if(e.isCheckTarget(e.currentRoundInfo.ai,e.currentRoundInfo.keyKingPos,n.Role,o,n.Type,f.Play.Player)&&e.hasEscapeWay(n.Role,n.Position,o).length<=0){var i=e.getAIProtector(n.Role,n.Position,o,e.currentRoundInfo.keyKingPos);if(i.length>0){var r=0;i.forEach(function(t,o){for(var n=0,i=o;n<i.length;n++){var s=i[n],a=e.chessModels.get(t),c=S.ChessUtil.GetPassingWay(a.Role,a.Position,s);c&&e.genChessByRange(c)&&r++}}),i.length<=r&&(t=!0)}}if(t)return"break"},r=0,s=S.ChessUtil.GetAllDestinationByOrigin(n.Role,f.Play.Player,n.Position,n.Type,e.map);r<s.length;r++){if("break"===i(s[r]))break}})},e.prototype.genChessByRange=function(e){var t;if(e.length<=0)return!1;for(var o=16-this.currentChessTypeCount[f.ChessType.White],n=16-this.currentChessTypeCount[f.ChessType.Black],i=[];o-- >0;)i.push(f.ChessType.White);for(;n-- >0;)i.push(f.ChessType.Black);if(i.length<=0)return!1;m.disOrderArray(i);var r=!1;if(m.disOrderArray(e),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!0),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!0),this.currentRoundInfo.protector)for(var s=0;s<this.currentRoundInfo.protector.length;++s)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[s],this.currentRoundInfo.protectorPos[s],this.currentRoundInfo.protectorTartget[s],!0);for(;i.length>0;){for(var a=i.pop(),c=((t={})[f.ChessRole.Pawn]=15,t[f.ChessRole.Bishop]=20,t[f.ChessRole.Knight]=25,t[f.ChessRole.Queen]=20,t[f.ChessRole.Rook]=20,t);e.length>0;){var l=e.pop();if(0!=R.GridUtil.CheckIsFree(l,this.map)){a==this.currentRoundInfo.play?c[this.currentRoundInfo.uniqueKey]=0:c[this.currentRoundInfo.uniqueKey]=20,this.checkChessIsFull(f.ChessRole.Bishop,a,l)&&(c[f.ChessRole.Bishop]=0);var u=!0;for(var h in c)if(c[h]&&c[h]>0){u=!1;break}if(u)break;var p=a==this.currentRoundInfo.ai?f.Play.AI:f.Play.Player,d=v.ChessRandomUtil.GenRandomChess(c,a,p,this,l);if(null!=d){if(d==f.ChessRole.Pawn){if(this.checkIsPawnPosLimit(l,a))continue;r=!0,this.genChess(a,d,l);break}r=!0,this.genChess(a,d,l);break}c[d]=0}}if(r)break}if(this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!1),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!1),this.currentRoundInfo.protector)for(s=0;s<this.currentRoundInfo.protector.length;++s)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[s],this.currentRoundInfo.protectorPos[s],this.currentRoundInfo.protectorTartget[s],!1);return r},e.prototype.genOtherChess=function(){var e,t=this.currentChessTypeCount[f.ChessType.Black]+this.currentChessTypeCount[f.ChessType.White],o=Math.max(15,t+c.Random.randomFloorToInt(0,25-t));if(console.log("nowChessCount:",t,", targetChessCount:",o),!(o<=t)){for(var n=16-this.currentChessTypeCount[f.ChessType.White],i=16-this.currentChessTypeCount[f.ChessType.Black],r=[];n-- >0;)r.push(f.ChessType.White);for(;i-- >0;)r.push(f.ChessType.Black);if(!(r.length<=0)){m.disOrderArray(r);var s=((e={})[f.ChessRole.Pawn]=15,e[f.ChessRole.Bishop]=20,e[f.ChessRole.Knight]=25,e[f.ChessRole.Queen]=20,e[f.ChessRole.Rook]=20,e),a=S.ChessUtil.GetPassingWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos);for(a.push(this.currentRoundInfo.keyAnswerPos);r.length>0&&t<o;){for(var l=r.pop(),u=[{i:4,j:4},{i:4,j:5}],h=0;h<u.length;++h)this.checkChessIsFull(f.ChessRole.Bishop,l,u[h])&&(u.splice(h,1),--h);u.length<=0&&(s[f.ChessRole.Bishop]=0);var p=!0;for(var d in s)if(s[d]&&s[d]>0){p=!1;break}if(p)break;var y=l==this.currentRoundInfo.ai?f.Play.AI:f.Play.Player,g=c.Random.randomFloorToInt(0,u.length),C=v.ChessRandomUtil.GenRandomChess(s,l,y,this,u[g]);if(this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!0),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!0),this.currentRoundInfo.protector)for(var R=0;R<this.currentRoundInfo.protector.length;++R)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[R],this.currentRoundInfo.protectorPos[R],this.currentRoundInfo.protectorTartget[R],!0);var P=[];if(P=C==f.ChessRole.Bishop?v.ChessRandomUtil.GetBishopPosRange(u[g],this.map):C==f.ChessRole.Pawn?v.ChessRandomUtil.GetPawnPosRange(this.map,l):v.ChessRandomUtil.GetAllPosRange(this.map),l==this.currentRoundInfo.play){var _=S.ChessUtil.GetAllDestinationByOrigin(f.ChessRole.King,f.Play.AI,this.currentRoundInfo.keyKingPos,this.currentRoundInfo.ai,this.map);S.ChessUtil.SpliceDuplicatePos(_,P)}if(S.ChessUtil.SpliceDuplicatePos([this.currentRoundInfo.keyAnswerPos],P),P.length<=0)s[C]=0;else{if(m.disOrderArray(P),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!1),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!1),this.currentRoundInfo.protector)for(R=0;R<this.currentRoundInfo.protector.length;++R)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[R],this.currentRoundInfo.protectorPos[R],this.currentRoundInfo.protectorTartget[R],!1);if(l==this.currentRoundInfo.ai){var b=this.getDuplicationAnswer();S.ChessUtil.SpliceDuplicatePos(b,P)}if(null!=C)for(;P.length>0;){var w=P.pop();if(y==f.Play.AI){var T=S.ChessUtil.GetAllDestinationByOrigin(C,y,w,this.currentRoundInfo.ai,this.map);if(C==f.ChessRole.Pawn&&this.checkIsPawnPosLimit(w,l))continue;if(S.ChessUtil.CheckHasDuplicatePos(a,T).length>0)continue;w.i==this.currentRoundInfo.keyAnswerPos.i&&w.j==this.currentRoundInfo.keyAnswerPos.j&&console.error(" AI\u968f\u673a\u68cb\u5b50\u8ddf\u7b54\u6848\u91cd\u590d"),console.log("\u751f\u6210AI\u968f\u673a\u68cb\u5b50:",f.ChessRole[C]," type\uff1a",f.ChessType[l],U(w)),this.genChess(l,C,w),t++;break}if(!this.isCheckTarget(this.currentRoundInfo.ai,this.currentRoundInfo.keyKingPos,C,w,this.currentRoundInfo.play,f.Play.Player)&&(w.i==this.currentRoundInfo.keyAnswerPos.i&&w.j==this.currentRoundInfo.keyAnswerPos.j&&console.error(" Player\u968f\u673a\u68cb\u5b50\u8ddf\u7b54\u6848\u91cd\u590d"),C!=f.ChessRole.Pawn||!this.checkIsPawnPosLimit(w,l))){console.log("\u751f\u6210Player\u968f\u673a\u68cb\u5b502:",f.ChessRole[C]," type\uff1a",f.ChessType[l],U(w)),this.genChess(l,C,w),t++;break}}else s[C]=0}}if(this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!1),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!1),this.currentRoundInfo.protector)for(R=0;R<this.currentRoundInfo.protector.length;++R)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[R],this.currentRoundInfo.protectorPos[R],this.currentRoundInfo.protectorTartget[R],!1);console.log(" Gen Other done!")}}},e.prototype.getDuplicationAnswer=function(){var e=this,t=S.ChessUtil.GetAllDestinationByOrigin(this.currentRoundInfo.uniqueKey,f.Play.Player,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.play,this.map);S.ChessUtil.SpliceDuplicatePos([this.currentRoundInfo.keyAnswerPos],t);for(var o=[],n=function(t){if(i.isCheckTarget(i.currentRoundInfo.ai,i.currentRoundInfo.keyKingPos,i.currentRoundInfo.uniqueKey,t,i.currentRoundInfo.play,f.Play.Player)){var n=!1;if(i.chessModels.forEach(function(o,i){if(i.Type==e.currentRoundInfo.ai&&e.isCheckTarget(e.currentRoundInfo.play,t,i.Role,i.Position,i.Type,f.Play.AI))if(i.Role==f.ChessRole.King){var r=!1;e.chessModels.forEach(function(o,n){n.Type==e.currentRoundInfo.play&&e.isCheckTarget(e.currentRoundInfo.ai,t,n.Role,n.Position,n.Type,f.Play.Player)&&(r=!0)}),0==r&&(n=!0)}else n=!0}),n)return"continue";o.push(t)}},i=this,r=0,s=t;r<s.length;r++){n(s[r])}return o},e.prototype.blockAnswerDuplicateWay=function(){var e=this.getDuplicationAnswer();if(e.length>0){var t=S.ChessUtil.GetPassingWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos);t.push(this.currentRoundInfo.keyAnswerPos);var o=S.ChessUtil.GetPassingWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos);for(m.disOrderArray(e);e.length>0;){var n=e.pop(),i=S.ChessUtil.GetAllDestinationByOrigin(this.currentRoundInfo.uniqueKey,f.Play.Player,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.play,this.map);if(!(S.ChessUtil.CheckHasDuplicatePos([n],i).length<=0)){var r=S.ChessUtil.CheckHasDuplicatePos([n],t).length>0,s=S.ChessUtil.CheckHasDuplicatePos([n],o).length>0;if(s||r)s&&!r||!s&&r||console.error("\u4e0d\u5b58\u5728\u540c\u65f6\u963b\u6321\u7b54\u6848\u548c\u5f00\u59cb\u8def\u7ebf\u7684\u591a\u4f59\u89e3\uff1a",this.currentRoundInfo);else{var a=S.ChessUtil.GetPassingWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,n);R.GridUtil.CheckIsFree(n,this.map)&&a.push(n),m.disOrderArray(a),S.ChessUtil.SpliceDuplicatePos(t,a),S.ChessUtil.SpliceDuplicatePos(o,a);for(var c=!1,l=0,u=a;l<u.length;l++){var h=u[l];if(this.isCheckTarget(this.currentRoundInfo.play,h,f.ChessRole.King,this.currentRoundInfo.keyKingPos,this.currentRoundInfo.ai,f.Play.AI)){if((p=this.randomPlaceholderChess(h,this.currentRoundInfo.ai,f.Play.AI,this.currentRoundInfo.play,this.currentRoundInfo.keyAnswerPos))==f.ChessRole.Pawn&&this.checkIsPawnPosLimit(h,this.currentRoundInfo.ai))continue;if(this.checkWillBlockProtector(this.currentRoundInfo.ai,h,p))continue;if(p){c=!0,this.genChess(this.currentRoundInfo.ai,p,h);break}}else{var p;if(((p=this.randomPlaceholderChess(h,this.currentRoundInfo.play,f.Play.Player,this.currentRoundInfo.ai,this.currentRoundInfo.keyKingPos))!=f.ChessRole.Pawn||!this.checkIsPawnPosLimit(h,this.currentRoundInfo.play))&&!this.checkWillBlockProtector(this.currentRoundInfo.play,h,p)&&p){c=!0,this.genChess(this.currentRoundInfo.play,p,h);break}}}0==c&&console.log(" \u5b58\u5728\u591a\u4e2a\u89e3\u65e0\u6cd5\u5b8c\u5168\u963b\u6321")}}}}},e.prototype.randomAnswerProtector=function(e,t){var o;void 0===t&&(t=[]);var n,i,r=((o={})[f.ChessRole.Pawn]=15,o[f.ChessRole.Bishop]=20,o[f.ChessRole.Knight]=25,o[f.ChessRole.Queen]=20,o[f.ChessRole.Rook]=20,o),s=null;r[this.currentRoundInfo.uniqueKey]=0;for(var a=500;a--;){n=v.ChessRandomUtil.GenRandomChess(r,this.currentRoundInfo.play,f.Play.Player,this,null),i=S.ChessUtil.GetAllOriginByDestination(n,f.Play.Player,e,this.currentRoundInfo.play,this.map);var l=S.ChessUtil.GetPassingWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos);l.push(this.currentRoundInfo.keyAnswerPos),l.push(this.currentRoundInfo.keyStartPos);for(var u=S.ChessUtil.GetPassingWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos),h=0;h<i.length;++h)this.isCheckTarget(this.currentRoundInfo.ai,this.currentRoundInfo.keyKingPos,n,i[h],this.currentRoundInfo.play,f.Play.Player)?(i.splice(h,1),--h):this.checkChessIsFull(n,this.currentRoundInfo.play,i[h])?(i.splice(h,1),--h):S.ChessUtil.CheckHasDuplicatePos([i[h]],l).length>0||S.ChessUtil.CheckHasDuplicatePos([i[h]],u).length>0?(i.splice(h,1),--h):this.checkWillBlockProtector(this.currentRoundInfo.play,i[h],n)?(i.splice(h,1),--h):n==f.ChessRole.Pawn&&this.checkIsPawnPosLimit(i[h],this.currentRoundInfo.play)&&(i.splice(h,1),--h);if(S.ChessUtil.SpliceDuplicatePos(t,i),!(i.length<=0))break;r[n]=0;var p=!0;for(var d in r)if(r[d]&&r[d]>0){p=!1;break}if(p)break}if(i.length>0&&n){m.disOrderArray(i);var y=i[c.Random.randomFloorToInt(0,i.length)];this.genChess(this.currentRoundInfo.play,n,y),this.currentRoundInfo.protector.push(n),this.currentRoundInfo.protectorPos.push({i:y.i,j:y.j}),this.currentRoundInfo.protectorTartget.push(e),s={chess:n,origin:y}}return s},e.prototype.checkWillBlockProtector=function(e,t,o){for(var n=!1,i=[],r=0;r<this.currentRoundInfo.protector.length;++r)i.push(S.ChessUtil.GetPassingWay(this.currentRoundInfo.protector[r],this.currentRoundInfo.protectorPos[r],this.currentRoundInfo.protectorTartget[r]));for(var s=0;s<i.length;++s)if(S.ChessUtil.CheckHasDuplicatePos(i[s],[t]).length>0){if(e!=this.currentRoundInfo.play){n=!0;break}var a=this.currentRoundInfo.protectorTartget[s],c=S.ChessUtil.GetAllDestinationByOrigin(o,f.Play.Player,t,this.currentRoundInfo.play,this.map);if(S.ChessUtil.CheckHasDuplicatePos([a],c).length<=0){n=!0;break}}return n},e.prototype.limitKingRunWay=function(){var e,t,o,n,i,r=this.hasEscapeWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos);if(r.length<=0)return!0;console.log(" \u5f00\u59cb\u9650\u5236 king \u7684\u8def\u5f84:",r.concat());var s=this,a=((e={})[f.ChessRole.Pawn]=15,e[f.ChessRole.Bishop]=20,e[f.ChessRole.Knight]=25,e[f.ChessRole.Queen]=20,e[f.ChessRole.Rook]=20,e);function l(e){for(var t={chess:null,pos:null},o=500;o--;){if(t.chess=v.ChessRandomUtil.GenRandomChess(a,s.currentRoundInfo.ai,f.Play.AI,s,e),console.log(" try AI Chess:",f.ChessRole[t.chess]),!(s.isCheckTarget(s.currentRoundInfo.play,s.currentRoundInfo.keyAnswerPos,t.chess,e,s.currentRoundInfo.ai,f.Play.AI)||t.chess==f.ChessRole.Pawn&&s.checkIsPawnPosLimit(e,s.currentRoundInfo.ai))){console.log("LimitChessAI:",t);break}a[f.ChessRole.Pawn]=0,t.chess=null;var n=!0;for(var i in a)if(a[i]&&a[i]>0){n=!1;break}if(n)break}return console.log(" limit AI Chess Count:",500-o,t,a),t}a[this.currentRoundInfo.uniqueKey]=0;for(var u=50;r.length>0&&u--;){var h=r.pop();if(0!=R.GridUtil.CheckIsFree(h,this.map)){var p=S.ChessUtil.GetPassingWay(s.currentRoundInfo.uniqueKey,s.currentRoundInfo.keyStartPos,s.currentRoundInfo.keyAnswerPos);p.push(s.currentRoundInfo.keyAnswerPos),p.push(s.currentRoundInfo.keyStartPos);var d=S.ChessUtil.GetPassingWay(s.currentRoundInfo.uniqueKey,s.currentRoundInfo.keyAnswerPos,s.currentRoundInfo.keyKingPos),y=[];if(s.currentRoundInfo.protector)for(var g=0;g<s.currentRoundInfo.protector.length;++g)y=y.concat(S.ChessUtil.GetPassingWay(s.currentRoundInfo.protector[g],s.currentRoundInfo.protectorPos[g],s.currentRoundInfo.protectorTartget[g]));var m=!1;(S.ChessUtil.CheckHasDuplicatePos([h],p).length>0||S.ChessUtil.CheckHasDuplicatePos([h],d).length>0||S.ChessUtil.CheckHasDuplicatePos([h],y).length>0)&&(m=!0);var C=void 0;if(c.Random.getRandom()>.5||m)(t={})[f.ChessRole.Pawn]=15,t[f.ChessRole.Bishop]=20,t[f.ChessRole.Knight]=25,t[f.ChessRole.Queen]=20,t[f.ChessRole.Rook]=20,(a=t)[this.currentRoundInfo.uniqueKey]=0,this.randomAnswerProtector(h,r)||((o={})[f.ChessRole.Pawn]=15,o[f.ChessRole.Bishop]=20,o[f.ChessRole.Knight]=25,o[f.ChessRole.Queen]=20,o[f.ChessRole.Rook]=20,a=o,(C=l(h)).chess?this.genChess(this.currentRoundInfo.ai,C.chess,h):console.log(" \u963b\u6321 \u5931\u8d25"));else(n={})[f.ChessRole.Pawn]=15,n[f.ChessRole.Bishop]=20,n[f.ChessRole.Knight]=25,n[f.ChessRole.Queen]=20,n[f.ChessRole.Rook]=20,a=n,(C=l(h)).chess?this.genChess(this.currentRoundInfo.ai,C.chess,h):((i={})[f.ChessRole.Pawn]=15,i[f.ChessRole.Bishop]=20,i[f.ChessRole.Knight]=25,i[f.ChessRole.Queen]=20,i[f.ChessRole.Rook]=20,(a=i)[this.currentRoundInfo.uniqueKey]=0,this.randomAnswerProtector(h)||console.log(" \u963b\u6321 \u5931\u8d25AI"));r=this.hasEscapeWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos)}else{R.GridUtil.CheckForwardType(h,this.currentRoundInfo.ai,this.map)==R.ForwardType.Kill&&(this.randomAnswerProtector(h,r)||console.log("\u6ca1\u6cd5\u4fdd\u62a4\uff0c\u654c\u65b9\u738b\u5b58\u5728\u9003\u8dd1\u8def\u7ebf\uff1a",U(h)))}}return(r=this.hasEscapeWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos)).length<=0},e.prototype.genPlayerKing=function(){var e=this;if(this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!0),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!0),this.currentRoundInfo.protector)for(var t=0;t<this.currentRoundInfo.protector.length;++t)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[t],this.currentRoundInfo.protectorPos[t],this.currentRoundInfo.protectorTartget[t],!0);var o=v.ChessRandomUtil.GetKingPosRange(f.Play.Player,this.map),n=v.ChessRandomUtil.GetKingPosRange(f.Play.AI,this.map);if(this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyAnswerPos,this.currentRoundInfo.keyKingPos,!1),this.checkBlockOfTargetWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos,!1),this.currentRoundInfo.protector)for(t=0;t<this.currentRoundInfo.protector.length;++t)this.checkBlockOfTargetWay(this.currentRoundInfo.protector[t],this.currentRoundInfo.protectorPos[t],this.currentRoundInfo.protectorTartget[t],!1);var i=[];this.chessModels.forEach(function(t,r){if(r.Type==e.currentRoundInfo.ai){for(var s=0;s<o.length;++s){var a=e.getType(V(o[s]));e.setOccupy(V(o[s]),e.currentRoundInfo.play);var c=S.ChessUtil.GetAllDestinationByOrigin(r.Role,f.Play.AI,r.Position,r.Type,e.map);i=i.concat(c),e.setOccupy(V(o[s]),a)}for(s=0;s<n.length;++s){a=e.getType(V(n[s]));e.setOccupy(V(n[s]),e.currentRoundInfo.play);c=S.ChessUtil.GetAllDestinationByOrigin(r.Role,f.Play.AI,r.Position,r.Type,e.map);i=i.concat(c),e.setOccupy(V(n[s]),a)}}}),S.ChessUtil.SpliceDuplicatePos(i,o),S.ChessUtil.SpliceDuplicatePos(i,n),o.length<=0&&(o=n),o.length<=0?console.error(" player king has no suitable place."):this.genChess(this.currentRoundInfo.play,f.ChessRole.King,o[c.Random.randomFloorToInt(0,o.length)])},e.prototype.testHasWscapeWay=function(){return this.hasEscapeWay(this.currentRoundInfo.uniqueKey,this.currentRoundInfo.keyStartPos,this.currentRoundInfo.keyAnswerPos)},e.prototype.hasEscapeWay=function(e,t,o){var n=this,i=this.getType(V(t)),r=this.getType(V(o));this.setOccupy(V(t),null),this.setOccupy(V(o),this.currentRoundInfo.play);var s=S.ChessUtil.GetAllDestinationByOrigin(f.ChessRole.King,f.Play.AI,this.currentRoundInfo.keyKingPos,this.currentRoundInfo.ai,this.map),a=this,c=[];this.setOccupy(V(this.currentRoundInfo.keyKingPos),null);for(var l=function(i){var r=!1,s=u.getType(V(i));u.setOccupy(V(i),u.currentRoundInfo.ai),i.i==o.i&&i.j==o.j?u.setOccupy(V(o),u.currentRoundInfo.ai):u.setOccupy(V(o),u.currentRoundInfo.play),u.chessModels.forEach(function(s,c){if(c.Type!=n.currentRoundInfo.ai){var l=c.Role==e&&c.Position.i==t.i&&t.j==c.Position.j?o:c.Position,u=S.ChessUtil.GetAllDestinationByOrigin(c.Role,f.Play.Player,l,c.Type,a.map,!0);S.ChessUtil.CheckHasDuplicatePos([i],u).length>0&&(0==n.isChessBeProtector(c.Role,l,i)&&(n.currentRoundInfo.protector.push(c.Role),n.currentRoundInfo.protectorPos.push(l),n.currentRoundInfo.protectorTartget.push(i)),r=!0)}}),u.setOccupy(V(i),s),0==r&&c.push(i)},u=this,h=0,p=s;h<p.length;h++){l(p[h])}this.setOccupy(V(t),i),this.setOccupy(V(o),r),this.setOccupy(V(this.currentRoundInfo.keyKingPos),this.currentRoundInfo.ai);for(var d=0,y=c;d<y.length;d++)y[d];return c},e.prototype.isChessBeProtector=function(e,t,o){if(null==this.currentRoundInfo.protector)return!1;for(var n=0;n<this.currentRoundInfo.protector.length;++n)if(e==this.currentRoundInfo.protector[n]&&t.i==this.currentRoundInfo.protectorPos[n].i&&t.j==this.currentRoundInfo.protectorPos[n].j&&o.i==this.currentRoundInfo.protectorTartget[n].i&&o.j==this.currentRoundInfo.protectorTartget[n].j)return!0;return!1},e.prototype.randomPlaceholderChess=function(e,t,o,n,i,r){var s;void 0===r&&(r=!1);var a=this.getType(V(i));this.setOccupy(V(i),n);var c=((s={})[f.ChessRole.Pawn]=15,s[f.ChessRole.Bishop]=20,s[f.ChessRole.Knight]=25,s[f.ChessRole.Queen]=20,s[f.ChessRole.Rook]=20,s);o==f.Play.Player&&(c[this.currentRoundInfo.uniqueKey]=0);var l,u=this,h=function(s){var a=!0;for(var p in s)s[p]&&s[p]>0&&(a=!1);if(a)console.log("random rule empty");else if(l=v.ChessRandomUtil.GenRandomChess(c,t,o,u,e),u.isCheckTarget(n,i,l,e,t,o)){if(r)return;s[l]=0,h(s)}else{if(!r)return;s[l]=0,h(s)}};return h(c),this.setOccupy(V(i),a),l},e.prototype.spliceCheckingOrigin=function(e,t,o,n,i){if(n!=i)for(var r=i==this.currentRoundInfo.ai?f.Play.AI:f.Play.Player,s=0;s<e.length;++s){var a=S.ChessUtil.GetAllDestinationByOrigin(o,r,e[s],i,this.map);S.ChessUtil.CheckHasDuplicatePos(a,[t]).length>0&&(e.splice(s,1),--s)}},e.prototype.isCheckTarget=function(e,t,o,n,i,r){if(e==i)return!1;var s=S.ChessUtil.GetAllDestinationByOrigin(o,r,n,i,this.map,!0);return S.ChessUtil.CheckHasDuplicatePos([t],s).length>0},e.prototype.checkBlockOfTargetWay=function(e,t,o,n){for(var i=0,r=S.ChessUtil.GetPassingWay(e,t,o);i<r.length;i++){var s=r[i];n?null==this.map[V(s)]&&this.setOccupy(V(s),f.ChessType.Any):this.map[V(s)]==f.ChessType.Any&&this.setOccupy(V(s),null)}},e.prototype.clearChessboard=function(){this.chessModels.forEach(function(e,t){t&&t.removeSelf()}),this.chessModels.clear()},e.prototype.removeChess=function(e){this.reduceChessCount(e.Type,e.Role,e.Position),this.setOccupy(V(e.Position),null),this.chessModels.remove(e.ID),e.removeSelf()},e.prototype.checkPlayerType=function(){for(var e=[];e.length<200;)e.push(f.ChessType.Black),e.push(f.ChessType.White);return m.disOrderArray(e),e[c.Random.randomFloorToInt(0,e.length)]},e.prototype.addChess=function(e){this.chessModels.add(e.ID,e);var t=V(e.Position);this.setOccupy(t,e.Type),this.currentRoundInfo.chessboardData[U(e.Position)]=e.WordRole},e.prototype.genChess=function(e,t,o){(0==R.GridUtil.CheckIsFree(o,this.map)||this.checkChessIsFull(t,e,o))&&console.error("\u68cb\u5b50"+f.ChessRole[t]+"\u8d85\u8fc7\u6570\u91cf\u9650\u5236");t==f.ChessRole.Pawn&&this.pawnPosLimit[o.j][e]++;var n=new g.ChessModel(e,t,o);return this.addChess(n),this.addChessCount(e,t,o),this.setOccupy(V(o),e),n},e.prototype.addChessCount=function(e,t,o){t==f.ChessRole.Bishop?this.chessCountLimit[e][t][(o.i+o.j)%2]--:this.chessCountLimit[e][t]--,this.currentChessTypeCount[e]++},e.prototype.reduceChessCount=function(e,t,o){t==f.ChessRole.Bishop?this.chessCountLimit[e][t][(o.i+o.j)%2]++:this.chessCountLimit[e][t]++,this.currentChessTypeCount[e]--,t==f.ChessRole.Pawn&&this.pawnPosLimit[o.j][e]--},e.prototype.genAIKing=function(e){if(this.checkChessIsFull(f.ChessRole.King,e,null))console.error(" King is Full:",f.ChessType[e]);else{var t=v.ChessRandomUtil.GetKingPosRange(f.Play.AI,this.map),o=this.genChess(e,f.ChessRole.King,t[c.Random.randomFloorToInt(0,t.length)]);this.currentRoundInfo.keyKingPos=o.Position,this.currentRoundInfo.kingID=o.ID}},e.prototype.genUniqueKeyChess=function(){var e;return v.ChessRandomUtil.GenRandomChess(((e={})[f.ChessRole.Pawn]=15,e[f.ChessRole.Bishop]=20,e[f.ChessRole.Knight]=25,e[f.ChessRole.Queen]=20,e[f.ChessRole.Rook]=20,e),this.currentRoundInfo.play,f.Play.Player,this,null)},e.prototype.getCheckingPos=function(e,t){return null},e.prototype.getOriginByTargetKill=function(e,t,o,n){for(var i=S.ChessUtil.GetAllOriginByDestination(t,o,e,n,this.map),r=0;r<i.length;++r)R.GridUtil.CheckForwardType(e,n,this.map)==R.ForwardType.Kill&&(t!=f.ChessRole.Pawn||i[r].j!=e.j)||(i.splice(r,1),--r);return i},e.prototype.isFree=function(e,t){return R.GridUtil.CheckForwardType(e,t,this.map)!=R.ForwardType.Block},e.prototype.checkIsCorrect=function(e,t){return console.log(this.currentRoundInfo&&this.currentRoundInfo.realAnswer&&this.currentRoundInfo.realAnswer[e]&&this.currentRoundInfo.realAnswer[e].length>0&&this.currentRoundInfo.realAnswer[e].indexOf(V(t))>=0),this.currentRoundInfo&&this.currentRoundInfo.realAnswer&&this.currentRoundInfo.realAnswer[e]&&this.currentRoundInfo.realAnswer[e].length>0&&this.currentRoundInfo.realAnswer[e].indexOf(V(t))>=0},e.prototype.getFirstAnswerID=function(){if(!this.currentRoundInfo||!this.currentRoundInfo.realAnswer)return null;for(var e in this.currentRoundInfo.realAnswer)return e},e.prototype.addPlayerScore=function(e,t,o,n){if(void 0===o&&(o=1),void 0===n&&(n=null),0!=e){null==this.playerScoreMap[t]&&(this.playerScoreMap[t]=0);var i=this.playerScore;return this.playerScore+=e,e>0||this.resetCombo(),this.playerScore=Math.max(this.playerScore,0),this.playerScoreMap[t]+=this.playerScore-i,s.PlayerScoreChanged.inst.dispatchFour(this.playerScore,e,o,n),this.playerScore-i}},e.prototype.addNoviceScore=function(e,t){void 0===t&&(t=1),this.noviceScore+=e,this.noviceScore=Math.max(this.noviceScore,0),s.NoviceScoreChanged.inst.dispatchThree(this.noviceScore,e,t)},e.prototype.getScoreByType=function(e){return"number"!=typeof this.playerScoreMap[e]?0:this.playerScoreMap[e]},e.prototype.addPauseCount=function(){this.pauseCount++,console.log("pause count:",this.pauseCount),this.pauseCount>r.FreePauseLimit&&this.addPlayerScore(-r.PauseScoreCost,n.Normal)},e.prototype.resetCombo=function(){this.streak=0},e.prototype.addStreak=function(){this.streak++,this.totalStreak++,this.maxSteak=Math.max(this.maxSteak,this.streak)},e.prototype.dump=function(){},e}();o.GamePlayModel=x,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Global/Chess":"Chess","../../Global/GameRule":"GameRule","../../Global/Level":"Level","../../Global/Theme":"Theme","../../Manager/AudioManager":"AudioManager","../../Utils/Celer/CelerSDK":"CelerSDK","../../Utils/Cocos":"Cocos","../../Utils/HashMap":"HashMap","../../Utils/Random":"Random","../../Utils/Signal":"Signal","../Command/GamePlaySignal":"GamePlaySignal","../View/UI/AnswerView":"AnswerView","../View/UI/HasAnswerView":"HasAnswerView","../View/UI/MoveCountLabelView":"MoveCountLabelView","../View/UI/RevertButtonView":"RevertButtonView","../View/UI/SkipButtonView":"SkipButtonView","../View/UI/SubmitLayerView":"SubmitLayerView","../View/UI/TurnView":"TurnView","./ChessModel":"ChessModel","./ChessRandomUtil":"ChessRandomUtil","./ChessUtil":"ChessUtil","./GameLogic":"GameLogic","./GridUtil":"GridUtil"}],GamePlaySignal:[function(e,t,o){"use strict";cc._RF.push(t,"6a923XZO3BHe6UfcoANFeWX","GamePlaySignal"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Utils/Signal"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.SubmitButtonClickSignal=i;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal);o.LevelDoneSignal=r,cc._RF.pop()},{"../../Utils/Signal":"Signal"}],GameRule:[function(e,t,o){"use strict";var n,i;cc._RF.push(t,"58c53me7vtEdKVK7W6RnNQo","GameRule"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Theme");o.TotalTime=(CELER_X,300),o.DrawDebug=!1,o.FreePauseLimit=2,o.PauseScoreCost=100,o.SortScore=100,o.SortScoreStep=10,o.ReadyOffset=45,o.BallOffsetY=((n={})[r.Theme.Blue]=87.24,n[r.Theme.Red]=87.086,n[r.Theme.Green]=80,n),o.BallStartOffsetY=((i={})[r.Theme.Blue]=0,i[r.Theme.Red]=10,i[r.Theme.Green]=0,i),o.GetBallPos=function(e,t){return cc.v2(0,(e-1)*o.BallOffsetY[t]+o.BallStartOffsetY[t])},o.GetBallReadyPos=function(e){return cc.v2(0,3*o.BallOffsetY[e]+o.BallStartOffsetY[e]+o.ReadyOffset)},cc._RF.pop()},{"./Theme":"Theme"}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"b768b1DCFpC4aef+tHUAH/Y","GameStateController"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../Utils/ToSingleton"),r=e("../Command/CommonSignal"),s=e("../Model/PlayModelProxy");(function(e){e[e.Complete=0]="Complete",e[e.Over=1]="Over",e[e.TimeUp=2]="TimeUp"})(n=o.RoundEndType||(o.RoundEndType={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pauseCount=0,t.roundstart=!1,t.isReady=!1,t.isOver=!1,t.currentRound=0,t.onResumeCallbacks=[],t}return __extends(t,e),t.prototype.start=function(){this.pauseCount=0},t.prototype.canStart=function(){return this.isReady},t.prototype.roundStart=function(){this.isOver||(console.log(" round start:",++this.currentRound),this.roundstart=!0)},t.prototype.roundEnd=function(e){console.log("round end :",n[e]),this.roundstart=!1,this.isOver=!0,r.GameOverSignal.inst.dispatchOne(e)},t.prototype.isRoundStart=function(){return this.roundstart},t.prototype.pause=function(e){void 0===e&&(e=!1),0==this.isPause()&&(this.onResumeCallbacks.length=0,r.GamePauseSignal.inst.dispatch(),e||this.onResumeCallbacks.push(function(){s.PlayModelProxy.inst.addPauseCount()})),this.pauseCount++},t.prototype.testEndComplete=function(){this.roundEnd(n.Complete)},t.prototype.testEndTimeUp=function(){s.PlayModelProxy.inst.addGameTime(-1e12)},t.prototype.clearResumeCallback=function(){this.onResumeCallbacks.length=0},t.prototype.resume=function(){if(this.pauseCount--,console.assert(this.pauseCount>=0," pause count smaller than 0!!!"),this.pauseCount=Math.max(this.pauseCount,0),this.pauseCount<=0){for(var e=0,t=this.onResumeCallbacks;e<t.length;e++){(0,t[e])()}this.onResumeCallbacks.length=0}},t.prototype.isPause=function(){return this.pauseCount>0},t.prototype.addResumeCallback=function(e){this.onResumeCallbacks||(this.onResumeCallbacks=[]),this.onResumeCallbacks.push(e)},t.prototype.isGameOver=function(){return this.isOver},t}(i.SingleTon());o.GameStateController=a,!CELER_X&&(window.GameState=a.inst),cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Model/PlayModelProxy":"PlayModelProxy","../Utils/ToSingleton":"ToSingleton"}],GlobalSingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"50484YTu+lAFp2acGVLgU7t","GlobalSingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Controller/GameStateController"),i=e("../SingleTouchMediator"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onRegister=function(){e.prototype.onRegister.call(this),this.node._touchListener.swallowTouches=!1},t.prototype.onTouchStart=function(e){n.GameStateController.inst.canStart()&&0==n.GameStateController.inst.isRoundStart()&&n.GameStateController.inst.roundStart()},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../Controller/GameStateController":"GameStateController","../SingleTouchMediator":"SingleTouchMediator"}],GlobalSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"4cc97bBcEZPu7Haxk0HdV9+","GlobalSingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../BaseView"),i=e("./GlobalSingleTouchMediator"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.BindMedaitor(i.default)},t.prototype.start=function(){},t=__decorate([s],t)}(n.default));o.default=a,cc._RF.pop()},{"../BaseView":"BaseView","./GlobalSingleTouchMediator":"GlobalSingleTouchMediator"}],GridUtil:[function(e,t,o){"use strict";cc._RF.push(t,"69ad7/d43xKmrnBZIb1wYWu","GridUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../../Global/Chess"),r=e("./GamePlayModel");(function(e){e[e.Kill=0]="Kill",e[e.Block=1]="Block",e[e.Free=2]="Free"})(n=o.ForwardType||(o.ForwardType={})),o.GridRange={i:{max:7,min:0},j:{max:7,min:0}};var s=function(){function e(){}return e.copyGrid=function(e){return{i:e.i,j:e.j}},e.GetHorizontalWayByOrigin=function(e,t,i){for(var r=[],s={i:e.i,j:e.j};--s.i>=o.GridRange.i.min;){var a=!1;switch(this.CheckForwardType(s,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(s));break;case n.Kill:r.push(this.copyGrid(s)),a=!0}if(a)break}for(var c={i:e.i,j:e.j};++c.i<=o.GridRange.i.max;){a=!1;switch(this.CheckForwardType(c,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(c));break;case n.Kill:a=!0,r.push(this.copyGrid(c))}if(a)break}return r},e.GetVerticalWayByOrigin=function(e,t,i){for(var r=[],s={i:e.i,j:e.j};++s.j<=o.GridRange.j.max;){var a=!1;switch(this.CheckForwardType(s,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(s));break;case n.Kill:a=!0,r.push(this.copyGrid(s))}if(a)break}for(var c={i:e.i,j:e.j};--c.j>=o.GridRange.j.min;){a=!1;switch(this.CheckForwardType(c,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(c));break;case n.Kill:r.push(this.copyGrid(c)),a=!0}if(a)break}return r},e.GetDiagonalWayByOrigin=function(e,t,i){for(var r=[],s={i:e.i,j:e.j};++s.i<=o.GridRange.i.max&&--s.j>=o.GridRange.j.min;){var a=!1;switch(this.CheckForwardType(s,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(s));break;case n.Kill:a=!0,r.push(this.copyGrid(s))}if(a)break}for(var c={i:e.i,j:e.j};++c.i<=o.GridRange.i.max&&++c.j<=o.GridRange.j.max;){a=!1;switch(this.CheckForwardType(c,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(c));break;case n.Kill:a=!0,r.push(this.copyGrid(c))}if(a)break}for(var l={i:e.i,j:e.j};--l.i>=o.GridRange.i.min&&--l.j>=o.GridRange.j.min;){a=!1;switch(this.CheckForwardType(l,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(l));break;case n.Kill:a=!0,r.push(this.copyGrid(l))}if(a)break}for(var u={i:e.i,j:e.j};--u.i>=o.GridRange.i.min&&++u.j<=o.GridRange.j.max;){a=!1;switch(this.CheckForwardType(u,t,i)){case n.Block:a=!0;break;case n.Free:r.push(this.copyGrid(u));break;case n.Kill:a=!0,r.push(this.copyGrid(u))}if(a)break}return r},e.GetSquaredWayByOrigin=function(e,t,i){for(var r=[],s={i:e.i,j:e.j};++s.i<=o.GridRange.i.max&&--s.j>=o.GridRange.j.min;){switch(this.CheckForwardType(s,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(s))}break}for(var a={i:e.i,j:e.j};++a.i<=o.GridRange.i.max&&++a.j<=o.GridRange.j.max;){switch(this.CheckForwardType(a,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(a))}break}for(var c={i:e.i,j:e.j};--c.i>=o.GridRange.i.min&&--c.j>=o.GridRange.j.min;){switch(this.CheckForwardType(c,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(c))}break}for(var l={i:e.i,j:e.j};--l.i>=o.GridRange.i.min&&++l.j<=o.GridRange.j.max;){switch(this.CheckForwardType(l,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(l))}break}for(var u={i:e.i,j:e.j};++u.j<=o.GridRange.j.max;){switch(this.CheckForwardType(u,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(u))}break}for(var h={i:e.i,j:e.j};--h.j>=o.GridRange.j.min;){switch(this.CheckForwardType(h,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(h))}break}for(var p={i:e.i,j:e.j};--p.i>=o.GridRange.i.min;){switch(this.CheckForwardType(p,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(p))}break}for(var d={i:e.i,j:e.j};++d.i<=o.GridRange.i.max;){switch(this.CheckForwardType(d,t,i)){case n.Block:break;case n.Free:case n.Kill:r.push(this.copyGrid(d))}break}return r},e.GetSunWay=function(e,t,i){var r=[];return e.i+2<=o.GridRange.i.max&&e.j-1>=o.GridRange.j.min&&this.CheckForwardType({i:e.i+2,j:e.j-1},t,i)!=n.Block&&r.push({i:e.i+2,j:e.j-1}),e.i+1<=o.GridRange.i.max&&e.j-2>=o.GridRange.j.min&&this.CheckForwardType({i:e.i+1,j:e.j-2},t,i)!=n.Block&&r.push({i:e.i+1,j:e.j-2}),e.i-1>=o.GridRange.i.min&&e.j-2>=o.GridRange.j.min&&this.CheckForwardType({i:e.i-1,j:e.j-2},t,i)!=n.Block&&r.push({i:e.i-1,j:e.j-2}),e.i-2>=o.GridRange.i.min&&e.j-1>=o.GridRange.j.min&&this.CheckForwardType({i:e.i-2,j:e.j-1},t,i)!=n.Block&&r.push({i:e.i-2,j:e.j-1}),e.i-2>=o.GridRange.i.min&&e.j+1<=o.GridRange.j.max&&this.CheckForwardType({i:e.i-2,j:e.j+1},t,i)!=n.Block&&r.push({i:e.i-2,j:e.j+1}),e.i-1>=o.GridRange.i.min&&e.j+2<=o.GridRange.j.max&&this.CheckForwardType({i:e.i-1,j:e.j+2},t,i)!=n.Block&&r.push({i:e.i-1,j:e.j+2}),e.i+1<=o.GridRange.i.max&&e.j+2<=o.GridRange.j.max&&this.CheckForwardType({i:e.i+1,j:e.j+2},t,i)!=n.Block&&r.push({i:e.i+1,j:e.j+2}),e.i+2<=o.GridRange.i.max&&e.j+1<=o.GridRange.j.max&&this.CheckForwardType({i:e.i+2,j:e.j+1},t,i)!=n.Block&&r.push({i:e.i+2,j:e.j+1}),r},e.GetKongWayDestinationByOrigin=function(e,t,i){var r=[];return e.i+1<=o.GridRange.i.max&&(this.CheckForwardType({i:e.i+1,j:e.j},t,i)==n.Free&&r.push({i:e.i+1,j:e.j}),e.j+1<=o.GridRange.j.max&&this.CheckForwardType({i:e.i+1,j:e.j+1},t,i)==n.Kill&&r.push({i:e.i+1,j:e.j+1}),e.j-1>=o.GridRange.j.min&&this.CheckForwardType({i:e.i+1,j:e.j-1},t,i)==n.Kill&&r.push({i:e.i+1,j:e.j-1})),e.i-1>=o.GridRange.i.min&&(this.CheckForwardType({i:e.i-1,j:e.j},t,i)==n.Free&&r.push({i:e.i-1,j:e.j}),e.j+1<=o.GridRange.j.max&&this.CheckForwardType({i:e.i-1,j:e.j+1},t,i)==n.Kill&&r.push({i:e.i-1,j:e.j+1}),e.j-1>=o.GridRange.j.min&&this.CheckForwardType({i:e.i-1,j:e.j-1},t,i)==n.Kill&&r.push({i:e.i-1,j:e.j-1})),e.i+2<=o.GridRange.i.max&&this.CheckForwardType({i:e.i+1,j:e.j},t,i)==n.Free&&this.CheckForwardType({i:e.i+2,j:e.j},t,i)==n.Free&&r.push({i:e.i+2,j:e.j}),e.i-2>=o.GridRange.i.min&&this.CheckForwardType({i:e.i-1,j:e.j},t,i)==n.Free&&this.CheckForwardType({i:e.i-2,j:e.j},t,i)==n.Free&&r.push({i:e.i-2,j:e.j}),r},e.GetKongWayOriginByDestination=function(e,t,i){var r=[];return e.i+1<=o.GridRange.i.max&&(this.CheckForwardType({i:e.i+1,j:e.j},t,i)==n.Free&&r.push({i:e.i+1,j:e.j}),e.j+1<=o.GridRange.j.max&&this.CheckForwardType(e,t,i)==n.Kill&&this.CheckForwardType({i:e.i+1,j:e.j+1},t,i)==n.Free&&r.push({i:e.i+1,j:e.j+1}),e.j-1>=o.GridRange.j.min&&this.CheckForwardType(e,t,i)==n.Kill&&this.CheckForwardType({i:e.i+1,j:e.j-1},t,i)==n.Free&&r.push({i:e.i+1,j:e.j-1})),e.i-1>=o.GridRange.i.min&&(this.CheckForwardType({i:e.i-1,j:e.j},t,i)==n.Free&&r.push({i:e.i-1,j:e.j}),e.j+1<=o.GridRange.j.max&&this.CheckForwardType(e,t,i)==n.Kill&&this.CheckForwardType({i:e.i-1,j:e.j+1},t,i)==n.Free&&r.push({i:e.i-1,j:e.j+1}),e.j-1>=o.GridRange.j.min&&this.CheckForwardType(e,t,i)==n.Kill&&this.CheckForwardType({i:e.i-1,j:e.j-1},t,i)==n.Free&&r.push({i:e.i-1,j:e.j-1})),e.i+2<=o.GridRange.i.max&&this.CheckForwardType({i:e.i+1,j:e.j},t,i)==n.Free&&this.CheckForwardType({i:e.i+2,j:e.j},t,i)==n.Free&&r.push({i:e.i+2,j:e.j}),e.i-2>=o.GridRange.i.min&&this.CheckForwardType({i:e.i-1,j:e.j},t,i)==n.Free&&this.CheckForwardType({i:e.i-2,j:e.j},t,i)==n.Free&&r.push({i:e.i-2,j:e.j}),r},e.CheckForwardType=function(e,t,o){if(o[r.pos2WordPos(e)]==t||o[r.pos2WordPos(e)]==i.ChessType.Any)return n.Block;var s=t==i.ChessType.Black?i.ChessType.White:i.ChessType.Black;return o[r.pos2WordPos(e)]==s?n.Kill:n.Free},e.CheckIsFree=function(e,t){return null==t[r.pos2WordPos(e)]},e}();o.GridUtil=s,cc._RF.pop()},{"../../Global/Chess":"Chess","./GamePlayModel":"GamePlayModel"}],HasAnswerView:[function(e,t,o){"use strict";cc._RF.push(t,"bcdd8rD9WdFZpFuI1kMS6Eb","HasAnswerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Global/Chess"),i=e("../../../Utils/Signal"),r=e("../../../View/Transform/ScaleView"),s=e("../../Model/ChessModel"),a=e("../../Model/GamePlayModel"),c=cc._decorator,l=c.ccclass,u=c.property,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal);o.HasAnswerSignal=h;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Close=null,t.Label=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;CELER_X?this.node.active=!1:(this.node.active=!0,this.node.scale=1,this.Close.on(cc.Node.EventType.TOUCH_END,function(){e.onScaleChanged(cc.v2(.1,.1),.1,function(){e.node.once(cc.Node.EventType.TOUCH_END,function(){e.onScaleChanged(cc.v2(1,1),.1,function(){})},e)})},this),h.inst.addListenerOne(function(t){var o="";t.forEach(function(e,t){var i=s.ChessModel.getModelByID(e);if(i)for(var r=0;r<t.targetPos.length;++r){var c=t.targetPos[r];o+=" \u89e3: "+n.ChessRole[i.Role]+"["+a.pos2LogPos(t.startPos)+"->"+a.pos2LogPos(c)+"]";var l="",u=t.escapePos[r];if(u.length<=0)l="0";else{for(var h=[],p=0,d=u;p<d.length;p++){var f=d[p];h.push(a.pos2LogPos(f))}l=h.join(",")}o+=", escape:"+l;var y=!1,g=t.protector[r],m=[];if(g&&g.length>0)for(var C=0;C<g.length;++C){var S=g[C];if(null!=S){y=!0;for(var R=[],v=0,P=S.to;v<P.length;v++){var _=P[v];R.push(a.pos2LogPos(_))}m.push(n.ChessRole[S.aiRole]+"["+a.pos2LogPos(S.from)+"->"+R.join(",")+"]")}}y?o+="  protector\uff1a"+m.join(",")+" \u975e\u6b63\u89e3":u.length<=0?o+=" \u6b63\u89e3":o+=" \u975e\u6b63\u89e3",o+="\n"}}),e.Label.string=o},this))},__decorate([u(cc.Node)],t.prototype,"Close",void 0),__decorate([u(cc.Label)],t.prototype,"Label",void 0),t=__decorate([l],t)}(r.default);o.default=p,cc._RF.pop()},{"../../../Global/Chess":"Chess","../../../Utils/Signal":"Signal","../../../View/Transform/ScaleView":"ScaleView","../../Model/ChessModel":"ChessModel","../../Model/GamePlayModel":"GamePlayModel"}],HashMap:[function(e,t,o){"use strict";cc._RF.push(t,"4b0e7DzcRNJnZXTYCWgDaDU","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._list=new Array,this.clear()}return e.prototype.getIndexByKey=function(e){for(var t=this._list.length,o=0;o<t;o++){if(this._list[o].key==e)return o}return-1},e.prototype.keyOf=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];if(n.value.hashKey&&e.hashKey&&n.value.hashKey===e.hashKey||n.value==e)return n.key}return null},Object.defineProperty(e.prototype,"keys",{get:function(){for(var e=new Array,t=0,o=this._list;t<o.length;t++){var n=o[t];n&&e.push(n.key)}return e},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var o={key:e,value:t},n=this.getIndexByKey(e);-1!=n?this._list[n]=o:this._list.push(o)},Object.defineProperty(e.prototype,"values",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){var t=this.getIndexByKey(e);if(-1!=t){var o=this._list[t];return this._list.splice(t,1),o}return null},e.prototype.has=function(e){return-1!=this.getIndexByKey(e)},e.prototype.get=function(e){var t=this.getIndexByKey(e);return-1!=t?this._list[t].value:null},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.sort=function(e){this._list.sort(e)},e.prototype.forEachKeyValue=function(e){for(var t=this._list.length,o=0;o<t;o++){e(this._list[o])}},e.prototype.forEach=function(e){for(var t=this._list.length,o=0;o<t;o++){var n=this._list[o];e(n.key,n.value)}},e.prototype.clear=function(){this._list=[]},e}();o.HashMap=n,cc._RF.pop()},{}],HelpButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"55938+NxDZMXZHVR36gYzbo","HelpButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../View/SingleTouchView"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||(n.ShowHelpLayerSignal.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t=__decorate([a],t)}(r.default));o.default=c,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../View/SingleTouchView":"SingleTouchView"}],HelpLayerMediator:[function(e,t,o){"use strict";cc._RF.push(t,"ab216iOmFFBBo7YhihjIFYL","HelpLayerMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseMediator"),i=e("../Command/CommonSignal"),r=e("../Controller/GameStateController"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.closeCallback=null,t}return __extends(t,e),t.prototype.onRegister=function(){i.ShowHelpLayerSignal.inst.addListenerOne(this.showHelp,this),i.ShowTutorialSignal.inst.addListenerOne(this.showGuide,this),i.HideHelpLayerSignal.inst.addListenerOne(this.hideGuide,this)},t.prototype.showHelp=function(e){this.View.isShowed()||(r.GameStateController.inst.pause(),this.closeCallback=e,this.View.Show(),this.View.isShowLastPage(!0))},t.prototype.showGuide=function(e){this.View.isShowed()||(r.GameStateController.inst.pause(!0),this.closeCallback=e,this.View.Show(),this.View.isShowLastPage(!1))},t.prototype.hideGuide=function(){0!=this.View.isShowed()&&(r.GameStateController.inst.resume(),this.View.Hide(this.closeCallback),this.closeCallback=null)},t=__decorate([a],t)}(n.default));o.default=c,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","./BaseMediator":"BaseMediator"}],HelpLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"7de5dV5nLxKg6SXhg1Pqw8Z","HelpLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("./BaseView"),r=e("./HelpLayerMediator"),s=e("../Command/CommonSignal"),a=e("../GamePlay/View/new/Page1"),c=cc._decorator,l=c.ccclass,u=c.property;(function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"})(n||(n={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=n.Hide,t.Next=null,t.Close=null,t.GuidePage=null,t.TotalPage=null,t.Page=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.BindMedaitor(r.default),this.state=n.Hide,this.node.scale=1,this.node.active=!1,this.GuidePage.node.on("page-turning",this.onPageChanged,this),this.Close.on(cc.Node.EventType.TOUCH_END,this.close,this),this.Next.on(cc.Node.EventType.TOUCH_END,this.next,this)},t.prototype.start=function(){},t.prototype.close=function(){s.ButtonClickSignal.inst.dispatch(),s.HideHelpLayerSignal.inst.dispatch()},t.prototype.next=function(){s.ButtonClickSignal.inst.dispatch(),this.GuidePage.scrollToPage((this.GuidePage.getCurrentPageIndex()+1)%this.GuidePage.content.childrenCount,0),this.onPageChanged()},t.prototype.onPageChanged=function(){var e=this,t=1;0==this.GuidePage.content.children[this.GuidePage.content.childrenCount-1].active&&(t=2),this.TotalPage&&(this.TotalPage.string=this.GuidePage.content.childrenCount.toString()),this.Page&&(this.Page.string=(this.GuidePage.getCurrentPageIndex()+1).toString()),this.GuidePage.content.children[this.GuidePage.getCurrentPageIndex()].children[0].getComponent(a.default)&&this.GuidePage.content.children[this.GuidePage.getCurrentPageIndex()].children[0].getComponent(a.default).play(),this.GuidePage.getCurrentPageIndex()>=this.GuidePage.content.childrenCount-t?setTimeout(function(){e.Next.active=!1,e.Close.active=!0},0):setTimeout(function(){e.Next.active=!0,e.Close.active=!1},0)},t.prototype.isShowed=function(){return this.state==n.Show},t.prototype.isShowLastPage=function(e){this.GuidePage.content.children[this.GuidePage.content.childrenCount-1].active=e},t.prototype.Show=function(e){this.isShowed()||(this.state=n.Show,this.node.active=!0,this.node.stopAllActions(),this.node.scale=0,this.node.runAction(cc.sequence(cc.callFunc(function(){}),cc.scaleTo(.1,1),cc.callFunc(function(){e&&e()}))),this.Next.active=!0,this.Close.active=!1,this.GuidePage.scrollToPage(0,0),this.onPageChanged())},t.prototype.Hide=function(e){var t=this;0!=this.isShowed()&&(this.state=n.Hide,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){t.node.scale=1,e&&e(),t.node.active=!1}))))},__decorate([u(cc.Node)],t.prototype,"Next",void 0),__decorate([u(cc.Node)],t.prototype,"Close",void 0),__decorate([u(cc.PageView)],t.prototype,"GuidePage",void 0),__decorate([u(cc.Label)],t.prototype,"TotalPage",void 0),__decorate([u(cc.Label)],t.prototype,"Page",void 0),t=__decorate([l],t)}(i.default);o.default=h,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../GamePlay/View/new/Page1":"Page1","./BaseView":"BaseView","./HelpLayerMediator":"HelpLayerMediator"}],HintButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"14f04aVgUxOXa8JgLG/Bvwq","HintButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Utils/Signal"),s=e("../../../View/SingleTouchView"),a=e("../../Model/GameLogic"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.HintButtonClickSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),a.FreeHintCountUpdateSignal.inst.addListenerOne(this.onHintCountUpdate,this)},t.prototype.onHintCountUpdate=function(e){for(var t=0,o=this.node.children;t<o.length;t++){var n=o[t];n.active=e.toString()==n.name}},t.prototype.onTouchEnd=function(){i.GameStateController.inst.isPause()||(u.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t=__decorate([l],t)}(s.default);o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../../Model/GameLogic":"GameLogic"}],HintCostLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"230cbnIKp9MXpaIEBabGAOi","HintCostLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.NextHintCostUpdateSignal=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){s.inst.addListenerOne(this.onCostUpdate,this)},t.prototype.onCostUpdate=function(e){this.Label.string=e>=0?"":"/"+Math.abs(e)},t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{"../../../Utils/Signal":"Signal"}],InitialFacade:[function(e,t,o){"use strict";cc._RF.push(t,"cbbbcO7od5PrqaPNOs8dFh3","InitialFacade"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Command/InititalCommand"),i=e("../Command/StartGameCommand"),r=e("../Command/LoadAudioCommand"),s=e("../Command/LoadPrefabCommand"),a=e("../../Utils/Celer/CelerSDK"),c=e("../../Manager/StepManager"),l=function(){function e(e){this.stepMgr=new c.StepManager,this.facade=puremvc.Facade.getInstance(e)}return Object.defineProperty(e,"inst",{get:function(){return this.instance?this.instance:this.instance=new e(e.MULTITON_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Facade",{get:function(){return console.assert(null!==this.facade," facade is null"),this.facade},enumerable:!0,configurable:!0}),e.prototype.register=function(){var t=this;this.facade.registerCommand(e.INITIALIZATION,n.InitialCommand),this.facade.registerCommand(e.START_UP,i.StartGameCommand),a.CelerSDK.inst.init(function(){t.facade.sendNotification(e.START_UP,t)}),this.stepMgr.register(function(){a.CelerSDK.inst.celerXReady()},e.TOTAL_STEPS)},e.prototype.unregister=function(){this.facade.removeCommand(e.INITIALIZATION),this.facade.removeCommand(e.START_UP)},e.prototype.start=function(){this.register(),this.facade.sendNotification(e.INITIALIZATION,this)},e.prototype.step=function(e){console.log(" initialization step:",e),this.stepMgr.nextStep(e)},e.MULTITON_KEY="INITIAL_FCADE",e.INITIALIZATION="initialization",e.START_UP="startup",e.TOTAL_STEPS=[r.LoadAudioCommand.STEP,s.LoadPrefabCommand.STEP],e}();o.InitialFacade=l,cc._RF.pop()},{"../../Manager/StepManager":"StepManager","../../Utils/Celer/CelerSDK":"CelerSDK","../Command/InititalCommand":"InititalCommand","../Command/LoadAudioCommand":"LoadAudioCommand","../Command/LoadPrefabCommand":"LoadPrefabCommand","../Command/StartGameCommand":"StartGameCommand"}],InititalCommand:[function(e,t,o){"use strict";cc._RF.push(t,"a28caT/H41F74cWxJYqN9pz","InititalCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./LoadPrefabCommand"),i=e("./LoadAudioCommand"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initializeMacroCommand=function(){this.addSubCommand(n.LoadPrefabCommand),this.addSubCommand(i.LoadAudioCommand)},t}(puremvc.MacroCommand);o.InitialCommand=r,cc._RF.pop()},{"./LoadAudioCommand":"LoadAudioCommand","./LoadPrefabCommand":"LoadPrefabCommand"}],KillAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"7d612rCGihFSowRBBcMdcbT","KillAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Manager/AudioManager"),i=e("../../../Utils/FrameAniBase"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this),n.KillSuccessSignal.inst.dispatch()},t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../../Manager/AudioManager":"AudioManager","../../../Utils/FrameAniBase":"FrameAniBase"}],LevelAnimationRoot:[function(e,t,o){"use strict";cc._RF.push(t,"4f07b8QcCJH3YqILemfo3j4","LevelAnimationRoot"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../Controller/ResourceController"),r=e("../../../Global/Chess"),s=e("../../../Manager/AudioManager"),a=e("../../Command/GamePlaySignal"),c=e("../../Model/GameLogic"),l=e("../../Model/GamePlayModel"),u=e("../UI/SkipButtonView"),h=e("./CompleteAnimation"),p=cc._decorator,d=p.ccclass,f=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"CompleteAnimation",{get:function(){return this.node.getChildByName("CompleteAnimation").getComponent(h.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LevelIcon",{get:function(){return this.node.getChildByName("LevelIcon").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){a.LevelDoneSignal.inst.addListenerTwo(this.onLevelDone,this),c.HintNoAnswerSignal.inst.addListener(this.onNoAnswerHint,this),l.LevelGenDoneSignal.inst.addListenerTwo(this.onRoundGenDone,this),this.LevelIcon.node.active=!1,this.CompleteAnimation.node.active=!1},t.prototype.onRoundGenDone=function(e,t){e==r.ChessType.Black?this.LevelIcon.spriteFrame=i.ResourceController.inst.getAnimationAtlas("bg_movebackb"):this.LevelIcon.spriteFrame=i.ResourceController.inst.getAnimationAtlas("bg_moveback"),this.LevelIcon.node.active=!0,this.LevelIcon.node.stopAllActions(),this.LevelIcon.node.scaleX=0,this.LevelIcon.node.opacity=255,this.LevelIcon.node.runAction(cc.sequence(cc.scaleTo(.15,1,1),cc.delayTime(.7),cc.fadeOut(.1),cc.callFunc(function(){t&&n.GameStateController.inst.roundStart()})))},t.prototype.onNoAnswerHint=function(){this.LevelIcon.node.active=!0,this.LevelIcon.node.stopAllActions(),this.LevelIcon.spriteFrame=i.ResourceController.inst.getAltas("bg_NOSOLU"),this.LevelIcon.node.scaleX=0,this.LevelIcon.node.opacity=255,this.LevelIcon.node.runAction(cc.sequence(cc.scaleTo(.15,1,1),cc.delayTime(2),cc.fadeOut(.2),cc.callFunc(function(){})))},t.prototype.onLevelDone=function(e,t){var o=this;if(this.LevelIcon.node.active=!0,this.LevelIcon.node.stopAllActions(),e){switch(t){case 0:this.LevelIcon.spriteFrame=i.ResourceController.inst.getAltas("bg_great");break;case 1:this.LevelIcon.spriteFrame=i.ResourceController.inst.getAltas("bg_nice");break;case 2:this.LevelIcon.spriteFrame=i.ResourceController.inst.getAltas("bg_good")}this.LevelIcon.node.scale=2,this.LevelIcon.node.opacity=255,this.LevelIcon.node.runAction(cc.sequence(cc.scaleTo(.1,.9),cc.scaleTo(.05,1),cc.callFunc(function(){switch(t){case 0:s.GreatSignal.inst.dispatch();break;case 1:s.NiceSignal.inst.dispatch();break;case 2:s.GoodSignal.inst.dispatch()}o.CompleteAnimation.node.active=!0,o.CompleteAnimation.node.opacity=255,o.CompleteAnimation.play(),o.CompleteAnimation.onComplete=function(){o.CompleteAnimation.node.runAction(cc.sequence(cc.fadeOut(.1),cc.delayTime(.3),cc.callFunc(function(){u.NextLevelSignal.inst.dispatchOne(e)})))}}),cc.delayTime(1),cc.fadeOut(.15)))}else this.LevelIcon.spriteFrame=i.ResourceController.inst.getAltas("bg_Oops"),this.LevelIcon.node.scaleX=0,this.LevelIcon.node.opacity=255,this.LevelIcon.node.runAction(cc.sequence(cc.scaleTo(.15,1,1),cc.delayTime(1),cc.fadeOut(.2),cc.callFunc(function(){u.NextLevelSignal.inst.dispatchOne(e)})))},t=__decorate([d],t)}(cc.Component));o.default=f,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Global/Chess":"Chess","../../../Manager/AudioManager":"AudioManager","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GameLogic":"GameLogic","../../Model/GamePlayModel":"GamePlayModel","../UI/SkipButtonView":"SkipButtonView","./CompleteAnimation":"CompleteAnimation"}],LevelLineView:[function(e,t,o){"use strict";cc._RF.push(t,"91f3538KCVMxLrz09P97fGo","LevelLineView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../../Model/GamePlayModel"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.TagUpdateSignal=a;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startUpdate=!1,t.isComplete=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;parseInt(this.node.name)>=2?(this.node.width=0,this.node.opacity=255):(this.node.width=65,this.node.opacity=0),i.OnLevelReachSignal.inst.addListenerTwo(function(t,o){o.toString()==e.node.name&&(e.isComplete=t,e.startUpdate=!0)},this)},t.prototype.update=function(e){this.startUpdate&&(this.node.width+=350*e,this.node.width>=65&&(this.startUpdate=!1,a.inst.dispatchTwo(this.isComplete,this.node.name))),this.node.width=Math.min(65,this.node.width)},t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../../Model/GamePlayModel":"GamePlayModel"}],LevelView:[function(e,t,o){"use strict";cc._RF.push(t,"70ec6K8DpZBbLeZCUWDLzma","LevelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Model/GamePlayModel"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.active=!CELER_X,n.OnLevelUpdatedSignal.inst.addListenerOne(function(t){e.getComponent(cc.Label).string="Level:"+t.toString()},this)},t=__decorate([r],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../Model/GamePlayModel":"GamePlayModel"}],Level:[function(e,t,o){"use strict";cc._RF.push(t,"3db54FVK6dM2Ik/+eMmSgop","Level"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Cocos"),i=e("./Theme"),r=function(){function e(){}return e.getThemeRandomPool=function(e){for(;this.pool.length<120;)this.pool.push(i.Theme.Blue),this.pool.push(i.Theme.Green),this.pool.push(i.Theme.Red);return n.disOrderArray(this.pool),this.pool},e.pool=[],e}();o.Level=r,cc._RF.pop()},{"../Utils/Cocos":"Cocos","./Theme":"Theme"}],LoadAudioCommand:[function(e,t,o){"use strict";cc._RF.push(t,"d4f3eGYUlBES5d8aEvuPQna","LoadAudioCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Manager/AudioManager"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){if(e){var o=e.getBody();o&&o.step&&n.gAudio.init(function(){o.step(t.STEP)})}},t.STEP="LoadAudio",t}(puremvc.SimpleCommand);o.LoadAudioCommand=i,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager"}],LoadPrefabCommand:[function(e,t,o){"use strict";cc._RF.push(t,"8b33fPnvCZEJ7bc/zCVv9My","LoadPrefabCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){n.gFactory.init(function(){if(e){var o=e.getBody();o&&o.step&&o.step(t.STEP)}})},t.STEP="LoadPrefab",t}(puremvc.SimpleCommand);o.LoadPrefabCommand=i,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory"}],LoadingPageMediator:[function(e,t,o){"use strict";cc._RF.push(t,"359acCsI6FNpLUAuWOw+Fv4","LoadingPageMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseMediator"),i=e("../../Utils/Celer/CelerSDK"),r=e("../../Command/CommonSignal"),s=e("../../Controller/GameStateController"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=3e3,t.startTime=0,t}return __extends(t,e),t.prototype.onRegister=function(){this.startTime=Date.now(),r.GameReadySignal.inst.addListener(this.onGameReady,this)},t.prototype.onGameReady=function(){var e=this,t=Date.now()-this.startTime;console.log(" -- game init done, hide loading page: ",t),t<=this.time?setTimeout(function(){e.View.Hide(function(){e.startGame()})},this.time-t):this.View.Hide(function(){e.startGame()})},t.prototype.startGame=function(){i.CelerSDK.inst.isNew()?r.ShowTutorialSignal.inst.dispatchOne(function(){r.GameStartSignal.inst.dispatch(),s.GameStateController.inst.isReady=!0}):(r.GameStartSignal.inst.dispatch(),s.GameStateController.inst.isReady=!0)},t.prototype.onDestroy=function(){},t=__decorate([c],t)}(n.default));o.default=l,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Controller/GameStateController":"GameStateController","../../Utils/Celer/CelerSDK":"CelerSDK","../../View/BaseMediator":"BaseMediator"}],LoadingView:[function(e,t,o){"use strict";cc._RF.push(t,"dfec6LZreJCaa8QdaMxRAO/","LoadingView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseView"),i=e("./LoadingPageMediator"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.scale=1,this.node.opacity=255,this.BindMedaitor(i.default)},t.prototype.start=function(){},t.prototype.Hide=function(e){var t=this;this.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.node.active=!1,e()})))},t=__decorate([s],t)}(n.default));o.default=a,cc._RF.pop()},{"../../View/BaseView":"BaseView","./LoadingPageMediator":"LoadingPageMediator"}],LogHandler:[function(e,t,o){"use strict";cc._RF.push(t,"a4747QIvUBIo6Ktpx/xQwuB","LogHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var o=e.call(this)||this;if(o.logFunc=console.log,o.logMsg=null,o.frameTimes=0,o.now=0,o.Frame=20,o.totalFrames=0,o.startTime=0,window.addEventListener)for(var n=0,i=t.LISTENNING_EVENTS;n<i.length;n++){var r=i[n],s="trigger"+r.charAt(0).toLocaleUpperCase()+r.substring(1);o[s]&&"function"==typeof o[s]&&window.addEventListener(r,o[s].bind(o))}return o}return __extends(t,e),t.prototype.dumpFrameInfo=function(){var e=(Date.now()-this.startTime)/1e3,t=e/this.totalFrames;this.log(" total frames:",this.totalFrames," ,total cost time:",e+"s"," , per frame cost time ave:"+t+"s")},t.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLog.apply(this,e),this.sendLog()},t.prototype.ready=function(){console.log(t.VERSION)},t.prototype.initLog=function(e){var o=this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){o.frameTimes=0,o.now=Date.now(),o.startTime=Date.now()},this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(){o.frameTimes++,o.totalFrames++,o.frameTimes>=o.Frame&&(o.frameTimes=0,o.now=Date.now())},this),this.logFunc=e,window.consoleError=console.error,window.consoleWarn=console.warn,window.consoleLog=console.log,window.consoleAssert=console.assert,console.error=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[ERROR]"].concat(o))},console.warn=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[WARN]"].concat(o))},console.log=function(){for(var e,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];(e=t.inst).log.apply(e,["[INFO]"].concat(o))},console.assert=function(e){for(var o,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];e||(o=t.inst).log.apply(o,["[ASSERT ERROR]"].concat(n))}},t.prototype.formatLogArguments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o="",n=0;n<arguments.length;n++){var i=typeof arguments[n];"string"==i||"number"==i?o+=" "+arguments[n]:"object"==i?o+=" "+JSON.stringify(arguments[n]):"boolean"==i&&arguments[n].toString&&(o+=arguments[n].toString())}return o},t.prototype.addLog=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==this.logMsg&&(this.logMsg={});var n=this.formatLogArguments.apply(this,e),i=this.getFullTime(new Date);this.logMsg[i]=t.VERSION+n},t.prototype.getFullTime=function(e){var t="";t+=e.getFullYear();var o=e.getMonth()+1;t+="-"+(o>=10?o:"0"+o);var n=e.getDate();t+="-"+(n>=10?n:"0"+n);var i=e.getHours();t+="  "+(i>=10?i:"0"+i);var r=e.getMinutes();t+=":"+(r>=10?r:"0"+r);var s=e.getSeconds();return t+=":"+(s>=10?s:"0"+s)},t.prototype.sendLog=function(){this.logFunc&&null!=this.logMsg&&(this.logFunc(JSON.stringify(this.logMsg)),this.logMsg=null)},t.prototype.triggerClose=function(e){this.addLog("triggerClose"),this.sendLog()},t.prototype.triggerLoad=function(e){this.addLog("triggerLoad"),this.sendLog()},t.prototype.triggerUnload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerOnunload=function(e){this.addLog("triggerUnload"),this.sendLog()},t.prototype.triggerError=function(e){this.addLog("triggerError"),this.addLog(e.message),this.sendLog()},t.prototype.triggerFocus=function(e){this.addLog("triggerFocus"),this.sendLog()},t.prototype.triggerBlur=function(e){this.addLog("triggerBlur"),this.sendLog()},t.prototype.triggerAbort=function(e){this.addLog("triggerAbort"),this.sendLog()},t.prototype.triggerSuspend=function(e){this.addLog("triggerSuspend"),this.sendLog()},t.prototype.beforeunload=function(e){this.addLog("beforeunload"),this.sendLog()},t.VERSION=window.GAME_VERSION||" --- ",t.LISTENNING_EVENTS=["error"],t}(e("./ToSingleton").SingleTon());o.LogHandler=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],MenuButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"28073o37LNPKaWTUfECMch5","MenuButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Utils/Signal"),s=e("../../../View/SingleTouchView"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal));o.MenuButtonClickSignal=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onTouchEnd=function(){i.GameStateController.inst.isGameOver()||(l.inst.dispatch(),n.ButtonClickSignal.inst.dispatch())},t.prototype.start=function(){},t=__decorate([c],t)}(s.default);o.default=u,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView"}],MenuLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"85bd9XHwOpA8pPYE/vCkvEe","MenuLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Controller/ResourceController"),s=e("../../../Model/PlayModelProxy"),a=e("../../../View/BaseView"),c=e("../../Command/GamePlaySignal"),l=e("./MenuButtonView"),u=e("./SubmitLayerView"),h=cc._decorator,p=h.ccclass,d=(h.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("ResumeButton")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndNow",{get:function(){return this.node.getChildByName("EndNow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return this.node.getChildByName("FreePauseCount").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseInfo",{get:function(){return this.node.getChildByName("PauseInfo").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;l.MenuButtonClickSignal.inst.addListener(this.onShow,this),c.SubmitButtonClickSignal.inst.addListener(this.onShow,this),n.ShowPauseLayerSignal.inst.addListener(function(){t.onShow()},this),this.Resume.on(cc.Node.EventType.TOUCH_END,function(){i.GameStateController.inst.resume(),t.Hide()},this),this.EndNow.on(cc.Node.EventType.TOUCH_END,function(){t.Hide(),u.EndNowSignal.inst.dispatch()},this),e.prototype.onLoad.call(this),this.node.active=!1},t.prototype.onShow=function(){this.node.active||(s.PlayModelProxy.inst.FreePauseCount<=0?(this.FreePauseCount.node.active=!1,this.PauseInfo.spriteFrame=r.ResourceController.inst.getAltas("bg_nofree")):(this.FreePauseCount.node.active=!0,this.FreePauseCount.string=s.PlayModelProxy.inst.FreePauseCount.toString(),this.PauseInfo.spriteFrame=r.ResourceController.inst.getAltas("bg_free")),this.Show(),i.GameStateController.inst.pause())},t.prototype.start=function(){},t=__decorate([p],t)}(a.default));o.default=d,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../View/BaseView":"BaseView","../../Command/GamePlaySignal":"GamePlaySignal","./MenuButtonView":"MenuButtonView","./SubmitLayerView":"SubmitLayerView"}],MoveCountLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"523c3oc4AhAw43gNtGFJ99Y","MoveCountLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../../../View/NumberChangedView"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.MoveCountChangedSignal=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),a.inst.addListenerOne(this.onNumberChanged,this)},t=__decorate([s],t)}(i.default);o.default=c,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../../../View/NumberChangedView":"NumberChangedView"}],MoveCountRootView:[function(e,t,o){"use strict";cc._RF.push(t,"33833tHA5dBPrcZaG3CvxNc","MoveCountRootView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=e("../../../Utils/Signal"),r=e("../../Model/GamePlayModel"),s=e("./MoveCountLabelView"),a=e("./SolutionButtonView"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.AfterCheckSolutionSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;s.MoveCountChangedSignal.inst.addListenerOne(this.onMoveCountUpdate,this),r.RoundGenDoneSignal.inst.addListener(function(){},this),a.StartMoveChessSignal.inst.addListener(function(){e.node.active=!0},this)},t.prototype.onMoveCountUpdate=function(e){for(var t=0,o=this.node.children;t<o.length;t++){var i=o[t];parseInt(i.name)<=e?i.getComponent(cc.Sprite).spriteFrame=n.ResourceController.inst.getAltas("bg_"+i.name+"dark"):i.getComponent(cc.Sprite).spriteFrame=n.ResourceController.inst.getAltas("bg_"+i.name)}},t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController","../../../Utils/Signal":"Signal","../../Model/GamePlayModel":"GamePlayModel","./MoveCountLabelView":"MoveCountLabelView","./SolutionButtonView":"SolutionButtonView"}],NoAnswerClickAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"f27c00c7ipIv4ibt1r+US/S","NoAnswerClickAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=e("../../Model/GameLogic"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playCount=0,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.active=!1,i.HintNoAnswerSignal.inst.addListener(function(){t.node.opacity=255,t.node.active=!0,t.playCount=0,t.play()},this)},t.prototype.onComplete=function(){this.playCount++,this.playCount>=5?this.node.runAction(cc.fadeOut(.1)):this.play()},t=__decorate([s],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase","../../Model/GameLogic":"GameLogic"}],NoSolutionButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"5f00cNFB8BOQohWYFVMCui+","NoSolutionButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Model/PlayModelProxy"),s=e("../../../View/SingleTouchView"),a=e("../../Command/GamePlaySignal"),c=e("../../Model/GamePlayModel"),l=cc._decorator,u=l.ccclass,h=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canTouch=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),c.LevelGenDoneSignal.inst.addListener(function(){t.canTouch=!0},this)},t.prototype.onTouchEnd=function(){if(n.ButtonClickSignal.inst.dispatch(),0!=this.canTouch&&!i.GameStateController.inst.isGameOver()&&!i.GameStateController.inst.isPause()){this.canTouch=!1;var e=r.PlayModelProxy.inst.checkHasAnswer(!1);a.LevelDoneSignal.inst.dispatchTwo(e,r.PlayModelProxy.inst.MoveCount),e&&r.PlayModelProxy.inst.addScore(20*(3-r.PlayModelProxy.inst.MoveCount),c.ScoreType.Normal,this.node)}},t=__decorate([u],t)}(s.default));o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../View/SingleTouchView":"SingleTouchView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GamePlayModel":"GamePlayModel"}],NumberChangedView:[function(e,t,o){"use strict";cc._RF.push(t,"5f2acutWoZLka/VldveJWjk","NumberChangedView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.num=0,t.showNum=0,t.step=0,t.label=null,t.action=!0,t.STEP=120,t.callback=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.label?this.label:this.label=this.node.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onStep=function(e){},t.prototype.onNumberChanged=function(e,t){if(this.num=e,this.callback=t,this.num!=this.showNum){var o=this.num-this.showNum;this.step=o>0?Math.ceil(o/this.STEP):Math.floor(o/this.STEP),this.action&&this.node.runAction(cc.sequence(cc.scaleTo(.1,1.4),cc.delayTime(.2),cc.scaleTo(.1,1)))}else this.step=0},t.prototype.update=function(e){this.num!=this.showNum&&(this.showNum+=this.step,this.onStep(this.step),(this.showNum>this.num&&this.step>0||this.showNum<this.num&&this.step<0)&&(this.showNum=this.num,this.step=0)),Math.abs(this.num-this.showNum)<=Math.abs(this.step)&&this.callback&&"function"==typeof this.callback&&(this.callback(),this.callback=null),this.Label.string=this.showNum>=0?this.showNum.toString():"/"+Math.abs(this.showNum).toString()},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"./BaseView":"BaseView"}],Page1:[function(e,t,o){"use strict";cc._RF.push(t,"63454kcZ+BB/6x4kmCwk6U4","Page1"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ball=null,t.ballStart=null,t.ballReady=null,t.ballReady2=null,t.ballTarget=null,t.hand=null,t.handStart=null,t.handEnd=null,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.play=function(){var e=this;this.ball.stopAllActions(),this.hand.stopAllActions(),this.hand.opacity=255,this.ball.opacity=255,this.ball.setPosition(this.ballStart.position),this.hand.setPosition(this.handStart.position),this.ball.runAction(cc.repeatForever(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){e.hand.runAction(cc.sequence(cc.fadeIn(0),cc.moveTo(0,e.handStart.position),cc.rotateBy(.1,-10),cc.rotateBy(.2,20),cc.rotateBy(.1,-10),cc.fadeOut(.1)))}),cc.delayTime(.4),cc.moveTo(.1,this.ballReady.position),cc.callFunc(function(){e.hand.runAction(cc.sequence(cc.fadeIn(0),cc.moveTo(0,e.handEnd.position),cc.rotateBy(.1,-10),cc.rotateBy(.2,20),cc.rotateBy(.1,-10),cc.fadeOut(.1)))}),cc.delayTime(.6),cc.moveTo(.4,this.ballReady2.position),cc.delayTime(.1),cc.moveTo(.1,this.ballTarget.position),cc.delayTime(.4),cc.fadeOut(.1),cc.moveTo(.2,this.ballStart.position),cc.fadeIn(.1))))},__decorate([r(cc.Node)],t.prototype,"ball",void 0),__decorate([r(cc.Node)],t.prototype,"ballStart",void 0),__decorate([r(cc.Node)],t.prototype,"ballReady",void 0),__decorate([r(cc.Node)],t.prototype,"ballReady2",void 0),__decorate([r(cc.Node)],t.prototype,"ballTarget",void 0),__decorate([r(cc.Node)],t.prototype,"hand",void 0),__decorate([r(cc.Node)],t.prototype,"handStart",void 0),__decorate([r(cc.Node)],t.prototype,"handEnd",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],PlayModelProxy:[function(e,t,o){"use strict";cc._RF.push(t,"50835VU6k9M3pgXsJbG5zxG","PlayModelProxy"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=e("../Controller/GameStateController"),r=e("../GamePlay/Model/GamePlayModel"),s=e("../Command/CommonSignal"),a=e("../Global/GameRule"),c=function(e){function t(){var t=e.call(this)||this;return t.isGameOver=!1,t.playerModel=null,t.bindSignal(),t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.playerModel?this.playerModel:this.playerModel=new r.GamePlayModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeLeft",{get:function(){return this.Model.Time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlayerScore",{get:function(){return this.Model.PlayerScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MoveCount",{get:function(){return this.Model.MoveCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NoviceScore",{get:function(){return this.Model.NoviceScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PointSpread",{get:function(){return this.Model.ScoreSpread},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Model.Timebonus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Theme",{get:function(){return this.Model.Theme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this.Model.Level},set:function(e){this.Model.Level=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseScore",{get:function(){return this.Model.PauseScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return Math.max(0,a.FreePauseLimit-this.Model.PauseCount)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HintBonus",{get:function(){return this.Model.HintBonus},enumerable:!0,configurable:!0}),t.prototype.bindSignal=function(){},t.prototype.initGametheme=function(){this.Model.initGametheme()},t.prototype.getTotalScore=function(){return this.Model.TotalScore},t.prototype.addScore=function(e,t,o){this.Model.addPlayerScore(e,t,1,o)},t.prototype.addPauseCount=function(){this.Model.addPauseCount()},t.prototype.checkHasAnswer=function(e){return this.Model.currentRoundInfo.hasAnswer==e},t.prototype.addGameTime=function(e){i.GameStateController.inst.isPause()||0==i.GameStateController.inst.isRoundStart()||this.isGameOver||(this.Model.Time+=e,s.UpdateTimeNumber.inst.dispatchOne(this.Model.Time),s.TimeAnimationStateChanged.inst.dispatchOne(this.Model.Time<=30),this.Model.Time<=0&&(this.Model.checkCompleteScore(),i.GameStateController.inst.roundEnd(i.RoundEndType.TimeUp)))},t.prototype.getScoreByType=function(e){return this.Model.getScoreByType(e)},t.prototype.dump=function(){this.Model.dump()},t.prototype.init=function(){this.Model.initGameData()},t}(n.SingleTon());o.PlayModelProxy=c,!CELER_X&&(window.Game=c.inst),cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Controller/GameStateController":"GameStateController","../GamePlay/Model/GamePlayModel":"GamePlayModel","../Global/GameRule":"GameRule","../Utils/ToSingleton":"ToSingleton"}],PositionView:[function(e,t,o){"use strict";cc._RF.push(t,"416f296ZMZPEaWAE2E6IRlj","PositionView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startPos=cc.Vec2.ZERO,t}return __extends(t,e),Object.defineProperty(t.prototype,"TargetPos",{get:function(){return cc.v2(this.Target.x,this.Target.y)},enumerable:!0,configurable:!0}),t.prototype.canUpdate=function(){return!0},t.prototype.onLoad=function(){0},t.prototype.start=function(){},t.prototype.onPositionChanged=function(e,t,o,n){void 0===n&&(n=0),this.startPos=this.node.position.clone(),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.x=this.ease(this.startPos.x,this.Target.x),this.node.y=this.ease(this.startPos.y,this.Target.y)},t.prototype.onComplete=function(){this.node.setPosition(cc.v2(this.Target.x,this.Target.y))},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],PrefabBaseView:[function(e,t,o){"use strict";cc._RF.push(t,"f24ed/ng45Kt5VKvqibEbvg","PrefabBaseView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.reuse=function(e){this.model=e,this.onReuse()},t.prototype.unuse=function(){this.node.group="default",this.model,this.model=null,this.onUnuse()},t.prototype.onReuse=function(){console.warn(" should override onReuse.")},t.prototype.onUnuse=function(){console.warn(" should override onUnuse.")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],RandomSeedView:[function(e,t,o){"use strict";cc._RF.push(t,"b5b88LQAW5ME4v5I23kerct","RandomSeedView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.RandomSeedInit=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.active=!CELER_X,s.inst.addListenerOne(function(t){e.getComponent(cc.Label).string=t.toString()},this)},t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{"../../../Utils/Signal":"Signal"}],Random:[function(e,t,o){"use strict";cc._RF.push(t,"114f9Vox8JGQbohBr4HFlkf","Random"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../GamePlay/View/UI/RandomSeedView"),i=function(){function e(){}return Object.defineProperty(e,"Seed",{get:function(){return this.randomSeed},enumerable:!0,configurable:!0}),e.seededRandom=function(e,t,o){return t+1e6*((1711*e+88888)%302654/302654+(1722*e+55555)%302665/302665+(1755*e+23333)%302766/302766)%1e6/1e6*(o-t)},e.getRandom=function(e,t){void 0===e&&(e=0),void 0===t&&(t=1);var o=this.randomSeed,n=this.seededRandom(o,e,t),i=Math.floor(this.seededRandom(o,1,302766));return this.randomSeed+=i,n},e.setRandomSeed=function(e){console.log(" set random seed:",e),n.RandomSeedInit.inst.dispatchOne(e),this.randomSeed=e,this.sharedSeed=e},e.randomRoundToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.round(this.getRandom(e,t))},e.randomFloorToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.floor(this.getRandom(e,t))},e.randomCeilToInt=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.ceil(this.getRandom(e,t))},e.clamp=function(e,t,o){return Math.max(t,Math.min(e,o))},e.randomSeed=Math.random(),e.sharedSeed=Math.random(),e}();o.Random=i,cc._RF.pop()},{"../GamePlay/View/UI/RandomSeedView":"RandomSeedView"}],ResourceController:[function(e,t,o){"use strict";cc._RF.push(t,"d264b/eizRMLqzXH1k4Oll+","ResourceController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=e("../Utils/HashMap");o.Title={Complete:"font_complete",TimeUp:"font_timeup",Over:"font_over"},o.PauseFont={HasFree:"bg_pause_font1",NoneFree:"bg_pause_font2"},o.Font={TotalScore:"totalScore",ResultScore:"resultScore",TimeWhite:"TimeWhite",TimeRed:"TimeRed",AddScore:"addScore",SubScore:"subScore",ShowScore:"showScore"};var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontMap=new i.HashMap,t.UIAtlas=null,t.Animation=null,t}return __extends(t,e),t.prototype.setFont=function(e,t){this.fontMap.add(e,t)},t.prototype.setAtlas=function(e){console.assert(null!=e,"game atlas is null!"),this.UIAtlas=e},t.prototype.getTitleSprite=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.getAltas=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.setAnimationAtlas=function(e){console.assert(null!=e,"animation atlas is null!"),this.Animation=e},t.prototype.getAnimationAtlas=function(e){return this.Animation.getSpriteFrame(e)},t.prototype.getAddScoreFont=function(){return this.fontMap.get(o.Font.AddScore)},t.prototype.getSubScoreFont=function(){return this.fontMap.get(o.Font.SubScore)},t.prototype.getSoundDisabled=function(){return this.UIAtlas.getSpriteFrame("btn_sounddown")},t.prototype.getSoundEnable=function(){return this.UIAtlas.getSpriteFrame("btn_sound")},t.prototype.getPauseFont=function(e){return this.UIAtlas.getSpriteFrame(e)},t.prototype.getTimeRedFont=function(){return this.fontMap.get(o.Font.TimeRed)},t.prototype.getTimeWhiteFont=function(){return this.fontMap.get(o.Font.TimeWhite)},t}(n.SingleTon());o.ResourceController=r,cc._RF.pop()},{"../Utils/HashMap":"HashMap","../Utils/ToSingleton":"ToSingleton"}],ResultLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"6c673+er7VG9r6c0kFbuHKb","ResultLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../View/BaseView"),i=e("../../../View/NumberChangedView"),r=e("../../../Command/CommonSignal"),s=e("../../../Controller/GameStateController"),a=e("../../../Controller/ResourceController"),c=e("../../../Model/PlayModelProxy"),l=e("../../../Utils/Celer/CelerSDK"),u=e("../../Model/GamePlayModel"),h=cc._decorator,p=h.ccclass,d=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CountTotal=4,t.count=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Root",{get:function(){return this.node.getChildByName("Root")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.Root.getChildByName("Title").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalScore",{get:function(){return this.Root.getChildByName("TotalScore").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TimeBonus",{get:function(){return this.Root.getChildByName("TimeBonus").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Score",{get:function(){return this.Root.getChildByName("ScoreLabel").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TipCostLabel",{get:function(){return this.Root.getChildByName("TipCostLabel").getComponent(i.default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Submit",{get:function(){return this.Root.getChildByName("Submit")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node.active=!1,this.node.scale=1,r.OpenResultLayerSignal.inst.addOnceOne(this.onGameOver,this)},t.prototype.onGameOver=function(e){console.log("Open result:",s.RoundEndType[e],Date.now()),this.Submit.scale=0,e==s.RoundEndType.TimeUp?this.Title.spriteFrame=a.ResourceController.inst.getTitleSprite(a.Title.TimeUp):e==s.RoundEndType.Complete?this.Title.spriteFrame=a.ResourceController.inst.getTitleSprite(a.Title.Complete):this.Title.spriteFrame=a.ResourceController.inst.getTitleSprite(a.Title.Over),this.Root.scale=0,this.node.active=!0,this.Root.runAction(cc.sequence(cc.scaleTo(.1,.9,1.3),cc.scaleTo(.1,1.2,.9),cc.scaleTo(.1,1,1),cc.callFunc(this.showInfo.bind(this))))},Object.defineProperty(t.prototype,"Count",{get:function(){return this.count},set:function(e){var t=this;this.count!=e&&(this.count=e,console.log("count:",this.Count),this.Count>=this.CountTotal&&(r.ShowSubmitSignal.inst.dispatch(),this.Submit.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){t.Submit.once(cc.Node.EventType.TOUCH_END,function(){l.CelerSDK.inst.submitScore(c.PlayModelProxy.inst.getTotalScore())},t),CELER_X&&setTimeout(function(){l.CelerSDK.inst.submitScore(c.PlayModelProxy.inst.getTotalScore())},5e3)})))))},enumerable:!0,configurable:!0}),t.prototype.showInfo=function(){var e=this;this.Count=0,this.TotalScore.STEP=150,this.TimeBonus.STEP=150,this.Score.STEP=150,this.TipCostLabel.STEP=5;var t=function(){r.ScoreCountingSignal.inst.dispatch()};this.TimeBonus.onStep=t,this.TotalScore.onStep=t,this.Score.onStep=t,this.TipCostLabel.onStep=t,this.TimeBonus.onNumberChanged(c.PlayModelProxy.inst.TimeBonus,function(){e.Count++,console.log("TimeBonus Done")}),this.TotalScore.onNumberChanged(c.PlayModelProxy.inst.getTotalScore(),function(){e.Count++,console.log("TotalScore Done")}),this.Score.onNumberChanged(c.PlayModelProxy.inst.getScoreByType(u.ScoreType.Normal),function(){e.Count++,console.log("Score Done")}),this.TipCostLabel.onNumberChanged(c.PlayModelProxy.inst.getScoreByType(u.ScoreType.HintCost),function(){e.Count++,console.log("MoveCount Done")})},t=__decorate([p],t)}(n.default));o.default=d,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Celer/CelerSDK":"CelerSDK","../../../View/BaseView":"BaseView","../../../View/NumberChangedView":"NumberChangedView","../../Model/GamePlayModel":"GamePlayModel"}],RevertButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"3e84eq+F3NMM5PkgzsJHXMl","RevertButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/Signal"),i=e("../../../View/SingleTouchView"),r=e("../../Model/GamePlayModel"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.BaseSignal));o.RevertSignal=c;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canRevert=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"Button",{get:function(){return this.getComponent(cc.Button)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.node.active=!CELER_X,this.node.scale=1,r.LevelGenDoneSignal.inst.addListener(function(){t.canRevert=!0},this)},t.prototype.onTouchEnd=function(){this.canRevert&&(this.canRevert=!1,c.inst.dispatch())},t=__decorate([a],t)}(i.default);o.default=l,cc._RF.pop()},{"../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../../Model/GamePlayModel":"GamePlayModel"}],RotationView:[function(e,t,o){"use strict";cc._RF.push(t,"f3329CeqRdN6ZoUyx7znT4N","RotationView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startRotation=0,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.canUpdate=function(){return!0},t.prototype.start=function(){},t.prototype.onRotationChanged=function(e,t,o,n){void 0===n&&(n=0),this.startRotation=this.node.rotation,this.startUpdate(new cc.Vec3(e,e,e),t,o,n)},t.prototype.onStep=function(){this.node.rotation=this.ease(this.startRotation,this.Target.x)},t.prototype.onComplete=function(){this.node.setRotation(this.Target.x)},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],ScaleView:[function(e,t,o){"use strict";cc._RF.push(t,"b6981r0u55OyqSF4preRXtY","ScaleView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startScale=cc.Vec2.ZERO,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.canUpdate=function(){return!0},t.prototype.start=function(){},t.prototype.onScaleChanged=function(e,t,o,n){void 0===n&&(n=0),this.startScale=cc.v2(this.node.scaleX,this.node.scaleY),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.scaleX=this.ease(this.startScale.x,this.Target.x),this.node.scaleY=this.ease(this.startScale.y,this.Target.y)},t.prototype.onComplete=function(){this.node.scaleX=this.Target.x,this.node.scaleY=this.Target.y},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],ScoreLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"5857dLL+ulDqKijkly4V/xN","ScoreLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),r=e("../../../Factory/GameFactory"),s=e("../../../Utils/Cocos"),a=e("../../../View/NumberChangedView"),c=cc._decorator,l=c.ccclass,u=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScoreFloatRoot=null,t}return __extends(t,e),t.prototype.onLoad=function(){n.PlayerScoreChanged.inst.addListenerFour(this.onScoreChanged,this)},t.prototype.onScoreChanged=function(e,t,o,n){var a=this;if(null!=this.ScoreFloatRoot){var c=r.gFactory.getObj("AddScore"),l=c.getComponent(cc.Label);l.font=t>=0?i.ResourceController.inst.getAddScoreFont():i.ResourceController.inst.getSubScoreFont(),l.string="/"+Math.abs(t),this.ScoreFloatRoot.addChild(c);var u=cc.v2(0,0);n&&(u=s.ConvertToNodeSpaceAR(n,this.ScoreFloatRoot));var h=s.ConvertToNodeSpaceAR(this.node,this.ScoreFloatRoot);c.setPosition(u);var p=s.Distance(u,h)/2e3;c.runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.2,1.2),cc.scaleTo(.1,1),cc.moveTo(p,h),cc.callFunc(function(){r.gFactory.putObj("AddScore",c)}))),setTimeout(function(){a.onNumberChanged(e)},300+1e3*p)}else this.onNumberChanged(e)},__decorate([u(cc.Node)],t.prototype,"ScoreFloatRoot",void 0),t=__decorate([l],t)}(a.default);o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController","../../../Factory/GameFactory":"GameFactory","../../../Utils/Cocos":"Cocos","../../../View/NumberChangedView":"NumberChangedView"}],Signal:[function(e,t,o){"use strict";cc._RF.push(t,"5e03fyVNOZPs7lLvT6ttunM","Signal"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listenerMap=[],t.onceListenerMap=[],t}return __extends(t,e),t.prototype.doDispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.excuteListener.apply(this,e),this.excuteOnce.apply(this,e)},t.prototype.excuteListener=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.listenerMap&&this.listenerMap.length>0)for(var o=0,n=this.listenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}},t.prototype.excuteOnce=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.onceListenerMap&&this.onceListenerMap.length>0){for(var o=0,n=this.onceListenerMap;o<n.length;o++){var i=n[o];i.callback.apply(i.target,e)}this.onceListenerMap.length=0}},t.prototype.listen=function(e,t){this.listenerMap.push({callback:e,target:t})},t.prototype.listenOnce=function(e,t){this.onceListenerMap.push({callback:e,target:t})},t.prototype.removeListener=function(e,t){if(this.listenerMap&&this.listenerMap.length>0)for(var o=0;o<this.listenerMap.length;++o){var n=this.listenerMap[o];n.callback==e&&n.target==t&&(this.listenerMap.splice(o,1),--o)}},t.prototype.removeTarget=function(e){if(this.listenerMap&&this.listenerMap.length>0)for(var t=0;t<this.listenerMap.length;++t){this.listenerMap[t].target==e&&(this.listenerMap.splice(t,1),--t)}},t.prototype.dispatch=function(){this.doDispatch(null)},t.prototype.dispatchOne=function(e){this.doDispatch(e)},t.prototype.dispatchTwo=function(e,t){this.doDispatch(e,t)},t.prototype.dispatchThree=function(e,t,o){this.doDispatch(e,t,o)},t.prototype.dispatchFour=function(e,t,o,n){this.doDispatch(e,t,o,n)},t.prototype.dispatchFive=function(e,t,o,n,i){this.doDispatch(e,t,o,n,i)},t.prototype.addListener=function(e,t){this.listen(e,t)},t.prototype.addOnce=function(e,t){this.listenOnce(e,t)},t.prototype.addListenerOne=function(e,t){this.listen(e,t)},t.prototype.addListenerTwo=function(e,t){this.listen(e,t)},t.prototype.addListenerThree=function(e,t){this.listen(e,t)},t.prototype.addListenerFour=function(e,t){this.listen(e,t)},t.prototype.addListenerFive=function(e,t){this.listen(e,t)},t.prototype.addOnceOne=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceTwo=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceThree=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFour=function(e,t){this.listenOnce(e,t)},t.prototype.addOnceFive=function(e,t){this.listenOnce(e,t)},t}(e("./ToSingleton").SingleTon());o.BaseSignal=n,cc._RF.pop()},{"./ToSingleton":"ToSingleton"}],SingleTouchMediator:[function(e,t,o){"use strict";cc._RF.push(t,"e1695pPIshGg5cBwRP4Oun7","SingleTouchMediator"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return __extends(t,e),t.prototype.bind=function(e){this.view=e},Object.defineProperty(t.prototype,"View",{get:function(){return console.assert(null!=this.view," view is null"),this.view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onRegister=function(){this.node.targetOff(this),this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.onUnregister=function(){this.node.targetOff(this)},t.prototype.touchStart=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch start  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();this.touchid=e.getID(),this.onTouchStart(e)},t.prototype.touchMove=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchMove(e)):e.stopPropagation()},t.prototype.touchEnd=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch end  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchEnd(e),this.OnClick()):e.stopPropagation()},t.prototype.touchCancel=function(e){if(null!==this.touchid&&this.touchid!==e.getID())return console.log(this.node.name," touch cancel  touchid is different: ",this.touchid,e.getID()),void e.stopPropagation();null!=this.touchid?(this.touchid=null,this.onTouchCancel(e)):e.stopPropagation()},t.prototype.OnClick=function(){},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],SingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"85688DQVyhPRqaAh/y2/Qug","SingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./BaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._touchid=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"touchid",{get:function(){return this._touchid},set:function(e){this._touchid=e,window.OpenTouchIDlog&&console.log(this.node.name," touchid :",this._touchid)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.node._onSetParent=this._onSetParent.bind(this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},t.prototype.start=function(){},t.prototype.touchStart=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=e.getID(),this.onTouchStart(e)):console.log(this.node.name," touch start  touchid is different! ")},t.prototype.touchMove=function(e){null!==this.touchid&&this.touchid!==e.getID()||(this.touchid=e.getID(),this.onTouchMove(e))},t.prototype.touchEnd=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchEnd(e)):console.log(this.node.name," touch end  touchid is different! ")},t.prototype.touchCancel=function(e){null===this.touchid||this.touchid===e.getID()?(this.touchid=null,this.onTouchCancel(e)):console.log(this.node.name," touch cancel  touchid is different! ")},t.prototype.onTouchStart=function(e){},t.prototype.onTouchMove=function(e){},t.prototype.onTouchEnd=function(e){},t.prototype.onTouchCancel=function(e){},t.prototype.onSetParent=function(e){},t.prototype._onSetParent=function(e){null==e&&(this.touchid=null),this.onSetParent(e)},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"./BaseView":"BaseView"}],SkewView:[function(e,t,o){"use strict";cc._RF.push(t,"dec79oJ2D1Ju7yCFAAR3rSI","SkewView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./EaseBaseView"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startSkew=cc.Vec2.ZERO,t}return __extends(t,e),t.prototype.onLoad=function(){0},t.prototype.start=function(){},t.prototype.canUpdate=function(){return!0},t.prototype.onSkewChanged=function(e,t,o,n){void 0===n&&(n=0),this.startSkew=cc.v2(this.node.skewX,this.node.skewY),this.startUpdate(new cc.Vec3(e.x,e.y,0),t,o,n)},t.prototype.onStep=function(){this.node.skewX=this.ease(this.startSkew.x,this.Target.x),this.node.skewY=this.ease(this.startSkew.y,this.Target.y)},t.prototype.onComplete=function(){this.node.skewX=this.Target.x,this.node.skewY=this.Target.y},t=__decorate([r],t)}(n.default));o.default=s,cc._RF.pop()},{"./EaseBaseView":"EaseBaseView"}],SkipButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"da4fdscFVtCWqRTSOOLaXU0","SkipButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Model/PlayModelProxy"),s=e("../../../Utils/Signal"),a=e("../../../View/SingleTouchView"),c=e("../../Command/GamePlaySignal"),l=e("../../Model/GamePlayModel"),u=cc._decorator,h=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal));o.NextLevelSignal=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal);o.SkipSignal=d;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canSkip=!1,t.startY=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"TimeCost",{get:function(){return this.node.getChildByName("TimeCost")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.TimeCost.active=!1,l.LevelGenDoneSignal.inst.addListener(function(){t.canSkip=!0},this),this.startY=this.TimeCost.y},t.prototype.onTouchEnd=function(){n.ButtonClickSignal.inst.dispatch(),0==this.canSkip||i.GameStateController.inst.isPause()||(this.canSkip=!1,this.TimeCost.active=!0,this.TimeCost.y=this.startY,this.TimeCost.opacity=255,this.TimeCost.runAction(cc.sequence(cc.delayTime(.3),cc.spawn(cc.moveBy(.4,this.TimeCost.x,120),cc.fadeOut(.4)))),setTimeout(function(){r.PlayModelProxy.inst.addGameTime(-10)},700),c.LevelDoneSignal.inst.dispatchOne(!1),d.inst.dispatch())},t=__decorate([h],t)}(a.default);o.default=f,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GamePlayModel":"GamePlayModel"}],SliderView:[function(e,t,o){"use strict";cc._RF.push(t,"2c746YFJCxKFJ34ypIaA1v3","SliderView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/Random"),i=cc._decorator,r=i.ccclass,s=i.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Progress=null,t.Slider=null,t.totalLength=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Percent",{get:function(){return this.Slider.progress},set:function(e){this.Slider.progress=n.Random.clamp(e,0,1),this.Progress.width=this.node.width*this.Slider.progress},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.Slider.node.on("slide",this.onSlided,this),this.totalLength=this.Progress.width},t.prototype.onSlided=function(){this.Progress.width=this.totalLength*this.Slider.progress,this.onProgress&&this.onProgress(this.Slider.progress)},t.prototype.start=function(){},t.prototype.onProgress=function(e){},__decorate([s(cc.Node)],t.prototype,"Progress",void 0),__decorate([s(cc.Slider)],t.prototype,"Slider",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{"../Utils/Random":"Random"}],SolutionButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"dab609dtz1ACY2ypJa9BUp+","SolutionButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Model/PlayModelProxy"),i=e("../../../Utils/Signal"),r=e("../../../View/SingleTouchView"),s=e("../../Command/GamePlaySignal"),a=e("../../Model/GamePlayModel"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i.BaseSignal));o.StartMoveChessSignal=u;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canTouch=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),a.LevelGenDoneSignal.inst.addListener(function(){t.canTouch=!0},this)},t.prototype.onTouchEnd=function(){0!=this.canTouch&&(this.canTouch=!1,n.PlayModelProxy.inst.checkHasAnswer(!0)||s.LevelDoneSignal.inst.dispatchOne(!1))},t=__decorate([l],t)}(r.default);o.default=h,cc._RF.pop()},{"../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView","../../Command/GamePlaySignal":"GamePlaySignal","../../Model/GamePlayModel":"GamePlayModel"}],SolutionRootView:[function(e,t,o){"use strict";cc._RF.push(t,"82bcassOXhJNpbX8DnWNaok","SolutionRootView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Model/GamePlayModel"),i=e("./SolutionButtonView"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;n.RoundGenDoneSignal.inst.addListener(function(){e.node.active=!0,i.StartMoveChessSignal.inst.dispatch()},this),i.StartMoveChessSignal.inst.addListener(function(){setTimeout(function(){},0)},this)},t.prototype.start=function(){},t=__decorate([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../../Model/GamePlayModel":"GamePlayModel","./SolutionButtonView":"SolutionButtonView"}],SoundButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"6d699bXGkJBYb+wyjeQyALI","SoundButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/ResourceController"),i=e("../../../Manager/AudioManager"),r=e("../../../Utils/Signal"),s=e("../../../View/SingleTouchView"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.BaseSignal)),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Sprite",{get:function(){return this.getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.updateState(),l.inst.addListener(this.updateState,this)},t.prototype.onTouchEnd=function(){i.gAudio.MusicVolume>0?(i.gAudio.setEffectVolume(0),i.gAudio.setMusicVolume(0)):(i.gAudio.setEffectVolume(1),i.gAudio.setMusicVolume(1)),l.inst.dispatch()},t.prototype.updateState=function(){var e=i.gAudio.MusicVolume;this.Sprite.spriteFrame=e>0?n.ResourceController.inst.getSoundEnable():n.ResourceController.inst.getSoundDisabled()},t=__decorate([c],t)}(s.default);o.default=u,cc._RF.pop()},{"../../../Controller/ResourceController":"ResourceController","../../../Manager/AudioManager":"AudioManager","../../../Utils/Signal":"Signal","../../../View/SingleTouchView":"SingleTouchView"}],StartGameCommand:[function(e,t,o){"use strict";cc._RF.push(t,"1db594KvoJIVbc+cwfogrGn","StartGameCommand"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Command/CommonSignal"),i=e("../../Model/PlayModelProxy"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){console.log("--------- excute StartGameCommand ---------"),i.PlayModelProxy.inst.initGametheme(),this.normalInit(),n.GameReadySignal.inst.dispatch()},t.prototype.testInit=function(){i.PlayModelProxy.inst.init()},t.prototype.normalInit=function(){i.PlayModelProxy.inst.init()},t}(puremvc.SimpleCommand);o.StartGameCommand=r,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Model/PlayModelProxy":"PlayModelProxy"}],StepManager:[function(e,t,o){"use strict";cc._RF.push(t,"83709TvPtJOVayPDGaPh6Ov","StepManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.totalStep=[],this.curStep=[],this.loadTime={}}return e.prototype.register=function(e,t){this.completeCallback=e,this.totalStep=t;for(var o=0,n=t;o<n.length;o++){var i=n[o];this.loadTime[i]=Date.now()}},e.prototype.nextStep=function(e){if(this.totalStep.indexOf(e)<0)console.error(" \u6ca1\u6709\u8fd9\u4e00\u6b65\uff1a",e);else if(this.curStep.indexOf(e)>=0)console.warn(" \u6b65\u9aa4\u5df2\u5b8c\u6210\uff1a",e);else{this.curStep.push(e),this.curStep.sort(function(e,t){return e>t?-1:1}),this.totalStep.sort(function(e,t){return e>t?-1:1});var t=this.curStep.join("-"),o=this.totalStep.join("-"),n=Date.now()-this.loadTime[e];console.log(" cur step:",t,", total step:",o,", cost time:",n," ms"),t==o&&(console.log(" step done"),this.totalStep.length=0,this.completeCallback(),this.completeCallback=null)}},e}();o.StepManager=n,cc._RF.pop()},{}],SubmitButtonView:[function(e,t,o){"use strict";cc._RF.push(t,"7d5e6ERlcdIapmrVvugM7L/","SubmitButtonView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Controller/GameStateController"),i=e("../../../View/SingleTouchView"),r=e("../../Command/GamePlaySignal"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onTouchEnd=function(){n.GameStateController.inst.isGameOver()||0==n.GameStateController.inst.isRoundStart()||r.SubmitButtonClickSignal.inst.dispatchOne("Submit"==this.node.name)},t=__decorate([a],t)}(i.default));o.default=c,cc._RF.pop()},{"../../../Controller/GameStateController":"GameStateController","../../../View/SingleTouchView":"SingleTouchView","../../Command/GamePlaySignal":"GamePlaySignal"}],SubmitLayerView:[function(e,t,o){"use strict";cc._RF.push(t,"f65c05YNytD2Zq3Ran+pohk","SubmitLayerView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/GameStateController"),r=e("../../../Controller/ResourceController"),s=e("../../../Model/PlayModelProxy"),a=e("../../../Utils/Signal"),c=e("../../../View/BaseView"),l=cc._decorator,u=l.ccclass,h=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(a.BaseSignal));o.EndNowSignal=h;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Resume",{get:function(){return this.node.getChildByName("ResumeButton")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndNow",{get:function(){return this.node.getChildByName("EndNow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FreePauseCount",{get:function(){return this.node.getChildByName("FreePauseCount").getComponent(cc.Label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PauseInfo",{get:function(){return this.node.getChildByName("PauseInfo").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;setTimeout(function(){e.node.active=!1,e.node.scale=1},0),this.EndNow.on(cc.Node.EventType.TOUCH_END,this.endNow,this),this.Resume.on(cc.Node.EventType.TOUCH_END,this.OnResume,this)},t.prototype.endNow=function(){var e=this;h.inst.dispatch(),n.ButtonClickSignal.inst.dispatch(),setTimeout(function(){e.Hide()},0)},t.prototype.OnResume=function(){var e=this;i.GameStateController.inst.resume(),n.ButtonClickSignal.inst.dispatch(),setTimeout(function(){e.Hide()},0)},t.prototype.onShow=function(){this.node.active||(s.PlayModelProxy.inst.FreePauseCount<=0?(this.FreePauseCount.node.active=!1,this.PauseInfo.spriteFrame=r.ResourceController.inst.getAltas("font_pauseno")):(this.FreePauseCount.node.active=!0,this.FreePauseCount.string=s.PlayModelProxy.inst.FreePauseCount.toString(),this.PauseInfo.spriteFrame=r.ResourceController.inst.getAltas("font_pausehave")),this.Show(),i.GameStateController.inst.pause())},t=__decorate([u],t)}(c.default);o.default=p,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Model/PlayModelProxy":"PlayModelProxy","../../../Utils/Signal":"Signal","../../../View/BaseView":"BaseView"}],TagAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"2eb85WnBC1OCK5o5I/S/Zlw","TagAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Utils/FrameAniBase"),i=e("../UI/LevelLineView"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Yes",{get:function(){return this.node.getChildByName("Yes")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"No",{get:function(){return this.node.getChildByName("No")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.Interval=.05,this.Yes.active=!1,this.No.active=!1,i.TagUpdateSignal.inst.addListenerTwo(function(t,o){e.node.name==o&&(e.node.active=!0,t?e.play():(e.getComponent(cc.Sprite).enabled=!1,e.No.active=!0,e.No.scale=0,e.No.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))))},this),this.node.active=!1},t.prototype.onComplete=function(){this.getComponent(cc.Sprite).enabled=!1,this.Yes.active=!0,this.Yes.scale=0,this.Yes.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))},t=__decorate([s],t)}(n.default));o.default=a,cc._RF.pop()},{"../../../Utils/FrameAniBase":"FrameAniBase","../UI/LevelLineView":"LevelLineView"}],TestApp:[function(e,t,o){"use strict";cc._RF.push(t,"b219e3JEelF8qF2ISXZvtH0","TestApp"),Object.defineProperty(o,"__esModule",{value:!0});e("../../Command/CommonSignal"),e("../../Factory/GameFactory");var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.prototype.start=function(){this.node.removeComponent(o)},t=o=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Factory/GameFactory":"GameFactory"}],TestSingleTouchView:[function(e,t,o){"use strict";cc._RF.push(t,"2761dS0K89JwJjOcqk97q1o","TestSingleTouchView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Factory/GameFactory"),i=e("../SingleTouchView"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onSetParent=function(e){console.error("parent:",e)},t.prototype.onTouchStart=function(){n.gFactory.putObj("TestNode",this.node)},t.prototype.onTouchEnd=function(){console.error("ontouchend")},t=__decorate([s],t)}(i.default));o.default=a,cc._RF.pop()},{"../../Factory/GameFactory":"GameFactory","../SingleTouchView":"SingleTouchView"}],Test:[function(e,t,o){"use strict";cc._RF.push(t,"df1af1sWs9HWZ8cYz9x0Gs9","Test"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.active=!CELER_X},t.prototype.start=function(){},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],ThemeView:[function(e,t,o){"use strict";cc._RF.push(t,"2b2d1k5+RZFrKLwiNmu7pk+","ThemeView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../View/BaseView"),i=e("../../Global/Theme"),r=e("../../Command/CommonSignal"),s=cc._decorator,a=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){r.GameThemeInit.inst.addListenerOne(this.onThemeInit,this)},t.prototype.start=function(){},t.prototype.onThemeInit=function(e){this.node.active=this.node.name==i.Theme[e]},t=__decorate([a],t)}(n.default));o.default=c,cc._RF.pop()},{"../../Command/CommonSignal":"CommonSignal","../../Global/Theme":"Theme","../../View/BaseView":"BaseView"}],Theme:[function(e,t,o){"use strict";cc._RF.push(t,"5fef4dbBENAfYW6Tw8oUA62","Theme"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Blue=0]="Blue",e[e.Green=1]="Green",e[e.Red=2]="Red"}(o.Theme||(o.Theme={})),cc._RF.pop()},{}],TimeEffectAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"603e6ws6zRH9IcpX4uo/ZlK","TimeEffectAnimation"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/FrameAniBase"),i=e("../Command/CommonSignal"),r=cc._decorator,s=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.opacity=0,i.TimeAnimationStateChanged.inst.addListenerOne(this.onPlayStateChanged,this)},t.prototype.onPlayStateChanged=function(e){e?0==this.isPlaying&&this.play():this.stop()},t.prototype.start=function(){},t.prototype.play=function(){this.node.opacity=255,e.prototype.play.call(this)},t.prototype.stop=function(){this.node.opacity=0,e.prototype.stop.call(this)},t=__decorate([s],t)}(n.default));o.default=a,cc._RF.pop()},{"../Command/CommonSignal":"CommonSignal","../Utils/FrameAniBase":"FrameAniBase"}],TimeLabelView:[function(e,t,o){"use strict";cc._RF.push(t,"8e78fIPKARBx69B005nUUwo","TimeLabelView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=e("../../../Controller/ResourceController"),r=e("../../../Global/GameRule"),s=e("../../../Utils/Time"),a=e("../../../View/BaseView"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sec=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"Label",{get:function(){return this.getComponent(cc.Label)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n.UpdateTimeNumber.inst.addListenerOne(this.onTimeChanged,this),this.onTimeChanged(r.TotalTime)},t.prototype.onTimeChanged=function(e){var t=s.Time.timeFormat(e);"MinuteLabel"==this.node.name?this.Label.string=t.split("/")[0]:"SecondLabel"==this.node.name?this.Label.string=t.split("/")[1]:this.Label.string=t,this.Label.font=e>30?i.ResourceController.inst.getTimeWhiteFont():i.ResourceController.inst.getTimeRedFont();var o=Math.floor(e);o!=this.sec&&("MinuteLabel"==this.node.name||"MinuteLabel"!=this.node.name&&"SecondLabel"!=this.node.name)&&(this.sec=o,this.sec<=5&&n.CountDownSignal.inst.dispatch())},t.prototype.start=function(){},t=__decorate([l],t)}(a.default));o.default=u,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/ResourceController":"ResourceController","../../../Global/GameRule":"GameRule","../../../Utils/Time":"Time","../../../View/BaseView":"BaseView"}],Time:[function(e,t,o){"use strict";cc._RF.push(t,"87a24xcV95AoII6L5W1ABoI","Time"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.timeFormat=function(e){var t=Math.floor(e/60),o=Math.floor(e%60),n=o.toString();return o<10&&(n="0"+o),t+"/"+n},e}();o.Time=n,cc._RF.pop()},{}],ToSingleton:[function(e,t,o){"use strict";cc._RF.push(t,"b07299nlSpOIIxOkIMBhUY9","ToSingleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleTon=function(){return function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this.ins?this.ins:this.ins=new this},enumerable:!0,configurable:!0}),e}()},cc._RF.pop()},{}],TurnView:[function(e,t,o){"use strict";cc._RF.push(t,"4c7ffI0FCdOq5IDmd4Ogl7g","TurnView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../Command/CommonSignal"),i=(e("../../../Controller/GameStateController"),e("../../../Controller/ResourceController")),r=e("../../../Global/Chess"),s=e("../../../Utils/Signal"),a=e("../../Model/GamePlayModel"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.BaseSignal));o.OnTurnInitSignal=u;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Color",{get:function(){return this.node.getChildByName("Color").getComponent(cc.Sprite)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Panel",{get:function(){return this.node.getChildByName("Panel")},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;this.Panel.active=!1,u.inst.addListenerOne(function(t){t==r.ChessType.White?e.Color.spriteFrame=i.ResourceController.inst.getAltas("bg_whitemove"):e.Color.spriteFrame=i.ResourceController.inst.getAltas("bg_blackmove")},this),this.node.y=0,a.LevelGenDoneSignal.inst.addListener(this.floatToBanner,this),n.GameStartSignal.inst.addListener(this.floatToBanner,this)},t.prototype.floatToBanner=function(){},t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../Command/CommonSignal":"CommonSignal","../../../Controller/GameStateController":"GameStateController","../../../Controller/ResourceController":"ResourceController","../../../Global/Chess":"Chess","../../../Utils/Signal":"Signal","../../Model/GamePlayModel":"GamePlayModel"}],UpdateController:[function(e,t,o){"use strict";cc._RF.push(t,"b3cadc9oLxMlaTWSqS0DgLW","UpdateController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Utils/ToSingleton"),i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){var t=e.call(this)||this;return t.assetsManager=null,t.STORAGE_PATH=(window.jsb&&jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hot-update",t.MANIFEST_PAth="",t.isUpdating=!1,t.manifest=null,t.completeCallback=[],t.startCallback=[],t.errorCallback=[],t.progressCallback=[],t.init(),t}return __extends(t,e),t.prototype.init=function(){window.jsb&&(this.assetsManager=new jsb.AssetsManager(this.MANIFEST_PAth,this.STORAGE_PATH,this.versionCompareHandle),this.assetsManager.setVerifyCallback(this.verifyCallback.bind(this)),cc.sys.os===cc.sys.OS_ANDROID&&this.assetsManager.setMaxConcurrentTask(2))},t.prototype.setManifest=function(e){this.manifest=e},t.prototype.getVersion=function(){return null==this.assetsManager?"":null==this.assetsManager.getLocalManifest()?"":this.assetsManager.getLocalManifest().getVersion()},t.prototype.addCompleteCallback=function(e,t){this.completeCallback.push({target:t,callback:e})},t.prototype.addErrorCallback=function(e,t){this.errorCallback.push({target:e,callback:t})},t.prototype.addStartCallback=function(e,t){this.startCallback.push({target:e,callback:t})},t.prototype.addProgressCallback=function(e,t){this.progressCallback.push({target:e,callback:t})},t.prototype.triggeError=function(e,t){void 0===t&&(t=!1),this.onError(e,t)},t.prototype.onError=function(e,t){void 0===t&&(t=!1),console.log(" this.errorCallback:",this.errorCallback.length,"error:",e);for(var o=0,n=this.errorCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.onComplete=function(e,t){void 0===t&&(t=!1),console.log(" on update complete:",this.getVersion()),console.log("storagePath:",this.getStoragePath()),console.log("search path:",this.getSearchPaths());for(var o=function(o){setTimeout(function(){o.callback.apply(o.target,[e,t])},0)},n=0,i=this.completeCallback;n<i.length;n++){o(i[n])}},t.prototype.getStoragePath=function(){return this.assetsManager?this.assetsManager.getStoragePath():""},t.prototype.getSearchPaths=function(){return window.jsb?jsb.fileUtils.getSearchPaths():""},t.prototype.onStart=function(e,t){void 0===t&&(t=!1),console.log(" this.startCallback:",this.startCallback.length);for(var o=0,n=this.startCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.onProgress=function(e,t){for(var o=0,n=this.progressCallback;o<n.length;o++){var i=n[o];i.callback.apply(i.target,[e,t])}},t.prototype.loadCustomManifest=function(e){if(null!=this.assetsManager&&this.assetsManager.getState()==jsb.AssetsManager.State.UNINITED){var t=new jsb.Manifest(e,this.STORAGE_PATH);this.assetsManager.loadLocalManifest(t,this.STORAGE_PATH)}},t.prototype.checkForUpdate=function(){this.onComplete("no need to update.")},t.prototype.checkUpdateCallback=function(e){switch(console.log("checkUpdateCallback Code: "+e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:var t=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():" null",o=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null";this.onComplete("Already up to date with the latest remote version :"+t+", local version :"+o);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.isUpdating=!1;var n=this.assetsManager.getLocalManifest()?this.assetsManager.getLocalManifest().getVersion():"null",i=this.assetsManager.getRemoteManifest()?this.assetsManager.getRemoteManifest().getVersion():"null";if(console.log("New version found, old:",n,", new: ",i),"null"==n||"null"==i);else{console.log("storage path:",this.assetsManager.getStoragePath());var r=n.split(".")[0];i.split(".")[0]>r?this.onStart("new version found, go to store to download new app.",!0):(this.onStart("new version found, update process start.",!1),this.updateVersion())}break;default:return}},t.prototype.getUpdateDescription=function(){return""},t.prototype.updateVersion=function(){if(null!=this.assetsManager&&!this.isUpdating)if([jsb.AssetsManager.State.UPDATING,jsb.AssetsManager.State.UNZIPPING,jsb.AssetsManager.State.UP_TO_DATE].indexOf(this.assetsManager.getState())>=0)this.onComplete("no need to update: "+this.assetsManager.getState(),!1);else{if(this.assetsManager.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifest.nativeUrl;cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this.assetsManager.loadLocalManifest(e)}this.assetsManager.setEventCallback(this.updateCallback.bind(this)),console.log(" start update ...:",this.assetsManager.getState()),this.assetsManager.update(),this.isUpdating=!0}},t.prototype.versionToInt=function(e){return parseInt(e.toString().split(".").join(""))},t.prototype.versionToString=function(e){return Math.floor(e/100)+"."+Math.floor(e/10)%10+"."+Math.floor(e)%10},t.prototype.updateCallback=function(e){var t=this,o=!1,n=!1,i=null;switch(console.log("update event code:",e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.onError("No local manifest file found, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var r=e.getPercent();NaN!=r&&"number"==typeof r||(r=0),this.onProgress(e.getMessage()?"Updated file:"+e.getMessage():"Updating:"+(100*r).toFixed(0)+"%",r);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.onError("Fail to download manifest file, hot update skipped."),n=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:i=function(){var e=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Already up to date with the latest remote version :"+e)},n=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:i=function(){var o=t.assetsManager.getRemoteManifest()?t.assetsManager.getRemoteManifest().getVersion():" null";t.onComplete("Update finished. new : "+o+e.getMessage(),!0)},o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.onError("Update failed. "+e.getMessage(),!0);break;case jsb.EventAssetsManager.ERROR_UPDATING:this.onError("Asset update error: "+e.getAssetId()+", "+e.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.onError(e.getMessage())}if(n&&(this.assetsManager.setEventCallback(null),this.isUpdating=!1),o){this.assetsManager.setEventCallback(null);var s=jsb.fileUtils.getSearchPaths();console.log("old searchPaths:",s);var a=this.assetsManager.getLocalManifest().getSearchPaths();console.log("new path:",JSON.stringify(a));for(var c=0,l=a;c<l.length;c++){var u=l[c];s.indexOf(u)<0&&Array.prototype.unshift.apply(s,u)}cc.sys.localStorage.setItem("select-game",JSON.stringify(s)),jsb.fileUtils.setSearchPaths(s),console.log("new searchPaths:",JSON.stringify(s)),console.log(" paths storage:",cc.sys.localStorage.getItem("select-game"))}i&&i()},t.prototype.restart=function(){cc.audioEngine.stopAll(),cc.game.restart()},t.prototype.retry=function(){null!=this.assetsManager&&0==this.isUpdating&&this.assetsManager.downloadFailedAssets()},t.prototype.versionCompareHandle=function(e,t){cc.log("JS Custom Version Compare: version A is "+e+", version B is "+t);for(var o=e.split("."),n=t.split("."),i=0;i<o.length;++i){var r=parseInt(o[i]),s=parseInt(n[i]||"0");if(r!==s)return r-s}return n.length>o.length?-1:0},t.prototype.verifyCallback=function(e,t){var o=t.compressed,n=t.md5,i=t.path;t.size;return o?("Verification passed : "+i,!0):("Verification passed : "+i+" ("+n+")",!0)},t.prototype.destory=function(){this.assetsManager&&this.assetsManager.setEventCallback(null),this.startCallback=[],this.completeCallback=[],this.errorCallback=[],this.progressCallback=[]},t=__decorate([r],t)}(n.SingleTon()));o.default=s,cc._RF.pop()},{"../Utils/ToSingleton":"ToSingleton"}]},{},["App","CommonSignal","GameStateController","ResourceController","GameFactory","GamePlaySignal","ChessModel","ChessRandomUtil","ChessUtil","GameLogic","GamePlayModel","GridUtil","CompleteAnimation","FireWorkAnimation","KillAnimation","LevelAnimationRoot","NoAnswerClickAnimation","TagAnimation","ChessGridTouchView","ChessGridView","ChessPositionView","ChessRoleView","ChessRootView","PrefabBaseView","ChessTouchView","AnswerView","BlackView","CompleteView","HasAnswerView","HelpButtonView","HintButtonView","HintCostLabelView","LevelLineView","LevelView","MenuButtonView","MenuLayerView","MoveCountLabelView","MoveCountRootView","NoSolutionButtonView","RandomSeedView","ResultLayerView","RevertButtonView","ScoreLabelView","SkipButtonView","SolutionButtonView","SolutionRootView","SoundButtonView","SubmitButtonView","SubmitLayerView","TimeLabelView","TurnView","Page1","Chess","GameRule","Level","Theme","InititalCommand","LoadAudioCommand","LoadPrefabCommand","StartGameCommand","InitialFacade","LoadingPageMediator","LoadingView","ThemeView","AudioManager","StepManager","PlayModelProxy","UpdateController","CelerSDK","Cocos","FrameAniBase","HashMap","LogHandler","Random","Signal","Time","ToSingleton","BaseMediator","BaseView","GlobalSingleTouchMediator","GlobalSingleTouchView","HelpLayerMediator","HelpLayerView","NumberChangedView","SingleTouchMediator","SingleTouchView","SliderView","Test","FrontView","TestApp","TestSingleTouchView","TimeEffectAnimation","EaseBaseView","PositionView","RotationView","ScaleView","SkewView"]);